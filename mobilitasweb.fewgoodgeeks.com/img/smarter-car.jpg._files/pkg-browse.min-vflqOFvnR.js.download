define("spectrum/icon_mode",["require","exports","tslib","react","spectrum/icon_templates/stateless","spectrum/svg_icon_bundle","spectrum/icon_mode/bundle"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.ICONS=s.ICONS,t.IconMode=function(e){var t=e.name,r=o.createElement(i.SvgIconBundle,{focusable:"false",icon:s.ICONS[t]});return o.createElement(n.Component,Object.assign({icon:r},e))},t.IconMode.displayName="IconMode"})),define("spectrum/icon_mode/bundle",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICONS=JSON.parse('\n    {"grid":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<g fill=\\"#637282\\" fill-rule=\\"evenodd\\"><path d=\\"M7 7h2v2H7zM11 7h2v2h-2zM15 7h2v2h-2zM7 11h2v2H7zM11 11h2v2h-2zM15 11h2v2h-2zM7 15h2v2H7zM11 15h2v2h-2zM15 15h2v2h-2z\\"></path></g>"},"list":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<g fill=\\"#637282\\" fill-rule=\\"evenodd\\"><path d=\\"M6 15h2v2H6zM10 15h8v2h-8zM6 11h2v2H6zM10 11h8v2h-8zM6 7h2v2H6zM10 7h8v2h-8z\\"></path></g>"},"tiles":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<g fill=\\"#637282\\" fill-rule=\\"evenodd\\"><path d=\\"M7 7h4v4H7zM13 7h4v4h-4zM13 13h4v4h-4zM7 13h4v4H7z\\"></path></g>"}}\n  ')})),define("modules/clean/browse/browse_bolt_client",["require","exports","modules/clean/bolt","modules/clean/react/browse/constants","modules/clean/api_v2/user_client","modules/core/exception"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e){var t=this;this.startLiveUpdate=function(e){void 0===e&&(e=null),e&&(t.handleUpdate=e),t.updateBoltClient(),t.status=o.BrowseBoltClientStatus.Live},this.onBoltRefresh=function(){t.updateBoltClient(),t.status=o.BrowseBoltClientStatus.Live},this.onBoltUpdate=function(){t.handleUpdate&&t.handleUpdate()},this.updateBoltClient=function(){var e=t.boltData.map((function(e){return new r.SignedChannelState("sfj",e.bolt_unique_id,e.latest_sjid.toString(),e.bolt_token)}));t.boltClient?t.boltClient.update_states(e):(t.boltClient=new r.BoltClient(e,t.onBoltUpdate,t.onBoltRefresh),t.boltClient.start())},this.userId=e,this.status=o.BrowseBoltClientStatus.NotReady,this.boltData=[]}return e.prototype.isReady=function(){return this.status!==o.BrowseBoltClientStatus.NotReady},e.prototype.setInitialBoltData=function(e){this.boltData=e,this.status=o.BrowseBoltClientStatus.NotLive},e.prototype.fetchInitialBoltData=function(e){var t=this;this.initialBoltDataRequest&&this.initialBoltDataRequest.abort(),(new n.UserApiV2Client).ns("files").rpc("get_browse_bolt_data",{},{subjectUserId:this.userId}).then((function(r){void 0===r.bolt_token_response&&i.reportException({err:new Error("Receieve empty bolt token response from /get_browse_bolt_data"),severity:"non-critical",tags:["js:browse"]});var o=r.bolt_token_response||[],n=[];o.forEach((function(e){n.push({bolt_token:e.bolt_token||"",bolt_unique_id:e.bolt_unique_id||"",latest_sjid:(e.latest_sjid||0).toString()})})),t.setInitialBoltData(n),e()}),(function(e){t.status=o.BrowseBoltClientStatus.NotReady,i.reportException({err:new Error("Error getting bolt data from /get_browse_bolt_data"),severity:"non-critical",tags:["js:browse"]})})).finally((function(){delete t.initialBoltDataRequest}))},e.prototype.handleUpdateBoltClient=function(e){this.boltData=e,this.updateBoltClient()},e.prototype.getNsMap=function(){var e={};return this.boltData.forEach((function(t){e[t.bolt_unique_id]=parseInt(t.latest_sjid,10)})),e},e.prototype.stopLiveUpdate=function(){this.status=o.BrowseBoltClientStatus.NotLive,this.boltClient&&this.boltClient.unsubscribe()},e})();t.BrowseBoltClient=s})),define("modules/clean/cloud_docs/create_api",["require","exports","tslib","react","apex-metrics","modules/clean/api_v2/user_client","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/create_pointer_modal","modules/clean/cloud_docs/event_logging","modules/clean/cloud_docs/types","modules/clean/filepath","modules/clean/logging/hive/schemas/web-modal-activity","modules/clean/react/async_file_modal_controller","modules/clean/react/folder_dialog/async","modules/clean/react/modal","modules/clean/react/snackbar","modules/clean/react/browse/api","modules/clean/react/browse/action_logger","modules/clean/web_user_action_events","modules/core/browser","modules/core/cookies","modules/core/i18n","spectrum/util/uuid_generator","modules/clean/cloud_docs/shared_components/survey_modal","modules/clean/metrics/index","modules/clean/cloud_docs/constants"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S,v,E,w,b,y,T,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),d=r.__importStar(d),p=r.__importStar(p),f=r.__importStar(f),h=r.__importStar(h),v=r.__importStar(v);var I=w.intl.formatMessage({id:"UpDkTB",defaultMessage:"Create file in..."}),O=w.intl.formatMessage({id:"7E4VWP",defaultMessage:"Create shortcut in..."}),C=w.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),P=w.intl.formatMessage({id:"GDikFY",defaultMessage:"Choose folder"});t.CloudDocSnackbarId="create-cloud-doc",t.getDepthFromPath=function(e){return(e.replace(/\/$/,"").match(/\//g)||[]).length},t.logCreateFileAttempt=function(e,t){l.logUserAction({actionEvent:c.UserActionEventType.PRE_CREATE,userId:t.userId,actionSource:t.action_source,data:{webOpenId:e}})},t.logCreateFileCallback=function(e){var t=e.ts,o=e.documentType,i=e.selectionMode,s=e.emptyFolder,a=e.error;return r.__awaiter(void 0,void 0,void 0,(function(){var e,l;return r.__generator(this,(function(r){return e=T.getMetricsReporter(),(l={}).document_type=o,l.selection_mode=i,l.empty_folder=String(s),l.error=a?"true":"false",e.createStats({ns:F.CLOUD_DOCS_AMP_NAMESPACE,name:"web/createFile"},l).recordDuration(Date.now()-t,n.TimeUnit.MILLISECONDS),[2]}))}))},t.logCreateFileSuccessCallback=function(e){var r=e.ts,o=e.openId,n=e.selection_mode,i=e.empty_folder;return function(e){t.logCreateFileCallback({ts:Date.now(),documentType:e.documentType,selectionMode:n,emptyFolder:i}),g.logFileCreateSuccess({uid:e.userId,document_type:e.documentType,time_elapsed:Date.now()-r,open_id:o,selection_mode:n,empty_folder:i}),l.logUserAction({actionEvent:c.UserActionEventType.CREATE,userId:e.userId,docPathOrId:e.fq_path,actionSource:e.action_source,data:{webOpenId:o}})}},t.showAsyncFolderDialog=function(e){var r=e.user,o=e.source,n=e.documentType,i=e.selection_mode,a=e.empty_folder,l=e.handleClickNewFolder,c=e.initialPath,d=s.isPointerFileType(n),p=d?O:I,_=d?P:C;f.showFolderDialog({modalName:u.ModalName.CLOUD_DOCS_CREATE,user:r,title:p,primaryActionLabel:_,handleClickNewFolder:l,initialPath:c,onSuccess:function(e,s){var l=e||"/";g.logFileCreateClick({uid:r.id,source:o,action:S.WebUserActionLogEvent.FILE_CREATE_HOME_FOLDER_SELECTED,depth_folder_selected:t.getDepthFromPath(l),selection_mode:i,empty_folder:a}),t.createNewFile({user:r,path:l,documentType:n,source:o,selection_mode:i,empty_folder:a})}})},t.createNewFile=function(o){var n=o.user,i=o.path,c=o.documentType,d=o.source,u=o.selection_mode,p=o.empty_folder,f=o.enableShortcutExtensionFeedback;return r.__awaiter(void 0,void 0,Promise,(function(){return r.__generator(this,(function(o){return[2,Promise.all([new Promise((function(t,r){e(["modules/clean/account/email"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/account/email_verify_reasons"],t,r)})).then(r.__importStar)]).then((function(e){var r=e[0].EmailVerification,o=e[1].CLOUD_DOCS;if(r.get_for_user(n).verified_or_show(o)){var _=b.generateUUID("web-create");if(s.isMicrosoftFileType(c)){t.logCreateFileAttempt(_,{userId:n.id,action_source:l.getActionSourceFromNewFileMenuType(d)});var m=t.logCreateFileSuccessCallback({ts:Date.now(),openId:_,selection_mode:u,empty_folder:p});A({userId:n.id,path:i,documentType:c,logSuccessCallback:m,source:d})}else if(s.isPointerFileType(c))a.CreatePointerModal.showInstance({createOnSubmit:function(e){t.logCreateFileAttempt(_,{userId:n.id,action_source:l.getActionSourceFromNewFileMenuType(d)});var r=t.logCreateFileSuccessCallback({ts:Date.now(),openId:_,selection_mode:u,empty_folder:p});t.createNewPointer({userId:n.id,pathName:i,name:e.pointerData.name,url:e.pointerData.url,onError:e.onError,logSuccessCallback:r,source:d,enableShortcutExtensionFeedback:f})}});else{t.logCreateFileAttempt(_,{userId:n.id,action_source:l.getActionSourceFromNewFileMenuType(d)});m=t.logCreateFileSuccessCallback({ts:Date.now(),openId:_,selection_mode:u,empty_folder:p});t.createNewCloudOnlyDoc({userId:n.id,pathName:i,title:w.intl.formatMessage({id:"j+AeKy",defaultMessage:"Untitled"}),documentType:c,logSuccessCallback:m,source:d,openId:_,selection_mode:u,empty_folder:p})}}}))]}))}))};var A=function(e){var r=e.userId,o=e.path,n=e.documentType,i=e.logSuccessCallback,s=e.source,a={fq_path:o,extension:n,action_source:t.getCreateActionSource(s),_subject_uid:String(r),t:E.Cookies.read("__Host-js_csrf")},c=t.constructFormForCreateNewMicrosoftFile(a);document.body.appendChild(c),c.submit(),i({userId:r,documentType:n,action_source:l.getActionSourceFromNewFileMenuType(s)})};t.constructFormForCreateNewMicrosoftFile=function(e){var t=document.createElement("form");t.action="/ow/msft/create_new_file",t.method="POST",t.target="_blank";for(var r=0,o=Object.keys(e);r<o.length;r++){var n=o[r],i=document.createElement("input");i.type="hidden",i.name=n,i.value=e[n],t.appendChild(i)}return t},t.createPlaceholderTabForNewCloudDoc=function(){return v.open_tab(s.LOADING_PAGE_URL,!0)},t.createNewCloudOnlyDoc=function(e){var r=e.userId,n=e.pathName,i=e.title,a=e.documentType,c=e.logSuccessCallback,d=e.source,u=e.openId,f=e.selection_mode,g=e.empty_folder,S=w.intl.formatMessage({id:"XcMi4Q",defaultMessage:"Creating new file…"}),v=w.intl.formatMessage({id:"5VrbkU",defaultMessage:"File created!"}),E=function(e){return e.preventDefault(),e.returnValue="",""};window.addEventListener("beforeunload",E);var b=t.createPlaceholderTabForNewCloudDoc(),T=function(e){m.Snackbar.sync(S,!0,t.CloudDocSnackbarId),h.createCloudDoc({pathName:n,title:i,documentType:a,userId:r,onSuccess:function(e){e.changesets;var n=e.createdFile,i=e.failureDetails;if(i){b.close(),m.Snackbar.close(t.CloudDocSnackbarId),window.removeEventListener("beforeunload",E),p.showFileSystemWarningsModal({fsws:i,confirmText:w.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),onFinalAccept:function(){c=t.logCreateFileSuccessCallback({ts:Date.now(),openId:u,selection_mode:f,empty_folder:g}),b=t.createPlaceholderTabForNewCloudDoc(),T(!1)}})}else if(m.Snackbar.complete(v,t.CloudDocSnackbarId),window.removeEventListener("beforeunload",E),null!==n){if(c({userId:r,documentType:a,fq_path:n.fq_path,action_source:l.getActionSourceFromNewFileMenuType(d)}),b){var h=n.open_to_url;try{var S=new URL(h);S.searchParams.set("web_open_id",u),h=S.toString()}catch(e){}b.location.replace(h)}s.isGoogleFileType(a)&&_.Modal.showInstance(o.default.createElement(y.GoogleSurveyModal,{userId:r,documentType:a}))}},onError:function(e){t.logCreateFileCallback({ts:Date.now(),documentType:a,selectionMode:f,emptyFolder:g,error:!0}),m.Snackbar.fail(e,t.CloudDocSnackbarId),window.removeEventListener("beforeunload",E)},checkFSWs:e})};T(!0)},t.createNewPointer=function(t){var n=t.userId,a=t.pathName,u=t.name,p=t.url,f=t.onError,h=t.logSuccessCallback,g=t.source,S=t.enableShortcutExtensionFeedback,v=new i.UserApiV2Client,E=w.intl.formatMessage({id:"l6L9q8",defaultMessage:"Creating new shortcut"}),b=w.intl.formatMessage({id:"EqUCHi",defaultMessage:"Created shortcut"});return m.Snackbar.sync(E,!0,"create-cloud-shortcut"),v.ns("cloud_docs").rpc("create",{to_path:d.normalize(a)||"/",title:u,cloud_doc_type:c.SimplePointer,pointer_url:p},{subjectUserId:n}).then((function(t){h({userId:n,documentType:s.PointerFileTypes.SIMPLE_POINTER,fq_path:t.result_path,action_source:l.getActionSourceFromNewFileMenuType(g)}),_.Modal.close(),m.Snackbar.complete(b+' "'+d.filename(t.result_path)+'"',"create-cloud-shortcut"),S&&new Promise((function(t,r){e(["modules/clean/cloud_docs/shortcuts/feedback_modal"],t,r)})).then(r.__importStar).then((function(e){var r=e.ShortcutsFeedbackModal,i=e.ShortcutsFeedbackModalFlagMask;_.Modal.showInstance(o.default.createElement(r,{userId:n,entryMask:i.CREATE_MENU,source:"create_menu",fqPath:t.result_path}))}))})).catch((function(e){f(),m.Snackbar.fail(w.intl.formatMessage({id:"fi9Okp",defaultMessage:"Oops, something went wrong. Please try again later."}),"create-cloud-shortcut")}))},t.getCreateActionSource=function(e){switch(e){case s.NewFileMenuFromType.BROWSE:return s.ActionSourceValue.WEB_BROWSE;case s.NewFileMenuFromType.HOME:return s.ActionSourceValue.WEB_HOME;default:return s.ActionSourceValue.WEB}}})),define("modules/clean/cloud_docs/create_pointer_modal",["require","exports","tslib","react","modules/clean/cloud_docs/pointers_common","modules/clean/react/css","modules/clean/react/modal","modules/core/i18n","spectrum/button","spectrum/modal"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var d=a.intl.formatMessage({id:"Qq0yqO",defaultMessage:"Create a new shortcut"}),u=a.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),p=a.intl.formatMessage({id:"KOp2Z9",defaultMessage:"Creating..."}),f=a.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),_=a.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"}),m=a.intl.formatMessage({id:"Di2bB3",defaultMessage:"URL"}),h=a.intl.formatMessage({id:"vtIvYJ",defaultMessage:"Invalid URL"}),g=(function(e){function t(t){var r=e.call(this,t)||this;return r.onChange=function(e){r.setState({pointerData:e})},r.handleCreateOnClick=function(){r.setState({creationInProgress:!0}),r.props.createOnSubmit({pointerData:{name:r.state.pointerData.name.trim(),url:r.state.pointerData.url.trim()},onError:r.handleSubmitError})},r.handleSubmitError=function(){r.setState({creationInProgress:!1})},r.renderCreateButton=function(){var e=n.CreatePointerFields.canSubmit(r.state.pointerData)&&!r.state.creationInProgress;return o.default.createElement(l.Button,{variant:"primary",disabled:!e,onClick:r.handleCreateOnClick},r.state.creationInProgress?p:u)},r.renderCancelButton=function(){return o.default.createElement(l.Button,{variant:"secondary",onClick:s.Modal.close},f)},r.state={pointerData:{name:"",url:""},creationInProgress:!1},r}return r.__extends(t,e),t.prototype.render=function(){return o.default.createElement(c.UtilityModal,{title:d,ariaLabel:"Shortcut Creation Modal",primaryAction:this.renderCreateButton,secondaryAction:this.renderCancelButton,open:!0,shouldRequestCloseOnActions:!1,overlayClickClose:!0,variant:"regular"},o.default.createElement(n.CreatePointerFields,{name:this.state.pointerData.name,url:this.state.pointerData.url,onChange:this.onChange,onSubmit:this.handleCreateOnClick,nameLabel:_,urlLabel:m,urlValidationMessage:h}))},t.showInstance=function(e){return s.Modal.showInstance(o.default.createElement(S,r.__assign({},e)))},t})(o.default.Component);t.CreatePointerModal=g;var S=i.requireCssWithComponent(g,["/static/css/spectrum/index.web-vfl6Z83yw.css","/static/css/cloud_docs/create_pointer_modal-vflATc8Dt.css"])})),define("modules/clean/cloud_docs/event_logging",["require","exports","tslib","modules/clean/api_v2/user_client","modules/clean/api_v2/noauth_client","modules/clean/cloud_docs/types","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/clean/logging/hive/schemas/web-user-action","modules/clean/logging/telemetry","modules/constants/python","modules/clean/cloud_docs/constants","modules/core/browser","modules/clean/perf_tools/web_timing_utils","modules/core/exception","modules/clean/filepath"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importStar(s),c=r.__importStar(c),p=r.__importStar(p);var h=void 0;t.getStartTime=function(){try{h=h||p.performance().timing.fetchStart}catch(e){_.reportStack("Unable to get fetchStart from browser.",{severity:_.SEVERITY.NONCRITICAL}),h=s.start_time()}return h},t.logViewEvent=function(e,t,r){var n={file_views:[{file_info:{shared_link_details:{url:t}},platform_type:{".tag":r}}]};(new o.UserApiV2Client).ns("seen_state").rpc("log_file_view",n,{subjectUserId:e})},t.logClientEvent=function(e,r,o,a,l){var c=l||[];c.push({key:"time_on_page_with_redirect",value:s.time_since_start().toString()}),c.some((function(e){return"time_now"===e.key}))||c.push({key:"time_now",value:Date.now().toString()}),(new n.NoAuthApiV2Client).ns("cloud_docs").rpc("log_client_event",{client:i.editorTypeToClient[r],doc_id:e,event_name:o,auth_token:a,time_on_page:f.WebTimingUtil.getNow()-t.getStartTime(),extras:c},{})},t.logUserAction=function(e){var t,r=(new o.UserApiV2Client).ns("cloud_docs");e.hasOwnProperty("docPathOrId")&&e.docPathOrId&&(t={".tag":"path_or_id",path_or_id:e.docPathOrId});var n=e.data&&e.data.webOpenId,i=e.data&&e.data.origDest,s=e.data&&e.data.routingDest;r.rpc("log_user_action",{action:e.actionEvent,doc_id:t,source:e.actionSource,open_id:n,orig_dest:i,routing_dest:s,extra_info:e.extra},{subjectUserId:e.userId})},t.logLoggedOutUserAction=function(e){var t,r=(new n.NoAuthApiV2Client).ns("cloud_docs");e.hasOwnProperty("docPathOrId")&&e.docPathOrId&&(t={".tag":"path_or_id",path_or_id:e.docPathOrId});var o=e.data&&e.data.webOpenId,i=e.data&&e.data.origDest,s=e.data&&e.data.routingDest;r.rpc("logged_out/log_user_action",{action:e.actionEvent,doc_id:t,source:e.actionSource,open_id:o,orig_dest:i,routing_dest:s,extra_info:e.extra},{})},t.checkAndLogNpu=function(e,t,r,n,i){(new o.UserApiV2Client).ns("cloud_docs").rpc("log_new_partner_users",{partner:t,cloud_doc_type:m.file_extension(r),cloud_editor:n,platform:i},{subjectUserId:e})},t.getActionSourceFromSurface=function(e){return"search"===e?i.UserActionSourceType.WEB_SEARCH:"previews"===e?i.UserActionSourceType.WEB_PREVIEW:"home_recent"===e||"home_starred"===e?i.UserActionSourceType.WEB_HOME:"browse"===e||"sidebar"===e?i.UserActionSourceType.WEB_BROWSE:i.UserActionSourceType.WEB},t.getActionSourceFromSourceArgs=function(e){return e.fileViewAction===d.FileViewActionType.SEARCH||e.fileViewOrigin===d.FileViewOriginType.SEARCH?i.UserActionSourceType.WEB_SEARCH:e.fileViewOrigin===d.FileViewOriginType.BROWSE?i.UserActionSourceType.WEB_BROWSE:e.fileViewOrigin===d.FileViewOriginType.HOME?i.UserActionSourceType.WEB_HOME:i.UserActionSourceType.WEB},t.getActionSourceFromNewFileMenuType=function(e){switch(e){case u.NewFileMenuFromType.BROWSE:return i.UserActionSourceType.WEB_BROWSE;case u.NewFileMenuFromType.HOME:return i.UserActionSourceType.WEB_HOME;default:return i.UserActionSourceType.WEB}},t.logFileOpenPromptAction=function(e,t,r,o,n){(new c.HiveLogger).log(new l.WebUserActionRow({user_id:e,event_name:a.WebUserActionLogEvent.FILE_OPEN_PROMPT_ACTION,extra:{file_type:t,integration_name:r,prompt_action:o,ask_again:n}}))},t.logFileConvertPromptAction=function(e,t,r,o){(new c.HiveLogger).log(new l.WebUserActionRow({user_id:e,event_name:a.WebUserActionLogEvent.FILE_CONVERT_PROMPT_ACTION,extra:{prompt_action:t,integration_name:r,file_extension:o}}))},t.logInterstitialLoginAction=function(e,t,r){(new c.HiveLogger).log(new l.WebUserActionRow({event_name:a.WebUserActionLogEvent.INTERSTITIAL_LOGIN_ACTION,extra:{prompt_action:e,logged_out_ux_google_variant:t,file_extension:r}}))},t.logLoggedOutUXSnackBarAction=function(e,t,r,o){(new c.HiveLogger).log(new l.WebUserActionRow({event_name:a.WebUserActionLogEvent.LOGGED_OUT_UX_SNACKBAR_ACTION,extra:{prompt_action:e,file_extension:t,logged_out_ux_google_variant:r||"",logged_out_ux_paper_variant:o||""}}))}})),define("modules/clean/cloud_docs/new_file_menu",["require","exports","tslib","classnames","react","dig-components/buttons","dig-components/typography","dig-components/menu","spectrum/icon_content","spectrum/icon_partners","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/create_api","modules/clean/react/browse/action_logger","modules/clean/react/css","modules/clean/web_user_action_events","modules/clean/web_user_action_logger","modules/constants/page_load","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),h=r.__importStar(h),t.LongNewFileCreateLabel=g.intl.formatMessage({id:"8/w9ir",defaultMessage:"Create new file"}),t.ShortNewFileCreateLabel=g.intl.formatMessage({id:"o96TiK",defaultMessage:"Create"});var S=g.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"}),v=g.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"}),E=g.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"}),w=g.intl.formatMessage({id:"0rYKaW",defaultMessage:"Excel Workbook"}),b=g.intl.formatMessage({id:"e9uLbL",defaultMessage:"PowerPoint Presentation"}),y=g.intl.formatMessage({id:"yY5byF",defaultMessage:"Word Document"}),T=g.intl.formatMessage({id:"neBk7u",defaultMessage:"Dropbox Paper"}),F=g.intl.formatMessage({id:"Rvv7NR",defaultMessage:"Dropbox Paper Template"}),I=g.intl.formatMessage({id:"sbO30Y",defaultMessage:"Dropbox Binder (Beta)"}),O=g.intl.formatMessage({id:"4gEt6j",defaultMessage:"Shortcut"});t.handleNewFileSelection=function(e){e.handleClick()};var C=function(e){switch(e){case d.MicrosoftFileTypes.WORD:return _.WebUserActionLogEvent.FILE_CREATE_WORD;case d.MicrosoftFileTypes.EXCEL:return _.WebUserActionLogEvent.FILE_CREATE_EXCEL;case d.MicrosoftFileTypes.POWERPOINT:return _.WebUserActionLogEvent.FILE_CREATE_POWERPOINT;case d.GoogleFileTypes.GOOGLE_DSS_DOC:return _.WebUserActionLogEvent.FILE_CREATE_GOOGLE_DOC;case d.GoogleFileTypes.GOOGLE_DSS_SHEET:return _.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SHEET;case d.GoogleFileTypes.GOOGLE_DSS_SLIDES:return _.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SLIDES;case d.PaperNewFileTypes.PAPER:return _.WebUserActionLogEvent.FILE_CREATE_PAPER;case d.PaperNewFileTypes.PAPER_TEMPLATE:return _.WebUserActionLogEvent.FILE_CREATE_PAPER_TEMPLATE;case d.PaperNewFileTypes.PAPER_BINDER:return _.WebUserActionLogEvent.FILE_CREATE_BINDER;case d.PointerFileTypes.SIMPLE_POINTER:return _.WebUserActionLogEvent.FILE_CREATE_SIMPLE_POINTER;case d.GenericFileTypes.DROPBOX_FORM:return _.WebUserActionLogEvent.FILE_CREATE_DROPBOX_FORM}},P=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.renderIcon=function(){return"dropbox_form"===this.props.item.iconName?n.default.createElement("img",{alt:this.props.item.displayName,src:"/static/images/dropbox_form-vfl1f-v2W.svg",width:"24px",height:"24px"}):"microsoft_docx"===this.props.item.iconName?n.default.createElement("img",{alt:this.props.item.displayName,src:"/static/images/cloud_docs/docx_icon-vfl0tYCBy.svg",width:"24px",height:"24px"}):"microsoft_xlsx"===this.props.item.iconName?n.default.createElement("img",{alt:this.props.item.displayName,src:"/static/images/cloud_docs/xlsx_icon-vflnPbWkI.svg",width:"24px",height:"24px"}):"microsoft_pptx"===this.props.item.iconName?n.default.createElement("img",{alt:this.props.item.displayName,src:"/static/images/cloud_docs/pptx_icon-vflRYqDYS.svg",width:"24px",height:"24px"}):this.props.item.isFolderAction?n.default.createElement(l.IconContent,{name:this.props.item.iconName,width:"24px",height:"24px"}):n.default.createElement(c.IconPartners,{name:this.props.item.iconName,width:"24px",height:"24px"})},t.prototype.render=function(){return n.default.createElement(a.Menu.ActionItem,{key:this.props.item.displayName,value:this.props.item,className:this.props.item.className,withLeftAccessory:this.renderIcon()},n.default.createElement(s.Text,null,this.props.item.displayName))},t})(n.default.Component);t.NewFileTypeRow=P;var A=(function(e){function s(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCreateNewFile=function(e){return function(){var r=t.props,o=r.selection_mode,n=r.empty_folder,i=function(r){u.showAsyncFolderDialog({user:t.props.user,source:t.props.source,documentType:e,selection_mode:o,empty_folder:n,handleClickNewFolder:t.props.handleClickNewFolder?t.props.handleClickNewFolder(t.props.user,i):void 0,initialPath:r})};p.logFileCreateClick({uid:t.props.user.id,source:t.props.source,action:C(e),depth_folder_selected:t.props.path?u.getDepthFromPath(t.props.path):void 0,selection_mode:o,empty_folder:n}),t.props.path?u.createNewFile({user:t.props.user,path:t.props.path,documentType:e,source:t.props.source,selection_mode:o,empty_folder:n,enableShortcutExtensionFeedback:t.props.enableShortcutExtensionFeedback}):i()}},t.logTriggerClick=function(){var e=t.props,r=e.empty_folder,o=e.selection_mode,n=e.path,i=e.user,s=e.source;p.logFileCreateClick({uid:i.id,source:s,action:_.WebUserActionLogEvent.FILE_CREATE_OPEN_MENU,depth_folder_selected:n?u.getDepthFromPath(n):void 0,selection_mode:o,empty_folder:r}),t.props.consolidateCreate&&m.WebUserActionLog.log(i.id,_.WebUserActionLogEvent.CREATE_CLICK,{})},t}return r.__extends(s,e),s.prototype.getNewFileTypeSections=function(){var e=[],t=[];if(this.props.consolidateCreate&&this.props.newFolderActions)for(var r=0,o=this.props.newFolderActions;r<o.length;r++){var n=o[r];t.push({displayName:n.displayName,iconName:n.iconName,className:n.className,handleClick:n.handleClick,isFolderAction:!0})}this.props.showPaper&&(t.push({displayName:T,iconName:"dropbox_paper",className:"action-create-file-paper-doc",handleClick:this.handleCreateNewFile(d.PaperNewFileTypes.PAPER)}),t.push({displayName:F,iconName:"dropbox_paper_template",className:"action-create-file-paper-template",handleClick:this.handleCreateNewFile(d.PaperNewFileTypes.PAPER_TEMPLATE)})),this.props.showBinder&&t.push({displayName:I,iconName:"dropbox_paper_binder",className:"action-create-file-paper-binder",handleClick:this.handleCreateNewFile(d.PaperNewFileTypes.PAPER_BINDER)}),t.push({displayName:O,iconName:"shortcut",className:"action-create-simple-pointer",handleClick:this.handleCreateNewFile(d.PointerFileTypes.SIMPLE_POINTER)}),t.length>0&&e.push(t);var i=[];if(i.push({displayName:y,iconName:"microsoft_docx",className:"action-create-file-word",handleClick:this.handleCreateNewFile(d.MicrosoftFileTypes.WORD)}),i.push({displayName:w,iconName:"microsoft_xlsx",className:"action-create-file-excel",handleClick:this.handleCreateNewFile(d.MicrosoftFileTypes.EXCEL)}),i.push({displayName:b,iconName:"microsoft_pptx",className:"action-create-file-powerpoint",handleClick:this.handleCreateNewFile(d.MicrosoftFileTypes.POWERPOINT)}),e.push(i),this.props.showGdd){var s=[];s.push({displayName:S,iconName:"google_gdoc",className:"action-create-file-google-doc",handleClick:this.handleCreateNewFile(d.GoogleFileTypes.GOOGLE_DSS_DOC)}),s.push({displayName:v,iconName:"google_gsheet",className:"action-create-file-google-sheet",handleClick:this.handleCreateNewFile(d.GoogleFileTypes.GOOGLE_DSS_SHEET)}),s.push({displayName:E,iconName:"google_gslides",className:"action-create-file-google-slides",handleClick:this.handleCreateNewFile(d.GoogleFileTypes.GOOGLE_DSS_SLIDES)}),e.push(s)}return this.props.showDropboxForms&&t.push({displayName:"Dropbox Form",iconName:"dropbox_form",className:"action-create-file-dropbox-form",handleClick:this.handleCreateNewFile(d.GenericFileTypes.DROPBOX_FORM)}),e},s.prototype.renderTrigger=function(e){var s=0===h.USER_LOCALE.indexOf("en")||this.props.forceLongLabel?t.LongNewFileCreateLabel:t.ShortNewFileCreateLabel;this.props.consolidateCreate&&(s=t.ShortNewFileCreateLabel);var a=r.__assign(r.__assign({},e),{disabled:this.props.disabled,className:o.default("primary-action-menu__button","action-create-file"),variant:this.props.enableSecondary?"outline":"primary"});return n.default.createElement(i.Button,r.__assign({key:t.LongNewFileCreateLabel,withDropdownIcon:!0},a),s)},s.prototype.renderSection=function(e,t){return n.default.createElement(a.Menu.Segment,{key:t},e.map((function(e){return n.default.createElement(P,{item:e,key:e.displayName})})))},s.prototype.render=function(){var e=this,o=this.getNewFileTypeSections();return n.default.createElement(a.Menu.Wrapper,{onToggle:this.logTriggerClick,onSelection:t.handleNewFileSelection},(function(t){var i=t.getContentProps,s=t.getTriggerProps;return n.default.createElement(n.default.Fragment,null,e.renderTrigger(s()),n.default.createElement(a.Menu.Content,r.__assign({},i()),o.map(e.renderSection)))}))},s.defaultProps={},s})(n.default.Component),D=f.requireCssWithComponent(A,["/static/css/dig-components/index.web-vfliFNMrU.css","/static/css/cloud_docs/create_pointer_modal-vflATc8Dt.css"]);t.NewFileMenu=D})),define("modules/clean/cloud_docs/open_with_utils",["require","exports","tslib","apex-metrics","modules/core/browser","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/event_logging","modules/clean/cloud_docs/types","modules/clean/referrer_cleansing_redirect","modules/clean/cloud_docs/constants","modules/core/uri","modules/clean/cloud_docs/utils","modules/clean/open_with","spectrum/util/uuid_generator","modules/core/browser_detection","modules/clean/cloud_docs/create_api","modules/clean/metrics/index"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h){"use strict";function g(){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/api_v2/user_client"],t,r)})).then(r.__importStar)];case 1:return[2,(new(0,t.sent().UserApiV2Client)).ns("cloud_docs")]}}))}))}var S,v;function E(e){if(void 0!==e&&void 0!==e.error&&void 0!==e.error[".tag"])return e.error[".tag"]}function w(e){switch(E(e)){case"invalid_file_id":case"permission_denied":case"other":default:return}}function b(e,t,r,o,i,l,c){var u=f.generateUUID("web_open_id"),p=d.URI.parse(e.cloud_editor_url).updateQuery({cloud_editor:i,web_open_id:u});l&&p.updateQuery({ignore_lock:"1"});var _=p.toString();_&&(void 0===c&&(c=a.UserActionSourceType.WEB),s.logUserAction({actionEvent:a.UserActionEventType.PRE_OPEN,userId:o.id,docPathOrId:r.file_id,actionSource:c,data:{webOpenId:u}}),null!=t?n.redirect(_,t):n.open_tab(_))}function y(e){return[".gdoc",".gsheet",".gslides"].indexOf(u.getFileExt(e))>=0}function T(e){return".web"===u.getFileExt(e)}function F(e,t){for(var r=u.getFileExt(e),o=0,n=Object.keys(c.DSS_TYPE_TO_SUPPORTED_EXTS);o<n.length;o++){var i=n[o];if(c.DSS_TYPE_TO_SUPPORTED_EXTS[i].indexOf(r)>=0)return i}switch(r){case".gdoc":return c.GoogleFileTypes.GOOGLE_DSS_DOC;case".gsheet":return c.GoogleFileTypes.GOOGLE_DSS_SHEET;case".gslides":return c.GoogleFileTypes.GOOGLE_DSS_SLIDES}return null}Object.defineProperty(t,"__esModule",{value:!0}),l=r.__importStar(l),p=r.__importDefault(p),_=r.__importStar(_),t.getCloudEditorUrlCached=function(e,o){return r.__awaiter(void 0,void 0,Promise,(function(){return r.__generator(this,(function(r){return S||(S=t.getCloudEditorUrl(e,o)),[2,S]}))}))},t.getCloudEditorUrl=function(e,t){return r.__awaiter(void 0,void 0,Promise,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,g()];case 1:return[2,r.sent().rpc("get_cloud_editor_url",{file_id:t},{subjectUserId:e})]}}))}))},t.decodeAPIError=E,t.handleError=w,t.isInEdgeIframe=function(){var e=!1;if(_.edge||_.msie||_.edgeChromium())try{e=window.self!==window.top}catch(t){e=!0}return e},t.openCloudEditorUrl=b,t.openWithCloudEditor=function(e,n,s,a,l){return r.__awaiter(void 0,void 0,void 0,(function(){var c,d,u,p,f,_,g,S;return r.__generator(this,(function(r){switch(r.label){case 0:r.trys.push([0,11,,12]),c=performance.now(),d=h.getMetricsReporter(),u={},r.label=1;case 1:return r.trys.push([1,8,9,10]),u.editor=s,l&&(u.source=l[".tag"]),p=t.isInEdgeIframe(),u.isInEdgeIframe=String(p),(f=e.open_to_url)&&f.startsWith("https://www.dropbox.com/scl/fi/")?(u.usedOpenToURLFromFile="true",b({cloud_editor_url:f},null,e,n,s,a,l),[3,7]):[3,2];case 2:return u.usedOpenToURLFromFile="false",_=p?null:m.createPlaceholderTabForNewCloudDoc(),p?[4,t.getCloudEditorUrlCached(n.id,e.file_id)]:[3,4];case 3:return g=r.sent(),[3,6];case 4:return[4,t.getCloudEditorUrl(n.id,e.file_id)];case 5:g=r.sent(),r.label=6;case 6:b(g,_,e,n,s,a,l),r.label=7;case 7:return u.error="false",[3,10];case 8:return S=r.sent(),u.error="true",w(S),[3,10];case 9:return d.createStats({ns:i.CLOUD_DOCS_AMP_NAMESPACE,name:"web/openWithCloudEditor"},u).recordDuration(performance.now()-c,o.TimeUnit.MILLISECONDS),[7];case 10:return[3,12];case 11:return w(r.sent()),[3,12];case 12:return[2]}}))}))},t.openCloudDoc=function(t,o,c){if(c||(c=a.UserActionSourceType.WEB),t.href)if(i.isPointerByExtension(t.ns_path))l.safe_open_tab_and_redirect(t.href),s.logUserAction({actionEvent:a.UserActionEventType.PRE_OPEN,userId:o.id,docPathOrId:t.file_id,actionSource:c});else{var u=f.generateUUID("web_open_id"),p=d.URI.parse(t.href).updateQuery("web_open_id",u).toString();n.open_tab(p),s.logUserAction({actionEvent:a.UserActionEventType.PRE_OPEN,userId:o.id,docPathOrId:t.file_id,actionSource:c,data:{webOpenId:u}})}else{var _=m.createPlaceholderTabForNewCloudDoc();new Promise((function(t,r){e(["modules/clean/previews/data/actions"],t,r)})).then(r.__importStar).then((function(e){return e.fetchPreviewUrl(t,o)})).then((function(e){e&&null!==_&&l.redirect(e,_,!0)}))}},(function(e){e.OfficeOnline="OfficeOnline",e.GoogleDSS="GoogleDSS"})(v=t.OpenWithCloudDocProvider||(t.OpenWithCloudDocProvider={})),t.getOpenWithCloudEditorInfo=function(e,r,o,n){var i=[],s=t.getOpenWithWopiEditorInfo(e,r,n);s&&o.wopi&&i.push(s);var a=t.getOpenWithGoogleEditorInfo(e,r,n);return a&&o.gdd&&i.push(a),i},t.getOpenWithGoogleEditorInfo=function(e,r,o){var n=F(e,r);return n?{text:c.DSS_TYPE_TO_TEXT[n],iconUrl:c.DSS_TYPE_TO_OPEN_WITH_ICONS[n],handler:function(){return t.openWithCloudEditor(e,r,n,!1,o)},provider:v.GoogleDSS}:null},t.getOpenWithWopiEditorInfo=function(e,r,o){var n=p.default.getWopiOpenWithButtonInfo(e);return n?{text:n.name,spriteName:n.icon,handler:function(){return t.openWithCloudEditor(e,r,n.editor,!1,o)},provider:v.OfficeOnline}:null},t.isGoogleDoc=y,t.isShortcut=T,t.isCloudBasedDoc=function(e){return!!y(e)||!!T(e)},t.getGoogleEditorType=F})),define("modules/clean/cloud_docs/pointers_common",["require","exports","tslib","modules/clean/keycode","react","spectrum/input"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.handleKeyPress=function(e){e.charCode===o.KeyCode.ENTER&&t.canSubmit({name:r.props.name,url:r.props.url})&&r.props.onSubmit()},r.handleNameChange=function(e){var t=e.target.value;r.props.onChange({name:t,url:r.props.url})},r.handleUrlChange=function(e){var t=e.target.value;r.props.onChange({name:r.props.name,url:t})},r.setNameFieldRef=function(e){r.nameRef=e},r}return r.__extends(t,e),t.prototype.render=function(){var e=""===this.props.url||t.isUrlValid(this.props.url),r=e?"default":"invalid",o="";return e||(o=this.props.urlValidationMessage),n.createElement("div",{className:"create-pointer--fields"},n.createElement("div",{className:"create-pointer--fieldset"},n.createElement("label",{htmlFor:"create-pointer--link_input"},this.props.urlLabel),n.createElement("div",{className:"create-pointer--fieldset-with-icon"},this.props.urlIcon,n.createElement(i.Input,{id:"create-pointer--link_input",className:"create-pointer--link_input",variant:r,onChange:this.handleUrlChange,onKeyPress:this.handleKeyPress,value:this.props.url,autoFocus:!0}))),n.createElement("div",{className:"create-pointer--url-validation-warning"},o),n.createElement("div",{className:"create-pointer--fieldset"},n.createElement("label",{htmlFor:"create-pointer--name_input"},this.props.nameLabel),n.createElement(i.Input,{id:"create-pointer--name_input",className:"create-pointer--name_input",onChange:this.handleNameChange,onKeyPress:this.handleKeyPress,forwardedRef:this.setNameFieldRef})))},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return this.props.urlPrepopulateFunction?[4,this.props.urlPrepopulateFunction()]:[3,2];case 1:(e=t.sent())&&(this.props.onChange({name:this.props.name,url:e}),this.nameRef.focus()),t.label=2;case 2:return[2]}}))}))},t.isUrlValid=function(e){return/^((http|https):\/\/)?([^.:/\\?#@!]+?\.)+[^.:/\\?#@!]+/i.test(e.trim())},t.canSubmit=function(e){return""!==e.name&&""!==e.url&&t.isUrlValid(e.url)},t})((n=r.__importStar(n)).Component);t.CreatePointerFields=s})),define("modules/clean/cloud_docs/preferred_editor_utils",["require","exports","tslib","modules/core/i18n","modules/core/browser","modules/core/exception","modules/clean/cloud_docs/event_logging","modules/clean/cloud_docs/utils","modules/clean/cloud_docs/types","react","modules/clean/filepath","modules/clean/cloud_docs/open_with_utils","modules/core/uri","modules/clean/cloud_docs/cloud_doc_api_client","spectrum/util/uuid_generator","modules/clean/cloud_docs/preferred_editor_constants","modules/clean/cloud_docs/create_api"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),c=r.__importDefault(c),t.hasPreferredEditorSupport=function(e){var t=a.getFileExt(e);return m.PREFERRED_EDITOR_SUPPORTED_EXTS.indexOf(t)>=0},t.openInPreferredEditor=function(e,t,r,o,c){var d=a.getFileExt(t),g=r[e.id],S="";if(g)try{var v=g[m.EXTENSION_TO_DOC_TYPE[d]],E=v===m.PreferredEditorTypes.GoogleDSS||v===m.PreferredEditorTypes.OfficeOnline,w=_.generateUUID("web_open_id");if(E){var b=h.createPlaceholderTabForNewCloudDoc();u.getCloudEditorUrl(e.id,t.file_id).then((function(r){S=p.URI.parse(r.cloud_editor_url).updateQuery("web_open_id",w).toString(),b?b.location.replace(S):o(),s.logUserAction({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:s.getActionSourceFromSourceArgs(c),data:{webOpenId:w}})})).catch((function(e){i.reportStack("Error getting cloud editor url from preferred editor open.",{severity:i.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:S,file_ext:d,preferred_editor_configs:g,error:e.message}}),b&&b.close(),o()}))}else f.getPreferredUrl(e.id,t.file_id,d).then((function(r){r.preferred_editor_url&&(S=p.URI.parse(r.preferred_editor_url).updateQuery("web_open_id",w).toString(),s.logUserAction({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:s.getActionSourceFromSourceArgs(c),data:{webOpenId:w}}),n.redirect(S))})).catch((function(e){i.reportStack("Error getting preferred editor url from preferred editor open.",{severity:i.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:S,file_ext:d,preferred_editor_configs:g,error:e.message}})})),o()}catch(e){i.reportStack("Error opening docs in preferred editor.",{severity:i.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:S,file_ext:d,preferred_editor_configs:g,error:e.message}}),o()}else o()},t.getPreferredEditorPrompt=function(e,t){var r="."+d.file_extension(e),n=m.EXTENSION_TO_DOC_TYPE[r],i=m.INTEGRATION_NAME_TO_PROMPT[t][n];return i?{title:o.intl.formatMessage({id:"jXF9I9",defaultMessage:"Would you like to open <b>{file_extension}</b> files with {web_editor_name} by default?"},{file_extension:r,web_editor_name:i,b:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c.default.createElement("b",null,e)}}),body:o.intl.formatMessage({id:"f37GH8",defaultMessage:"{web_editor_name} will automatically be used to open your <b>{file_extension}</b> files in Dropbox. You can always update this later in your Dropbox settings."},{file_extension:r,web_editor_name:i,b:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c.default.createElement("b",null,e)}})}:null}})),define("modules/clean/cloud_docs/preferred_editor_constants",["require","exports","modules/core/i18n","modules/clean/cloud_docs/types"],(function(e,t,r,o){"use strict";var n,i,s,a,l,c,d;Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.Unknown=0]="Unknown",e[e.FileViewer=1]="FileViewer",e[e.OfficeOnline=2]="OfficeOnline",e[e.GoogleDSS=3]="GoogleDSS"})(c=t.PreferredEditorTypes||(t.PreferredEditorTypes={})),(function(e){e.WORD="ms_word",e.EXCEL="ms_excel",e.POWERPOINT="ms_powerpoint"})(d=t.PreferredEditorDocTypes||(t.PreferredEditorDocTypes={})),t.PreferredEditorOptionsMap=((n={})[d.WORD]={1:r.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:r.intl.formatMessage({id:"Y9FcUQ",defaultMessage:"Word for the web"}),3:r.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"})},n[d.EXCEL]={1:r.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:r.intl.formatMessage({id:"o3mRdr",defaultMessage:"Excel for the web"}),3:r.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"})},n[d.POWERPOINT]={1:r.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:r.intl.formatMessage({id:"RTj2SO",defaultMessage:"PowerPoint for the web"}),3:r.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"})},n),t.EXTENSION_TO_DOC_TYPE={".docx":d.WORD,".doc":d.WORD,".xlsx":d.EXCEL,".xls":d.EXCEL,".pptx":d.POWERPOINT,".ppt":d.POWERPOINT},t.PREFERRED_EDITOR_SUPPORTED_EXTS=Object.keys(t.EXTENSION_TO_DOC_TYPE),t.INTEGRATION_NAME_TO_PROMPT=((i={})[o.IntegrationName.GOOGLE_DSS]=((s={})[d.WORD]=r.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"}),s[d.EXCEL]=r.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"}),s[d.POWERPOINT]=r.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"}),s),i[o.IntegrationName.OFFICE_ONLINE]=((a={})[d.WORD]=r.intl.formatMessage({id:"Y9FcUQ",defaultMessage:"Word for the web"}),a[d.EXCEL]=r.intl.formatMessage({id:"o3mRdr",defaultMessage:"Excel for the web"}),a[d.POWERPOINT]=r.intl.formatMessage({id:"RTj2SO",defaultMessage:"PowerPoint for the web"}),a),i[o.IntegrationName.PAPER_INTEGRATION]={},i[o.IntegrationName.DROPBOX_FORM]={},i),t.IntegrationNameToPreferredEditorEnums=((l={})[o.IntegrationName.GOOGLE_DSS]=c.GoogleDSS,l[o.IntegrationName.OFFICE_ONLINE]=c.OfficeOnline,l[o.IntegrationName.PAPER_INTEGRATION]=c.Unknown,l[o.IntegrationName.DROPBOX_FORM]=c.Unknown,l)})),define("modules/clean/cloud_docs/utils",["require","exports","modules/clean/filepath","modules/clean/sharing/constants","modules/clean/cloud_docs/types"],(function(e,t,r,o,n){"use strict";function i(e){return e.replace(/[/?<>:*\\]/g,"_")}Object.defineProperty(t,"__esModule",{value:!0}),t.getFileExt=function(e){var t="";return e.hasOwnProperty("ext")?t=e.ext:e.hasOwnProperty("filename")?(t=r.file_extension(e.filename))&&(t="."+t):(t=r.file_extension(e))&&(t="."+t),t},t.integrationNameToShareActionOrigin=function(e){switch(e){case n.IntegrationName.GOOGLE_DSS:return o.SHARE_ACTION_ORIGIN_TYPE.GOOGLE_DSS;case n.IntegrationName.PAPER_INTEGRATION:return o.SHARE_ACTION_ORIGIN_TYPE.PAPER_INTEGRATION;case n.IntegrationName.OFFICE_ONLINE:return o.SHARE_ACTION_ORIGIN_TYPE.OFFICE_INTEGRATION;case n.IntegrationName.DROPBOX_FORM:return o.SHARE_ACTION_ORIGIN_TYPE.DROPBOX_FORM;default:throw"No mapping for integration to share action origin: "+e}},t.replaceInvalidFilenameChars=i,t.replaceInvalidURLFilenameChars=function(e){return i(e).replace(/\ /g,"-")}})),define("modules/clean/cloud_docs/shared_components/survey_modal",["require","exports","tslib","react","modules/clean/static_urls","modules/clean/cloud_docs/cloud_doc_api_client","modules/clean/cloud_docs/constants","modules/clean/react/modal","modules/clean/referrer_cleansing_redirect","modules/constants/page_load"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var d=(function(e){function t(t){var r=e.call(this,t)||this;return r.state={hasSeenSurvey:null},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return[4,i.getGoogleSurveyAsync(this.props.userId)];case 1:return e=t.sent().has_seen_google_survey,this.setState({hasSeenSurvey:e}),e?[3,3]:[4,i.setGoogleSurveyAsync(this.props.userId)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},t.prototype.googleFileTypeToString=function(e){return e===s.GoogleFileTypes.GOOGLE_DSS_SHEET?"Google Sheet":e===s.GoogleFileTypes.GOOGLE_DSS_SLIDES?"Google Slide":"Google Doc"},t.prototype.render=function(){return["en","en_GB"].includes(c.USER_LOCALE)?this.state.hasSeenSurvey||null===this.state.hasSeenSurvey?null:o.default.createElement(a.Modal,{width:440,style:"clean",acceptButtonText:"Submit feedback",altAction:o.default.createElement("a",{onClick:function(){return a.Modal.close()}},"No, thank you"),onAccept:function(){l.safe_open_tab_and_redirect("https://forms.gle/XTVr6LNw5w77dUEJ9")},submitting:!1,className:"shortcuts-feedback-modal"},o.default.createElement("img",{src:n.static_url("/static/images/shortcuts/shortcuts-survey-modal-vflB35Wls.png"),alt:"Image of cartoon holding globe"}),o.default.createElement("h1",null,"Congrats on creating a "+this.googleFileTypeToString(this.props.documentType)+" in Dropbox!"),o.default.createElement("div",null,"Please take a moment to give us feedback on your experience.")):null},t})(o.default.Component);t.GoogleSurveyModal=d})),define("modules/clean/file_actions/create-folder",["require","exports","tslib","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/files_view/file_actions/api_v2","modules/clean/react/snackbar","modules/clean/web_user_action_events","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),i=r.__importStar(i);var c={CREATING_FOLDER:l.intl.formatMessage({id:"Tu4jXQ",defaultMessage:"Creating folder..."}),MALFORMED_PATH:l.intl.formatMessage({id:"ZJfxlG",defaultMessage:'The following characters are not allowed: angle brackets \\ / : ? * " |'}),GENERIC_ERROR:l.intl.formatMessage({id:"ci+J7E",defaultMessage:"Can’t create folder."}),FSW_ACCEPT:l.intl.formatMessage({id:"5Z9j+l",defaultMessage:"Create folder"}),FOLDER_CREATED:l.intl.formatMessage({id:"a26imc",defaultMessage:"Folder created."})};function d(e){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(t){return[2,new Promise((function(t){o.showFileSystemWarningsModal({fsws:e,onFinalAccept:function(){t(!0)},onAbortAction:function(){t(!1)},confirmText:c.FSW_ACCEPT})}))]}))}))}function u(e,t,r){n.logWebUserAction({event_name:a.WebUserActionLogEvent.CREATE_FOLDER_ERROR,extra:{error_summary:e||null,error:t||null,origin:r||null}})}function p(e){n.logWebUserAction({event_name:a.WebUserActionLogEvent.CREATE_FOLDER_CANCEL,extra:{origin:e||null}})}function f(e){n.logWebUserAction({event_name:a.WebUserActionLogEvent.CREATE_FOLDER_PENDING,extra:{origin:e||null}})}function _(e){n.logWebUserAction({event_name:a.WebUserActionLogEvent.CREATE_FOLDER_SUCCESS,extra:{origin:e||null}})}t.createFolder=function(e){var o=e.user,n=e.name,a=e.destination,l=e.checkFsw,m=e.origin;return r.__awaiter(void 0,void 0,Promise,(function(){var e;return r.__generator(this,(function(r){switch(r.label){case 0:return f(m),s.Snackbar.sync(c.CREATING_FOLDER,!1,"browse-action"),[4,i.createFolder(a,n,o,l)];case 1:return(e=r.sent()).isError?"path"!==e.error[".tag"]||"file_system_warnings"!==e.error.path[".tag"]?[3,5]:(s.Snackbar.close("browse-action"),[4,d(e.error.path.details)]):(s.Snackbar.complete(c.FOLDER_CREATED,"browse-action"),_(m),[2,{type:"success",folder:e.result.metadata}]);case 2:return r.sent()?[4,t.createFolder({user:o,name:n,destination:a,checkFsw:!1,origin:m})]:[3,4];case 3:return[2,r.sent()];case 4:return p(m),[2,{type:"cancel"}];case 5:return"path"===e.error[".tag"]&&"malformed_path"===e.error.path[".tag"]?s.Snackbar.fail(c.MALFORMED_PATH,"browse-action"):s.Snackbar.fail(c.GENERIC_ERROR,"browse-action"),u(e.error_summary,e.error[".tag"],m),[2,{type:"error",summary:e.error_summary,error:e.error[".tag"]}]}}))}))},t.logCreateFolder=function(e){var t=e.uid,r=e.view_type,o=e.origin;n.logWebUserAction({user_id:t,event_name:a.WebUserActionLogEvent.CREATE_FOLDER,view_type:r||null,extra:{origin:o}})},t.logCreateFolderError=u,t.logCreateFolderCancel=p,t.logCreateFolderPending=f,t.logCreateFolderSuccess=_})),define("modules/clean/file_operations/notifications",["require","exports","tslib","external/lodash","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filepath","modules/clean/react/browse/api","modules/clean/undo","modules/core/html","modules/core/i18n","modules/core/notify"],(function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";function p(e,t,r,o){l.notifyWithUndo(e,r,(function(){return a.rollbackChangeSets({changesets:r,userId:t.id,progressText:d.intl.formatMessage({id:"wKzr7W",defaultMessage:"Undoing…"}),onSuccess:function(){u.Notify.success(d.intl.formatMessage({id:"t6mPeQ",defaultMessage:"Undo complete."})),o&&o()}})}))}function f(e,t){var r=n.browse_uri_for_fq_path(t,e),a=i.Emstring.em_snippet(s.filename(e),40);return{href:r,text:o.escape(a)}}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),s=r.__importStar(s),a=r.__importStar(a),l=r.__importStar(l),t.notifyCopySuccess=function(e,t,r,o,n){var i;if(o){var s=f(o,t);i=d.intl.formatMessage({id:"UZ+XVI",defaultMessage:"{count, plural, one{Copied {count} item to {dest}.} other{Copied {count} items to {dest}.}}"},{count:e,dest:'<a href="'+s.href.toString()+'">'+s.text+"</a>"}),i=new c.HTML(i)}else i=d.intl.formatMessage({id:"BDtFp+",defaultMessage:"{count, plural, one{Copied {count} item.} other{Copied {count} items.}}"},{count:e});p(i,t,r,n)},t.notifyMoveSuccess=function(e,t,r,o,n){var i;if(o){var s=f(o,t);i=d.intl.formatMessage({id:"GBu2Ic",defaultMessage:"{count, plural, one{Moved {count} item to {dest}.} other{Moved {count} items to {dest}.}}"},{count:e,dest:'<a href="'+s.href.toString()+'">'+s.text+"</a>"}),i=new c.HTML(i)}else i=d.intl.formatMessage({id:"tFGyx0",defaultMessage:"{count, plural, one{Moved {count} item.} other{Moved {count} items.}}"},{count:e});p(i,t,r,n)},t.notifyDeleteSuccess=function(e,t,r,o){p(d.intl.formatMessage({id:"THAbub",defaultMessage:"{count, plural, one{Deleted {count} item.} other{Deleted {count} items.}}"},{count:e}),t,r,o)},t.notifyRenameSuccess=function(e,t,r){p(d.intl.formatMessage({id:"sAZa2U",defaultMessage:"Rename complete."}),e,t,r)},t.notifyFolderCreationSuccess=function(e,t,r){p(d.intl.formatMessage({id:"ndMNx/",defaultMessage:"Created folder {folder_name}."},{folder_name:e}),t,r)},t.notifyPurgeSuccess=function(e){var t=d.intl.formatMessage({id:"jh+GyF",defaultMessage:"{count, plural, one{Permanently deleted {count} item.} other{Permanently deleted {count} items.}}"},{count:e});u.Notify.success(t)},t.notifyRestoreSuccess=function(e){var t,r=e.length;if(1===r){var n=o.escape(s.filename(e[0].fq_path));t=d.intl.formatMessage({id:"TAukDw",defaultMessage:"Restored <strong>{filename}</strong>."},{filename:n}),t=new c.HTML(t)}else t=d.intl.formatMessage({id:"8N7KT8",defaultMessage:"{count, plural, one{Restored {count} file.} other{Restored {count} files.}}"},{count:r});u.Notify.success(t,30)}})),define("modules/clean/growth/smb_funnel/smb_funnel_logger",["require","exports","tslib","modules/clean/metrics/index","modules/core/exception"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.WEB="web",e.DESKTOP_SSCV="desktop_sscv",e.MOBILE_WEB="mobile_web"})(t.Platform||(t.Platform={}));var i=["platform","variant"],s=function(e){var t={};return Object.keys(e).forEach((function(r){i.indexOf(r)>=0&&(t[r]=e[r])})),t},a=function(e){var t=this;void 0===e&&(e={}),this.setCommonTags=function(e){var r=s(e);Object.keys(r).forEach((function(r){t.commonTags[r]&&t.commonTags[r]!==e[r]&&n.reportStack("Attempting to change "+r+" after it was already set",{severity:n.SEVERITY.NONCRITICAL,tags:["activation-smb","smb-funnel"]})})),t.commonTags=r},this.log=function(e,o){void 0===o&&(o={});var n=r.__assign(r.__assign({},t.commonTags),o),i=t.metricsReporter.createCounter({ns:"smb_funnel",name:e},n);i.increment(),i.record()},this.commonTags=s(e),this.metricsReporter=o.getMetricsReporter()};t.SMBFunnelLoggerSingleton=a,t.SMBFunnelLogger=new a})),define("modules/clean/react/admin/teams/onboarding/web/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FRAMEWORK="team_setup_essential",t.MODULE_NAME="smooth_transitions",(function(e){e.VERIFICATION="verification",e.RIGHTSIZING="rightsizing",e.TEAM_INFO="team_info",e.MOVE_FOLDERS="move_folders",e.CONFIRM_FOLDERS="confirm_folders",e.INVITE_MEMBERS="invite_members",e.SUGGESTED_INVITE_MEMBERS="suggested_invite_members",e.INVITE_MOBILE="invite_mobile",e.INSTALL="install",e.INSTALL_MOBILE="install_mobile",e.ROLE="role",e.FIRST_PATH="first_path",e.OPEN="team_install_page_open",e.DOWNLOAD="team_install_page_download",e.DOWNLOAD_COMPLETE="download_complete",e.MOBILE_INSTALL="mobile_install"})(t.Steps||(t.Steps={})),(function(e){e.Inactive="inactive",e.Active="active",e.Completed="completed"})(t.StepStatus||(t.StepStatus={})),(function(e){e.CELADON="celadon",e.CLOUD="cloud",e.ORCHID="orchid",e.SAPPHIRE="sapphire",e.SAND="sand",e.VANILLA="vanilla"})(t.BackgroundColors||(t.BackgroundColors={})),(function(e){e.DESKTOP_WEB="desktop_web",e.DESKTOP_SSCV="desktop_sscv",e.MOBILE_WEB="mobile_web"})(t.Platform||(t.Platform={})),(function(e){e.SETUP_START="setup/start",e.SETUP_FINISH="setup/finish",e.SETUP_STEP_START="setup/step/start",e.SETUP_STEP_FINISH="setup/step/finish",e.SETUP_STEP_ERROR="setup/step/error",e.SETUP_STEP_INTERRUPT="setup/step/interrupt",e.SETUP_STEP_CTA="setup/step/cta",e.ACTIVATION_IMM_VIEW="activation/imm/view",e.ACTIVATION_IMM_ADD_MEMBERS="activation/imm/add_members",e.ACTIVATION_DESKTOP_ICON_OPEN="activation/desktop_icon/open",e.ACTIVATION_EMPTY_STATE_VIEW="activation/empty_state/view",e.ACTIVATION_SUGGESTED_FOLDER_CREATE="activation/suggested_folder/create",e.ACTIVATION_SUGGESTED_FOLDER_DISMISS="activation/suggested_folder/dismiss",e.ACTIVATION_SUGGESTED_FOLDER_TOGGLE="activation/suggested_folder/toggle",e.ACTIVATION_INVITE_LINK_CREATE="activation/invite_link/create",e.ACTIVATION_MOBILE_LINK_SEND="activation/mobile_link/send",e.ACTIVATION_DESKTOP_LINK_DISMISS="activation/desktop_link/dismiss",e.ACTIVATION_DESKTOP_LINK_INIT="activation/desktop_link/init",e.ACTIVATION_DESKTOP_LINK_SEND="activation/desktop_link/send"})(t.AMPMetrics||(t.AMPMetrics={})),(function(e){e[e.ESSENTIAL_SETUP=1]="ESSENTIAL_SETUP",e[e.PERSONALIZATION=2]="PERSONALIZATION",e[e.MOBILE_WEB_INVITES=3]="MOBILE_WEB_INVITES",e[e.FOLDER_MIGRATION=4]="FOLDER_MIGRATION",e[e.MOBILE_APP_LINKS=5]="MOBILE_APP_LINKS",e[e.P13N_COLLECTIONS=6]="P13N_COLLECTIONS"})(t.FlowId||(t.FlowId={})),(function(e){e.DEFAULT="",e.WORK="/work"})(t.ContUrl||(t.ContUrl={}))})),define("modules/clean/react/folder_overview/api",["require","exports","modules/clean/api_v2/user_client"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new r.UserApiV2Client;t.getDescription=function(e,t){return o.ns("files").rpc("get_description_batch",{file_ids:[t]},{subjectUserId:e}).then((function(e){if(!e||!e.items||1!==e.items.length)throw new Error("Unexpected response from get_description_batch");return e.items[0]}))},t.setDescription=function(e,t,r,n,i){return o.ns("files").rpc("set_description",{file_id:t,current_revision_id:r,text:n,format_version:i},{subjectUserId:e})},t.getContentReferences=function(e,t){return o.ns("files").rpc("get_content_references_info",{file_id:t},{subjectUserId:e})},t.removeContentReferences=function(e,t,r){return o.ns("files").rpc("remove_content_references",{anchor_file_id:t,return_roots_as_ns_ids:!0,file_ids:r},{subjectUserId:e})},t.addContentReferences=function(e,t,r){return o.ns("files").rpc("add_content_references",{anchor_file_id:t,return_roots_as_ns_ids:!0,file_ids:r},{subjectUserId:e})},t.addContentReferencesToPath=function(e,t,r){return o.ns("files").rpc("add_content_references_to_path",{path:t,return_roots_as_ns_ids:!0,file_ids:r},{subjectUserId:e})},t.getFolderAccess=function(e){var t=e.userId,r=e.sharedFolderId,n=e.accountId,i=e.accountEmail;return o.ns("folder_overview").rpc("has_folder_access",{shared_folder_id:r,account_id:n,account_email:i},{subjectUserId:t})},t.getSharedFolderPath=function(e){var t=e.userId,r=e.sharedFolderId;return o.ns("files").rpc("get_metadata",{path:"ns:"+r},{subjectUserId:t}).then((function(e){return e.is_shareable?e.path_display:void 0}))},t.getLoggingFileId=function(e){var t=e.userId,r=e.path;return o.ns("files").rpc("get_metadata",{path:r},{subjectUserId:t}).then((function(e){return e.id}))},t.isConflictError=function(e){return e.error&&e.error.status&&"conflict"===e.error.status[".tag"]},t.isFormatVersionError=function(e){return e.error&&e.error.status&&"bad_format_version"===e.error.status[".tag"]},t.getUserAccount=function(e){var t=e.userId,r=e.accountId;return o.ns("users").rpc("get_account",{account_id:r},{subjectUserId:t})}})),define("modules/clean/react/folder_overview/async_components",["require","exports","tslib","react","modules/clean/react/async/loadable","modules/clean/react/folder_overview/placeholder"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.AsyncFolderOverviewDescription=n.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/folder_overview/description"],t,r)})).then(r.__importStar).then((function(e){return e.FolderOverviewDescription}))},loading:function(e){return o.default.createElement(i.WrappedFolderOverviewPlaceholder,{showExamples:e.showExamplesInPlaceholder,isReadOnly:e.isReadOnly,showExamplesAsButton:"V3"===e.expFolderOverview})}}),t.AsyncFolderOverviewContentReferences=n.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/folder_overview/content_references"],t,r)})).then(r.__importStar).then((function(e){return e.FolderOverviewContentReferences}))}}),t.AsyncFolderOverviewLastEdit=n.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/folder_overview/last_edit"],t,r)})).then(r.__importStar).then((function(e){return e.FolderOverviewLastEdit}))}}),t.asyncShowOverviewExamples=function(){new Promise((function(t,r){e(["modules/clean/react/folder_overview/examples_modal"],t,r)})).then(r.__importStar).then((function(e){return e.OverviewExamplesModal.show()}))},t.asyncShowPinToModal=function(t){new Promise((function(t,r){e(["modules/clean/react/folder_overview/pin_to_modal"],t,r)})).then(r.__importStar).then((function(e){return e.FolderOverviewPinToModal.show(t)}))}})),define("modules/clean/react/folder_overview/constants",["require","exports","modules/core/i18n","react-intl"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DATA_CACHE_TTL_MS=3e4,t.DESCRIPTION_PLACEHOLDER=r.intl.formatMessage({id:"5wJAeB",defaultMessage:"Click here to describe this folder and turn it into a Space"}),t.DESCRIPTION_PLACEHOLDER_FOR_SPACE=r.intl.formatMessage({id:"uBopyb",defaultMessage:"Click here to describe this Space"}),t.DESCRIPTION_PLACEHOLDER_EXAMPLES_BUTTON=r.intl.formatMessage({id:"PR6SPH",defaultMessage:"Show examples"}),t.DESCRIPTION_PLACEHOLDER_READ_ONLY=r.intl.formatMessage({id:"PYQBlc",defaultMessage:"To edit this overview, ask the folder admin for access"}),t.FOLDER_EXAMPLES_LINK_LABEL=r.intl.formatMessage({id:"PR6SPH",defaultMessage:"Show examples"}),t.FOLDER_EXAMPLES_LINK_URI="https://www.dropbox.com/help/desktop-web/folder-overviews",t.ERROR_DESCRIPTION_CONFLICT=r.intl.formatMessage({id:"ssdefa",defaultMessage:"Can’t save changes. Paste text elsewhere to save, then click Refresh."}),t.ERROR_DESCRIPTION_FORMAT_VERSION=r.intl.formatMessage({id:"5dt0hu",defaultMessage:"Can’t save changes. Reload the page and try again."}),t.ERROR_DESCRIPTION_SAVE=r.intl.formatMessage({id:"PM6K+P",defaultMessage:"Can’t save changes."}),t.ERROR_SHARE_PERSONAL_FOLDER=r.intl.formatMessage({id:"9C/lc5",defaultMessage:"Can’t @mention someone in your Personal Dropbox."}),t.ERROR_SHARE_MEMBER_FOLDER=r.intl.formatMessage({id:"+dhj1b",defaultMessage:"Can’t @mention someone in your member folder."}),t.ERROR_SHARE_NO_PERMISSION=r.intl.formatMessage({id:"b7//2e",defaultMessage:"You don’t have permission to share this folder."}),t.DESCRIPTION_SAVE_DELAY_MS=3e3,t.DESCRIPTION_SAVE_ERROR_DELAY_MS=10*t.DESCRIPTION_SAVE_DELAY_MS,t.OPT_KEY=r.intl.formatMessage({id:"HRXOjw",defaultMessage:"opt"}),t.ALT_KEY=r.intl.formatMessage({id:"RIxWSs",defaultMessage:"alt"}),t.CTRL_KEY=r.intl.formatMessage({id:"FL9yea",defaultMessage:"ctrl"}),t.CMD_KEY=r.intl.formatMessage({id:"NWv/3R",defaultMessage:"⌘"}),t.FOLDER_OVERVIEW_EDITOR_EDITING=r.intl.formatMessage({id:"Kud10T",defaultMessage:"Everyone in this folder can see notes, tasks, and pinned items"}),t.SHARING_MODAL_MESSAGE_SAME_FOLDER=o.defineMessage({id:"xkXFjI",defaultMessage:"Hi {user_name}, I @mentioned you in this folder. Take a look."}),t.SHARING_MODAL_MESSAGE_PARENT_FOLDER=o.defineMessage({id:"YzaJIx",defaultMessage:"Hi {user_name}, I @mentioned you in the {folder_name} folder. Take a look."}),t.SHARING_MODAL_MESSAGE_SAME_FOLDER_NO_NAME=r.intl.formatMessage({id:"sl5Fj7",defaultMessage:"I @mentioned you in this folder. Take a look."}),t.SHARING_MODAL_MESSAGE_PARENT_FOLDER_NO_NAME=o.defineMessage({id:"erm7J0",defaultMessage:"I @mentioned you in the {folder_name} folder. Take a look."}),t.DESCRIPTION_VERSION=[1,0,1],t.PIN_TO_SUCCESS_SINGLE=o.defineMessage({id:"N91bIS",defaultMessage:"Pinned {file} to {path}"}),t.PIN_TO_SUCCESS_MULTIPLE=o.defineMessage({id:"rlqf2h",defaultMessage:"Pinned {num} files to {path}"}),t.PIN_TO_MODAL_TITLE_SINGLE=o.defineMessage({id:"kh62rs",defaultMessage:"Pin “{name}” to..."}),t.PIN_TO_MODAL_TITLE_MULTIPLE=o.defineMessage({id:"QEFBFz",defaultMessage:"Pin {num} files to..."}),t.PIN_TO_FAILURE_SINGLE=o.defineMessage({id:"usoFNB",defaultMessage:"Failed to pin {file} to {path}"}),t.PIN_TO_FAILURE_MULTIPLE=o.defineMessage({id:"M0cBOF",defaultMessage:"Failed to pin {num} files to {path}"}),t.PIN_TO_FAILURE_PERMISSION_DENIED=o.defineMessage({id:"BGyZpk",defaultMessage:"You do not have permission to pin to {path}"}),t.DESCRIPTION_LAST_EDIT_EMPTY_YOU=o.defineMessage({id:"PX5Hq1",defaultMessage:"Deleted {time_ago} by you"}),t.DESCRIPTION_LAST_EDIT_EMPTY=o.defineMessage({id:"7V5b6j",defaultMessage:"Deleted {time_ago} by {name}"}),t.DESCRIPTION_LAST_EDIT_YOU=o.defineMessage({id:"oA46AW",defaultMessage:"Updated {time_ago} by you"}),t.DESCRIPTION_LAST_EDIT=o.defineMessage({id:"MP7zas",defaultMessage:"Updated {time_ago} by {name}"}),t.CONFLICT_POPUP_TITLE=o.defineMessage({id:"PHRYz8",defaultMessage:"Your changes weren’t saved because you and {user} are editing at the same time."}),t.CONFLICT_POPUP_TITLE_YOU=r.intl.formatMessage({id:"tc/4YZ",defaultMessage:"Your changes weren’t saved because you are editing this description elsewhere."}),t.CONFLICT_POPUP_CONTENT=r.intl.formatMessage({id:"4aEgv5",defaultMessage:"Please wait until they’re done before making changes."}),t.CONFLICT_POPUP_CONTENT_YOU=r.intl.formatMessage({id:"oYSO1Z",defaultMessage:"Please save your other changes before making them here."}),t.CONFLICT_POPUP_BUTTON=r.intl.formatMessage({id:"nOO9Qi",defaultMessage:"OK"})})),define("modules/clean/react/folder_overview/controller",["require","exports","tslib","classnames","react","react-redux","retrieval-components/collapsable-section","modules/clean/filepath","modules/clean/react/browse/data/selectors","modules/clean/react/browse/logger","modules/clean/react/browse/uri_helper","modules/clean/react/css","modules/clean/react/files_view/types","modules/clean/react/folder_overview/async_components","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/store","modules/clean/react/folder_overview/live_update","modules/clean/react/folder_overview/logging","modules/clean/react/folder_overview/placeholder","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S,v,E,w,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),a=r.__importStar(a),l=r.__importStar(l),_=r.__importStar(_),m=r.__importStar(m);var y=h.getStoreForFolderOverview();c.browseLogger.registerRowInjector((function(){var e=m.makeFolderNsIdSelector(),t=m.makeDoesFolderOverviewExistSelector(),r=m.makeIsFolderOverviewEmptySelector(),o=m.makeFolderFileIdSelector(),n=y.getState(),i=l.path(n),s=S.extractNsIdAndPath(e(n,{path:i})),a=s.nsPath,c=s.nsId;return{extra:{in_folder_with_overview:t(n,{path:i})&&!r(n,{path:i})?"1":"0",folder_file_id:o(n,{path:i})||null,ns_id:c||null,resource_namespace_path:S.hashPath(a)}}}));var T={updateFolderData:_.updateFolderDataCache,saveFolderData:_.saveFolderPreferences,addLoadedComponent:_.addLoadedComponent,removeLoadedComponent:_.removeLoadedComponent,fetchDataForFolder:_.fetchDataForFolder,reloadDescription:_.reloadDescription,reloadContentReferences:_.reloadContentReferences},F=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleHeaderClick=function(){var e=r.props,t=e.folderFileId,o=e.isOpen;t&&(r.props.updateFolderData({fileId:t,folderData:{isCollapsed:o}}),r.props.saveFolderData({folderFileId:t}),S.logFolderOverviewAction(w.WebUserActionLogEvent.FOLDER_OVERVIEW_TOGGLED,r.props.user.id,null,{opened:o?"0":"1"}))},r.handleLiveUpdate=function(e){var t=e.type,o=r.props,n=o.folderFileId,i=o.componentNamespace;if(n)switch(t){case"description":r.props.reloadDescription({folderFileId:n,componentNamespace:i});break;case"content_references":r.props.reloadContentReferences({folderFileId:n,componentNamespace:i})}},r.shouldRenderFolderOverview=function(e){return!e.shouldHideFolderOverview&&!("OFF"===e.expFolderOverview&&e.loadedComponents&&e.loadedComponents.includes("description")&&e.loadedComponents.includes("content_references")&&!e.doesFolderOverviewExist)},r.handlePlaceholderClick=function(){r.setState({showPlaceholder:!1})},r.handleExamplesButtonClick=function(){f.asyncShowOverviewExamples()},r.setContainerRef=function(e){return r.container=e},r.state={showPlaceholder:!0},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props,r=t.path,o=t.expFolderOverview,n=t.componentNamespace;(this.props.folderFileId||this.props.folderNsId)&&this.props.fetchDataForFolder({path:r,expFolderOverview:o,componentNamespace:n,fetchContentReferences:!0}),"V2"!==this.experimentVariant&&"V3"!==this.experimentVariant||g.folderOverviewLiveUpdateManager.addListener("update",this.handleLiveUpdate),this.shouldRenderFolderOverview(this.props)||this.props.addLoadedComponent({componentNamespace:n,component:"draftjs"}),this.props.loadedComponents&&this.props.loadedComponents.includes("description")&&(this.props.descriptionBaseRevision?this.setState({showPlaceholder:!1}):this.props.addLoadedComponent({componentNamespace:n,component:"draftjs"})),E.waitForTTI().then((function(){e.setState({showPlaceholder:!1})}))},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.path,r=e.expFolderOverview,o=e.componentNamespace;(!a.paths_are_equal(t,this.props.path)&&(e.folderFileId||e.folderNsId)||!this.props.folderNsId&&!this.props.folderFileId&&e.folderNsId)&&this.props.fetchDataForFolder({path:t,expFolderOverview:r,componentNamespace:o,fetchContentReferences:!0}),!this.props.folderFileId&&e.folderFileId&&d.getQueryArgs().folder_overview&&(this.props.updateFolderData({fileId:e.folderFileId,folderData:{isCollapsed:!1}}),this.props.saveFolderData({folderFileId:e.folderFileId}))},t.prototype.componentDidUpdate=function(e){this.container&&this.props.onChangeHeight(this.container.getBoundingClientRect().height),!(e.loadedComponents||[]).includes("description")&&this.props.loadedComponents&&this.props.loadedComponents.includes("description")&&(this.props.descriptionBaseRevision?this.setState({showPlaceholder:!1}):this.props.addLoadedComponent({componentNamespace:this.props.componentNamespace,component:"draftjs"}))},t.prototype.componentWillUnmount=function(){"V2"!==this.experimentVariant&&"V3"!==this.experimentVariant||(g.folderOverviewLiveUpdateManager.removeListener("update",this.handleLiveUpdate),g.folderOverviewLiveUpdateManager.stop())},Object.defineProperty(t.prototype,"experimentVariant",{get:function(){return"V1"===this.props.expFolderOverview||"V2"===this.props.expFolderOverview||"V3"===this.props.expFolderOverview?this.props.expFolderOverview:"V3"},enumerable:!0,configurable:!0}),t.prototype.render=function(){if(!this.shouldRenderFolderOverview(this.props))return null;var e=!this.props.haveAllComponentsLoaded||this.props.hasFailedToLoad||this.props.browseLoadingState===p.LoadingState.LOADING_FIRST_PAGE;return n.default.createElement("div",{"aria-hidden":e||!this.props.isOpen,className:o.default({"folder-overview":!0,"folder-overview--expanded":this.props.isOpen,"folder-overview--loading":e}),ref:this.setContainerRef},n.default.createElement(s.CollapsableSection,{title:b.intl.formatMessage({id:"OFYmCJ",defaultMessage:"Overview"}),isOpen:this.props.isOpen,onHeaderClick:this.handleHeaderClick,strings:{buttonClose:b.intl.formatMessage({id:"NNi2D+",defaultMessage:"Hide"}),buttonOpen:b.intl.formatMessage({id:"2X0e4z",defaultMessage:"Show"})},containerClassName:o.default({"folder-overview__border":"V3"===this.props.expFolderOverview&&this.props.descriptionHasFocus,"folder-overview__fixed-toolbar-container":"V3"===this.props.expFolderOverview})},this.state.showPlaceholder?n.default.createElement(v.WrappedFolderOverviewPlaceholder,{showExamples:!0,isReadOnly:this.props.isReadOnly,showExamplesAsButton:"V3"===this.props.expFolderOverview,onClick:this.handlePlaceholderClick,onExampleButtonClick:this.handleExamplesButtonClick}):n.default.createElement(f.AsyncFolderOverviewDescription,{path:this.props.path,componentNamespace:this.props.componentNamespace,expFolderOverview:this.experimentVariant,isReadOnly:this.props.isReadOnly||!this.props.descriptionFormatValid,showReadOnlyIcon:!0,showDraftIcon:"V3"!==this.props.expFolderOverview,descriptionKey:[this.props.folderFileId,this.props.descriptionBaseRevision].join("-"),showExamplesInPlaceholder:!0,shouldHidePlaceholder:!1,limitedWidth:!1,toolbarTopMargin:146,canShareFolder:this.props.canShareFolder}),n.default.createElement(f.AsyncFolderOverviewContentReferences,{path:this.props.path,componentNamespace:this.props.componentNamespace,isReadOnly:this.props.isReadOnly,onNavigateToFileOrFolder:this.props.onNavigateToFileOrFolder}),n.default.createElement(f.AsyncFolderOverviewLastEdit,{path:this.props.path,componentNamespace:this.props.componentNamespace})))},t})(n.default.PureComponent);t.FolderOverviewController=F;var I=i.connect((function(){var e=m.makeHaveAllComponentsLoadedSelector(),t=m.makeHasFailedToLoadSelector(),r=m.makeFolderFileIdSelector(),o=m.makeFolderNsIdSelector(),n=m.makeLoadedComponentsSelector(),i=m.makeIsCollapsedSelector(),s=m.makeDescriptionBaseRevisionSelector(),a=m.makeDescriptionHasFocusSelector(),l=m.makeDescriptionFormatValidSelector(),c=m.makeDoesFolderOverviewExistSelector();return function(d,u){return{user:m.user(d),haveAllComponentsLoaded:e(d,u),hasFailedToLoad:!!t(d,u),loadedComponents:n(d,u),folderFileId:r(d,u),folderNsId:o(d,u),isOpen:!i(d,u),descriptionBaseRevision:s(d,u),descriptionFormatValid:l(d,u),doesFolderOverviewExist:c(d,u),descriptionHasFocus:a(d,u)}}}),T)(F);t.FolderOverview=u.requireCssWithComponent(I,["/static/css/browse/folder_overview-vflrny3Ss.css","/static/js/comments2/index.web-vflS3-E6r.css","/static/js/retrieval-components/index.web-vflPW373a.css"])})),define("modules/clean/react/folder_overview/data/action_creators",["require","exports","tslib","modules/clean/filepath","modules/clean/react/browse/data/selectors","modules/clean/react/folder_overview/api","modules/clean/react/folder_overview/constants","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/types","modules/clean/react/folder_overview/errors","modules/clean/react/folder_overview/live_update","modules/clean/react/folder_overview/logging","modules/clean/react/folder_overview/utils","modules/clean/react/snackbar","modules/clean/storage","modules/clean/viewer","modules/clean/web_user_action_events","modules/core/exception","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),i=r.__importStar(i),a=r.__importStar(a),p=r.__importStar(p),g=r.__importStar(g),t.fetchDataForFolder=function(e){var o=e.path,n=e.nsId,c=e.expFolderOverview,d=e.componentNamespace,u=e.fetchContentReferences;return function(e,f){return r.__awaiter(void 0,void 0,void 0,(function(){var _,m,h,S,v,E,w,T,F,I,O,C,P,A,D,R;return r.__generator(this,(function(r){switch(r.label){case 0:m=!1,h=!1,S=p.normalizePath(o),v=Date.now(),(E=a.componentDataCache(f())[d])&&0!==E.requiredComponents.length||(w=u?["content_references","description","draftjs"]:["description","draftjs"],e(t.setRequiredComponents({componentNamespace:d,requiredComponents:w}))),T=[],r.label=1;case 1:if(r.trys.push([1,3,,4]),F=a.user(f()).id,_=a.fileIdCache(f())[S],!(I=_||a.nsIdCache(f())[S]||n))throw new Error("Unable to get file ID or NS ID for current folder");return e(t.setFailedToLoad({componentNamespace:d,hasFailedToLoad:!1})),(O=_?a.folderDataCache(f())[_]:void 0)&&O.descriptionLastUpdated&&v-O.descriptionLastUpdated<s.DATA_CACHE_TTL_MS?(m=!!O.descriptionBaseRevision,e(t.addLoadedComponent({componentNamespace:d,component:"description"})),T.push(Promise.resolve(null))):(e(t.removeLoadedComponent({componentNamespace:d,component:"description"})),T.push(i.getDescription(F,I))),O&&O.contentReferencesLastUpdated&&v-O.contentReferencesLastUpdated<s.DATA_CACHE_TTL_MS?(h=!!O.contentReferencesRevision,e(t.addLoadedComponent({componentNamespace:d,component:"content_references"})),T.push(Promise.resolve(null))):u&&(e(t.removeLoadedComponent({componentNamespace:d,component:"content_references"})),T.push(i.getContentReferences(F,I))),[4,Promise.all(T)];case 2:if(C=r.sent(),P=C[0],A=C[1],P&&(_=P.file_obj_id),!_)throw new Error("Did not get a file ID from the Sprinkle description payload");return e({type:l.ActionTypes.UPDATE_FILE_ID_CACHE,payload:{fileIdCache:(R={},R[p.normalizePath(o)]=_,R)}}),m=!!P&&b(e,_,P,d,v),h=!!A&&y(e,_,A,m,d,v,c),"V1"===c||"V2"===c||"V3"===c||h||m||e(t.addLoadedComponent({componentNamespace:d,component:"draftjs"})),(O=a.folderDataCache(f())[_])&&O.sharedFolderPath||e(t.fetchSharedFolderName({path:o})),O&&O.loggingFileId||e(t.fetchLoggingFileId({path:o})),e(t.loadFolderPreferences({folderFileId:_})),[3,4];case 3:return D=r.sent(),g.reportException({err:D,severity:"non-critical",exc_extra:{path:o,expFolderOverview:c}}),e(t.setFailedToLoad({componentNamespace:d,hasFailedToLoad:!0})),[3,4];case 4:return[2]}}))}))}},t.handlePrefetch=function(e){var o=e.path,n=e.expFolderOverview,i=e.content_references,s=e.description,a=e.componentNamespace,c=e.ts,d=void 0===c?Date.now():c;return function(e){return r.__awaiter(void 0,void 0,void 0,(function(){var c,u,f,_,m,h;return r.__generator(this,(function(r){try{if(u=i||{},!(f=(c=s||{}).file_obj_id))throw new Error("Did not get a file ID from the Odyssey prefetch payload");e({type:l.ActionTypes.UPDATE_FILE_ID_CACHE,payload:{fileIdCache:(h={},h[p.normalizePath(o)]=f,h)}}),_=c&&b(e,f,c,a,d),m=u&&y(e,f,u,_,a,d,n),"V1"===n||"V2"===n||"V3"===n||m||_||e(t.addLoadedComponent({componentNamespace:a,component:"draftjs"}))}catch(r){g.reportException({err:r,severity:"non-critical",exc_extra:{path:o,expFolderOverview:n}}),e(t.setFailedToLoad({componentNamespace:a,hasFailedToLoad:!0}))}return[2]}))}))}},t.loadFolderPreferences=function(e){var o=e.folderFileId;return function(e,n){return r.__awaiter(void 0,void 0,void 0,(function(){var i,s;return r.__generator(this,(function(r){return i=a.user(n()).id,_.UserLocalStorage.clearOtherUsers([i]),(s=_.UserLocalStorage.get(i,"folder-overview-"+o))?(e(t.updateFolderDataCache({fileId:o,folderData:s})),[2]):[2]}))}))}},t.saveFolderPreferences=function(e){var t=e.folderFileId;return function(e,o){return r.__awaiter(void 0,void 0,void 0,(function(){var e,n;return r.__generator(this,(function(r){return e=a.user(o()).id,_.UserLocalStorage.clearOtherUsers([e]),(n=a.folderDataCache(o())[t])?(_.UserLocalStorage.set(e,"folder-overview-"+t,{isCollapsed:n.isCollapsed}),[2]):[2]}))}))}},t.addLoadedComponent=function(e){var t=e.componentNamespace,r=e.component;return{type:l.ActionTypes.ADD_LOADED_COMPONENT,payload:{componentNamespace:t,component:r}}},t.removeLoadedComponent=function(e){var t=e.componentNamespace,r=e.component;return{type:l.ActionTypes.REMOVE_LOADED_COMPONENT,payload:{componentNamespace:t,component:r}}},t.setFailedToLoad=function(e){var t=e.componentNamespace,r=e.hasFailedToLoad;return{type:l.ActionTypes.SET_FAILED_TO_LOAD,payload:{componentNamespace:t,hasFailedToLoad:r}}},t.setDescriptionData=function(e,r,o){var n=e.text,i=e.latest_revision_id,s=e.file_obj_id,a=e.bolt_channel_state,c=e.format_version,d=e.last_modified_time,u=e.last_modified_user;if(!s)throw new Error("Unexpected response from Sprinkle");var p=i||"";r(t.updateFolderDataCache({fileId:s,folderData:{description:n,descriptionBaseRevision:p,descriptionDraft:void 0,descriptionSaveState:l.DescriptionSaveState.IDLE,descriptionFormatVersion:c,descriptionBoltChannelState:a,descriptionLastUpdated:Date.now()}})),r(t.addLoadedComponent({componentNamespace:o,component:"description"})),r(E({folderFileId:s,time:d,userId:u})),t.subscribeToBolt("description",a)},t.reloadDescription=function(e){var o=e.folderFileId,n=e.componentNamespace;return function(e,s){return r.__awaiter(void 0,void 0,void 0,(function(){var l,c,d;return r.__generator(this,(function(r){switch(r.label){case 0:l=a.user(s()),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.getDescription(l.id,o)];case 2:return c=r.sent(),e(t.updateFolderDataCache({fileId:o,folderData:{descriptionBaseRevision:""}})),t.setDescriptionData(c,e,n),[3,4];case 3:return d=r.sent(),g.reportException({err:d,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"],exc_extra:{fileId:o,isReload:!0}}),[3,4];case 4:return[2]}}))}))}},t.saveDescriptionDraft=function(e){var o=e.folderFileId,n=e.componentNamespace;return function(e,d){return r.__awaiter(void 0,void 0,void 0,(function(){function p(r){e(t.updateFolderDataCache({fileId:o,folderData:r}))}var f,_,m,g,S,E,b,y,T,F,I;return r.__generator(this,(function(t){switch(t.label){case 0:f=a.user(d()).id,t.label=1;case 1:return t.trys.push([1,3,,4]),_=a.folderDataCache(d()),(m=_[o])&&v(m)?(p({descriptionSaveState:l.DescriptionSaveState.SAVING}),[4,i.setDescription(f,o,m.descriptionLatestRevision,m.descriptionDraft,s.DESCRIPTION_VERSION.join("."))]):[2];case 2:return g=t.sent(),S=g.text,E=g.latest_revision_id,b=g.last_modified_time,y=g.last_modified_user,p({description:S,descriptionSaveState:l.DescriptionSaveState.IDLE,lastModifiedTime:b,lastModifiedUserId:y,descriptionBaseRevision:E,descriptionLatestRevision:E}),T="BROWSE"===n?h.ActionSurfaceLogValue.CENTER_PANE:h.ActionSurfaceLogValue.RIGHT_SIDEBAR,F="search-sidebar"===n?h.RetrievalSourceValue.SEARCH:h.RetrievalSourceValue.BROWSE,u.logOverviewEdited({folderFileId:o,action_surface:T,retrievalSource:F,loggingFileId:m.loggingFileId}),[3,4];case 3:return I=t.sent(),i.isConflictError(I)?(p({descriptionSaveState:l.DescriptionSaveState.CONFLICT,lastModifiedUserId:void 0}),e(w({folderFileId:o}))):i.isFormatVersionError(I)?(c.showDescriptionFormatError(),p({descriptionSaveState:l.DescriptionSaveState.ERROR})):(c.showDescriptionSaveError(),p({descriptionSaveState:l.DescriptionSaveState.ERROR})),[3,4];case 4:return[2]}}))}))}},t.setContentReferencesData=function(e,r,o,n){var i=r.content_references||[],s=r.latest_revision_id,a=r.last_modified_time,l=r.last_modified_user;o(t.updateFolderDataCache({fileId:e,folderData:{contentReferences:i,contentReferencesRevision:s,contentReferencesBoltChannelState:r.bolt_channel_state,contentReferencesLastUpdated:Date.now()}})),o(E({folderFileId:e,time:a,userId:l})),o(t.addLoadedComponent({componentNamespace:n,component:"content_references"})),t.subscribeToBolt("content_references",r.bolt_channel_state)},t.reloadContentReferences=function(e){var o=e.folderFileId,n=e.componentNamespace;return function(e,s){return r.__awaiter(void 0,void 0,void 0,(function(){var l,c,d;return r.__generator(this,(function(r){switch(r.label){case 0:l=a.user(s()),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.getContentReferences(l.id,o)];case 2:return c=r.sent(),t.setContentReferencesData(o,c,e,n),[3,4];case 3:return d=r.sent(),g.reportException({err:d,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"],exc_extra:{fileId:o,isReload:!0}}),[3,4];case 4:return[2]}}))}))}},t.addContentReferences=function(e){var o=e.folderFileId,n=e.fileIds,s=e.componentNamespace;return function(e,l){return r.__awaiter(void 0,void 0,void 0,(function(){var c,d,p,f,_,m;return r.__generator(this,(function(r){switch(r.label){case 0:c=a.user(l()).id,d=a.folderDataCache(l())[o],p=d&&d.loggingFileId,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.addContentReferences(c,o,n)];case 2:return r.sent(),e(t.reloadContentReferences({folderFileId:o,componentNamespace:s})),f="BROWSE"===s?h.ActionSurfaceLogValue.CENTER_PANE:h.ActionSurfaceLogValue.RIGHT_SIDEBAR,_="search-sidebar"===s?h.RetrievalSourceValue.SEARCH:h.RetrievalSourceValue.BROWSE,u.logOverviewEdited({folderFileId:o,action_surface:f,retrievalSource:_,loggingFileId:p}),[3,4];case 3:return m=r.sent(),g.reportException({err:m,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}}))}))}},t.addContentReferencesForPath=function(e){var n=e.path,l=e.files;return function(e,c){return r.__awaiter(void 0,void 0,void 0,(function(){var d,u,_;return r.__generator(this,(function(r){switch(r.label){case 0:d=a.user(c()),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.addContentReferencesToPath(d.id,n,l.map(p.fileToContentReferenceId))];case 2:return r.sent(),1===l.length?f.Snackbar.complete(S.intl.formatMessage(s.PIN_TO_SUCCESS_SINGLE,{file:o.filename(l[0].fq_path),path:o.filename(n,m.Viewer.get_root_name(d))}),"folder-overview-pin"):f.Snackbar.complete(S.intl.formatMessage(s.PIN_TO_SUCCESS_MULTIPLE,{num:l.length,path:o.filename(n,m.Viewer.get_root_name(d))}),"folder-overview-pin"),(u=a.fileIdCache(c())[p.normalizePath(n)])&&e(t.reloadContentReferences({folderFileId:u,componentNamespace:"BROWSE"})),[3,4];case 3:_=r.sent(),g.reportException({err:_,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]});try{if("permission_denied"===_.error.status[".tag"])return f.Snackbar.fail(S.intl.formatMessage(s.PIN_TO_FAILURE_PERMISSION_DENIED,{file:o.filename(l[0].fq_path),path:o.filename(n,m.Viewer.get_root_name(d))}),"folder-overview-pin"),[2]}catch(e){}return 1===l.length?f.Snackbar.fail(S.intl.formatMessage(s.PIN_TO_FAILURE_SINGLE,{file:o.filename(l[0].fq_path),path:o.filename(n,m.Viewer.get_root_name(d))}),"folder-overview-pin"):f.Snackbar.fail(S.intl.formatMessage(s.PIN_TO_FAILURE_MULTIPLE,{num:l.length,path:o.filename(n,m.Viewer.get_root_name(d))}),"folder-overview-pin"),[3,4];case 4:return[2]}}))}))}},t.removeContentReferences=function(e){var o=e.folderFileId,n=e.fileIds,s=e.componentNamespace;return function(e,l){return r.__awaiter(void 0,void 0,void 0,(function(){var c,d,p,f,_,m;return r.__generator(this,(function(r){switch(r.label){case 0:c=a.user(l()).id,d=a.folderDataCache(l())[o],p=d&&d.loggingFileId,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.removeContentReferences(c,o,n)];case 2:return r.sent(),e(t.reloadContentReferences({folderFileId:o,componentNamespace:s})),f="BROWSE"===s?h.ActionSurfaceLogValue.CENTER_PANE:h.ActionSurfaceLogValue.RIGHT_SIDEBAR,_="search-sidebar"===s?h.RetrievalSourceValue.SEARCH:h.RetrievalSourceValue.BROWSE,u.logOverviewEdited({folderFileId:o,action_surface:f,retrievalSource:_,loggingFileId:p}),[3,4];case 3:return m=r.sent(),g.reportException({err:m,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}}))}))}},t.updateFolderDataCache=function(e){var t=e.fileId,r=e.folderData;return{type:l.ActionTypes.UPDATE_FOLDER_DATA_CACHE,payload:{fileId:t,folderData:r}}},t.setRequiredComponents=function(e){var t=e.componentNamespace,r=e.requiredComponents;return{type:l.ActionTypes.SET_REQUIRED_COMPONENTS,payload:{componentNamespace:t,requiredComponents:r}}},t.setDescriptionHasFocus=function(e){var r=e.componentNamespace,o=e.descriptionHasFocus,n=e.folderFileId;return function(e,i){var s=a.componentDataCache(i())[r];if(o&&s&&!s.descriptionHasFocus){var c=a.folderDataCache(i())[n].descriptionBaseRevision;e(t.updateFolderDataCache({fileId:n,folderData:{descriptionLatestRevision:c}}))}e({type:l.ActionTypes.SET_DESCRIPTION_HAS_FOCUS,payload:{componentNamespace:r,descriptionHasFocus:o}})}};var v=function(e){return!!e&&(e.descriptionSaveState!==l.DescriptionSaveState.CONFLICT&&(e.descriptionSaveState!==l.DescriptionSaveState.SAVING&&p.hasUnsavedDescriptionDraft(e)))};t.fetchSharedFolderName=function(e){var n=e.path;return function(e,s){return r.__awaiter(void 0,void 0,void 0,(function(){var l,c,d,u,f,_,m;return r.__generator(this,(function(r){switch(r.label){case 0:if(o.paths_are_equal(n,"/"))return[2];if(l=p.normalizePath(n),!(c=a.nsIdCache(s())[l]))return[2];if(d=a.fileIdCache(s())[l],u=a.user(s()).id,!(f=p.extractSharedFolderId(c)))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.getSharedFolderPath({userId:u,sharedFolderId:f})];case 2:return _=r.sent(),e(t.updateFolderDataCache({fileId:d,folderData:{sharedFolderPath:_}})),[3,4];case 3:return m=r.sent(),g.reportException({err:m,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}}))}))}},t.fetchAccountForUserId=function(e){var t=e.accountId;return function(e,o){return r.__awaiter(void 0,void 0,void 0,(function(){var n,s,c;return r.__generator(this,(function(r){switch(r.label){case 0:return n=a.user(o()),t?t in a.accountCache(o())?[2]:t===n.account_id?[2]:[4,i.getUserAccount({userId:n.id,accountId:t})]:[2];case 1:return s=r.sent(),e({type:l.ActionTypes.UPDATE_ACCOUNT_CACHE,payload:{accountCache:(c={},c[t]=s,c)}}),[2]}}))}))}},t.fetchLoggingFileId=function(e){var s=e.path;return function(e,l){return r.__awaiter(void 0,void 0,void 0,(function(){var c,d,u,f,_;return r.__generator(this,(function(r){switch(r.label){case 0:if(o.paths_are_equal(s,"/"))return[2];if(o.paths_are_equal(n.context(l()).currentFQPath,s)&&!n.context(l()).currentNSPath)return[2];c=p.normalizePath(s),d=a.fileIdCache(l())[c],u=a.user(l()).id,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.getLoggingFileId({userId:u,path:c})];case 2:return f=r.sent(),e(t.updateFolderDataCache({fileId:d,folderData:{loggingFileId:f}})),[3,4];case 3:return _=r.sent(),g.reportException({err:_,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}}))}))}};var E=function(e){var r=e.folderFileId,o=e.time,n=e.userId;return function(e,i){if(o&&n){var s=a.folderDataCache(i())[r];s&&(s.lastModifiedTime&&o<s.lastModifiedTime||(e(t.updateFolderDataCache({fileId:r,folderData:{lastModifiedTime:o,lastModifiedUserId:n}})),e(t.fetchAccountForUserId({accountId:n}))))}}};t.subscribeToBolt=function(e,t){if(void 0!==t)try{var r=t.channel_id,o=t.revision,n=t.token;if(void 0===r||void 0===o||void 0===n)return;var i=r.unique_id,s=r.app_id;if(void 0===i||void 0===s)return;d.folderOverviewLiveUpdateManager.setUpdateChannelForType(e,{uniqueId:i,appId:s,token:n,revision:""+o})}catch(e){g.reportException({err:e,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]})}};var w=function(e){var t=e.folderFileId;return function(e,o){return r.__awaiter(void 0,void 0,void 0,(function(){var n,s,l,c;return r.__generator(this,(function(r){switch(r.label){case 0:return n=a.user(o()),[4,i.getDescription(n.id,t)];case 1:return s=r.sent(),l=s.last_modified_time,c=s.last_modified_user,e(E({folderFileId:t,time:l,userId:c})),[2]}}))}))}},b=function(e,r,o,n,i){return o.latest_revision_id?(t.setDescriptionData(o,e,n),!0):(e(t.addLoadedComponent({componentNamespace:n,component:"description"})),e(t.updateFolderDataCache({fileId:r,folderData:{descriptionBoltChannelState:o.bolt_channel_state,descriptionLastUpdated:i}})),t.subscribeToBolt("description",o.bolt_channel_state),!1)},y=function(e,r,o,n,i,s,a){if(o.latest_revision_id)return t.setContentReferencesData(r,o,e,i),!0;var l="V1"===a||"V2"===a||"V3"===a||n;return e(t.updateFolderDataCache({fileId:r,folderData:{contentReferences:l?[]:void 0,contentReferencesBoltChannelState:l?o.bolt_channel_state:void 0,contentReferencesLastUpdated:s}})),e(t.addLoadedComponent({componentNamespace:i,component:"content_references"})),!1}})),define("modules/clean/react/folder_overview/data/reducer",["require","exports","tslib","modules/clean/react/browse/data/types","modules/clean/react/browse/models","modules/clean/react/folder_overview/data/types","modules/clean/react/folder_overview/utils","modules/clean/search/single_page/data/types"],(function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFolderOverviewState={folderDataCache:{},fileIdCache:{},accountCache:{},nsIdCache:{},componentDataCache:{}};var l=function(e,t){var r=e.componentDataCache[t];return r||{requiredComponents:[],loadedComponents:[],hasFailedToLoad:!1,descriptionHasFocus:!1}},c=function(e){var t={};return e.forEach((function(e){t[s.normalizePath(e.fq_path)]=e.target_ns?"ns:"+e.target_ns+"/":"ns:"+e.ns_id+"/"+e.ns_path})),t};t.folderOverviewReducer=function(e,d){switch(void 0===e&&(e=t.defaultFolderOverviewState),d.type){case i.ActionTypes.UPDATE_FOLDER_DATA_CACHE:return(function(e,t){var o,n=t.fileId,i=t.folderData;return r.__assign(r.__assign({},e),{folderDataCache:r.__assign(r.__assign({},e.folderDataCache),(o={},o[n]=r.__assign(r.__assign({},e.folderDataCache[n]),i),o))})})(e,d.payload);case i.ActionTypes.UPDATE_FILE_ID_CACHE:return(function(e,t){var o=t.fileIdCache;return r.__assign(r.__assign({},e),{fileIdCache:r.__assign(r.__assign({},e.fileIdCache),o)})})(e,d.payload);case i.ActionTypes.UPDATE_ACCOUNT_CACHE:return(function(e,t){var o=t.accountCache;return r.__assign(r.__assign({},e),{accountCache:r.__assign(r.__assign({},e.accountCache),o)})})(e,d.payload);case i.ActionTypes.SET_REQUIRED_COMPONENTS:return(function(e,t){var o,n=t.componentNamespace,i=t.requiredComponents,s=l(e,n);return r.__assign(r.__assign({},e),{componentDataCache:r.__assign(r.__assign({},e.componentDataCache),(o={},o[n]=r.__assign(r.__assign({},s),{requiredComponents:i}),o))})})(e,d.payload);case o.ActionTypes.SET_CONTEXT:return(function(e,t){var o,n=t.context;return r.__assign(r.__assign({},e),{nsIdCache:r.__assign(r.__assign({},e.nsIdCache),(o={},o[s.normalizePath(n.currentFQPath)]="ns:"+n.currentNSID+"/"+n.currentNSPath,o))})})(e,d.payload);case i.ActionTypes.REMOVE_LOADED_COMPONENT:return(function(e,t){var o,n=t.componentNamespace,i=t.component,s=l(e,n),a=s.loadedComponents;return r.__assign(r.__assign({},e),{componentDataCache:r.__assign(r.__assign({},e.componentDataCache),(o={},o[n]=r.__assign(r.__assign({},s),{loadedComponents:a.filter((function(e){return e!==i}))}),o))})})(e,d.payload);case i.ActionTypes.ADD_LOADED_COMPONENT:return(function(e,t){var o,n=t.componentNamespace,i=t.component,s=l(e,n),a=s.loadedComponents;return a.includes(i)?e:r.__assign(r.__assign({},e),{componentDataCache:r.__assign(r.__assign({},e.componentDataCache),(o={},o[n]=r.__assign(r.__assign({},s),{loadedComponents:r.__spreadArrays(a,[i])}),o))})})(e,d.payload);case i.ActionTypes.SET_FAILED_TO_LOAD:return(function(e,t){var o,n=t.componentNamespace,i=t.hasFailedToLoad,s=l(e,n);return r.__assign(r.__assign({},e),{componentDataCache:r.__assign(r.__assign({},e.componentDataCache),(o={},o[n]=r.__assign(r.__assign({},s),{hasFailedToLoad:i}),o))})})(e,d.payload);case i.ActionTypes.SET_DESCRIPTION_HAS_FOCUS:return(function(e,t){var o,n=t.componentNamespace,i=t.descriptionHasFocus,s=l(e,n);return r.__assign(r.__assign({},e),{componentDataCache:r.__assign(r.__assign({},e.componentDataCache),(o={},o[n]=r.__assign(r.__assign({},s),{descriptionHasFocus:i}),o))})})(e,d.payload);case o.ActionTypes.SET_UNSORTED_FILES:return(function(e,t){var o=t.unsortedFiles.filter((function(e){return e.is_dir})).toArray();return r.__assign(r.__assign({},e),{nsIdCache:r.__assign(r.__assign({},e.nsIdCache),c(o))})})(e,d.payload);case a.ActionTypes.SET_RESULTS:case a.ActionTypes.APPEND_RESULTS:return(function(e,t){var o=t.searchResults.results.filter((function(e){return e instanceof n.File&&e.is_dir}));return r.__assign(r.__assign({},e),{nsIdCache:r.__assign(r.__assign({},e.nsIdCache),c(o))})})(e,d.payload)}return e}})),define("modules/clean/react/folder_overview/data/selectors",["require","exports","tslib","reselect","modules/clean/filepath","modules/clean/react/folder_overview/constants","modules/clean/react/folder_overview/data/reducer","modules/clean/react/folder_overview/utils","comments2/components/folder_overview_utils","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/clean/user"],(function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),a=r.__importStar(a);var p=[],f=function(e){return d.getStateAtNamespace(e,c.FOLDER_OVERVIEW_NAMESPACE_KEY)||s.defaultFolderOverviewState};t.folderDataCache=function(e){return f(e).folderDataCache},t.fileIdCache=function(e){return f(e).fileIdCache};var _=function(e,r){return t.fileIdCache(e)[a.normalizePath(r.path)]};t.nsIdCache=function(e){return f(e).nsIdCache};var m=function(e,r){return t.nsIdCache(e)[a.normalizePath(r.path)]};t.accountCache=function(e){return f(e).accountCache},t.componentDataCache=function(e){return f(e).componentDataCache},t.user=function(e){return e.BROWSE&&e.BROWSE.user||u.mkUser(e.SEARCH.user)};var h=function(e,r){return t.componentDataCache(e)[r.componentNamespace]},g=function(e,r){var o=_(e,r);return t.folderDataCache(e)[o]},S=function(e,t){var r=g(e,t);return r?r.sharedFolderPath||t.path:void 0},v=function(e,t){var r=g(e,t);return r?r.lastModifiedUserId:void 0},E=o.createSelector(g,(function(e){return e?e.descriptionFormatVersion:void 0})),w=o.createSelector(g,(function(e){if(e&&e.description)try{return JSON.parse(e.description)}catch(e){return}})),b=o.createSelector(g,(function(e){if(void 0!==e&&void 0!==e.contentReferences)return 0===e.contentReferences.length?p:a.convertContentReferencesToSortedFiles(e.contentReferences)})),y=o.createSelector(w,l.isEmptyDescription);t.makeLoadedComponentsSelector=function(){return o.createSelector(h,(function(e){return e?e.loadedComponents:void 0}))},t.makeHaveAllComponentsLoadedSelector=function(){return o.createSelector(h,(function(e){return!(!e||0===e.requiredComponents.length)&&0===e.requiredComponents.filter((function(t){return!e.loadedComponents.includes(t)})).length}))},t.makeHasFailedToLoadSelector=function(){return o.createSelector(h,(function(e){return!!e&&e.hasFailedToLoad}))},t.makeDescriptionHasFocusSelector=function(){return o.createSelector(h,(function(e){return!!e&&e.descriptionHasFocus}))},t.makeFolderFileIdSelector=function(){return o.createSelector(_,(function(e){return e}))},t.makeFolderNsIdSelector=function(){return o.createSelector(m,(function(e){return e}))},t.makeSharedFolderIdSelector=function(){return o.createSelector(m,(function(e){if(e)return a.extractSharedFolderId(e)}))},t.descriptionAuthorSelector=o.createSelector(t.user,a.convertDbxUserToIUser),t.makeIsCollapsedSelector=function(){return o.createSelector(g,(function(e){return!!e&&!!e.isCollapsed}))},t.makeDescriptionBaseRevisionSelector=function(){return o.createSelector(g,(function(e){return e?e.descriptionBaseRevision:void 0}))},t.makeLastModifiedTimeSelector=function(){return o.createSelector(g,(function(e){return e?e.lastModifiedTime:void 0}))},t.makeLastModifiedUserIdSelector=function(){return o.createSelector(v,(function(e){return e}))},t.makeLastModifiedUserSelector=function(){return o.createSelector(v,t.accountCache,(function(e,t){return e?t[e]:void 0}))},t.makeDescriptionSaveStateSelector=function(){return o.createSelector(g,(function(e){return e?e.descriptionSaveState:void 0}))},t.makeDescriptionFormatValidSelector=function(){return o.createSelector(E,(function(e){if(!e)return!0;var t=e.split(".").map((function(e){return parseInt(e,10)}));return!(t[0]>i.DESCRIPTION_VERSION[0])&&!(t[0]===i.DESCRIPTION_VERSION[0]&&t[1]>i.DESCRIPTION_VERSION[1])}))},t.makeHasUnsavedDescriptionDraftSelector=function(){return o.createSelector(g,a.hasUnsavedDescriptionDraft)},t.makeSharedFolderPathSelector=function(){return o.createSelector(S,(function(e){return e}))},t.makeSharedFolderNameSelector=function(){return o.createSelector(S,(function(e){return e?n.filename(e):void 0}))},t.makeLoggingFileIdSelector=function(){return o.createSelector(g,(function(e){return e?e.loggingFileId:void 0}))},t.makeDescriptionContentSelector=function(){return o.createSelector(w,(function(e){return e}))},t.makePinnedItemsSelector=function(){return o.createSelector(b,(function(e){return e}))},t.makeIsFolderOverviewEmptySelector=function(){return o.createSelector(y,b,(function(e,t){return e&&!(t&&t.length)}))},t.makeIsSpaceSelector=function(){return o.createSelector(y,b,(function(e,t){return!e||!(!t||!t.length)}))},t.makeDoesFolderOverviewExistSelector=function(){return o.createSelector(g,(function(e){return!!e&&(!!e.descriptionBaseRevision||!!e.contentReferencesRevision)}))}})),define("modules/clean/react/folder_overview/data/store",["require","exports","modules/clean/react/folder_overview/data/reducer","modules/clean/redux/store","modules/clean/redux/namespaces"],(function(e,t,r,o,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForFolderOverview=function(){var e;return i||(i=o.getStoreAndRegisterReducers(((e={})[n.FOLDER_OVERVIEW_NAMESPACE_KEY]=r.folderOverviewReducer,e))),i}})),define("modules/clean/react/folder_overview/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.UPDATE_FOLDER_DATA_CACHE="FOLDER_OVERVIEW/UPDATE_FOLDER_DATA_CACHE",e.UPDATE_FILE_ID_CACHE="FOLDER_OVERVIEW/UPDATE_FILE_ID_CACHE",e.REMOVE_LOADED_COMPONENT="FOLDER_OVERVIEW/REMOVE_LOADED_COMPONENT",e.ADD_LOADED_COMPONENT="FOLDER_OVERVIEW/ADD_LOADED_COMPONENT",e.SET_FAILED_TO_LOAD="FOLDER_OVERVIEW/SET_FAILED_TO_LOAD",e.SET_DESCRIPTION_HAS_FOCUS="FOLDER_OVERVIEW/SET_DESCRIPTION_HAS_FOCUS",e.UPDATE_ACCOUNT_CACHE="FOLDER_OVERVIEW/UPDATE_ACCOUNT_CACHE",e.SET_REQUIRED_COMPONENTS="FOLDER_OVERVIEW/SET_REQUIRED_COMPONENTS"})(t.ActionTypes||(t.ActionTypes={})),(function(e){e.IDLE="IDLE",e.SAVING="SAVING",e.CONFLICT="CONFLICT",e.ERROR="ERROR"})(t.DescriptionSaveState||(t.DescriptionSaveState={}))})),define("modules/clean/react/folder_overview/errors",["require","exports","modules/clean/react/folder_overview/constants","modules/clean/react/snackbar"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showDescriptionFormatError=function(){o.Snackbar.fail(r.ERROR_DESCRIPTION_FORMAT_VERSION,"folder-overview")},t.showDescriptionSaveError=function(){o.Snackbar.fail(r.ERROR_DESCRIPTION_SAVE,"folder-overview")}})),define("modules/clean/react/folder_overview/live_update",["require","exports","tslib","external/lodash","eventemitter3","modules/clean/bolt"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var s=(function(e){function t(){var t=e.call(this)||this;return t.setUpdateChannelForType=function(e,r){t.signedChannelStates[e]=new i.SignedChannelState(r.appId,r.uniqueId,r.revision,r.token),t.boltClient.update_states(o.values(t.signedChannelStates)),t.boltClient.start()},t.handleUpdate=function(e){var r=[];e.forEach((function(e){var n=o.findKey(t.signedChannelStates,{app_id:e.app_id,unique_id:e.unique_id});n&&!r.includes(n)&&(t.emit("update",{type:n}),r.push(n))}))},t.handleRefresh=function(){t.boltClient.update_states(o.values(t.signedChannelStates))},t.boltClient=new i.BoltClient([],t.handleUpdate,t.handleRefresh),t.signedChannelStates={},t}return r.__extends(t,e),t.prototype.stop=function(){this.boltClient.unsubscribe()},t})(n.EventEmitter);t.FolderOverviewLiveUpdateManager=s,t.folderOverviewLiveUpdateManager=new s})),define("modules/clean/react/folder_overview/logging",["require","exports","tslib","sjcl","immutable","modules/clean/filepath","modules/clean/logging/hive/schemas/web-user-action","modules/clean/logging/telemetry","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/store","modules/clean/react/folder_overview/utils","modules/clean/web_user_action_events"],(function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";function p(e){return e.blocks.map((function(e){return e.text.length})).reduce((function(e,t){return e+t}),0)}function f(e){var t=n.OrderedSet();return t=t.merge(e.blocks.map((function(e){return e.type})).filter((function(e){return"unstyled"!==e}))),e.blocks.forEach((function(e){return e.inlineStyleRanges.forEach((function(e){t=t.add(e.style)}))})),e.blocks.forEach((function(r){return r.entityRanges.forEach((function(r){t=t.add(e.entityMap[r.key].type)}))})),t.toArray().sort()}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),i=r.__importStar(i),a=r.__importStar(a),l=r.__importStar(l),t.hiveLogger=new a.HiveLogger;var _=function(e,t){var r=l.folderDataCache(t)[e];return r&&r.contentReferences||[]},m=function(e){if(!e)return"";var t=o.hash.sha256.hash(e.toLowerCase());return o.codec.hex.fromBits(t)};t.hashPath=function(e){return(e||"/").split("/").map(m).join("/")};var h=function(e){var t=i.normalize(e).split("/");return m(t.pop())};t.extractNsIdAndPath=function(e){return e?{nsId:d.extractSharedFolderId(e),nsPath:d.extractSharedFolderPath(e)}:{}},t.makeEditedData=function(e){var o,n,i=e.folderFileId,s=e.loggingFileId,a=e.action_surface,d=e.retrievalSource,u=c.getStoreForFolderOverview().getState(),m=(o=(function(e,t){var r=l.folderDataCache(t)[e];if(r&&r.descriptionDraft)try{return JSON.parse(r.descriptionDraft)}catch(e){return}})(i,u),n=(function(e){var t={all:0,checked:0};return e?(e.blocks.forEach((function(e){"task-block"===e.type&&(t.all+=1,e.data&&e.data.checked&&(t.checked+=1))})),t):t})(o),{length:o?p(o):0,features:o?f(o):[],tasks:n.all,checkedTasks:n.checked}),g=t.makeOverviewResourceExtras({folderFileId:i,loggingFileId:s,action_surface:a,retrievalSource:d});if(g)return r.__assign(r.__assign({},g),{length:m.length.toString(),formatting:JSON.stringify(m.features),tasks:m.tasks.toString(),checkedTasks:m.checkedTasks.toString(),pins:JSON.stringify(_(i,u).map((function(e){return{file_id:e.ns_path?e.file_id:e.ns_id,file_obj_id:e.file_id,resource:{resource_title:h(e.fq_path),resource_type:e.is_dir?"SFJ_FOLDER":"SFJ_FILE",ns_id:""+e.ns_id,resource_path:t.hashPath(e.fq_path),resource_namespace_path:t.hashPath(e.ns_path)}}})))})},t.makeOverviewResourceExtras=function(e){var r=e.folderFileId,o=e.loggingFileId,n=e.action_surface,i=e.retrievalSource,s=c.getStoreForFolderOverview().getState(),a=(function(e,t){var r=l.fileIdCache(t);for(var o in r)if(r[o]===e)return o})(r,s);if(void 0!==a){var d=t.extractNsIdAndPath(l.nsIdCache(s)[a]),u=d.nsId,p=d.nsPath;if(u)return{resource_type:"SFJ_FOLDER",resource_title:h(a),ns_id:u,resource_path:t.hashPath(a),resource_namespace_path:t.hashPath(p),file_id:(p?o:u)||null,file_obj_id:r,is_offline:"false",action_surface:n,retrieval_source:i}}},t.logOverviewEdited=function(e){var r=e.folderFileId,o=e.loggingFileId,n=e.action_surface,i=e.retrievalSource,s=c.getStoreForFolderOverview().getState();t.logFolderOverviewAction(u.WebUserActionLogEvent.FOLDER_OVERVIEW_EDITED,l.user(s).id,null,t.makeEditedData({folderFileId:r,loggingFileId:o,action_surface:n,retrievalSource:i}))},t.logFolderOverviewAction=function(e,o,n,a){void 0===a&&(a={});var l={user_id:o,event_name:e};n&&(l=r.__assign(r.__assign({},l),{file_nsid:n.ns_id,file_sjid:n.sjid,file_id:n.file_id,file_name:i.filename(n.fq_path),file_path:n.fq_path,file_extension:n.ext})),t.hiveLogger.log(new s.WebUserActionRow(r.__assign(r.__assign({},l),{extra:r.__assign({},a)})))}})),define("modules/clean/react/folder_overview/placeholder",["require","exports","tslib","react","spectrum/button","modules/clean/react/folder_overview/constants"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.FolderOverviewPlaceholder=function(e){var r=e.isReadOnly?i.DESCRIPTION_PLACEHOLDER_READ_ONLY:e.isSpace?i.DESCRIPTION_PLACEHOLDER_FOR_SPACE:i.DESCRIPTION_PLACEHOLDER;return o.default.createElement("div",{className:"folder-overview__description--placeholder",onClick:e.onClick},o.default.createElement("span",null,r),e.showExamples&&o.default.createElement(t.FolderOverviewPlaceholderExample,{showExamplesAsButton:e.showExamplesAsButton,onExampleButtonClick:e.onExampleButtonClick}))},t.FolderOverviewPlaceholderExample=function(e){return e.showExamplesAsButton?o.default.createElement(n.Button,{"aria-label":i.FOLDER_EXAMPLES_LINK_LABEL,onClick:e.onExampleButtonClick,className:"folder_overview__examples-button",variant:"secondary"},i.DESCRIPTION_PLACEHOLDER_EXAMPLES_BUTTON):o.default.createElement("a",{"aria-label":i.FOLDER_EXAMPLES_LINK_LABEL,href:i.FOLDER_EXAMPLES_LINK_URI,target:"_blank",rel:"noreferrer"},i.DESCRIPTION_PLACEHOLDER_EXAMPLES_BUTTON)},t.WrappedFolderOverviewPlaceholder=function(e){return o.default.createElement("div",{className:"folder-overview__description folder-overview__placeholder folder-overview__fixed-toolbar"},o.default.createElement(t.FolderOverviewPlaceholder,{showExamples:e.showExamples,isReadOnly:e.isReadOnly,showExamplesAsButton:e.showExamplesAsButton,onClick:e.onClick}))}})),define("modules/clean/react/folder_overview/sidebar_controller",["require","exports","tslib","classnames","react-redux","react","modules/clean/react/css","modules/clean/react/folder_overview/async_components","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/store","modules/clean/react/folder_overview/live_update"],(function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),i=r.__importDefault(i),l=r.__importStar(l),c=r.__importStar(c),d.getStoreForFolderOverview();var p={fetchDataForFolder:l.fetchDataForFolder,reloadDescription:l.reloadDescription},f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleLiveUpdate=function(e){"description"===e.type&&t.props.reloadDescription({folderFileId:t.props.folderFileId,componentNamespace:t.props.componentNamespace})},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.fetchDataForFolder({path:this.props.path,nsId:this.props.nsId,expFolderOverview:"V3",componentNamespace:this.props.componentNamespace,fetchContentReferences:!0}),u.folderOverviewLiveUpdateManager.addListener("update",this.handleLiveUpdate)},t.prototype.componentWillUnmount=function(){u.folderOverviewLiveUpdateManager.removeListener("update",this.handleLiveUpdate),u.folderOverviewLiveUpdateManager.stop()},t.prototype.render=function(){return!this.props.doesFolderOverviewExist&&this.props.onlyRenderExistingFolderOverviews?null:i.default.createElement("div",{className:o.default({"folder-overview":!0,"folder-overview--loading":!this.props.haveAllComponentsLoaded||this.props.hasFailedToLoad,"folder-overview__fixed-toolbar-container":!0,"folder-overview__border":this.props.descriptionHasFocus})},i.default.createElement(a.AsyncFolderOverviewDescription,{path:this.props.path,componentNamespace:this.props.componentNamespace,expFolderOverview:"V3",isReadOnly:this.props.isReadOnly||!this.props.descriptionFormatValid,showReadOnlyIcon:!0,showDraftIcon:!1,descriptionKey:[this.props.folderFileId,this.props.descriptionBaseRevision].join("-"),showExamplesInPlaceholder:!1,limitedWidth:!0,canShareFolder:this.props.canShareFolder}),i.default.createElement(a.AsyncFolderOverviewLastEdit,{path:this.props.path,componentNamespace:this.props.componentNamespace}))},t})(i.default.PureComponent),_=n.connect((function(){var e=c.makeHaveAllComponentsLoadedSelector(),t=c.makeHasFailedToLoadSelector(),r=c.makeFolderFileIdSelector(),o=c.makeDescriptionBaseRevisionSelector(),n=c.makeDescriptionHasFocusSelector(),i=c.makeDescriptionFormatValidSelector(),s=c.makeDoesFolderOverviewExistSelector();return function(a,l){return{user:c.user(a),haveAllComponentsLoaded:e(a,l),hasFailedToLoad:t(a,l),folderFileId:r(a,l),descriptionBaseRevision:o(a,l),descriptionFormatValid:i(a,l),descriptionHasFocus:n(a,l),doesFolderOverviewExist:s(a,l)}}}),p)(f);t.SidebarFolderOverview=s.requireCssWithComponent(_,["/static/css/browse/folder_overview-vflrny3Ss.css","/static/js/comments2/index.web-vflS3-E6r.css","/static/js/retrieval-components/index.web-vflPW373a.css"])})),define("modules/clean/react/folder_overview/utils",["require","exports","tslib","modules/clean/filepath","modules/clean/react/browse/models","modules/core/i18n","comments2/components/folder_overview_utils"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.convertDbxUserToIUser=function(e){return{id:e.id.toString(),name:{display:e.display_name,initials:[e.fname.substr(0,1),e.lname.substr(0,1)].join(""),public:e.familiar_name},photoUrl:e.initials_url}},t.normalizePath=function(e){return o.normalize(e).toLowerCase()},t.hasUnsavedDescriptionDraft=function(e){if(!e)return!1;try{var t=void 0===e.description||""===e.description||s.isEmptyDescription(JSON.parse(e.description)),r=void 0===e.descriptionDraft||""===e.descriptionDraft||s.isEmptyDescription(JSON.parse(e.descriptionDraft));if(t&&r)return!1}catch(e){}return e.description!==e.descriptionDraft&&void 0!==e.descriptionDraft},t.convertContentReferencesToSortedFiles=function(e){var r=[];e.forEach((function(e){var o={file_id:e.file_id,fq_path:e.fq_path,href:e.href,icon:e.icon,is_cloud_doc:e.is_cloud_doc,is_dir:e.is_dir,thumbnail_url_tmpl:e.thumbnail_url_tmpl,ns_id:e.ns_id,ns_path:e.ns_path,sjid:e.sjid,isDeleted:e.is_deleted,ext:t.getFileExtension(e.fq_path)},i=new n.File(o);r.push(i)}));var o=i.case_insensitive_comparator(!0);return r.sort((function(e,t){return o(n.File.getFilename(e),n.File.getFilename(t))}))},t.getFileExtension=function(e){if(!e)return"";var t=o.file_extension(e);return t?"."+t:""},t.extractSharedFolderId=function(e){var t=/^ns:([0-9]+)\/?/.exec(e);return t?t[1]:void 0},t.extractSharedFolderPath=function(e){var t=/^ns:[0-9]+\/?(.*)/.exec(e);return t?t[1]:void 0},t.pathFromSharingFolder=function(e,t){return e.length>=t.length?o.filename(t):r.__spreadArrays([o.filename(e)],t.substr(e.length).split("/").filter((function(e){return!!e}))).join(" › ")},t.fileToContentReferenceId=function(e){return e.is_dir&&e.target_ns?"ns:"+e.target_ns:e.file_id};t.userInitials=function(e){return(function(e){return"fname"in e})(e)?e.fname.substr(0,1)+e.lname.substr(0,1):e.name.given_name.substr(0,1)+e.name.surname.substr(0,1)},t.canEditOverviewForFile=function(e){return(!e.is_dir||!e.isDeleted)&&(e.target_ns?!e._mount_access_perms||!(!e._mount_access_perms||!e._mount_access_perms.includes("can_edit")):!e.read_only)}})),define("modules/clean/react/folder_subscriptions/follow/async_folder_unfollower",["require","exports","tslib","react"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o=r.__importDefault(o)).default.lazy((function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/folder_subscriptions/follow/folder_unfollower"],t,r)})).then(r.__importStar)];case 1:return[2,{default:t.sent().FolderUnfollower}]}}))}))}));t.AsyncFolderUnfollower=function(){return o.default.createElement(o.default.Suspense,{fallback:null},o.default.createElement(n,null))}})),define("modules/clean/pagination_manager",["require","exports","tslib","modules/clean/ajax","modules/core/i18n","modules/core/notify","modules/clean/react/snackbar"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var a=(function(){function e(e){this.hasMoreItems=e}return e.prototype.areAllItemsReady=function(){return!this.hasMoreItems},e.prototype.invalidateHasMore=function(){this.hasMoreItems=!0},e.prototype.addDataToAjax=function(e){},e})(),l=(function(){function e(e){var t=this;this.handleNextPageSuccess=function(e){t.nextRequestVoucher=e.next_request_voucher,t.mode.hasMoreItems=e.has_more_items,t.autoFetching&&t.fetchNext(),t.addPage(e.items)},this.ajaxURL=e.ajaxURL,this.newDataCallback=e.newDataAvailableCallback,this.autoFetching=!1,this.mode=e.mode,this.keyName=e.keyName,this.items={},this.pages=[],this.nextRequestVoucher=e.firstPage.next_request_voucher,this.userID=e.userID,this.fqPathPrefix=e.fqPathPrefix?"/"+e.fqPathPrefix:"",this.addPage(e.firstPage.items),this.fetchNextFn=e.fetchNextFn}return e.prototype.areAllItemsReady=function(){return this.mode.areAllItemsReady()},e.prototype.addPage=function(e){for(var t=[],r=[],o=0,s=e;o<s.length;o++){var a=s[o],l=a[this.keyName];if(null==l)return void i.Notify.warning(n.intl.formatMessage({id:"xlabvw",defaultMessage:"Invalid server response"}));null==this.items[l]&&(this.items[l]=a,r.push(a),t.push(l))}this.pages.push(t),this.newDataCallback(this,r)},e.prototype.startAutoFetching=function(){this.autoFetching=!0,this.fetchNext()},e.prototype.stopAutoFetching=function(){this.autoFetching=!1},e.prototype.reSync=function(e){void 0===e&&(e=!1),e&&(this.nextRequestVoucher=null,this.items={},this.pages=[]);var t=this.autoFetching&&this.mode.areAllItemsReady();this.mode.invalidateHasMore(),t&&this.startAutoFetching()},e.prototype.fetchNext=function(){var e=this;if(!this.mode.areAllItemsReady()){var t={};this.nextRequestVoucher&&(t.voucher=this.nextRequestVoucher),this.mode.addDataToAjax(t),this.fetchNextFn?this.fetchNextFn(this.nextRequestVoucher||"",this.fqPathPrefix,this.userID).then((function(t){e.handleNextPageSuccess(t)})).catch((function(){s.Snackbar.fail(n.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}),"browse")})):o.WebRequest({url:this.ajaxURL,data:t,subject_user:this.userID,success:function(t){for(var r=JSON.parse(t),o=0,n=r.items;o<n.length;o++){var i=n[o];i.fq_path=e.fqPathPrefix+i.fq_path}var s={next_request_voucher:r.next_request_voucher,has_more_items:r.has_more_items,items:r.items};e.handleNextPageSuccess(s)},error:function(){s.Snackbar.fail(n.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}),"browse")}})}},e.prototype.loadedPageCount=function(){return this.pages.length},e.prototype.getLoadedPage=function(e){var t=this,r=this.pages[e];return null==r?null:r.map((function(e){return t.items[e]}))},e.prototype.getLastLoadedPage=function(){return this.getLoadedPage(this.loadedPageCount()-1)},e})();t.BasePaginationManager=l;var c=(function(e){function t(t){return e.call(this,r.__assign(r.__assign({},t),{mode:new a(t.firstPage.has_more_items)}))||this}return r.__extends(t,e),t.create=function(e){return new t(e)},t})(l);t.PaginationManager=c})),define("modules/clean/react/app_actions/education/async_extensions_edu_modal",["require","exports","tslib","react","modules/clean/react/modal"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.asyncShowExtensionsEduModal=function(t,i){var s=this;return new Promise((function(t){return r.__awaiter(s,void 0,void 0,(function(){var s;return r.__generator(this,(function(a){switch(a.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/app_actions/education/edu_modal_component"],t,r)})).then(r.__importStar)];case 1:return s=a.sent().AppActionsEduModal,t(n.Modal.showInstance(o.default.createElement(s,{appName:i}))),[2]}}))}))}))}})),define("modules/clean/react/extensions/app_recommendations_modal/async_modal",["require","exports","tslib","react","modules/clean/react/modal"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.asyncShowAppRecommendationModal=function(t,i){return r.__awaiter(this,void 0,Promise,(function(){var s,a,l,c;return r.__generator(this,(function(d){switch(d.label){case 0:return[4,Promise.all([new Promise((function(t,r){e(["modules/clean/react/extensions/app_recommendations_modal/util"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/extensions/app_recommendations_modal/modal"],t,r)})).then(r.__importStar)])];case 1:return s=d.sent(),a=s[0].fetchAppRecommendationEntries,l=s[1].AppRecommendationsModal,[4,a(t)];case 2:return c=d.sent(),n.Modal.showInstance(o.default.createElement(l,{appEntries:c,userId:t,launcherTag:i})),[2]}}))}))}}));var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/async_fileops_modals",["require","exports"],(function(e,t){"use strict";function r(t){new Promise((function(t,r){e(["modules/clean/react/fileops_modals"],t,r)})).then(__importStar).then(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.showCopy=function(e){r((function(t){return(0,t.showCopy)(e)}))},t.showMove=function(e){r((function(t){return(0,t.showMove)(e)}))},t.showUpload=function(e){r((function(t){return(0,t.showUpload)(e)}))},t.showAdminUpload=function(e){r((function(t){return(0,t.showAdminUpload)(e)}))},t.showMoveDialog=function(t){new Promise((function(t,r){e(["modules/clean/react/folder_dialog/move_dialog_modal"],t,r)})).then(__importStar).then((function(e){return e.MoveDialogModal.show(t)}))}}));__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/async_onboarding_move_modal",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showOnboardingMoveDialog=function(t){new Promise((function(t,r){e(["modules/clean/react/onboarding_folder_dialog/onboarding_move_dialog"],t,r)})).then(__importStar).then((function(e){return(0,e.showMove)(t)}))},t.showOnboardingMoveDialogV2=function(t){new Promise((function(t,r){e(["modules/clean/react/onboarding_folder_dialog/onboarding_move_dialog_v2"],t,r)})).then(__importStar).then((function(e){return(0,e.showMoveDialog)(t)}))}})),define("modules/clean/react/browse/actions",["require","exports","tslib","immutable","modules/clean/cloud_docs/open_with_utils","modules/clean/cloud_docs/preferred_editor_utils","modules/clean/cloud_docs/types","modules/clean/downloads","modules/clean/file_actions/create-folder","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/filetypes","modules/clean/flux/dispatcher","modules/clean/history","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/helpers","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/store","modules/clean/react/browse/models","modules/clean/react/file_uploader/constants","modules/clean/react/file_viewer/async_controller","modules/clean/react/fileops_actions","modules/clean/react/files_view/types","modules/clean/pnm/utils","modules/clean/react/plusplus/file_actions","modules/clean/react/share_download/api","modules/clean/react/snackbar","modules/clean/react/vault/constants","modules/clean/sharing/browse_exports","modules/clean/user_education/user_education_client","modules/constants/python","modules/core/browser","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S,v,E,w,b,y,T,F,I,O,C,P,A,D,R,M,N,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),a=r.__importStar(a),c=r.__importStar(c),d=r.__importStar(d),f=r.__importDefault(f),_=r.__importStar(_),m=r.__importStar(m),g=r.__importStar(g),v=r.__importStar(v),T=r.__importStar(T),C=r.__importStar(C),N=r.__importStar(N);var x=(function(){function x(){var n=this;this.initializeEverything=function(e){var t=e.path,i=e.files,s=e.paginatedTotalNumFiles,a=e.context,l=e.mountPoints,c=e.fqPathsToSelect,d=e.loadingState,u=e.teamFolders;n.reduxStore.dispatch(g.setPath({path:t})),n.reduxStore.dispatch(g.appendFiles({path:t,files:r.__spreadArrays(i,u)})),n.reduxStore.dispatch(g.setPaginatedTotalNumFiles({paginatedTotalNumFiles:s})),n.reduxStore.dispatch(g.setMountPoints({mountPoints:l})),n.reduxStore.dispatch(g.setLoadingState({loadingState:d,path:t})),d===F.LoadingState.LOADED?n.reduxStore.dispatch(g.selectFilesByFqPath({fqPathsToSelect:c})):n.reduxStore.dispatch(g.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(c)})),n.reduxStore.dispatch(g.setContext({context:a})),p.Dispatcher.dispatch({type:b.UploaderActionType.SET_PATH,data:{path:t,hasPermissionToUploadToFolder:a.isCurrentPathWriteable(),isMovingIntoVault:a.isInsideVaultFolder}}),p.Dispatcher.dispatch({type:h.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:t,files:i}})},this.addFilesAndSetLoadingState=function(e){var t=e.path,r=e.loadingState,o=e.files,i=e.paginatedTotalNumFiles;n.reduxStore.dispatch(g.appendFiles({path:t,files:o})),n.reduxStore.dispatch(g.setPaginatedTotalNumFiles({paginatedTotalNumFiles:i})),n.reduxStore.dispatch(g.setLoadingState({loadingState:r,path:t})),p.Dispatcher.dispatch({type:h.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:t,files:o}})},this.setUrl=function(e){var t=e.path,r=e.qargs;n.reduxStore.dispatch(g.setUrl({path:t,qargs:r}))},this.nameNewFolder=function(){n.reduxStore.dispatch(g.setNewFolderCreationState({newFolderCreationState:F.NewFolderCreationState.PENDING_INPUT}))},this.createFolderPending=function(){l.logCreateFolderPending(),n.reduxStore.dispatch(g.setNewFolderCreationState({newFolderCreationState:F.NewFolderCreationState.SAVING_INPUT}))},this.cancelCreateFolder=function(e){l.logCreateFolderCancel(e),n.reduxStore.dispatch(g.setNewFolderCreationState({newFolderCreationState:F.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),window.setTimeout((function(){R.UEClient.sendEvent("CdmNewFolderModal","maybeFinished")}),2500)},this.createFolderComplete=function(){l.logCreateFolderSuccess(),n.reduxStore.dispatch(g.setNewFolderCreationState({newFolderCreationState:F.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),P.Snackbar.complete(L.intl.formatMessage({id:"a26imc",defaultMessage:"Folder created."}),"browse-action"),window.setTimeout((function(){R.UEClient.sendEvent("CdmNewFolderModal","maybeFinished")}),2500)},this.createFolder=function(e){n.reduxStore.dispatch(g.createFolder(e))},this.createFolderInNewFolderModal=function(e){var r=e.folderName,o=e.isConfidential,i=e.user,s=e.context,a=e.redirectOnSuccess,l=e.redirectOnCancel,c=e.fqPath,d=e.selectCreatedFolder,u=e.origin,p=s?s.currentFQPath:c,f=s?s.rootNSID:i.root_ns_id;if(o&&s&&!s.isInsideTeamFolderTree)D.asyncShowNewFolderShareModal(i,null,p,r,!1,!1,null,n.setUrl);else{var _=(i.is_cdm_member||o)&&!!s&&s.isInsideTeamFolderTree;t.browseActions.createFolder({pathName:p,folderName:r,nsId:f,checkFSWs:!1,showShareModalOnSuccess:_?n.handleShowShareModal:null,redirectOnSuccess:a,redirectOnCancel:l,selectCreatedFolder:d,origin:u})}},this.handleNewFolderRedirectOnSuccess=function(e){n.setUrl({path:e})},this.doDeleteFilesWithModal=function(e){var t=e.files,o=v.user(n.reduxStore.getState()),i=v.context(n.reduxStore.getState());_.showDelete(o,t,i,d.filename(i.currentFQPath),(function(){return r.__awaiter(n,void 0,void 0,(function(){return r.__generator(this,(function(e){return this.reduxStore.dispatch(g.deleteFiles({files:r.__spreadArrays(t),checkFSWs:!0})),[2]}))}))}))},this.purgeSuccessCallback=function(e){t.browseActions.reloadCurrentPath()},this.onPurgeBatch=function(t,o){new Promise((function(t,r){e(["modules/clean/react/trash/actions"],t,r)})).then(r.__importStar).then((function(e){(0,e.purgeByPathBatch)(t,o,n.purgeSuccessCallback)}))},this.doPermanentDeleteWithModal=function(e){var t=v.user(n.reduxStore.getState()),r=v.context(n.reduxStore.getState());_.showPurgeModal({userId:t.id,context:r,files:e,onPurge:n.onPurgeBatch})},this.onRestore=function(e,t,r){m.restoreFiles({files:t,userId:e,onSuccess:function(){c.notifyRestoreSuccess(t)},isSearchMode:r})},this.doRestoreFilesWithUnifiedTrashModal=function(e){var t=e.files,r=v.user(n.reduxStore.getState()),o=v.context(n.reduxStore.getState());_.showUnifiedTrashModal({userId:r.id,context:o,files:t,onRestore:function(e,t){n.onRestore(e,t,!1)}})},this.handleShowRewindPanel=function(){f.default.update_query_param(h.BrowseQueryArg.rewind,"true"),n.reduxStore.dispatch(g.showRewind())},this.fetchFolderSizes=function(e){var t=e.file;return r.__awaiter(n,void 0,Promise,(function(){var e,o,n,i,s,a,l,c;return r.__generator(this,(function(d){switch(d.label){case 0:e=v.user(this.reduxStore.getState()),o=h.MAX_FOLDER_SIZE_ITERATIONS,d.label=1;case 1:return d.trys.push([1,7,,8]),this.reduxStore.dispatch(g.requestFolderSizes({fqPath:t.fq_path})),[4,m.fetchSharedFolderSizes(e.id,{fq_path:t.fq_path})];case 2:return n=d.sent(),this.reduxStore.dispatch(g.setFolderSizesPending({fetchFolderSizesResp:n})),i=[],[4,this.fetchAndSetSameNamespaceFolderSize(e.id,{fq_path:t.fq_path,folder_limit:h.MAX_FOLDERS_PER_CALL})];case 3:(s=d.sent()).queue&&(i=r.__spreadArrays(i,s.queue)),d.label=4;case 4:return i.length>0&&o>0?(o--,a=Math.min(h.MAX_FOLDER_SIZE_QUEUE_SIZE,i.length),l=i.splice(0,a),[4,this.fetchAndSetSameNamespaceFolderSize(e.id,{fq_path:t.fq_path,folder_limit:h.MAX_FOLDERS_PER_CALL,queue:l})]):[3,6];case 5:return(s=d.sent()).queue&&i&&(i=r.__spreadArrays(i,s.queue)),[3,4];case 6:return c=0!==o&&s.queue&&0===s.queue.length?F.FetchFolderSizeState.COMPLETE:F.FetchFolderSizeState.ERROR,this.reduxStore.dispatch(g.completeFolderSizes({fetchFolderSizeState:c})),[3,8];case 7:return d.sent(),this.reduxStore.dispatch(g.setFolderSizesPending({fetchFolderSizesResp:{sizes_dict:[{fq_path:t.fq_path,size:0}],queue:[]}})),this.reduxStore.dispatch(g.completeFolderSizes({fetchFolderSizeState:F.FetchFolderSizeState.ERROR})),[3,8];case 8:return[2]}}))}))},this.fetchMultipleFolderSizes=function(e){var t=e.files;return r.__awaiter(n,void 0,Promise,(function(){var e,o,n;return r.__generator(this,(function(r){switch(r.label){case 0:e=0,o=t.toArray(),r.label=1;case 1:return e<o.length?(n=o[e],[4,this.fetchFolderSizes({file:n})]):[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))},this.handleShowShareModal=function(e,t){var r=v.user(n.reduxStore.getState()),o=v.context(n.reduxStore.getState());D.asyncShowShareModal(r,e,{browseContext:o,origin:t},n.setUrl)},this.reduxStore=E.getStoreForBrowse()}return x.prototype.reloadCurrentPath=function(){this.setUrl({path:v.path(this.reduxStore.getState()),qargs:{reload:!0}})},x.prototype.selectRowsFromBoltClient=function(e){void 0===e&&(e=[]),this.reduxStore.dispatch(g.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(e.map((function(e){return e.fq_path})))}))},x.prototype.copyFiles=function(e){T.copyFiles(e)},x.prototype.moveFiles=function(e){T.moveFiles(e)},x.prototype.selectFilesAfterUpload=function(e){var t=e.fqPathsToSelect,r=v.unsortedFilesWithFolderSizes(this.reduxStore.getState());t.every((function(e){return r.has(e)}))?this.reduxStore.dispatch(g.selectFilesByFqPath({fqPathsToSelect:t})):this.reduxStore.dispatch(g.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(t)}))},x.prototype.selectFilesByFqPath=function(e){var t=e.fqPathsToSelect;this.reduxStore.dispatch(g.selectFilesByFqPath({fqPathsToSelect:t}))},x.prototype.navigateToFileOrFolder=function(e){var t=this,r=e.file,o=e.shouldFocusComment,n=void 0!==o&&o,s=e.onFileViewerUnmount,a=e.fileViewAction,l=void 0===a?M.FileViewActionType.CLICK:a,c=e.fileViewOrigin,d=void 0===c?M.FileViewOriginType.BROWSE:c,p=e.preferredEditors,f=v.user(this.reduxStore.getState()),m=v.context(this.reduxStore.getState());if(r.isDeleted)this.doRestoreFilesWithUnifiedTrashModal({files:[r]});else{if("passwords_post_setup"===I.getLinkNodeAction(r.per_node_metadata))return void O.openPasswords();if(r.is_dir)r.type===u.FileTypes.VAULT_FOLDER?N.redirect(A.VAULT_URL):w.File.isNoAccessSharedFolder(r)?_.showNoAccess(f,r,m):this.setUrl({path:r.fq_path});else{var h=function(){t.openPreviewForBrowseFile(r,n,f,l,d,s)};!n&&p&&i.hasPreferredEditorSupport(r)?i.openInPreferredEditor(f,r,p,h,{fileViewAction:l,fileViewOrigin:d}):h()}}},x.prototype.openPreviewForBrowseFile=function(e,t,r,o,i,a){var l=this,c=S.getIndexOfFile(e,this.reduxStore.getState()),d=c<0?[e]:v.sortedFilesWithFolderSizes(this.reduxStore.getState()).toArray();if(c<0?c=0:d[c]=e,e.is_cloud_doc)n.openCloudDoc(e,r,o===M.FileViewActionType.SEARCH?s.WebSearchSource:s.WebBrowseSource);else{var u;y.asyncOpenPreview({containerId:h.BROWSE_FILE_VIEWER_ELEMENT_ID,files:d,indexOfPreviewFile:c,shouldFocusComment:t,user:r,onFileViewerDidMount:function(){u=document.querySelector(":focus"),y.hideElementsBehindFileViewer(),l.reduxStore.dispatch(g.setIsFileViewerShown({isShown:!0}))},onFileViewerUnmount:function(){y.showElementsBehindFileViewer(),l.reduxStore.dispatch(g.setIsFileViewerShown({isShown:!1})),a&&a(),u&&u.focus()},fileViewAction:o,fileViewOrigin:i,fileViewTarget:M.FileViewTargetType.PRIVATE})}},x.prototype.navigateToResultObjectParentFolder=function(e){var t=e.file,r=e.fileViewAction;void 0===r&&M.FileViewActionType.CLICK;if(w.File.isNoAccessSharedFolder(t))_.showNoAccess(v.user(this.reduxStore.getState()),t,v.context(this.reduxStore.getState()));else{var o=d.parent_dir(t.fq_path);this.setUrl({path:o})}},x.prototype.navigateToParentFolder=function(){var e=d.parent_dir(v.path(this.reduxStore.getState()));this.setUrl({path:e})},x.prototype.setShouldShowDeletedFiles=function(e){e.shouldShowDeletedFiles?f.default.update_query_param(h.BrowseQueryArg.d,"1"):f.default.remove_query_param(h.BrowseQueryArg.d)},x.prototype.downloadFiles=function(e){var t=e.files,o=e.context,n=e.user;return r.__awaiter(this,void 0,void 0,(function(){var e,i,s,l,c;return r.__generator(this,(function(r){switch(r.label){case 0:return 1!==t.count()||t.first().is_dir?[3,4]:(e=t.first())instanceof w.FileSharedWithMe?[4,C.fetchDownloadUrl(e.href)]:[3,2];case 1:return s=r.sent(),[3,3];case 2:s=e.href,r.label=3;case 3:return i=s,a.get({url:i}),[2];case 4:return o.blockHash?(l=o.currentFQPath,c=t.toArray().map((function(e){return e.fq_path})),a.get_zip({fq_paths:c,subject_uid:n.id,block_hash:o.blockHash,parent_path:l}),[2]):[2]}}))}))},x.prototype.fetchAndSetSameNamespaceFolderSize=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){var o;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,m.fetchSameNamespaceFolderSizes(e,t)];case 1:return o=r.sent(),this.reduxStore.dispatch(g.setFolderSizesPending({fetchFolderSizesResp:o})),[2,o]}}))}))},x})();t.browseActions=new x})),define("modules/clean/react/browse/api",["require","exports","tslib","modules/clean/ajax","modules/clean/csrf","modules/clean/react/file_uploader/constants","modules/clean/filepath","external/lodash","modules/core/i18n","modules/clean/react/browse/models","modules/clean/react/browse/crypto_subtle_digest","modules/core/html","modules/core/notify","modules/core/uri","modules/clean/api_v2/user_client"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_){"use strict";function m(e){try{return JSON.parse(e)}catch(e){if(!(e instanceof SyntaxError))throw e}return null}function h(e){return{isError:!1,result:e}}function g(e){return{isError:!0,error:e}}function S(e){return"locked_team"===e.error?i.UploadErrorType.LOCKED_TEAM_ERROR:i.UploadErrorType.OVER_QUOTA_ERROR}function v(e){return new Promise((function(t){var r=new FileReader;r.onloadend=function(e){if(!(null!==e&&e.target&&e.target.result instanceof ArrayBuffer))throw new Error;t(e.target.result)},r.readAsArrayBuffer(e)}))}function E(e){return r.__awaiter(this,void 0,Promise,(function(){var t,o,n,s,a;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,v(e)];case 1:return t=r.sent(),[3,3];case 2:return r.sent(),[2,g({type:i.UploadErrorType.FILE_READER_NULL_RESULT_ERROR})];case 3:return r.trys.push([3,5,,6]),[4,d.encryptArrayBuffer(t)];case 4:return o=r.sent(),n=btoa(String.fromCharCode.apply(null,new Uint8Array(o))),s=n.replace(/\//g,"_").replace(/\+/g,"-"),(a=(function(e){for(;e.endsWith("=");)e=e.slice(0,-1);return e})(s))?[2,h({hash:a})]:[2,g({type:i.UploadErrorType.CLIENT_HASH_EMPTY_ERROR})];case 5:return r.sent(),[2,g({type:i.UploadErrorType.CLIENT_HASH_DIGEST_ERROR})];case 6:return[2]}}))}))}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),s=r.__importStar(s),a=r.__importStar(a),t.loadPath=function(e){var t=e.sortLabel,r=e.sortIsAscending,n=e.path,i=e.userId,s=e.onSuccess,a=e.includeDeletedFiles,l=void 0!==a&&a,c=e.onError;return o.WebRequest({data:{sort_label:t,sort_is_ascending:r.toString(),show_deleted:l||"",sort_folders_first:!0,include_file_info:"True",path2:n},url:"/browse",subject_user:i,success:function(e,t,r){var o=m(e);o&&s({path:n,data:o,xhr:r})},error:function(e,t,r){c&&c(e,t,r)}})},t.loadPath2=function(e){var t=e.userId,r=e.path,o=e.sortType,n=e.sortIsAscending,i=e.includeDeleted;return(new _.UserApiV2Client).ns("files").rpc("browse",{fq_path:r,include_deleted:i,sort_type:o,sort_is_ascending:n,sort_folders_first:!0,include_xattrs:!0,include_folder_overview:!0},{subjectUserId:t})},t.loadPath2Continue=function(e,t){return(new _.UserApiV2Client).ns("files").rpc("browse_continue",{cursor:e},{subjectUserId:t})},t.copyFiles=function(e){var t=e.files,r=e.newPath,n=e.userId,i=e.onSuccess,s=e.checkFSWs,d=t.map((function(e){return e.fq_path}));return d.includes(r)?(p.Notify.error(l.intl.formatMessage({id:"wWiDtY",defaultMessage:"You can’t copy a folder into itself."})),null):o.WebProgressRequest({url:"/cmd/copy",data:{files:d,to_path:r,fsw_request:s?"check":void 0},subject_user:n,progress_text:l.intl.formatMessage({id:"AZPIG5",defaultMessage:"Copying files..."}),success:function(e){try{var t=a.isString(e)?JSON.parse(e):e,o=t.new_browse_files?t.new_browse_files.map(c.File.fromServerObject):[];i({newFiles:o,destinationPath:r,changesets:t.changesets,failureDetails:t.failure_details})}catch(e){}}})},t.isRewindButtonEnabled=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(r){2;try{return"/"===e&&(e=""),[2,(new _.UserApiV2Client).ns("chronicle").rpc("can_rewind",{path:e,version:2},{subjectUserId:t})]}catch(e){return[2,{can_rewind:!1}]}return[2]}))}))},t.moveFiles=function(e){var t=e.path,r=e.files,n=e.newPath,i=e.userId,d=e.onSuccess,f=e.allowOwnershipTransfer,_=e.checkFSWs;if(void 0!==t&&s.paths_are_equal(t,n))return p.Notify.error(l.intl.formatMessage({id:"V6/bVk",defaultMessage:"Those files already exist in that folder."})),null;var m=r.map((function(e){return e.fq_path}));return m.includes(n)?(p.Notify.error(l.intl.formatMessage({id:"blAaiJ",defaultMessage:"You can’t move a folder into itself."})),null):o.WebProgressRequest({url:"/cmd/move",data:{files:m,to_path:n,allow_ownership_transfer:f,fsw_request:_?"check":void 0},subject_user:i,progress_text:l.intl.formatMessage({id:"FdTkAn",defaultMessage:"Moving files..."}),skipNotifyError:!f,success:function(e){try{var r=a.isString(e)?JSON.parse(e):e,o=r.new_browse_files?r.new_browse_files.map(c.File.fromServerObject):[];d({path:t,destinationPath:n,newFiles:o,changesets:r.changesets,failureDetails:r.failure_details})}catch(e){}},error:function(t,r,o){p.Notify.error(new u.HTML(o)),e.onError&&e.onError(o)}})},t.restoreFiles=function(e){var t=e.files,r=e.userId,n=e.onSuccess,i=e.isSearchMode;return o.WebProgressRequest({url:"/cmd/restore",data:{files:t.map((function(e){return e.fq_path})),source:i?"search":"browse"},subject_user:r,dataType:"text",progress_text:l.intl.formatMessage({id:"kBkLSN",defaultMessage:"Restoring…"}),success:function(){n()}})},t.rollbackChangeSets=function(e){var t=e.userId,r=e.changesets,n=void 0===r?null:r,i=e.progressText,s=e.onSuccess;return o.WebProgressRequest({url:"/cmd/rollback",data:{ns_to_cs:JSON.stringify(n)},subject_user:t,progress_text:i,success:function(){s()}})},t.createNewFolder=function(e){var t=e.pathName,r=e.folderName,n=e.userId,i=e.onSuccess,s=e.onError,a=e.checkFSWs;return o.WebProgressRequest({url:new f.URI({path:"/cmd/new"+t}).toString(),data:{to_path:r,folder:"yes",fsw_request:a?"check":void 0},subject_user:n,success:function(e){var t=m(e);if(t){var r=t.new_browse_files?c.File.fromServerObject(t.new_browse_files[0]):null;i({changesets:t.changesets,createdFolder:r,failureDetails:t.failure_details})}},error:function(){s()}})},t.createCloudDoc=function(e){var t=e.pathName,r=e.title,n=e.documentType,i=e.userId,s=e.onSuccess,a=e.onError,l=e.checkFSWs,d=e.actionSource,u=(t+"/"+r+"."+n).replace("//","/");return o.WebRequest({url:new f.URI({path:"/cmd/create_cloud_doc"}).toString(),subject_user:i,data:{to_path:u,title:r,fsw_request:l?"check":void 0,action_source:d},success:function(e){var t=m(e);if(t){var r=t.new_browse_files?c.File.fromServerObject(t.new_browse_files[0]):null;s({changesets:null,createdFile:r,failureDetails:t.failure_details})}},error:function(e,t,r){a(r)},skipNotifyError:!0})},t.getChangesForDirectory=function(e){var t=e.path,r=e.userId,n=e.namespaceToJournalIdMap,i=e.onSuccess,s=e.includeDeletedFiles,l={fq_dir:"/"===t?"":t,ns_map:a.map(n,(function(e,t){return t+"_"+e})).join(","),show_deleted:!!s};return o.WebRequest({url:"/update/list_dir",subject_user:r,data:l,dataType:"text",success:function(e){var t=m(e);t&&i(t)}})},t.fetchSharedFolderSizes=function(e,t){return(new _.UserApiV2Client).ns("folders").rpc("get_shared_subfolder_sizes",t,{subjectUserId:e})},t.fetchSameNamespaceFolderSizes=function(e,t){return(new _.UserApiV2Client).ns("folders").rpc("get_subfolder_sizes_in_same_namespace",t,{subjectUserId:e})},t.commitBlocks=function(e,t,r,o,s){return new Promise((function(a,l){try{var c=new f.URI({scheme:"https",authority:"www.dropbox.com",path:"/commit_web_upload_by_token",query:{_subject_uid:e.toString(),dest:t,name:r,overwrite:"1",reported_total_size:o.toString(),t:n.readCsrfToken()||""}}),d=new XMLHttpRequest;d.withCredentials=!0;return d.onreadystatechange=function(){d.readyState===XMLHttpRequest.DONE&&(200===d.status?"complete"===JSON.parse(d.responseText).status?a(h({})):a(g({type:i.UploadErrorType.HTTP_ERROR})):a(g({type:507===d.status?S(d):0===d.status?i.UploadErrorType.CONNECTION_ERROR:i.UploadErrorType.COMMIT_HTTP_ERROR})))},d.open("POST",c.toString(),!0),d.setRequestHeader("Content-Type","application/octet-stream"),d.send(JSON.stringify(s)),d}catch(e){return void a(g({type:i.UploadErrorType.HTTP_ERROR}))}}))},t.uploadBlock=function(e,t,o,s,a){return new Promise((function(l){return r.__awaiter(void 0,void 0,void 0,(function(){var c,u,p,_,m;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),d.windowHasCryptoSubtleDigest()?[4,E(s)]:[3,2];case 1:if((u=r.sent()).isError)return[2,l(u)];c=u.result.hash,r.label=2;case 2:return p=new f.URI({scheme:"https",authority:"dl-web.dropbox.com",path:"/put_block_returning_token",query:{owner_id:e.toString(),_subject_uid:e.toString(),t:n.readCsrfToken()||"",reported_block_size:s.size.toString(),num_blocks:Math.ceil(o/s.size).toString(),ns_id_for_routing:t.toString()}}),(_=new XMLHttpRequest).withCredentials=!0,m=function(){return{type:507===_.status?S(_):0===_.status?i.UploadErrorType.CONNECTION_ERROR:i.UploadErrorType.UPLOAD_BLOCK_ERROR}},_.onreadystatechange=function(){if(_.readyState===XMLHttpRequest.DONE){if(200!==_.status)return l(g({type:i.UploadErrorType.HTTP_ERROR}));var e=JSON.parse(_.responseText);return e.token?d.windowHasCryptoSubtleDigest()&&e.block_hash!==c?l(g({type:i.UploadErrorType.HASHES_NOT_EQUAL_ERROR})):void l(h({token:e.token})):l(g({type:i.UploadErrorType.HTTP_ERROR}))}},_.onerror=function(){l(g(m()))},_.upload&&(_.upload.onprogress=a),_.onload=function(){_.status>=400&&l(g(m()))},_.open("POST",p.toString(),!0),_.setRequestHeader("Content-Type","application/octet-stream"),_.send(s),[2,_];case 3:return r.sent(),l(g({type:i.UploadErrorType.HTTP_ERROR})),[2];case 4:return[2]}}))}))}))}})),define("modules/clean/react/browse/app_action_util",["require","exports"],(function(e,t){"use strict";function r(e){return"function"==typeof e?e:{displayName:e.label,popoverMenuName:e.popoverLabel,iconName:e.iconName,handleClick:e.performAction,disabled:e.disabled,className:e.className,badge:e.badge,ariaLabel:e.ariaLabel,ariaPressed:e.ariaPressed,key:e.key}}Object.defineProperty(t,"__esModule",{value:!0}),t.browseAppActionToPrimaryMenuItem=function(e){if("function"==typeof e)return e;var t=void 0;return e.subItems&&(t=e.subItems.map(r)),{displayName:e.label,iconName:e.iconName,handleClick:e.performAction,disabled:e.disabled,className:e.className,subItems:t,ariaLabel:e.ariaLabel,ariaPressed:e.ariaPressed,key:e.key}},t.browseAppActionToSecondaryMenuItem=r})),define("modules/clean/react/browse/async_extensions",["require","exports","tslib","modules/clean/web_timing_logger","modules/clean/redux/store"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function t(){var e=this;this.initOnce=!1,this.emptyState={},this.sharingServiceInfo=function(){return e.emptyState},this.getFeatureFlags=function(){return e.emptyState},this.initializeStore=function(t,r){return e.files=r,e.user=t,n.getStoreAndRegisterReducers({})}}return t.prototype.init=function(){var e=this;this.initOnce||(o.waitForTTI().then((function(){return e.loadExtensionsStore()})),this.initOnce=!0)},t.prototype.loadExtensionsStore=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,o,n,i,s,a,l;return r.__generator(this,(function(c){switch(c.label){case 0:return[4,Promise.all([new Promise((function(t,r){e(["modules/clean/react/extensions/data/store"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/extensions/data/selectors"],t,r)})).then(r.__importStar)])];case 1:return t=c.sent(),o=t[0],n=o.getStore,i=o.initializeStore,s=t[1],a=s.sharingServiceInfo,l=s.getFeatureFlags,n(),this.sharingServiceInfo=a,this.getFeatureFlags=l,this.initializeStore=i,this.user&&this.initializeStore(this.user,this.files),[2]}}))}))},t})();t.asyncExtensions=new i})),define("modules/clean/react/browse/browse_prefetch_loader",["require","exports","tslib","modules/core/exception","modules/clean/react/files_view/types","modules/clean/react/browse/models","modules/clean/pagination_manager","modules/core/notify","modules/clean/web_timing_logger","modules/clean/react/browse/api"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";function d(e){if(0===e.indexOf("err:")){var t=e.substr("err:".length);a.Notify.error(t)}}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),l=r.__importStar(l),c=r.__importStar(c),t.apiV2FetchNextFn=function(e,t,r){return c.loadPath2Continue(e,r).then((function(e){for(var r=new Array,n=0,i=e.paginated_file_info;n<i.length;n++){var s=i[n];o.assert(void 0!==s.file_info,"file_info is undefined");var a=s.file_info;a.fq_path=t+a.fq_path,r.push(a)}return{next_request_voucher:e.next_request_voucher||null,has_more_items:e.has_more||!1,items:r}}))};var u=function(e,r,a,c){var u=this,p=e.user,f=e.path,_=e.fqPathsToSelect,m=e.useApiv2NextPage,h=r.onPrefetchComplete,g=r.onPrefetchError,S=r.onLoadComplete,v=r.onPostTTIPrefetchComplete,E=r.onPostTTIPrefetchError,w=a.onInitializeEverything,b=a.onAddFilesAndSetLoadingState;void 0===c&&(c=window),this.isPrefetching=function(){return!!u.browsePreloadHandler&&!!u.firstPagePreloadHandler},this.handlePrefetch=function(){o.assert(u.isPrefetching(),"trying to handle prefetching and think we aren't prefetching at the same time.  something is wrong"),u.browsePreloadHandler(u.handlePrefetchDataSuccess,u.onPrefetchError),l.waitForTTI().then((function(){u.postTTIPreloadHandler(u.handlePostTTIDataSuccess,u.onPostTTIPrefetchError)}))},this.handlePostTTIDataSuccess=function(e){var t=void 0;try{t=JSON.parse(e)}catch(e){return void u.onPostTTIPrefetchError(e)}t?u.onPostTTIPrefetchComplete(t):u.onPostTTIPrefetchError()},this.handlePrefetchDataSuccess=function(e){var t=u.extractAjaxInitData(e);if(t){var r=i.BrowseContext.fromServerObject(t);u.firstPagePreloadHandler((function(e){u.handleFirstPagePrefetchDataSuccess(e,t,r)}),u.onPrefetchError)}else u.onPrefetchError()},this.handleFirstPagePrefetchDataSuccess=function(e,t,r){var o=u.extractAjaxFileInfo(e);if(o){var s=[],a=0,l=n.LoadingState.LOADING_FIRST_PAGE,c=o.file_info,d=o.first_page;d?(s=[],a=d.total_num_items,l=n.LoadingState.LOADING_REMAINING_PAGES):c&&(a=(s=c).length,l=n.LoadingState.LOADED),u.onInitializeEverything({path:u.path,files:s.map(i.File.fromServerObject),paginatedTotalNumFiles:a,context:r,mountPoints:t.ns_id_to_mount_point,fqPathsToSelect:u.fqPathsToSelect,loadingState:l,teamFolders:t.team_folders_js_info&&t.team_folders_js_info.map(i.File.fromServerObject)}),d?u.initializePaginationManager(d):u.onLoadComplete(),u.onPrefetchComplete(t)}else u.onPrefetchError()},this.extractAjaxInitData=function(e){var t=void 0;try{t=JSON.parse(e)}catch(t){d(e)}return t},this.extractAjaxFileInfo=function(e){var t=void 0;try{t=JSON.parse(e)}catch(t){d(e)}return t},this.initializePaginationManager=function(e){var r=e.total_num_items,o=s.PaginationManager.create({firstPage:{items:e.items,has_more_items:e.has_more_items,next_request_voucher:e.next_request_voucher},keyName:"sjid",ajaxURL:"/browse_get_next",userID:u.user.id,newDataAvailableCallback:function(e,t){var o=e.areAllItemsReady(),s=o?n.LoadingState.LOADED:n.LoadingState.LOADING_REMAINING_PAGES;u.onAddFilesAndSetLoadingState({path:u.path,files:t.map((function(e){return"object"==typeof e.type?i.File.fromApiV2Object(e):i.File.fromServerObject(e)})),paginatedTotalNumFiles:r,loadingState:s}),o&&(e.stopAutoFetching(),u.onLoadComplete())},fetchNextFn:u.useApiv2NextPage?t.apiV2FetchNextFn:void 0});l.waitForTTI().then((function(){return o.startAutoFetching()}))},this.user=p,this.path=f,this.fqPathsToSelect=_,this.onPrefetchComplete=h,this.onPrefetchError=g,this.onLoadComplete=S,this.onPostTTIPrefetchComplete=v,this.onPostTTIPrefetchError=E,this.onInitializeEverything=w,this.onAddFilesAndSetLoadingState=b,this.browsePreloadHandler=c.__REGISTER_BROWSE_PRELOAD_HANDLER,this.firstPagePreloadHandler=c.__REGISTER_BROWSE_FIRST_PAGE_PRELOAD_HANDLER,this.postTTIPreloadHandler=c.__REGISTER_BROWSE_POST_TTI_PRELOAD_HANDLER,this.useApiv2NextPage=m};t.BrowsePrefetchLoader=u})),define("modules/clean/react/browse/browse_upload_provider",["require","exports","tslib","react","react-redux","modules/clean/filepath","modules/clean/react/browse/api","modules/clean/react/browse/data/selectors","modules/clean/react/file_uploader/actions_adapter","modules/clean/react/file_uploader/processors","modules/clean/react/file_uploader/utils","modules/clean/react/upload_kit/uploader/context","modules/clean/viewer","modules/core/exception"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f){"use strict";function _(e,t){var r=i.normalize(e),o=i.parent_dir(t);return""===r?"/"===o?"/":"/"+o:"/"===o?r:r+"/"+o}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),i=r.__importStar(i),s=r.__importStar(s),a=r.__importStar(a),d=r.__importStar(d),f=r.__importStar(f),t.getDestinationDir=_;var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onBeforeUpload=function(e){return new Promise((function(t){l.ActionsAdapter.emit("beforeUpload",{uploadItems:e,beforeUploadComplete:function(e){var r=e.items;t(r)}})}))},t.onChoose=function(e){return r.__awaiter(t,void 0,Promise,(function(){var t=this;return r.__generator(this,(function(r){return[2,e.map((function(e){return[e,{parentPath:t.props.context.currentFQPath}]}))]}))}))},t.onChooseDropboxFile=function(e){return r.__awaiter(t,void 0,Promise,(function(){var t=this;return r.__generator(this,(function(r){return[2,e.map((function(e){return[e,{parentPath:t.props.context.currentFQPath}]}))]}))}))},t.processFiles=function(e,o,n){return r.__awaiter(t,void 0,void 0,(function(){var t,n;return r.__generator(this,(function(r){switch(r.label){case 0:return t=p.Viewer.get_viewer().get_user_by_id(this.props.userId),o.forEach((function(e){var r=e.item,o=e.error;l.ActionsAdapter.emit("error",{user:t,uploadItem:r,errorType:l.convertValidationError(o),loggingOnly:!0})})),[4,c.processFiles(e,o)];case 1:return n=r.sent(),l.ActionsAdapter.emit("filesAdded",{uploadItems:n}),[4,this.onBeforeUpload(n)];case 2:return[2,{items:n=r.sent(),errors:o}]}}))}))},t.nsIdForRouting=function(e){var r=p.Viewer.get_viewer().get_user_by_id(t.props.userId),o=""===t.props.context.currentFQPath,n=_(e.parentPath||"",e.destPath);return o?r.root_ns_id:(f.assert(null!=t.props.mountPoints,"mountPoints is null"),f.assert(null!=t.props.rootNSID,"rootNSID is null"),d.getNsId(t.props.mountPoints,t.props.rootNSID,n))},t.uploadBlock=function(e,o,n){return r.__awaiter(t,void 0,void 0,(function(){var t,i,a;return r.__generator(this,(function(r){switch(r.label){case 0:return t=p.Viewer.get_viewer().get_user_by_id(this.props.userId),i=function(t){n&&n(t.loaded),l.ActionsAdapter.emit("uploadProgress",{uploadItem:e})},[4,s.uploadBlock(t.id,this.nsIdForRouting(e),e.bytes,o,i)];case 1:if((a=r.sent()).isError)throw l.ActionsAdapter.emit("error",{uploadItem:e,errorType:a.error.type,user:t}),new Error;return[2,a.result.token]}}))}))},t.commitBlocksBatch=function(e){var o=p.Viewer.get_viewer().get_user_by_id(t.props.userId);return Promise.all(e.map((function(e){var n=e.info,a=e.tokens;return r.__awaiter(t,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.commitBlocks(o.id,_(n.parentPath||"",n.destPath),i.filename(n.destPath),n.bytes,a)];case 1:return(e=t.sent()).isError?l.ActionsAdapter.emit("error",{uploadItem:n,errorType:e.error.type,user:o}):l.ActionsAdapter.emit("fileUploaded",{uploadItem:n}),[2]}}))}))})))},t}return r.__extends(t,e),t.prototype.render=function(){return o.default.createElement(u.UploadProvider,{userId:this.props.userId,selectMultiple:!0,onChoose:this.onChoose,onChooseDropboxFile:this.onChooseDropboxFile,processFiles:this.processFiles,commitBlocksBatch:this.commitBlocksBatch,uploadBlock:this.uploadBlock,maxFileSize:524288e5},this.props.children)},t})(o.default.Component);t.UnconnectedBrowseUploadProvider=m,t.BrowseUploadProvider=n.connect((function(e){return{context:a.context(e)}}))(m)})),define("modules/clean/react/browse/browse_view",["require","exports","tslib","classnames","immutable","react","dig-components/icons/src","modules/clean/browse_uri_interface","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/new_file_menu","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/async/loadable","modules/clean/react/browse/action_logger","modules/clean/react/browse/app_action_util","modules/clean/react/browse/components/consolidated_upload_button","modules/clean/react/browse/components/first_task_create_folder_button","modules/clean/react/browse/components/import_painted_door_button","modules/clean/react/browse/constants","modules/clean/react/browse/global_actions","modules/clean/react/browse/logger_util","modules/clean/react/browse/sidebar_view","modules/clean/react/browse/title","modules/clean/react/browse/uri_helper","modules/clean/react/browse/web_team_sharing_experiment","modules/clean/react/education/education_module_experiment","modules/clean/react/file_uploader/file_uploader","modules/clean/react/files_view/constants","modules/clean/react/files_view/controller","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/folder_overview/controller","modules/clean/react/folder_subscriptions/follow/async_folder_unfollower","modules/clean/react/growth/personalization/team_space_empty_zone/team_space_empty_zone","modules/clean/react/growth/personalization/util","modules/clean/react/maestro/layout/search","modules/clean/react/plusplus/loadables","modules/clean/react/retrieval_success_banner/constants","modules/clean/react/retrieval_success_banner/retrieval_success_browseview_banner","modules/clean/react/retrieval_success_banner/util","modules/clean/react/snackbar","modules/clean/react/snackbar_manager","modules/clean/react/vault/vault_browse_root_async","modules/clean/search/types","modules/clean/sharing/access_level","modules/clean/upsell/top_notification_listener","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/core/browser","modules/core/browser_detection","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S,v,E,w,b,y,T,F,I,O,C,P,A,D,R,M,N,L,x,k,U,V,B,H,W,q,j,G,z,K,Y,Q,X,J){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n),i=r.__importDefault(i),d=r.__importStar(d),f=r.__importStar(f),E=r.__importStar(E),Q=r.__importStar(Q),X=r.__importStar(X);var Z=[j.NameSpaceAccess.ACCESS_NO_ACCESS,j.NameSpaceAccess.ACCESS_READER,j.NameSpaceAccess.ACCESS_READER_NO_COMMENT];function $(e){var t=e.selectedFiles,r=e.context,o=e.isDraggingInternalFiles,n=e.isDraggingExternalFiles,i=e.isUploadModalOpen;return r.isInsideSharedFolder&&Z.includes(r.currentSharedFolderPermissionRole)?P.DropTargetHighlightMode.NONE:o?t.some((function(e){return e.isDeleted||e.type===u.FileTypes.TEAM_SHARED_FOLDER}))?P.DropTargetHighlightMode.NONE:t.some((function(e){return e.type===u.FileTypes.SHARED_FOLDER}))?r.currentNSAllowsNesting?P.DropTargetHighlightMode.NONSELECTED_FOLDERS:P.DropTargetHighlightMode.NONSELECTED_NONSHARED_FOLDERS:P.DropTargetHighlightMode.NONSELECTED_FOLDERS:n&&!i?P.DropTargetHighlightMode.ALL_FOLDERS:P.DropTargetHighlightMode.NONE}function ee(){var e=document.querySelector("#embedded-app");return e?e.parentElement:null}t.getCurrentDropTargetHighlightMode=$;var te=(function(p){function j(e){var y=p.call(this,e)||this;return y.scrollContainer=i.default.createRef(),y.snackbarManager=i.default.createRef(),y.vaultContentSlot=i.default.createRef(),y.vaultHeaderSlot=i.default.createRef(),y.vaultLockButtonSlot=i.default.createRef(),y.handleGetOverflowMenuActions=function(e,t,r){var o=y.handleGetFileActionsForSetOfFiles(n.Set([e]),t,r,!1,!1),i=new Array;return o.forEach((function(e){"function"!=typeof e&&i.push(e)})),[i]},y.handleGetFileActionsForSetOfFiles=function(e,t,r,o,n,i){var s=y.props,a=s.context,l=s.user,c=s.actionHandlers,d=s.isOverFreeQuota,u=s.hasExcludedNsIds,p=s.isQueryingFolderSizes,f=s.browsePostTTIExperiments,_=s.viewType,m=s.extensionsFeatureFlags,h=s.sharingServiceInfo,g=s.pinnedItems,S=y.state.fileActionsModule;if(!S)return[];var v=f.showAddToTransfer,E=f.showAddFolderToTransfer,w=f.expListSubfoldersWithOdyssey,b=f.expShowFileLocking,T=f.expVaultEnableViewOnlySharing,F=y.props.browseExperiments,I=F.searchSuccessQualitativeMetric,O=F.browseSuccessQualitativeMetric,C=F.folderHistoryRollbacks;return S.getActionsForFileCollection({files:e,context:a,user:l,viewType:_,sharingServiceInfo:h,extensionsFeatureFlags:m,canDisplayFolderSizes:t,actionHandlers:c,skipSharing:!1,isSearchMode:!1,isOverFreeQuota:d,hasExcludedNsIds:u,isQueryingFolderSizes:p,canShowUJPopup:o,isSidebar:n,responsive:r,showAddToTransfer:!!v,showAddFolderToTransfer:!!E,useSearchSuccessBanner:!!I,expBrowseSuccessBanner:O,pinnedItems:g,expFolderHistoryRollbacks:C,expListSubfoldersWithOdyssey:!!w,expShowFileLocking:b,forceSplitShareSecondary:!0,scrollableSidebarRef:i,expVaultEnableViewOnlySharing:T})},y.handleLocationLinkClick=function(e,t){if(!t){var r=d.parent_dir(e.fq_path);y.props.onNavigateToPath(r)}},y.handleOpenPaper=function(e){Q.redirect(e.url)},y.handleUploadButtonClick=function(e){I.FileUploaderController.setPath(y.props.path),I.FileUploaderController.handleUploadButtonClick(e)},y.handleShowFileUploader=function(){I.FileUploaderController.setPath(y.props.path),I.FileUploaderController.showModal()},y.handleSelectionChange=function(e,t){y.props.onSelectionChange({selection:e,actionSource:t})},y.handleFileListSortChange=function(e,t){f.logSortRecords({uid:y.props.user.id,sort_by:e,sort_direction:t,view_type:y.props.viewType}),y.props.onSortFiles({sortField:e,sortDirection:t})},y.handleStarClick=function(e,t){var r=t?Y.WebUserActionLogEvent.STAR:Y.WebUserActionLogEvent.REMOVE_STAR,o=y.props,n=o.user,i=o.viewType,s=o.selectedFiles,a=o.browseExperiments,l=E.countFilesAndFolders(s),c=l.num_files_selected,d=l.num_folders_selected;f.logBrowseAction({uid:n.id,source:"BROWSE",action:r,num_files_selected:c,num_folders_selected:d,view_type:i,result:e});var u=a.searchSuccessQualitativeMetric,p=a.browseSuccessQualitativeMetric;y.showRetrievalSuccessBanner(!!u,!1,p,Y.WebUserActionLogEvent.STAR)},y.handleFocusSearchBar=function(){document.getElementsByClassName("search__input")[0].focus()},y.renderSharedWithController=function(e,t){var r=y.props,o=r.context,n=r.user,s=y.state.sharedWithModule;if(!s)return null;if(e.type===u.FileTypes.TEAM_SHARED_FOLDER&&("archived"===e.team_folder_status||"archive_in_progress"===e.team_folder_status))return null;var a=!!y.props.selectedFiles.size,l=s.SharedWithController;return i.default.createElement("div",{className:"brws-vertically-center brws-shared-with-wrapper"},i.default.createElement(l,{file:e,browseContext:o,inSelectMode:a,user:n,tabIndex:t}))},y.handleFixedHeaderHeightChange=function(e){var t=y.props.isSmbFirstTask?38:0;y.setState({fixedHeaderHeight:(e||0)+t})},y.showRetrievalSuccessBanner=function(e,t,r,o){e&&t?V.setSearchSuccessBannerVisible():r!==q.BrowseSuccessBannerVariants.V2||t||V.setBrowseSuccessBannerVisible(o)},y.handleSidebarContextMenuClick=function(){var e=y.props,t=e.selectedFiles,r=e.user,o=e.viewType,n=t?t.count((function(e){return e.is_dir})):0,i=t?t.count()-n:0;f.logContextMenuClick({uid:r.id,viewType:o,action_surface:Y.ActionSurfaceLogValue.RIGHT_SIDEBAR,numFilesSelected:i,numFoldersSelected:n})},y.onFolderOverviewNavigateToFileOrFolder=function(e){return y.props.onNavigateToFileOrFolder(e,{actionSource:P.FilesViewActionSource.FOLDER_OVERVIEW})},y.onContainerClick=function(e){A.shouldClickDeselect(e)&&y.props.onClearSelection({actionSource:Y.ActionSourceValue.WHITESPACE})},y.renderFixedHeader=function(e){var r=y.props,o=r.totalNumItems,n=r.browseExperiments,s=r.browsePostTTIExperiments,a=r.context,d=r.memberInfo,u=r.needsPairingToken,p=r.hasLinkedMobile,f=s.expEnableCloudDocsPaperCreate,E=s.expEnableCloudDocsBinderCreate,w=s.expEnableCloudDocsGddCreate,b=s.expEnableDropboxFormsCreate,T=s.expImportPaintedDoor,F=s.expTeamInviteLinkEnable,I=s.expMobileAppLinks,O=n.growthActSmbCreateConsolidation,C="V1"===O||"V2"===O,A=v.getUploadActions(y.props.context.isCurrentPathWriteable(),y.handleUploadButtonClick).map(_.browseAppActionToSecondaryMenuItem),R=null;return y.shouldShowMobileWebInvitesButton(e)&&(R=i.default.createElement(oe,{memberInfo:d,isInviteLinkEnabled:!!F})),[R,i.default.createElement(D.FolderOverview,{componentNamespace:S.BrowseFolderOverviewComponentNamespace,key:y.props.context.currentFQPath,path:y.props.context.currentFQPath,expFolderOverview:n.browseWebFolderOverview||"OFF",onNavigateToFileOrFolder:y.onFolderOverviewNavigateToFileOrFolder,isReadOnly:!y.props.context.isCurrentPathWriteable(),browseLoadingState:y.props.loadingState,onChangeHeight:y.handleFixedHeaderHeightChange,canShareFolder:!y.props.context.isCurrentlyInRoot&&y.props.context.canViewContainingNSMembers,shouldHideFolderOverview:y.shouldHideFolderOverview()}),!a.isInsideVaultFolder&&[P.LoadingState.LOADED,P.LoadingState.LOAD_ERROR].includes(y.props.loadingState)?i.default.createElement("div",{className:"create-button-container sapphire-button"},i.default.createElement(c.NewFileMenu,{key:"new-file-menu",user:y.props.user,source:l.NewFileMenuFromType.BROWSE,disabled:!y.props.context.isCurrentPathWriteable(),path:y.props.path,showGdd:!!w,showPaper:!!f,showBinder:!!E,showDropboxForms:!!b,selection_mode:y.props.selectedFiles.count()>0?"selected":"unselected",empty_folder:y.props.emptyFolder,forceLongLabel:!0,consolidateCreate:C,newFolderActions:v.getConsolidatedFolderActions(y.props.user,y.props.viewType,y.props.context,n.goldenGateRaclsEnabled,y.props.autoTeamGroupId),enableSecondary:y.enableSecondaryForNewFileMenu(),enableShortcutExtensionFeedback:s.expEnableShortcutExtensionFeedback}),y.shouldShowFirstTaskCreateFolderButton()&&i.default.createElement(h.FirstTaskCreateFolderButton,{createFolderAction:v.getCreateFolderAction(y.props.user,y.props.viewType,y.props.context,y.props.browseExperiments.goldenGateRaclsEnabled,y.props.autoTeamGroupId)}),"V2"===O&&i.default.createElement(m.ConsolidatedUploadButton,{uploadActions:A,className:"browse-consolidated-upload",attachment:"left",userId:y.props.user.id}),T&&i.default.createElement(g.ImportPaintedDoorButton,{userId:y.props.user.id}),I?i.default.createElement(t.AsyncOpenInMenu,{browseContext:a,needsPairingToken:u,totalNumItems:o,hasLinkedMobile:!!p,growthActSmbMpIteration:s.growthActSmbMpIteration}):y.shouldShowDesktopCta()&&i.default.createElement(t.AsyncOpenInDesktop,{needsPairingToken:u,totalNumItems:o,textType:N.getDesktopCtaType(y.state.initialTotalNumItems,y.getPersonalizedConfigs()),growthActSmbMpIteration:s.growthActSmbMpIteration})):null]},y.shouldShowMobileWebInvitesButton=function(e){return y.props.browsePostTTIExperiments.expMobileWebInvites&&!e.isMatchedLarge&&y.isInTeamSpaceRoot()},y.shouldShowMobileWebUploadButton=function(e){return y.props.browsePostTTIExperiments.expMobileWebInvites&&!e.isMatchedLarge},y.isInTeamSpaceRoot=function(){return y.props.context.isInsideMyTeamFolderTree&&y.props.context.isCurrentlyInRoot},y.isInitialEmptyAtTeamSpaceRoot=function(){return y.isInTeamSpaceRoot()&&1===y.state.initialTotalNumItems},y.getPersonalizedConfigs=function(){return y.props.browsePostTTIExperiments.expPersonalizedFirstPaths},y.enableExpPersonalization=function(){return!!y.getPersonalizedConfigs()},y.shouldHideRightsideActions=function(){return!!y.enableExpPersonalization()&&(y.isInitialEmptyAtTeamSpaceRoot()&&y.props.memberInfo.users.length<=1&&N.enableHideRightsideActions(y.getPersonalizedConfigs()))},y.shouldHideFolderOverview=function(){return!(!y.props.context.isInsideVaultFolder&&!y.state.initialHideState)||(y.enableExpPersonalization()?y.isInTeamSpaceRoot()&&N.enableHideFolderOverview(y.state.initialTotalNumItems,y.getPersonalizedConfigs()):y.isFirstTaskEmptyState())},y.shouldHideSideBarCtas=function(){return!!y.state.initialHideState||!y.enableExpPersonalization()&&y.isFirstTaskEmptyState()},y.shouldHideSelectionPreviewPane=function(){return!!y.state.initialHideState||(y.enableExpPersonalization()?y.isInitialEmptyAtTeamSpaceRoot()&&y.props.memberInfo.users.length<=1&&N.enableHideRightsideActions(y.getPersonalizedConfigs()):y.isFirstTaskEmptyState())},y.shouldShowDesktopCta=function(){return y.enableExpPersonalization()?!y.isInTeamSpaceRoot()||N.enableDesktopCta(y.props.memberInfo.users.length,y.state.initialTotalNumItems,y.getPersonalizedConfigs()):y.props.isSmbFirstTask},y.enableSecondaryForNewFileMenu=function(){return y.isInviteMode()||y.isDownloadAppMode()},y.isInviteMode=function(){return N.enableInvitePanel(y.getPersonalizedConfigs())&&y.props.memberInfo.users.length<=1},y.isDownloadAppMode=function(){var e=y.state.initialTotalNumItems;return N.enableDownloadAppPanel(e,y.getPersonalizedConfigs())},y.showTeamSpaceEmptyZone=function(){return!y.props.browsePostTTIExperiments.expMobileWebInvites&&(y.enableExpPersonalization()||!!y.props.browsePostTTIExperiments.expFirstTaskDropZone)&&y.isInTeamSpaceRoot()&&y.props.loadingState!==P.LoadingState.LOADING_FIRST_PAGE},y.renderTeamSpaceEmptyZone=function(){return y.showTeamSpaceEmptyZone()?i.default.createElement(M.TeamSpaceEmptyZone,{numItems:y.props.totalNumItems,numInitialItems:y.state.initialTotalNumItems,numMembers:y.props.memberInfo.users.length,dropTargetProps:y.getDropTargetProps(),suggestedFoldersContext:y.getSuggestedFoldersContext(),personalizedConfigs:y.getPersonalizedConfigs()}):null},y.shouldShowEmptyStateDropTarget=function(){return y.isInTeamSpaceRoot()&&1===y.props.totalNumItems||y.isFirstTaskEmptyState()},y.shouldShowFirstTaskCreateFolderButton=function(){return!y.enableExpPersonalization()&&y.isFirstTaskEmptyState()},y.handleUpdateDropTarget=function(e){y.isFirstTaskEmptyState()&&y.setState({currentDropTarget:e})},y.isFirstTaskEmptyState=function(){return!!y.props.browsePostTTIExperiments.expFirstTaskDropZone&&y.isInTeamSpaceRoot()&&1===y.props.totalNumItems},y.getDropTargetProps=function(){var e=[],t=J.intl.formatMessage({id:"SHYorf",defaultMessage:"Upload files to the team space"});return e.push({iconName:"upload-file",iconSrc:s.UploadFileLine,displayName:J.intl.formatMessage({id:"Qayhb5",defaultMessage:"Upload files"}),handleClick:function(){return y.handleUploadButtonClick(!1)}}),X.is_input_webkitdirectory_supported()&&(t=J.intl.formatMessage({id:"ZmstxO",defaultMessage:"Add files and folders to the team space"}),e.push({iconName:"upload-folder",iconSrc:s.UploadFolderLine,displayName:J.intl.formatMessage({id:"53oUlv",defaultMessage:"Upload folder"}),handleClick:function(){return y.handleUploadButtonClick(!0)}})),{popoverOptions:e,ariaLabel:t,isDropTargetRoot:!y.state.currentDropTarget,isDraggingFiles:y.props.isDraggingExternalFiles||y.props.isDraggingInternalFiles,isLoading:y.props.loadingState===P.LoadingState.LOADING_FIRST_PAGE}},y.shouldShowVaultEmptyState=function(){return y.props.context.isInsideVaultFolder&&null!=y.props.context.currentNSPath&&d.paths_are_equal(y.props.context.currentNSPath,"")&&0===y.props.totalNumItems},y.shouldShowFilesView=function(){return!y.state.hideFilesAndSidebar&&!y.shouldShowVaultEmptyState()},y.setHideFilesAndSidebar=function(e){y.setState({hideFilesAndSidebar:e})},y.renderFilesViewController=function(e){if(y.props.loadingState===P.LoadingState.LOAD_ERROR)return i.default.createElement(i.default.Suspense,{fallback:i.default.createElement("div",null,J.intl.formatMessage({id:"zD5i93",defaultMessage:"Something went wrong on our end."}))},i.default.createElement(re,null));var t=y.props,n=t.shouldShowPinnedTeamFolders,s=t.preSetupPlusFeatures,l=n?y.props.filesWithoutTeamFolders:y.props.files,c=$({context:y.props.context,selectedFiles:y.props.selectedFiles,isDraggingExternalFiles:y.props.isDraggingExternalFiles,isDraggingInternalFiles:y.props.isDraggingInternalFiles,isUploadModalOpen:y.props.isUploadModalOpen}),d=o.default("maestro-browse-app-content","maestro-content-scroll",{"maestro-content-scroll_scroll-disabled":y.props.loadingState===P.LoadingState.LOADING_FIRST_PAGE,"maestro-browse-app-content--empty-state":y.shouldShowEmptyStateDropTarget()}),u=null;if(y.shouldShowMobileWebUploadButton(e)){var p=v.getUploadActions(y.props.context.isCurrentPathWriteable(),y.handleUploadButtonClick);p.length>0&&(u=i.default.createElement(ne,{onClick:p[0].performAction}))}return i.default.createElement("div",{className:d,ref:y.scrollContainer,onClick:y.onContainerClick},i.default.createElement(U.RetrievalSuccessBrowseviewBanner,{user:y.props.user,displayContext:k.SearchSuccessDisplayContext.IN_EMBEDDED_APP,expSearchSuccessBanner:!!y.props.browseExperiments.searchSuccessQualitativeMetric,isFilePreview:V.isFilePreview(),isSearchMode:!1}),i.default.createElement(T.WebTeamSharingModalExperiment,{context:y.props.context,user:y.props.user,path:y.props.path,selectedFiles:y.props.selectedFiles,browsePostTTIExperiments:y.props.browsePostTTIExperiments}),y.renderFixedHeader(e),y.props.browsePostTTIExperiments.expCXEducationModule&&i.default.createElement(F.CXEducationModuleExperiment,{user:y.props.user,initialState:y.props.browsePostTTIExperiments.expCXEducationModule,contentType:y.props.browsePostTTIExperiments.expCXEducationModuleContentType,isCurrentlyInOnboarding:!1,vacuumingPolicyMaxDays:y.props.browsePostTTIExperiments.vacuumingPolicyMaxDays||120}),y.props.context.isInsideVaultFolder&&i.default.createElement("div",{ref:y.vaultContentSlot}),y.props.browseExperiments.plusPlusEnabled&&s.count()?i.default.createElement(x.AsyncNewFeaturesTable,{items:s,userId:y.props.user.id,viewType:y.props.viewType,viewTypes:O.AllViewTypes,viewTypeLabels:O.ViewTypeLabels,platform:"web"}):null,y.shouldShowFilesView()&&i.default.createElement(C.FilesViewController,r.__assign({},y.props.filesViewActionHandlers,{disabledMultiselect:y.props.isRewindVisible||y.props.isFolderHistoryVisible,getOverflowMenuActions:y.handleGetOverflowMenuActions,renderSharedWithController:y.renderSharedWithController,hrefForFile:a.href_for_file,onLocationLinkClick:y.handleLocationLinkClick,onNavigateToFileOrFolder:y.props.onNavigateToFileOrFolder,onNavigateToParentFolder:y.props.onNavigateToParentFolder,onOpenFileSharedWithMe:y.props.onOpenFileSharedWithMe,onOpenPaper:y.handleOpenPaper,onFocusSearchBar:y.handleFocusSearchBar,context:y.props.context,createNewFolderState:y.props.createNewFolderState,currentSort:y.props.currentSort,dropTargetHighlightMode:c,fileRename:y.props.fileRename,items:l,responsive:e,getIsFileJumping:y.props.getIsFileJumping,isDraggingExternalFiles:y.props.isDraggingExternalFiles,isDraggingInternalFiles:y.props.isDraggingInternalFiles,isFileViewerShown:y.props.isFileViewerShown,isOverFreeQuota:y.props.isOverFreeQuota,shouldShowPinnedTeamFolders:n,arePostTTIModulesLoaded:y.props.arePostTTIModulesLoaded,sharingServiceInfo:y.props.sharingServiceInfo,extensionsFeatureFlags:y.props.extensionsFeatureFlags,loadingState:y.props.loadingState,onComponentTTI:y.props.handleComponentTTI,onSelectionChange:y.handleSelectionChange,onSortChange:y.handleFileListSortChange,onStarClick:y.handleStarClick,path:y.props.path,selectedFiles:y.props.selectedFiles,selection:y.props.selection,setFileUploaderPath:I.FileUploaderController.setPathAndPermissions,showFileUploaderModal:y.handleShowFileUploader,teamFolders:y.props.teamFolders,totalNumFiles:y.props.totalNumItems,user:y.props.user,viewType:y.props.viewType,isQueryingFolderSizes:y.props.isQueryingFolderSizes,columns:y.props.columns,viewTypeColumns:y.props.viewTypeColumns,viewTypes:O.AllViewTypes,viewTypeLabels:O.ViewTypeLabels,starredState:y.props.starredState,stickyOffsetTop:-1,scrollContainer:y.scrollContainer,isStickyColumnHeader:!0,scrollPositionOffset:y.state.fixedHeaderHeight||0,highDensity:!0,updateDropTarget:y.handleUpdateDropTarget,eligibleForFirstTaskSubtitle:y.props.browsePostTTIExperiments.expFirstTaskSubtitle||!1,isFirstTaskEmptyState:y.isFirstTaskEmptyState(),eligibleForBasicToBizSubtitle:y.props.browsePostTTIExperiments.expBasicToBizSubtitle||!1,expVaultEnableViewOnlySharing:y.props.browsePostTTIExperiments.expVaultEnableViewOnlySharing||!1,customEmptyFolderView:u?function(){return i.default.createElement("div",{className:"mobile-web-invites-empty-state"})}:void 0})),y.renderTeamSpaceEmptyZone(),u)},y.renderSidebar=function(e,t){return y.state.hideFilesAndSidebar?null:i.default.createElement(w.BrowseSidebarView,{autoTeamGroupId:y.props.autoTeamGroupId,arePostTTIModulesLoaded:y.props.arePostTTIModulesLoaded,uploaderExperiments:y.props.uploaderExperiments,uploaderPostTTIExperiments:y.props.uploaderPostTTIExperiments,handleComponentTTI:y.props.handleComponentTTI,isNoComment:y.props.isNoComment,starredState:y.props.starredState,uploadAjaxInterceptor:y.props.uploadAjaxInterceptor,onUploadButtonClick:y.handleUploadButtonClick,onGetFileActionsForFiles:y.handleGetFileActionsForSetOfFiles,responsive:e,onContextMenuClick:y.handleSidebarContextMenuClick,scrollableSidebarRef:t,hideSidebarCtas:y.shouldHideSideBarCtas(),hideSelectionPreviewPane:y.shouldHideSelectionPreviewPane(),memberInfo:y.props.memberInfo,hideRightsideActions:y.shouldHideRightsideActions(),showInviteSidePanel:y.isInviteMode(),personalizationLogCtx:y.getPersonalizationLogCtx()})},y.closeRewindPanel=function(){y.props.onCloseRewind()},y.closeFolderHistoryPanel=function(){y.props.onCloseFolderHistoryPanel()},y.renderTitle=function(){var e=y.props,t=e.context,r=e.isDraggingExternalFiles,o=e.isDraggingInternalFiles,n=e.isUploadModalOpen;return i.default.createElement(i.default.Fragment,null,t.isInsideVaultFolder&&i.default.createElement("div",{ref:y.vaultLockButtonSlot}),i.default.createElement(b.BrowseTitle,{isDraggingExternalFiles:r,isDraggingInternalFiles:o,isUploadModalOpen:n}),t.isInsideVaultFolder&&i.default.createElement("div",{ref:y.vaultHeaderSlot}))},y.state={searchBarProps:y.getCurrentSearchBarProps(y.props),initialTotalNumItems:y.props.totalNumItems||1,initialHideState:!!y.props.isSmbPersonalization,hideFilesAndSidebar:!1},y}return r.__extends(j,p),j.prototype.UNSAFE_componentWillMount=function(){var e=this;this.topNotificationListener=G.createTopNotificationListener((function(t){e.setState({hasTopNotification:t})}))},j.prototype.UNSAFE_componentWillReceiveProps=function(e){e.path!==this.props.path&&this.setState({searchBarProps:this.getCurrentSearchBarProps(e)})},j.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,o=this;return r.__generator(this,(function(n){switch(n.label){case 0:return(t=this.props.browseExperiments.browseSuccessQualitativeMetric)===q.BrowseSuccessBannerVariants.V1||t===q.BrowseSuccessBannerVariants.V3?V.startBrowseSuccessBannerCounter(t):t===q.BrowseSuccessBannerVariants.V2&&V.setBrowseSuccessBannerTimer(),B.Snackbar.manager=this.snackbarManager.current,[4,K.waitForTTI()];case 1:return n.sent(),Promise.all([new Promise((function(t,r){e(["modules/clean/react/browse/file_actions/file_actions"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/browse/shared_with"],t,r)})).then(r.__importStar)]).then((function(e){var t=e[0],r=e[1];o.setState({fileActionsModule:t,sharedWithModule:r})})),I.FileUploaderController.loadCoreComponent(),this.props.shouldOpenUploadModal&&this.handleShowFileUploader(),z.UEClient.sendEvent("BrowseView","componentDidMount",this.props.context.toJSON()),f.logPageView(this.getPageVieworBrowseLoadedData()),[2]}}))}))},j.prototype.componentDidUpdate=function(e){void 0!==this.props.browsePostTTIExperiments.expPersonalizedFirstPaths&&this.state.initialHideState&&this.setState({initialHideState:!1}),this.props.loadingState===P.LoadingState.LOADED&&z.UEClient.sendEvent("BrowseView","componentDidUpdate",this.props.context.toJSON()),this.props.loadingState===P.LoadingState.LOADED&&e.loadingState===P.LoadingState.LOADING_FIRST_PAGE&&(f.logBrowseLoaded(this.getPageVieworBrowseLoadedData()),this.setState({initialTotalNumItems:this.props.totalNumItems}))},j.prototype.getPageVieworBrowseLoadedData=function(){var e=this.props,t=e.context,r=e.user,o=e.viewType,n=t.currentFQPath.split("/").filter((function(e){return!!e})).length;return 0===n?{uid:r.id,view_type:o,url:a.get_browse_root(r)}:{uid:r.id,view_type:o,url:a.get_browse_root(r)+"/*",navigation_depth:n}},j.prototype.componentWillUnmount=function(){this.topNotificationListener.unsubscribe()},j.prototype.getCurrentSearchBarProps=function(e){return{searchVariant:"full-page",currentPath:e.path}},j.prototype.getSuggestedFoldersContext=function(){var e=this.props,t=e.user,r=e.autoTeamGroupId,o=e.files;return{userId:t.id,autoTeamGroupId:r,files:o}},j.prototype.getPersonalizationLogCtx=function(){return{role:N.getRole(this.getPersonalizedConfigs()),totalNumItems:this.props.totalNumItems}},j.prototype.render=function(){var e=this.props,r=e.user,n=e.clickRewindTimestamp,s=e.clickFolderHistoryTimestamp,a=e.context,l=e.handleComponentTTI,c=e.isRewindVisible,d=e.isFolderHistoryVisible,u=e.browsePostTTIExperiments.expMobileWebInvites,p=e.montanaModalProps,f=e.browseExperiments,_=f.folderHistoryRollbacks,m=f.plusPlusEnabled,h=f.useMaestroPortal,g=e.showPlusPlusSetupModal,S=e.path,v=o.default("exp-details-pane-variants",{"exp-mobile-web-invites":u});return i.default.createElement("div",{className:v},i.default.createElement(t.AsyncRewindPanel,{clickBrowseButtonTimestampMs:n,user:r,fromDesktopClient:"true"===y.getQueryArgs().from_desktop_client,browseContext:a,close:this.closeRewindPanel,isVisible:c,expFolderHistoryRollbacks:_||!1,userVersionHistoryLength:this.props.userVersionHistoryLength}),i.default.createElement(t.AsyncFolderHistoryPanel,{browseContext:a,clickFolderHistoryButtonInBrowseTimestampMs:s,close:this.closeFolderHistoryPanel,isVisible:d,user:r,userVersionHistoryLength:this.props.userVersionHistoryLength}),p&&i.default.createElement(t.AsyncMontanaModal,{montanaModalProps:p,user:r}),m?i.default.createElement(x.AsyncPlusPlusSetupModal,{userId:r.id,forceShow:g}):null,a.isInsideVaultFolder&&i.default.createElement(W.AsyncVaultRoot,{contentSlot:this.vaultContentSlot,headerSlot:this.vaultHeaderSlot,lockButtonSlot:this.vaultLockButtonSlot,handleComponentTTI:l,shouldShowVaultEmptyState:this.shouldShowVaultEmptyState(),expVaultPinRecovery:!!this.props.browsePostTTIExperiments.expVaultPinRecovery,expVaultTrustedContactGA:!!this.props.browsePostTTIExperiments.expVaultTrustedContactGA,setHideFilesAndSidebar:this.setHideFilesAndSidebar,path:S,user:r}),y.getQueryArgs().unfollow_folder&&i.default.createElement(R.AsyncFolderUnfollower,null),i.default.createElement(L.SearchChrome,{user:r,titleRegion:this.renderTitle(),titleClass:"page-header__title-overflow",embeddedAppRegion:this.renderFilesViewController,actionSidebarRegion:this.renderSidebar,searchBarProps:this.state.searchBarProps,useHeaderPortal:!0,scrollableSidebarRegion:this.renderSidebar,useScrollableSidebar:!0,chromeClass:"dig2--enabled",useMaestroPortal:h}),i.default.createElement(H.SnackbarManager,{ref:this.snackbarManager,getParentElement:ee}))},j.defaultProps={selectedFiles:n.OrderedMap(),viewType:P.ViewType.List},j})(i.default.PureComponent);t.BrowseView=te;var re=i.default.lazy((function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/browse/components/post_tti/error"],t,r)})).then(r.__importStar)];case 1:return[2,{default:t.sent().ErrorComponent}]}}))}))}));t.AsyncRewindPanel=p.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,K.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/delorean/delorean"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().RewindPanel]}}))}))}}),t.AsyncOpenInDesktop=p.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,K.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/growth/open_in_desktop"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().OpenInDesktop]}}))}))}}),t.AsyncOpenInMenu=p.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,K.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/growth/open_in_menu"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().OpenInMenu]}}))}))}}),t.AsyncFolderHistoryPanel=p.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,K.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/delorean/folder_history_panel"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().FolderHistoryPanel]}}))}))}}),t.AsyncMontanaModal=p.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,K.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/montana/in_product_modal/in_product_modal_post_tti_renderer"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().PostTTIMontanaIPAModalRenderer]}}))}))}});var oe=p.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,K.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/browse/components/mobile_web_invite_button"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().MobileWebInviteButton]}}))}))}}),ne=p.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,K.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/browse/components/mobile_web_upload_button"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().MobileWebUploadButton]}}))}))}})})),define("modules/clean/react/browse/browse",["require","exports","tslib","react","react-redux","dropbox/proto/js_init_data/browse_web/browse_web","dropbox/proto/js_init_data/web_timing_logger/web_timing_logger","proto_utils/unpack","modules/clean/react/browse/async_extensions","modules/clean/react/browse/controller","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/folder_overview_selectors","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/store","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/data/store","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/retrieval_success_banner/data/selectors","modules/clean/react/retrieval_success_banner/data/store","modules/clean/search/search_bar/data/action_creators","modules/clean/search/search_bar/data/selectors","modules/clean/viewer","modules/clean/web_timing_logger","modules/clean/react/browse/data/selectors"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S,v,E,w,b,y,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),d=r.__importStar(d),u=r.__importStar(u),p=r.__importStar(p),_=r.__importStar(_),m=r.__importStar(m),g=r.__importStar(g),E=r.__importStar(E),w=r.__importStar(w),y=r.__importStar(y);var F={addFileJumpKeyCode:d.addFileJumpKeyCode,appendFiles:d.appendFiles,applyBoltUpdates:d.applyBoltUpdates,blurSearchBar:E.blurSearchBar,clearSearchBar:E.clearSearchBar,copyFilesToClipboard:d.copyFilesToClipboard,setIsRewindButtonEnabled:d.setIsRewindButtonEnabled,hideRewind:d.hideRewind,showRewind:d.showRewind,hideFolderHistoryPanel:d.hideFolderHistoryPanel,showFolderHistoryPanel:d.showFolderHistoryPanel,pasteFilesFromClipboard:d.pasteFilesFromClipboard,renameFile:d.renameFile,resetFileJumpFilter:d.resetFileJumpFilter,setAndStoreSortOrder:d.setAndStoreSortOrder,setBrowsePostTTIExperiments:d.setBrowsePostTTIExperiments,setBrowseScope:E.setBrowseScope,setCanDisplayFolderSizes:d.setCanDisplayFolderSizes,setFileCategories:E.setFileCategories,setFileRename:_.setFileRename,setLoadingState:d.setLoadingState,setMountPoints:d.setMountPoints,setPath:d.setPath,setPathData:d.setPathData,setSearchBarExperiments:E.setExperiments,setSearchQuery:E.setSearchQuery,setSelection:d.setSelection,clearSelection:d.clearSelection,setShouldShowDeletedFiles:d.setShouldShowDeletedFiles,setUrl:d.setUrl,setViewType:_.setViewType,setViewTypeColumns:_.setViewTypeColumns,setViewTypeScope:_.setViewTypeScope,handleFolderOverviewPrefetch:g.handlePrefetch,addFolderOverviewLoadedComponent:g.addLoadedComponent},I=n.connect((function(e){var t=p.context,r=p.sortedFilesWithFoldersSizesWithoutTeamFolders,o=p.sortedFilesWithFolderSizes,n=p.isFolderHistoryVisible,i=p.teamFolders,s=p.path,a=p.selection,c=p.selectedFiles,d=p.shouldShowDeletedFiles,f=p.newFolderCreationState,_=p.isRewindVisible,h=p.sortOrder,g=p.urlPrefix,v=p.canDisplayFolderSizes,E=p.isQueryingFolderSizes,b=p.user,y=p.viewer,F=p.browsePostTTIExperiments,I=p.mountPoints,O=p.isFileJumping,C=p.clickRewindTimestamp,P=p.clickFolderHistoryTimestamp,A=u.paginatedTotalNumFiles,D=u.loadingState,R=u.shouldShowPinnedTeamFolders,M=u.folderOverviewPinnedItems,N=m.viewType,L=m.viewTypeColumns,x=w.searchSessionId,k=w.isSearchBarFocused;return l.asyncExtensions.init(),{files:o(e),filesWithoutTeamFolders:r(e),teamFolders:i(e),paginatedTotalNumFiles:A(e),loadingState:D(e),path:s(e),fileRename:m.fileRename(e),shouldShowDeletedFiles:d(e),shouldShowPinnedTeamFolders:R(e),createNewFolderState:f(e),isFolderHistoryVisible:n(e),isRewindVisible:_(e),clickRewindTimestamp:C(e),clickFolderHistoryTimestamp:P(e),currentSort:h(e),urlPrefix:g(e),canDisplayFolderSizes:v(e),viewTypeColumns:L(e),isQueryingFolderSizes:E(e),user:b(e),viewer:y(e),browsePostTTIExperiments:F(e),browseContext:t(e),selection:a(e),selectedFiles:c(e),mountPoints:I(e),isFileJumping:O(e),searchSessionId:x(e),isSearchBarFocused:k(e),viewType:N(e),sharingServiceInfo:l.asyncExtensions.sharingServiceInfo(e),extensionsFeatureFlags:l.asyncExtensions.getFeatureFlags(e),shouldShowRetrievalSuccessBanner:S.isRetrievalSuccessBannerVisible(e),pinnedItems:M(e),emptyFolder:u.emptyFolder(e),preSetupPlusFeatures:T.preSetupPlusFeatures(e)}}),F)(c.BrowseController),O=(function(e){function t(t){var r=e.call(this,t)||this;y.log_js_modules_application_code_start(),h.getStoreForFilesView(),v.getStoreForSuccessBanner(),r.reduxStore=f.getStoreForBrowse();var o=b.Viewer.get_viewer(),n=o.get_user_by_id(t.userId);return r.reduxStore.dispatch(_.loadViewTypes({user:n})),r.reduxStore.dispatch(_.loadViewTypeColumns({user:n})),r.reduxStore.dispatch(d.setPath({path:t.initFqPath||"/"})),r.reduxStore.dispatch(d.appInit({experiments:t.browseExperiments,shouldShowDeletedFiles:t.shouldShowDeletedFiles,user:n,viewer:o})),r}return r.__extends(t,e),t.prototype.render=function(){return o.default.createElement(n.Provider,{store:this.reduxStore},o.default.createElement(I,r.__assign({},this.props)))},t})(o.default.PureComponent);t.BrowseApp=O,t.RootComponent=function(e){var t=a.unpackProto(e.encodedProto,i.browse_web.BrowseWebPageProps),n=t.webTimingLoggerServerContext,l=r.__rest(t,["webTimingLoggerServerContext"]);return y.initialize({log_time_to_view:!0,log_time_to_interactive:!0},a.unpackProto(n,s.web_timing_logger.WebTimingLoggerServerContext)),o.default.createElement(O,r.__assign({},l))}})),define("dropbox/proto/js_init_data/browse_web/browse_web",["require","exports","tslib","protobufjs-dbx/minimal"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=(o=r.__importStar(o)).Reader,s=o.Writer,a=o.util,l=o.roots.default||(o.roots.default={});t.default=l,t.browse_web=l.browse_web=((n=l.browse_web||{}).BrowseExperiments=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.goldenGateRaclsEnabled=!1,e.prototype.browseWebFolderOverview="",e.prototype.folderHistoryRollbacks=!1,e.prototype.searchSuccessQualitativeMetric=!1,e.prototype.browseSuccessQualitativeMetric="",e.prototype.browseCreateButtonMove=!1,e.prototype.browseAjaxApiProxy=!1,e.prototype.growthActSmbCreateConsolidation="",e.prototype.lifeVault=!1,e.prototype.sidebarNavigationDelegation=!1,e.prototype.browseNextPageAjaxApiProxy=!1,e.prototype.plusPlusEnabled=!1,e.prototype.browseWebHqlPilot=!1,e.prototype.useMaestroPortal="",e.prototype.browseDigActions=!1,e.prototype.browseDeletedFilesOdyssey=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.goldenGateRaclsEnabled&&Object.hasOwnProperty.call(e,"goldenGateRaclsEnabled")&&t.uint32(8).bool(e.goldenGateRaclsEnabled),null!=e.browseWebFolderOverview&&Object.hasOwnProperty.call(e,"browseWebFolderOverview")&&t.uint32(18).string(e.browseWebFolderOverview),null!=e.folderHistoryRollbacks&&Object.hasOwnProperty.call(e,"folderHistoryRollbacks")&&t.uint32(24).bool(e.folderHistoryRollbacks),null!=e.searchSuccessQualitativeMetric&&Object.hasOwnProperty.call(e,"searchSuccessQualitativeMetric")&&t.uint32(32).bool(e.searchSuccessQualitativeMetric),null!=e.browseSuccessQualitativeMetric&&Object.hasOwnProperty.call(e,"browseSuccessQualitativeMetric")&&t.uint32(42).string(e.browseSuccessQualitativeMetric),null!=e.browseCreateButtonMove&&Object.hasOwnProperty.call(e,"browseCreateButtonMove")&&t.uint32(48).bool(e.browseCreateButtonMove),null!=e.browseAjaxApiProxy&&Object.hasOwnProperty.call(e,"browseAjaxApiProxy")&&t.uint32(56).bool(e.browseAjaxApiProxy),null!=e.growthActSmbCreateConsolidation&&Object.hasOwnProperty.call(e,"growthActSmbCreateConsolidation")&&t.uint32(66).string(e.growthActSmbCreateConsolidation),null!=e.lifeVault&&Object.hasOwnProperty.call(e,"lifeVault")&&t.uint32(72).bool(e.lifeVault),null!=e.sidebarNavigationDelegation&&Object.hasOwnProperty.call(e,"sidebarNavigationDelegation")&&t.uint32(88).bool(e.sidebarNavigationDelegation),null!=e.browseNextPageAjaxApiProxy&&Object.hasOwnProperty.call(e,"browseNextPageAjaxApiProxy")&&t.uint32(104).bool(e.browseNextPageAjaxApiProxy),null!=e.plusPlusEnabled&&Object.hasOwnProperty.call(e,"plusPlusEnabled")&&t.uint32(112).bool(e.plusPlusEnabled),null!=e.browseWebHqlPilot&&Object.hasOwnProperty.call(e,"browseWebHqlPilot")&&t.uint32(120).bool(e.browseWebHqlPilot),null!=e.useMaestroPortal&&Object.hasOwnProperty.call(e,"useMaestroPortal")&&t.uint32(130).string(e.useMaestroPortal),null!=e.browseDigActions&&Object.hasOwnProperty.call(e,"browseDigActions")&&t.uint32(136).bool(e.browseDigActions),null!=e.browseDeletedFilesOdyssey&&Object.hasOwnProperty.call(e,"browseDeletedFilesOdyssey")&&t.uint32(144).bool(e.browseDeletedFilesOdyssey),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new l.browse_web.BrowseExperiments;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.goldenGateRaclsEnabled=e.bool();break;case 2:o.browseWebFolderOverview=e.string();break;case 3:o.folderHistoryRollbacks=e.bool();break;case 4:o.searchSuccessQualitativeMetric=e.bool();break;case 5:o.browseSuccessQualitativeMetric=e.string();break;case 6:o.browseCreateButtonMove=e.bool();break;case 7:o.browseAjaxApiProxy=e.bool();break;case 8:o.growthActSmbCreateConsolidation=e.string();break;case 9:o.lifeVault=e.bool();break;case 11:o.sidebarNavigationDelegation=e.bool();break;case 13:o.browseNextPageAjaxApiProxy=e.bool();break;case 14:o.plusPlusEnabled=e.bool();break;case 15:o.browseWebHqlPilot=e.bool();break;case 16:o.useMaestroPortal=e.string();break;case 17:o.browseDigActions=e.bool();break;case 18:o.browseDeletedFilesOdyssey=e.bool();break;default:e.skipType(7&n)}}return o},e})(n.BrowseExperiments||{}),n.BrowseWebPageProps=(function(e){function e(e){if(this.selectFqPaths=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.autoTeamGroupId="",e.prototype.emailJustVerified=!1,e.prototype.emailJustVerifiedAndChanged=!1,e.prototype.fromSclSyncModal=!1,e.prototype.initFqPath="",e.prototype.nsId=a.Long?a.Long.fromBits(0,0,!1):0,e.prototype.nsPath="",e.prototype.openPreview=!1,e.prototype.selectFqPaths=a.emptyArray,e.prototype.sendVerificationEmail=!1,e.prototype.shareLink=!1,e.prototype.sharePrefillEmail="",e.prototype.shouldShowDeletedFiles=!1,e.prototype.shouldShowUnsyncNotification=!1,e.prototype.shouldOpenExtensionsEduModal="",e.prototype.shouldOpenAppRecommendationsModal=!1,e.prototype.shouldOpenUploadModal=!1,e.prototype.showShareModal=!1,e.prototype.showShareSuccessSnackbar=!1,e.prototype.showingClientModal=!1,e.prototype.showingMobileBillingModal=!1,e.prototype.userId=a.Long?a.Long.fromBits(0,0,!1):0,e.prototype.userVersionHistoryLength=0,e.prototype.browseExperiments=null,e.prototype.isSmbFirstTask=!1,e.prototype.webTimingLoggerServerContext="",e.prototype.showPlusPlusSetupModal=!1,e.prototype.isSmbPersonalization=!1,e.prototype.hasLinkedMobile=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.autoTeamGroupId&&Object.hasOwnProperty.call(e,"autoTeamGroupId")&&t.uint32(10).string(e.autoTeamGroupId),null!=e.emailJustVerified&&Object.hasOwnProperty.call(e,"emailJustVerified")&&t.uint32(16).bool(e.emailJustVerified),null!=e.emailJustVerifiedAndChanged&&Object.hasOwnProperty.call(e,"emailJustVerifiedAndChanged")&&t.uint32(24).bool(e.emailJustVerifiedAndChanged),null!=e.fromSclSyncModal&&Object.hasOwnProperty.call(e,"fromSclSyncModal")&&t.uint32(32).bool(e.fromSclSyncModal),null!=e.initFqPath&&Object.hasOwnProperty.call(e,"initFqPath")&&t.uint32(42).string(e.initFqPath),null!=e.nsId&&Object.hasOwnProperty.call(e,"nsId")&&t.uint32(48).int64(e.nsId),null!=e.nsPath&&Object.hasOwnProperty.call(e,"nsPath")&&t.uint32(58).string(e.nsPath),null!=e.openPreview&&Object.hasOwnProperty.call(e,"openPreview")&&t.uint32(64).bool(e.openPreview),null!=e.selectFqPaths&&e.selectFqPaths.length)for(var r=0;r<e.selectFqPaths.length;++r)t.uint32(74).string(e.selectFqPaths[r]);return null!=e.sendVerificationEmail&&Object.hasOwnProperty.call(e,"sendVerificationEmail")&&t.uint32(80).bool(e.sendVerificationEmail),null!=e.shareLink&&Object.hasOwnProperty.call(e,"shareLink")&&t.uint32(88).bool(e.shareLink),null!=e.sharePrefillEmail&&Object.hasOwnProperty.call(e,"sharePrefillEmail")&&t.uint32(98).string(e.sharePrefillEmail),null!=e.shouldShowDeletedFiles&&Object.hasOwnProperty.call(e,"shouldShowDeletedFiles")&&t.uint32(104).bool(e.shouldShowDeletedFiles),null!=e.shouldShowUnsyncNotification&&Object.hasOwnProperty.call(e,"shouldShowUnsyncNotification")&&t.uint32(112).bool(e.shouldShowUnsyncNotification),null!=e.shouldOpenExtensionsEduModal&&Object.hasOwnProperty.call(e,"shouldOpenExtensionsEduModal")&&t.uint32(122).string(e.shouldOpenExtensionsEduModal),null!=e.shouldOpenAppRecommendationsModal&&Object.hasOwnProperty.call(e,"shouldOpenAppRecommendationsModal")&&t.uint32(128).bool(e.shouldOpenAppRecommendationsModal),null!=e.shouldOpenUploadModal&&Object.hasOwnProperty.call(e,"shouldOpenUploadModal")&&t.uint32(136).bool(e.shouldOpenUploadModal),null!=e.showShareModal&&Object.hasOwnProperty.call(e,"showShareModal")&&t.uint32(144).bool(e.showShareModal),null!=e.showShareSuccessSnackbar&&Object.hasOwnProperty.call(e,"showShareSuccessSnackbar")&&t.uint32(152).bool(e.showShareSuccessSnackbar),null!=e.showingClientModal&&Object.hasOwnProperty.call(e,"showingClientModal")&&t.uint32(160).bool(e.showingClientModal),null!=e.showingMobileBillingModal&&Object.hasOwnProperty.call(e,"showingMobileBillingModal")&&t.uint32(168).bool(e.showingMobileBillingModal),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(176).int64(e.userId),null!=e.userVersionHistoryLength&&Object.hasOwnProperty.call(e,"userVersionHistoryLength")&&t.uint32(184).int32(e.userVersionHistoryLength),null!=e.browseExperiments&&Object.hasOwnProperty.call(e,"browseExperiments")&&l.browse_web.BrowseExperiments.encode(e.browseExperiments,t.uint32(194).fork()).ldelim(),null!=e.isSmbFirstTask&&Object.hasOwnProperty.call(e,"isSmbFirstTask")&&t.uint32(200).bool(e.isSmbFirstTask),null!=e.webTimingLoggerServerContext&&Object.hasOwnProperty.call(e,"webTimingLoggerServerContext")&&t.uint32(210).string(e.webTimingLoggerServerContext),null!=e.showPlusPlusSetupModal&&Object.hasOwnProperty.call(e,"showPlusPlusSetupModal")&&t.uint32(216).bool(e.showPlusPlusSetupModal),null!=e.isSmbPersonalization&&Object.hasOwnProperty.call(e,"isSmbPersonalization")&&t.uint32(224).bool(e.isSmbPersonalization),null!=e.hasLinkedMobile&&Object.hasOwnProperty.call(e,"hasLinkedMobile")&&t.uint32(232).bool(e.hasLinkedMobile),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new l.browse_web.BrowseWebPageProps;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.autoTeamGroupId=e.string();break;case 2:o.emailJustVerified=e.bool();break;case 3:o.emailJustVerifiedAndChanged=e.bool();break;case 4:o.fromSclSyncModal=e.bool();break;case 5:o.initFqPath=e.string();break;case 6:o.nsId=e.int64();break;case 7:o.nsPath=e.string();break;case 8:o.openPreview=e.bool();break;case 9:o.selectFqPaths&&o.selectFqPaths.length||(o.selectFqPaths=[]),o.selectFqPaths.push(e.string());break;case 10:o.sendVerificationEmail=e.bool();break;case 11:o.shareLink=e.bool();break;case 12:o.sharePrefillEmail=e.string();break;case 13:o.shouldShowDeletedFiles=e.bool();break;case 14:o.shouldShowUnsyncNotification=e.bool();break;case 15:o.shouldOpenExtensionsEduModal=e.string();break;case 16:o.shouldOpenAppRecommendationsModal=e.bool();break;case 17:o.shouldOpenUploadModal=e.bool();break;case 18:o.showShareModal=e.bool();break;case 19:o.showShareSuccessSnackbar=e.bool();break;case 20:o.showingClientModal=e.bool();break;case 21:o.showingMobileBillingModal=e.bool();break;case 22:o.userId=e.int64();break;case 23:o.userVersionHistoryLength=e.int32();break;case 24:o.browseExperiments=l.browse_web.BrowseExperiments.decode(e,e.uint32());break;case 25:o.isSmbFirstTask=e.bool();break;case 26:o.webTimingLoggerServerContext=e.string();break;case 27:o.showPlusPlusSetupModal=e.bool();break;case 28:o.isSmbPersonalization=e.bool();break;case 29:o.hasLinkedMobile=e.bool();break;default:e.skipType(7&n)}}return o},e})(n.BrowseWebPageProps||{}),n)})),define("modules/clean/react/browse/components/first_task_create_folder_button",["require","exports","tslib","react","dig-components/buttons","modules/clean/react/css"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);t.FirstTaskCreateFolderButton=i.requireCssWithComponent((function(e){var t=e.createFolderAction;return o.default.createElement("div",{className:"first-task-create-folder-button-container"},o.default.createElement(n.Button,{variant:"opacity",className:"first-task-create-folder-button",onClick:function(){t.handleClick&&t.handleClick()},disabled:t.disabled},t.displayName))}),["/static/css/dig-components/index.web-vfliFNMrU.css","/static/css/browse/first_task_create_folder_button-vflhhsdlT.css"])})),define("modules/clean/react/browse/components/import_painted_door_button",["require","exports","tslib","react","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/menu","modules/clean/static_urls","modules/clean/react/css","modules/core/i18n","modules/core/browser","modules/clean/web_user_action_logger","modules/clean/web_user_action_events","modules/clean/react/image"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),u=r.__importStar(u);var m=[{key:"google drive",displayName:d.intl.formatMessage({id:"B8KWTE",defaultMessage:"Google Drive"}),icon:o.default.createElement(_.Image,{className:"import-painted-door-icon import-painted-door-icon__drive",width:20,height:20,src:l.static_url("/static/images/growth/import_painted_door/google_drive_logo-vflKwckuX.png")})},{key:"icloud",displayName:d.intl.formatMessage({id:"bKRt8R",defaultMessage:"iCloud"}),icon:o.default.createElement(_.Image,{className:"import-painted-door-icon import-painted-door-icon__icloud",width:20,height:20,src:l.static_url("/static/images/growth/import_painted_door/apple_icloud_logo-vfllCi8cM.png")})},{key:"microsoft onedrive",displayName:d.intl.formatMessage({id:"RpeoU1",defaultMessage:"Microsoft OneDrive"}),icon:o.default.createElement(_.Image,{className:"import-painted-door-icon import-painted-door-icon__onedrive",width:20,height:20,src:l.static_url("/static/images/growth/import_painted_door/microsoft_office_logo-vfl4Twkzl.png")})},{key:"other",displayName:d.intl.formatMessage({id:"TBg4yk",defaultMessage:"Other services"}),icon:o.default.createElement(i.UIIcon,{className:"import-painted-door-icon",src:s.DownloadLine})}];t.ImportPaintedDoorButton=c.requireCssWithComponent((function(e){var t=function(e,t){return o.default.createElement(a.Menu.ActionItem,{className:"import-painted-door-item",key:e.key,value:e,withLeftAccessory:o.default.createElement("div",{className:"import-painted-door-item__icon"},e.icon)},e.displayName)},i=function(){p.WebUserActionLog.log(e.userId,f.WebUserActionLogEvent.IMPORT_CLICK,{})};return o.default.createElement(a.Menu.Wrapper,{onSelection:function(t){p.WebUserActionLog.log(e.userId,f.WebUserActionLogEvent.IMPORT_OPTION_CLICK,{source:t.key}).then((function(){u.redirect("https://help.dropbox.com/es-la/installs-integrations/sync-uploads/import-files")}))},className:"import-painted-door-container "+e.className},(function(e){var s=e.getContentProps,l=e.getTriggerProps;return o.default.createElement(o.default.Fragment,null,o.default.createElement(n.Button,r.__assign({},l({onClick:i}),{variant:"opacity",withDropdownIcon:!0,className:"import-painted-door-button"}),d.intl.formatMessage({id:"dP8mnr",defaultMessage:"Import"})),o.default.createElement(a.Menu.Content,r.__assign({},s()),o.default.createElement(a.Menu.Segment,null,m.map(t))))}))}),["/static/css/spectrum/index.web-vfl6Z83yw.css","/static/css/browse/import_painted_door_button-vflABeW6H.css"])})),define("modules/clean/react/browse/controller",["require","exports","tslib","external/lodash","immutable","react","modules/clean/analytics","modules/clean/browse/browse_bolt_client","modules/clean/css","modules/clean/em_string","modules/clean/filepath","modules/clean/filetypes","modules/clean/history","modules/clean/pagelet_logger","modules/clean/pagination_manager","modules/clean/react/app_actions/education/async_extensions_edu_modal","modules/clean/react/browse/action_logger","modules/clean/react/browse/actions","modules/clean/react/browse/api","modules/clean/react/browse/browse_prefetch_loader","modules/clean/react/browse/browse_upload_provider","modules/clean/react/browse/browse_view","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/store","modules/clean/react/browse/models","modules/clean/react/browse/scroll_position","modules/clean/react/browse/uri_helper","modules/clean/react/extensions/app_recommendations_modal/async_modal","modules/clean/react/file_uploader/constants","modules/clean/react/file_uploader/file_uploader","modules/clean/react/file_uploader/store","modules/clean/react/file_uploader/utils","modules/clean/react/file_viewer/async_controller","modules/clean/react/fileops_actions","modules/clean/react/files_view/constants","modules/clean/react/files_view/types","modules/clean/react/retrieval_success_banner/util","modules/clean/react/snackbar","modules/clean/react/vault/constants","modules/clean/react/vault/lib/browse_utils","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/sharing/ui_notifications_util","modules/clean/storage","modules/clean/upsell/prompt_event_emitter","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/constants/python","modules/core/browser","modules/core/exception","modules/core/html","modules/core/i18n","modules/core/notify","modules/core/uri","modules/clean/navigation"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S,v,E,w,b,y,T,F,I,O,C,P,A,D,R,M,N,L,x,k,U,V,B,H,W,q,j,G,z,K,Y,Q,X,J,Z,$,ee,te){"use strict";function re(e){return!!e&&e.isShown()}function oe(e){return o.pick.apply(o,r.__spreadArrays([e,b.BrowseQueryArg.d,b.BrowseQueryArg.select,b.BrowseQueryArg.preview,b.BrowseQueryArg.activity,b.BrowseQueryArg.rewind,b.BrowseQueryArg.folder_history,b.BrowseQueryArg.from_desktop_client,b.BrowseQueryArg.preselected_for_showcase,b.BrowseQueryArg.folder_overview,b.BrowseQueryArg.unfollow_folder],b.FRAMEWORK_ARGS))}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),i=r.__importDefault(i),d=r.__importStar(d),p=r.__importDefault(p),h=r.__importStar(h),S=r.__importStar(S),y=r.__importStar(y),R=r.__importStar(R),N=r.__importStar(N),K=r.__importStar(K),Q=r.__importStar(Q),X=r.__importStar(X);var ne=(function(t){function ne(n){var i=t.call(this,n)||this;return i.deferredCheckForMissingStarredData=o.noop,i.showEmailVerificationModalsIfNeeded=function(){return r.__awaiter(i,void 0,void 0,(function(){var t;return r.__generator(this,(function(o){switch(o.label){case 0:return this.props.emailJustVerified||this.props.emailJustVerifiedAndChanged||this.props.sendVerificationEmail?[4,new Promise((function(t,r){e(["modules/clean/account/email"],t,r)})).then(r.__importStar)]:[2];case 1:return t=o.sent().EmailVerification,this.props.emailJustVerified?t.getForRole(this.props.user.role).show_verified_modal():this.props.emailJustVerifiedAndChanged?t.getForRole(this.props.user.role).show_verified_and_changed_modal():this.props.sendVerificationEmail&&t.getForRole(this.props.user.role).show_sent_modal(),[2]}}))}))},i.handlePostTTIPrefetchComplete=function(t){return r.__awaiter(i,void 0,void 0,(function(){var o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S;return r.__generator(this,(function(v){switch(v.label){case 0:return o=t["exp-browse-post-tti-experiments"],n=t["exp-uploader-post-tti-experiments"],i=!!t["is-over-free-quota"],s=!!t["maybe-render-team-admin-modals"],a=!!t["has-excluded-ns-ids"],l=t["montana-modal-props"],c=t["preferred-editors"],d=t["member-info"],u=!!t["needs-pairing-token"],p=!!t["seen-desktop-tooltip"],o.expShouldShowNcctPaywall&&Q.redirect("/ncct-trial-end"),[4,new Promise((function(t,r){e(["modules/core/browser_detection"],t,r)})).then(r.__importStar)];case 1:return f=v.sent().is_supported_mobile_browser,_=!f()&&l,this.setState({uploaderPostTTIExperiments:n,isOverFreeQuota:i,hasExcludedNsIds:a,montanaModalProps:_?l:null,preferredEditors:c,memberInfo:d,needsPairingToken:u}),this.props.setBrowsePostTTIExperiments({browsePostTTIExperiments:o}),!s||_?[3,3]:[4,new Promise((function(t,r){e(["modules/clean/react/ncct/post_tti_ncct_modal"],t,r)})).then(r.__importStar)];case 2:(0,v.sent().postTTINCCTReminderModal)(),v.label=3;case 3:return[4,new Promise((function(t,r){e(["modules/clean/react/growth/first_task/first_task"],t,r)})).then(r.__importStar)];case 4:return m=v.sent(),h=m.markClinkTooltipSeenAndHide,g=m.showClinkTooltip,S=m.TooltipType,p?h():d&&d.users.length>1&&g(S.Members),[2]}}))}))},i.handlePostTTIPrefetchError=function(e){X.reportException({err:new Error("failed to load post TTI experiments")})},i.handlePreviewAndShareModalsOnLoad=function(t){var o=i.getPathFromProps(),n=i.props.user,s=!!i.props.openPreview,a=!!i.props.showShareModal,l=i.props.sharePrefillEmail,c=l?l.split(","):void 0;if(s&&!t){$.Notify.error(Z.intl.formatMessage({id:"D+KIIm",defaultMessage:"The file doesn’t exist"}));var d=i.props.urlPrefix,u=i.getUrlForFQPath(d,o),f=O.getQueryArgs();delete f.preview,p.default.replace_state(u,f)}if(t){var _=F.File.fromServerObject(t);M.asyncOpenPreview({containerId:b.BROWSE_FILE_VIEWER_ELEMENT_ID,files:[_],fileViewAction:Y.FileViewActionType.CLICK,fileViewOrigin:Y.FileViewOriginType.BROWSE,fileViewTarget:Y.FileViewTargetType.PRIVATE,indexOfPreviewFile:0,user:n,updateBrowserLocation:!1,onFileViewerDidMount:function(){M.hideElementsBehindFileViewer(),T.getStoreForBrowse().dispatch(y.setIsFileViewerShown({isShown:!0}))},onFileViewerUnmount:function(){M.showElementsBehindFileViewer(),T.getStoreForBrowse().dispatch(y.setIsFileViewerShown({isShown:!1})),i.restoreUrlAfterFileViewClose()}}),a&&K.waitForTTI().then((function(){i.mounted&&H.asyncShowPrefilledShareModal({user:n,sharePrefillEmails:c,content:_,setUrl:i.props.setUrl})}))}else a&&i.showShareModalForCurrentPath(c);a||i.props.showingMobileBillingModal||i.props.showingClientModal||K.waitForTTI().then((function(){G.promptBufferedEventEmitter.on(G.Events.ON_PROMPT_INITIALIZED,(function(t){return r.__awaiter(i,void 0,void 0,(function(){return r.__generator(this,(function(o){switch(o.label){case 0:return t&&(t.didMainCampaignLoad()||t.didCampaignForUserEducationLoad())?[2]:[4,new Promise((function(t,r){e(["modules/clean/react/ncct/post_tti_ncct_modal"],t,r)})).then(r.__importStar)];case 1:return[4,(0,o.sent().postTTINCCTReminderModal)()];case 2:return o.sent(),[2]}}))}))}))}))},i.receiveStateFromStores=function(){i.setState(i.getStateFromStores())},i.handleComponentTTI=function(e){i.browseLogger&&(!i.browseLogger.ttiLogged||"FilesViewController"!==e&&"SearchResultsTitle"!==e?i.browseLogger.componentReady(e):i.ajaxRequestWebTimer&&(i.ajaxRequestWebTimer.markTimeToInteractive(),delete i.ajaxRequestWebTimer))},i.onAllUploadsComplete=function(e){var t=e,r=t&&t.detail&&t.detail.files;if(r){var o=r.map((function(e){return d.normalize(e.path)+d.normalize(e.name)}));g.browseActions.selectFilesAfterUpload({fqPathsToSelect:o})}},i.getIsFileJumping=function(){return i.props.isFileJumping},i.getFileByFilename=function(e){return i.props.files.find((function(t){return d.filename(t.fq_path)===e}))||null},i.startBoltLiveUpdate=function(){i.browseBoltClient.startLiveUpdate((function(){i.getChangesRequest&&i.getChangesRequest.abort();var e=i.props,t=e.user,r=e.path,o=e.shouldShowDeletedFiles;i.getChangesRequest=S.getChangesForDirectory({path:r,userId:t.id,namespaceToJournalIdMap:i.browseBoltClient.getNsMap(),includeDeletedFiles:o,onSuccess:function(e){delete i.getChangesRequest,r===i.props.path&&(i.props.applyBoltUpdates({updates:e,setPath:i.props.setPath}),i.browseBoltClient.handleUpdateBoltClient(e.bolt_data))}})}))},i.toggleRewindIfNecessary=function(){var e=O.getQueryArgs().activity||O.getQueryArgs().rewind;e&&!i.props.isRewindVisible&&i.props.showRewind(),!e&&i.props.isRewindVisible&&i.props.hideRewind()},i.toggleFolderHistoryIfNecessary=function(){var e=O.getQueryArgs().folder_history;e&&!i.props.isFolderHistoryVisible&&i.props.showFolderHistoryPanel(),!e&&i.props.isFolderHistoryVisible&&i.props.hideFolderHistoryPanel()},i.showShareModalForCurrentPath=function(e){var t=i.props.user,r=i.getPathFromProps();K.waitForTTI().then((function(){if(i.mounted){var o=i.props.nsId,n=i.props.nsPath;H.asyncShowPrefilledShareModal({user:t,sharePrefillEmails:e,content:{fqPath:r,isFolder:!0,nsId:o&&n?o:null,targetNsId:o&&!n?o:null},setUrl:i.props.setUrl})}}))},i.handleMaestroNavigationAction=function(e){if(e.method!==te.NavigationMethod.REDIRECT)return!1;var t=ee.URI.parse(e.url);return p.default.push_state(t.getPath(),oe(t.getQuery())),!0},i.handleFileLocationChange=function(e,t){e="/"+ee.URI.decode(e),i.ensureFileViewerIsOpenedOrClosedIfNeeded(t),i.toggleRewindIfNecessary(),i.toggleFolderHistoryIfNecessary();var r=!d.paths_are_equal(i.props.path,e);t.share&&!i.props.showShareModal&&i.showShareModalForCurrentPath();var o="1"===t.d!=!!i.props.shouldShowDeletedFiles;if(r||o||t.reload){t.reload&&(delete t.reload,i.props.setUrl({path:i.props.path,qargs:t}));i.props.setPath({path:e}),i.props.setLoadingState({loadingState:x.LoadingState.LOADING_FIRST_PAGE,path:e}),i.props.setShouldShowDeletedFiles({shouldShowDeletedFiles:"1"===t.d}),i.browseLogger&&i.browseLogger.ttiLogged&&i.ensureTimer("browse_ajax","browse_ajax_nav");var n=i.browseExperiments,s=n.browseAjaxApiProxy,a=n.browseDeletedFilesOdyssey,l=i.props.currentSort.sortDirection===x.SortDirection.ASCENDING,c="1"===t.d,u=i.props.viewer.is_team_assume_user_session||i.props.viewer.is_assume_user_session;!s||u||c&&!a?S.loadPath({sortLabel:L.SortIsFilename.includes(i.props.currentSort.sortField)?x.SortLabel.FILENAME:i.props.currentSort.sortField===x.SortField.MODIFIED?x.SortLabel.MODIFIED:x.SortLabel.SIZE,sortIsAscending:l,path:e,userId:i.props.user.id,includeDeletedFiles:c,onSuccess:function(t){var o=t.path,n=t.data,s=t.xhr;if(i.ajaxRequestWebTimer){var a=s.getResponseHeader("x-dropbox-request-id");i.ajaxRequestWebTimer.end(a||void 0)}if(d.paths_are_equal(e,o)){var l={folderOverview:n.folder_overview||null,mountPoints:n.ns_id_to_mount_point,context:F.BrowseContext.fromServerObject(n),items:n.file_info||n.first_page.items,hasMore:n.paginated,nextRequestVoucher:void 0!==n.first_page?n.first_page.next_request_voucher:null,paginatedTotalNumFiles:void 0!==n.first_page?n.first_page.total_num_items:n.file_info.length};i.handleFileLocationChangeSuccess(e,l,r,!1)}},onError:function(){d.paths_are_equal(e,"/")||i.props.setUrl({path:"/"})}}):S.loadPath2({userId:i.props.user.id,path:e,sortType:L.SortIsFilename.includes(i.props.currentSort.sortField)?{".tag":"files_by_name"}:i.props.currentSort.sortField===x.SortField.MODIFIED?{".tag":"files_by_modified"}:{".tag":"files_by_size"},sortIsAscending:l,includeDeleted:c}).then((function(t){X.assert(void 0!==t.context,"context is undefined"),X.assert(void 0!==t.paginated_file_info,"paginated_file_info is undefined"),X.assert(void 0!==t.total_count,"total_count is undefined"),i.ajaxRequestWebTimer&&i.ajaxRequestWebTimer.end();for(var o=new Array,n=0,s=t.paginated_file_info;n<s.length;n++){var a=s[n];o.push(a.file_info)}var l={folderOverview:t.folder_overview||null,mountPoints:i.convertToMountPointMap(t.context.ns_id_infos),context:F.BrowseContext.fromApiV2Object(t.context),items:o,hasMore:t.has_more||!1,nextRequestVoucher:t.next_request_voucher||null,paginatedTotalNumFiles:t.total_count};i.handleFileLocationChangeSuccess(e,l,r,!0)})).catch((function(t){var r=(function(e){var t="";return void 0!==e.status&&("auth_failed"===e.status[".tag"]?t=Z.intl.formatMessage({id:"8nB2Fu",defaultMessage:"Not authorized to browse {path}."},{path:e.path}):"rate_limited"===e.status[".tag"]?t=Z.intl.formatMessage({id:"2NDCop",defaultMessage:"Too many attempts. Try again later."}):"invalid_path"===e.status[".tag"]?t=Z.intl.formatMessage({id:"o19fmC",defaultMessage:"Unsupported path provided {path}."},{path:e.path}):"folder_not_found"===e.status[".tag"]?t=Z.intl.formatMessage({id:"VZE6IM",defaultMessage:"The folder ‘{path}’ doesn’t exist."},{path:e.path}):"folder_is_deleted"===e.status[".tag"]&&(t=Z.intl.formatMessage({id:"qZpUNY",defaultMessage:"The folder ‘{path}’ is deleted."},{path:e.path}))),t})(t.error);r?U.Snackbar.fail(r,"browse"):(X.reportException({err:t,severity:X.SEVERITY.CRITICAL,tags:["browse"]}),U.Snackbar.fail(Z.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}),"browse")),d.paths_are_equal(e,"/")||i.props.setUrl({path:"/"})}))}},i.handleFileLocationChangeSuccess=function(e,t,o,n){if(i.props.setIsRewindButtonEnabled({path:e,userId:i.props.user.id,userSkuHasRewind:!!i.browseExperiments.folderHistoryRollbacks}),!O.getQueryArgs().query)if(o&&i.props.handleFolderOverviewPrefetch(r.__assign(r.__assign({},t.folderOverview),{path:e,expFolderOverview:i.browseExperiments.browseWebFolderOverview,componentNamespace:b.BrowseFolderOverviewComponentNamespace})),i.props.setPath({path:e}),i.props.setMountPoints({mountPoints:t.mountPoints}),t.hasMore){i.props.setPathData({path:e,files:[],context:t.context,paginatedTotalNumFiles:t.paginatedTotalNumFiles});var s=i.browseExperiments.browseNextPageAjaxApiProxy,a=void 0;n&&s&&(a=v.apiV2FetchNextFn),_.PaginationManager.create({firstPage:{items:t.items,has_more_items:!0,next_request_voucher:t.nextRequestVoucher},keyName:"sjid",ajaxURL:"/browse_get_next",userID:i.props.user.id,newDataAvailableCallback:function(t,r){var o=t.areAllItemsReady()?x.LoadingState.LOADED:x.LoadingState.LOADING_REMAINING_PAGES;i.props.appendFiles({path:e,files:r.map((function(e){return"object"==typeof e.type?F.File.fromApiV2Object(e):F.File.fromServerObject(e)}))}),i.props.setLoadingState({path:e,loadingState:o}),t.areAllItemsReady()&&t.stopAutoFetching()},fetchNextFn:a}).startAutoFetching()}else i.props.setPathData({path:e,files:t.items.map((function(e){return"object"==typeof e.type?F.File.fromApiV2Object(e):F.File.fromServerObject(e)})),paginatedTotalNumFiles:t.paginatedTotalNumFiles,context:t.context}),i.props.setLoadingState({loadingState:x.LoadingState.LOADED,path:e})},i.getPathFromProps=function(){return i.props.initFqPath||"/"},i.markTTVIfNeeded=function(){!i.hasTTVBeenLogged&&i.mounted&&i.state.hasPrefetchLoaded&&(K.mark_time_to_view(),i.hasTTVBeenLogged=!0)},i.handleFileListUpdated=function(){re(i.state.fileViewerController)?i.props.files.isEmpty()?i.state.fileViewerController.close():i.state.fileViewerController.updateFiles(i.props.files.toJS()):i.ensureFileViewerIsOpenedOrClosedIfNeeded(O.getQueryArgs()),i.prefetchPreviewData(i.props.files.toArray(),i.props.user)},i.handleOnNavigateToPath=function(e){i.browseExperiments.searchSuccessQualitativeMetric&&(k.setSearchSuccessBannerVisible(),k.setClickablePathData(e)),g.browseActions.setUrl({path:e})},i.handleOnNavigateToParentFolder=function(){I.ScrollPositionHandler.navigateUpFolder(),g.browseActions.navigateToParentFolder()},i.handleDelete=function(e){var t=e.some(F.File.isTeamSharedFolder),r=e.some((function(e){return e.read_only})),o=e.every((function(e){return e.isDeleted}));!i.props.browseContext.isCurrentPathWriteable()||t||r?t?$.Notify.error(Z.intl.formatMessage({id:"BL2R2n",defaultMessage:"Team folders can’t be deleted."})):$.Notify.warning(Z.intl.formatMessage({id:"GXM4JR",defaultMessage:"You don’t have permission to delete files in this folder."})):o?g.browseActions.doPermanentDeleteWithModal(e):g.browseActions.doDeleteFilesWithModal({files:e})},i.handleOnNavigateToFileOrFolder=function(e,t){void 0===t&&(t={});var r=t.actionSource;if(i.browseExperiments.searchSuccessQualitativeMetric&&!k.userIsOptedOutOfRetrievalSuccessBanner()){k.resetSearchResultClickKey();var o=e.is_dir;k.doSearchBarInteractionBroadcast(!1),k.doSearchResultActionClickBroadcast(!1);var n=e.fq_path,s=k.getClickablePath(),a=k.getSearchResultPath(),l=k.getSearchResultClickTimestamp(),c=k.getClickableFilePathClickTimestamp(),d=Date.now();(l&&d-l<=3e4&&k.parentPathOfFileEqualsSearchResultPath(n,a,o)||c&&d-c<=3e4&&k.parentPathOfFileEqualsSearchResultPath(n,s,o))&&k.setSearchSuccessBannerVisible()}i.props.hideRewind();var u=window.pageYOffset;i.ensureFullFileObjectPopulated(e,(function(e,t){i.completeNavigateToFileOrFolder(e,r,t)}),(function(){window.scrollTo({top:u})}))},i.convertToMountPointMap=function(e){if(void 0===e)return{};for(var t={},r=0,o=e;r<o.length;r++){var n=o[r];void 0!==n.ns_id&&void 0!==n.mount_point&&(t[n.ns_id]=n.mount_point)}return t},i.ensureFullFileObjectPopulated=function(e,t,r){t(e,r)},i.completeNavigateToFileOrFolder=function(e,t,r){var o=i.state,n=o.vaultApi,a=o.vaultLoggingTypes,l=i.props,c=l.user,p=l.viewer,f=l.viewType,_=e.ns_id,m=e.sjid,S=e.file_id,v=e.fq_path,E=e.bytes,w=e.ext,b=e.request_id;h.logOpenRow({uid:c.id,entity_type:e.is_dir?"folder":"file",source:"list_browse",view_type:f,file_nsid:_,file_sjid:m,file_id:S,file_name:d.filename(e.fq_path),file_path:v,file_size:E,file_type:e.type,file_extension:w,request_id:b,action_source:t,vaultApi:n,vaultLoggingTypes:a}),e.type===u.FileTypes.TEAM_SHARED_FOLDER&&(z.UEClient.sendEvent("FileItemRow","TeamFolderClicked"),s.TeamsWebActionsLogger.log("clicked_team_folder_web",{team_id:p.team_id})),g.browseActions.navigateToFileOrFolder({file:e,onFileViewerUnmount:r,fileViewAction:Y.FileViewActionType.CLICK,preferredEditors:i.state.preferredEditors})},i.handleOnOpenFileSharedWithMe=function(e){Q.redirect(e.href)},i.actionHandlers={onDelete:i.handleDelete,onShowRename:function(e){return i.props.setFileRename({file:e,renameState:x.RenameState.PENDING_INPUT})},onRestore:function(e){g.browseActions.doRestoreFilesWithUnifiedTrashModal({files:e})},onPermanentDelete:function(e){g.browseActions.doPermanentDeleteWithModal(e)},onShowComment:function(e){return i.onShowComment(e)}},i.handlePresentInZoom=function(e){M.asyncOpenPreview({containerId:b.BROWSE_FILE_VIEWER_ELEMENT_ID,files:[e],indexOfPreviewFile:0,shouldFocusComment:!1,user:i.props.user,onFileViewerDidMount:M.hideElementsBehindFileViewer,onFileViewerUnmount:M.showElementsBehindFileViewer,fileViewAction:Y.FileViewActionType.CLICK,fileViewOrigin:Y.FileViewOriginType.BROWSE,fileViewTarget:Y.FileViewTargetType.PRIVATE,shouldPresentInZoom:!0})},i.filesViewActionHandlers={onDelete:i.handleDelete,onShowRename:function(e){return i.props.setFileRename({file:e,renameState:x.RenameState.PENDING_INPUT})},onCopyToClipboard:function(e){return i.props.copyFilesToClipboard({files:e})},onPasteFromClipboard:function(){return i.props.pasteFilesFromClipboard({copyFiles:N.copyFiles})},onNewFolderSubmit:function(e){return g.browseActions.createFolder({pathName:i.props.browseContext.currentFQPath,folderName:e,nsId:i.props.browseContext.rootNSID,checkFSWs:!0})},onNewFolderCancel:function(){return g.browseActions.cancelCreateFolder()},onRenameSubmit:function(e,t){return i.props.renameFile({file:e,name:t,checkFSWs:!0})},onRenameCancel:function(e){return i.props.setFileRename({file:e,renameState:null})},onSwitchViewType:function(e){h.logSwitchViewType({uid:i.props.user.id,isSearchMode:!1,viewType:e}),i.props.setViewType({user:i.props.user,viewType:e}),window.setTimeout((function(){var e=document.querySelector(".brws-view-type-column-header-menu-trigger");e&&e.focus()}),0)},onColumnsChanged:function(e,t,r){i.props.setViewTypeColumns({columns:e,viewType:t,user:i.props.user}),i.props.setCanDisplayFolderSizes({canDisplayFolderSizes:r})},onCanDisplayFolderSizesChanged:function(e){return i.props.setCanDisplayFolderSizes({canDisplayFolderSizes:e})},onAddFileJumpKeyCode:function(e){return i.props.addFileJumpKeyCode({keyChar:e})},onResetFileJump:function(){return i.props.resetFileJumpFilter()},onShowShare:g.browseActions.handleShowShareModal,onPresentInZoom:i.handlePresentInZoom},i.uploadAjaxInterceptor={interceptUploadPrecheck:function(e){return e},interceptUpload:function(e,t){var o=t.ns_id_for_routing;if(!o){var n=i.props.mountPoints,s=i.props.browseContext.rootNSID;X.assert(null!=n,"mountPoints is null"),X.assert(null!=s,"rootNSID is null"),o=R.getNsId(n,s,e.dest)}return r.__assign(r.__assign({},t),{ns_id_for_routing:o,ns_id:o})}},i.fileViewerIsShown=function(){return re(i.state.fileViewerController)},i.ensureFileViewerClosedIfNotPreviewing=function(e){!e.preview&&re(i.state.fileViewerController)&&i.state.fileViewerController.close()},i.prefetchPreviewData=function(e,t){i.state.fileViewerController&&i.state.fileViewerController.prewarmPreviewData(e,t)},i.ensureFileViewerIsOpenedOrClosedIfNeeded=function(e){if(e.preview&&!re(i.state.fileViewerController)){var t=i.getFileByFilename(e.preview);t&&g.browseActions.navigateToFileOrFolder({file:t,preferredEditors:i.state.preferredEditors})}else!e.preview&&re(i.state.fileViewerController)&&i.state.fileViewerController.close()},i.handleSelectionChange=function(e){var t=e.selection,r=e.actionSource;i.props.setSelection({selection:t,actionSource:r})},i.getLearnMoreLinkHandler=function(){window.open("/help/business/unsynced-team-folder","_blank")},i.props.setSearchBarExperiments({experiments:i.searchBarExperiments}),D.uploaderStore.add_change_listener(i.receiveStateFromStores),window.addEventListener(P.ALL_UPLOADS_COMPLETE_EVENT,i.onAllUploadsComplete),i.state=r.__assign(r.__assign({},i.getStateFromStores()),{montanaModalProps:null,arePostTTIModulesLoaded:!1,preferredEditors:{},hasPrefetchLoaded:!1,memberInfo:{tiered_admin:!1,users:[],evh_max_days:0}}),i}return r.__extends(ne,t),Object.defineProperty(ne.prototype,"uploaderExperiments",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(ne.prototype,"uploaderPostTTIExperiments",{get:function(){return this.state.uploaderPostTTIExperiments||{}},enumerable:!0,configurable:!0}),Object.defineProperty(ne.prototype,"searchBarExperiments",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(ne.prototype,"browseExperiments",{get:function(){return this.props.browseExperiments},enumerable:!0,configurable:!0}),ne.prototype.UNSAFE_componentWillMount=function(){var e,t,o=this,n=this.props,i=n.urlPrefix,s=n.user,l=n.viewer,c=this.props.shareLink,d=!!this.props.openPreview,u=this.getPathFromProps();this.browseLogger=new f.PageletLogger("browse",["FilesViewController","AppActionsView"],!0,{view_type:this.props.viewType.toLowerCase()}),c||d||(e=this.getUrlForFQPath(i,u),t=O.getQueryArgs(),p.default.replace_state(e,oe(t)));var _=l.get_users().map((function(e){return e.id}));j.UserLocalStorage.clearOtherUsers(_),this.browseBoltClient=new a.BrowseBoltClient(s.id);var m=this.browseExperiments.browseNextPageAjaxApiProxy,h=this.props.shouldShowDeletedFiles,S=this.props.viewer.is_team_assume_user_session||this.props.viewer.is_assume_user_session,E=!1;!m||h||S||(E=!0);var w=new v.BrowsePrefetchLoader({user:s,path:u,fqPathsToSelect:this.props.selectFqPaths,useApiv2NextPage:E},{onPrefetchComplete:function(e){o.setState({hasPrefetchLoaded:!0}),o.handlePreviewAndShareModalsOnLoad(e.preview_file_info),"folder_overview"in e&&e.folder_overview?o.props.handleFolderOverviewPrefetch(r.__assign(r.__assign({},e.folder_overview),{path:u,expFolderOverview:o.browseExperiments.browseWebFolderOverview,componentNamespace:b.BrowseFolderOverviewComponentNamespace})):o.props.addFolderOverviewLoadedComponent({componentNamespace:b.BrowseFolderOverviewComponentNamespace,component:"draftjs"}),K.log_js_modules_fetched_data_required_for_tti(),o.markTTVIfNeeded()},onPrefetchError:function(e){B.isInsideVault(u)?Q.redirect(V.VAULT_URL):(o.setState({hasPrefetchLoaded:!0}),X.reportException({err:e||new Error("Failed to prefetch browse data"),severity:"user-error",exc_extra:{path:u}}),o.props.setUrl({path:""}),o.props.setLoadingState({loadingState:x.LoadingState.LOAD_ERROR,path:u}),o.handleFileLocationChange("",{}))},onLoadComplete:function(){},onPostTTIPrefetchComplete:this.handlePostTTIPrefetchComplete,onPostTTIPrefetchError:this.handlePostTTIPrefetchError},{onInitializeEverything:g.browseActions.initializeEverything,onAddFilesAndSetLoadingState:g.browseActions.addFilesAndSetLoadingState});(w.isPrefetching()&&w.handlePrefetch(),this.browseExperiments.searchSuccessQualitativeMetric)&&(p.default.deconstruct_url(document.referrer).qargs.search_session_id&&!k.getClickedOnSearchResultsPageItem()?k.setSearchSuccessBannerVisible():k.getSearchSuccessBannerVisibleFromHome()&&k.setSearchSuccessBannerVisible());if(this.browseExperiments.sidebarNavigationDelegation)for(var y=0,T=b.browseSidebarNavigationCommandIds;y<T.length;y++){var F=T[y];te.navigationActionDispatcher.handle(this.handleMaestroNavigationAction,{actionId:F})}p.default.add_callback(i,this.handleFileLocationChange,!0)},ne.prototype.componentDidMount=function(){var t=this;this.mounted=!0;var n=this.getPathFromProps(),i=this.props.user,s=this.props.shareLink,a=!!this.props.openPreview,u=this.props.fromSclSyncModal;if(this.props.setIsRewindButtonEnabled({path:n,userId:this.props.user.id,userSkuHasRewind:this.browseExperiments.folderHistoryRollbacks}),I.ScrollPositionHandler.register(),this.updateScroll(),u&&(i.is_cdm_member?(function(e){var t=Z.intl.formatMessage({id:"7sFPiN",defaultMessage:"Added “{folder_name}” <a>Learn More</a>"},{folder_name:c.Emstring.em_snippet(d.filename(e),W.SNIPPET_SIZES.FILENAME),a:function(e){return'<a href="/help/business/team-space-overview#acceptfolder">'+e+"</a>"}});$.Notify.success(new J.HTML(t))})(n):(function(e){$.Notify.success(Z.intl.formatMessage({id:"YYLxxv",defaultMessage:"{file_name} added to your Dropbox."},{file_name:d.filename(e)}))})(n)),this.props.showShareSuccessSnackbar){var p=d.filename(n);q.showInBandShareSuccessSnackbar(p)}this.props.shouldOpenAppRecommendationsModal&&C.asyncShowAppRecommendationModal(i.id,"prompt"),this.shouldShowUnsyncNotification()&&this.showUnsyncNotification(),s&&!a&&i.is_cdm_member&&(function(e){var t=d.parent_dir(e);"/"!==t&&$.Notify.success(Z.intl.formatMessage({id:"nZ/TMQ",defaultMessage:"Folder is in {path}"},{path:c.Emstring.em_snippet(t,22)}))})(n),this.toggleRewindIfNecessary(),this.toggleFolderHistoryIfNecessary(),this.markTTVIfNeeded(),ne.mountFileViewerTarget(),K.waitForTTI().then((function(){l.require_css("/static/css/main_browse_post_tti-vflje69_6.css"),t.fetchAndStartBoltUpdates();var n=function(e){var r=e[0],n=r[0],i=(r[1],r[2].SharedWithStore),s=r[3],a=s.checkForMissingStarredData,l=s.StarredStore,c=(r[4],r[5],e[1]),d=(c[0],c[1],c[2].BloodhoundContactsV2),u=(c[3],c[4],c[5],e[2]),p=u[0],f=u[1];if(t.mounted){var _=t.props,h=_.user,g=_.path,S=_.files,v=S.toArray();i.initializeWith({path:g,files:v}),a({items:v,user:h});var E=l.addListener((function(){t.setState({starredState:l.getLoadingStates()})}));t.deferredCheckForMissingStarredData=function(){return o.defer((function(){a({items:t.props.files.toArray(),user:h})}))},t.removeStarredStoreListener=function(){E()},d.getOrCreateForUser(h),t.setState({arePostTTIModulesLoaded:!0,fileViewerController:n,vaultApi:p,vaultLoggingTypes:f}),t.showEmailVerificationModalsIfNeeded(),t.prefetchPreviewData(S.toArray(),h);var w=t.props.shouldOpenExtensionsEduModal;w&&m.asyncShowExtensionsEduModal(h.id,w)}};n.perfName="browse_post_tti",Promise.all([Promise.all([new Promise((function(t,r){e(["modules/clean/react/file_viewer/controller"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/browse/file_actions/file_actions"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/browse/shared_with"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/starred/browse_exports"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/file_modal_controller"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/sharing/share_modal_util"],t,r)})).then(r.__importStar)]),Promise.all([new Promise((function(t,r){e(["modules/clean/sharing/ui_util"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/sharing/wizard/wizard_modals"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/contacts/bloodhound_contacts_v2"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/unity_browse_interface"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/unity/features"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/unity/check_file_cache"],t,r)})).then(r.__importStar)]),Promise.all([new Promise((function(t,r){e(["modules/clean/react/vault/lib/api"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/vault/logging_types"],t,r)})).then(r.__importStar)])]).then(n)}))},ne.prototype.UNSAFE_componentWillUpdate=function(e,t){e.files.equals(this.props.files)||o.defer(this.handleFileListUpdated)},ne.prototype.updateScroll=function(){var e=I.ScrollPositionHandler.getLastScrollPosition(this.props.path);if(e){var t=this.props,r=t.selection;(0,t.setSelection)({selection:r.set("selected",n.OrderedSet([e])).set("anchor",e),skipLogging:!0})}},ne.prototype.componentDidUpdate=function(e){e.loadingState===x.LoadingState.LOADING_FIRST_PAGE&&this.props.loadingState!==e.loadingState&&(this.markTTVIfNeeded(),this.updateScroll()),e.files!==this.props.files&&this.deferredCheckForMissingStarredData()},ne.prototype.componentWillUnmount=function(){this.removeStarredStoreListener&&this.removeStarredStoreListener(),I.ScrollPositionHandler.unregister(),ne.unmountFileViewerTarget(),D.uploaderStore.remove_change_listener(this.receiveStateFromStores),window.removeEventListener(P.ALL_UPLOADS_COMPLETE_EVENT,this.onAllUploadsComplete),this.mounted=!1},ne.prototype.getStateFromStores=function(){return{isDraggingInternalFiles:A.FileUploaderController.isDraggingInternalFiles(),isDraggingExternalFiles:A.FileUploaderController.isDraggingExternalFiles(),isUploadModalOpen:A.FileUploaderController.isUploadModalOpen()}},ne.prototype.restoreUrlAfterFileViewClose=function(){var e,t=this.props.urlPrefix,r=this.getUrlForFQPath(t,this.props.path);e=this.props.openPreview?o.omit(O.getQueryArgs(),b.BrowseQueryArg.preview,b.BrowseQueryArg.select):{},p.default.replace_state(r,e)},ne.prototype.getUrlForFQPath=function(e,t){return e+("/"===t?"":ee.URI.encode_parts(t))},ne.prototype.fetchAndStartBoltUpdates=function(){this.browseBoltClient.isReady()?this.startBoltLiveUpdate():this.browseBoltClient.fetchInitialBoltData(this.startBoltLiveUpdate)},ne.prototype.ensureTimer=function(e,t){if(this.ajaxRequestWebTimer&&this.ajaxRequestWebTimer.getContextName()!==e&&(this.ajaxRequestWebTimer.abort(),K.delete_timer(this.ajaxRequestWebTimer.getContextName()),this.ajaxRequestWebTimer=void 0),this.ajaxRequestWebTimer)this.ajaxRequestWebTimer.restart();else{K.delete_timer(e),this.ajaxRequestWebTimer=K.get_timer(e);var r={requireTTI:!0,requireTTV:!1};t&&(r.url=t),this.ajaxRequestWebTimer.initialize(r)}},ne.prototype.onShowComment=function(e){var t=this;e instanceof F.FileSharedWithMe?Q.redirect(e.href):this.ensureFullFileObjectPopulated(e,(function(e){g.browseActions.navigateToFileOrFolder({file:e,shouldFocusComment:!0,preferredEditors:t.state.preferredEditors})}))},ne.prototype.shouldShowUnsyncNotification=function(){return this.props.shouldShowUnsyncNotification},ne.prototype.showUnsyncNotification=function(){U.Snackbar.show(i.default.createElement(U.Snackbar,{variant:"generic",title:Z.intl.formatMessage({id:"pwl1MF",defaultMessage:"Do you also need this on your computer?"}),timeoutDelayMs:1e5,actionButtonText:Z.intl.formatMessage({id:"gk12sS",defaultMessage:"Learn more"}),closeButtonText:Z.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),onActionClick:this.getLearnMoreLinkHandler,id:"browse-unsync"}))},ne.prototype.render=function(){var e=this.state,t=e.isUploadModalOpen,r=e.starredState,o=e.arePostTTIModulesLoaded,n=e.isDraggingExternalFiles,s=e.isDraggingInternalFiles,a=e.isOverFreeQuota,l=e.hasExcludedNsIds,c=e.montanaModalProps,d=e.memberInfo,u=e.needsPairingToken,p=this.props,f=p.browseContext,_=p.selection,m=p.selectedFiles,h=p.browsePostTTIExperiments,g=p.canDisplayFolderSizes,S=p.clearSelection,v=p.clickFolderHistoryTimestamp,b=p.clickRewindTimestamp,y=p.createNewFolderState,T=p.currentSort,F=p.extensionsFeatureFlags,I=p.fileRename,O=p.files,C=p.filesWithoutTeamFolders,P=p.hideRewind,A=p.hideFolderHistoryPanel,D=p.showFolderHistoryPanel,R=p.isQueryingFolderSizes,M=p.isRewindVisible,N=p.isFolderHistoryVisible,L=p.loadingState,x=p.paginatedTotalNumFiles,k=p.path,U=p.setAndStoreSortOrder,V=p.setUrl,B=p.shouldShowDeletedFiles,H=p.shouldShowPinnedTeamFolders,W=p.showRewind,q=p.teamFolders,j=p.user,G=p.viewType,z=p.viewTypeColumns,K=p.sharingServiceInfo,Y=p.shouldShowRetrievalSuccessBanner,Q=p.pinnedItems,X=p.emptyFolder,J=p.preSetupPlusFeatures;return i.default.createElement(E.BrowseUploadProvider,{userId:this.props.user.id,mountPoints:this.props.mountPoints,rootNSID:this.props.browseContext.rootNSID},i.default.createElement(w.BrowseView,{autoTeamGroupId:this.props.autoTeamGroupId,userVersionHistoryLength:this.props.userVersionHistoryLength,actionHandlers:this.actionHandlers,filesViewActionHandlers:this.filesViewActionHandlers,onNavigateToParentFolder:this.handleOnNavigateToParentFolder,onNavigateToPath:this.handleOnNavigateToPath,onNavigateToFileOrFolder:this.handleOnNavigateToFileOrFolder,onOpenFileSharedWithMe:this.handleOnOpenFileSharedWithMe,clickRewindTimestamp:b,clickFolderHistoryTimestamp:v,context:f,createNewFolderState:y,currentSort:T,ensureFileViewerClosedIfNotPreviewing:this.ensureFileViewerClosedIfNotPreviewing,fileRename:I,files:O,filesWithoutTeamFolders:C,getIsFileJumping:this.getIsFileJumping,handleComponentTTI:this.handleComponentTTI,isDraggingExternalFiles:n,isDraggingInternalFiles:s,isFileViewerShown:this.fileViewerIsShown,isFolderHistoryVisible:N,isRewindVisible:M,isUploadModalOpen:t,loadingState:L,path:k,selectedFiles:m,selection:_,shouldOpenUploadModal:this.props.shouldOpenUploadModal,shouldShowDeletedFiles:B,shouldShowPinnedTeamFolders:H,starredState:r,teamFolders:q,totalNumItems:x,uploadAjaxInterceptor:this.uploadAjaxInterceptor,user:j,viewType:G,canDisplayFolderSizes:g,columns:z[G],viewTypeColumns:z,arePostTTIModulesLoaded:o,isOverFreeQuota:a,hasExcludedNsIds:l,isQueryingFolderSizes:R,nsId:this.props.nsId,uploaderExperiments:this.uploaderExperiments,uploaderPostTTIExperiments:this.uploaderPostTTIExperiments,searchBarExperiments:this.searchBarExperiments,browseExperiments:this.browseExperiments,browsePostTTIExperiments:h,onShowRewind:W,onCloseRewind:P,onCloseFolderHistoryPanel:A,onShowFolderHistoryPanel:D,onSelectionChange:this.handleSelectionChange,onClearSelection:S,extensionsFeatureFlags:F,sharingServiceInfo:K,onSortFiles:U,pinnedItems:Q,onSetUrl:V,shouldShowRetrievalSuccessBanner:Y,montanaModalProps:c,emptyFolder:X,memberInfo:d,needsPairingToken:u,isSmbFirstTask:this.props.isSmbFirstTask,showPlusPlusSetupModal:this.props.showPlusPlusSetupModal,isSmbPersonalization:this.props.isSmbPersonalization,preSetupPlusFeatures:J,hasLinkedMobile:this.props.hasLinkedMobile}))},ne.mountFileViewerTarget=function(){var e=document.getElementById(b.BROWSE_FILE_VIEWER_ELEMENT_ID);e||((e=document.createElement("div")).id=b.BROWSE_FILE_VIEWER_ELEMENT_ID,document.body.insertBefore(e,document.body.children[0]))},ne.unmountFileViewerTarget=function(){var e=document.getElementById(b.BROWSE_FILE_VIEWER_ELEMENT_ID);e&&document.body.removeChild(e)},ne})(i.default.Component);t.BrowseController=ne})),define("modules/clean/react/browse/crypto_subtle_digest",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.windowHasCryptoSubtleDigest=function(){return!!window.crypto&&!!window.crypto.subtle&&!!window.crypto.subtle.digest},t.encryptArrayBuffer=function(e){if(t.windowHasCryptoSubtleDigest())return new Promise((function(t){window.crypto.subtle.digest("SHA-256",e).then(t)}));throw new Error("window.crypto.subtle.digest not available")}})),define("modules/clean/react/browse/data/action_creators",["require","exports","tslib","external/lodash","immutable","modules/clean/file_actions/create-folder","modules/clean/filepath","modules/clean/flux/dispatcher","modules/clean/history","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/browse/api","modules/clean/react/browse/async_extensions","modules/clean/react/browse/constants","modules/clean/react/browse/data/folder_overview_selectors","modules/clean/react/browse/data/helpers","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/types","modules/clean/react/browse/logger_util","modules/clean/react/browse/models","modules/clean/react/browse/uri_helper","modules/clean/react/file_uploader/constants","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/file_actions/api_v2","modules/clean/react/files_view/file_actions/file_from_metadata","modules/clean/react/files_view/file_actions/rollback","modules/clean/react/files_view/file_actions/snackbars","modules/clean/react/files_view/types","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/selection","modules/clean/react/snackbar","modules/clean/redux/tests/store","modules/clean/sharing/constants","modules/clean/undo","modules/clean/web_user_action_events","modules/core/cookies","modules/core/exception","modules/core/i18n","modules/core/uri","modules/clean/hql/index","dropbox/proto/hql_events/browse/web_browse"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S,v,E,w,b,y,T,F,I,O,C,P,A,D,R,M,N,L,x,k,U,V,B,H){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),i=r.__importStar(i),s=r.__importStar(s),l=r.__importDefault(l),c=r.__importStar(c),u=r.__importStar(u),_=r.__importStar(_),h=r.__importStar(h),S=r.__importStar(S),b=r.__importStar(b),y=r.__importStar(y),T=r.__importStar(T),O=r.__importStar(O);t.appInit=function(e){var t=e.experiments,r=e.shouldShowDeletedFiles,o=e.user,n=e.viewer;return function(e,i){e({type:g.ActionTypes.APP_INIT,payload:{experiments:t,shouldShowDeletedFiles:r,user:o,viewer:n}});var s=x.Cookies.read(f.BROWSE_SORT_COOKIE_NAME);if(s&&s.indexOf("|")>-1){var l=s.split("|",2),c={sortField:l[0],sortDirection:l[1]},d=h.sortOrder(i());c.sortDirection===d.sortDirection&&c.sortField===d.sortField||e(q({sortOrder:c}))}a.Dispatcher.dispatch({type:w.UploaderActionType.SET_USER,data:{user:o}})}},t.pushBoltIgnore=function(e){return{type:g.ActionTypes.PUSH_BOLT_IGNORE,payload:e}},t.popBoltIgnore=function(e){return{type:g.ActionTypes.POP_BOLT_IGNORE,payload:e}},t.selectFilesByFqPath=function(e){var t=e.fqPathsToSelect;return{type:g.ActionTypes.SELECT_FILES_BY_FQ_PATH,payload:{fqPathsToSelect:t}}},t.setCanDisplayFolderSizes=function(e){var t=e.canDisplayFolderSizes;return{type:g.ActionTypes.SET_CAN_DISPLAY_FOLDER_SIZES,payload:{canDisplayFolderSizes:t}}},t.setClipboardFiles=function(e){var t=e.clipboardFiles;return{type:g.ActionTypes.SET_CLIPBOARD_FILES,payload:{clipboardFiles:t}}},t.copyFilesToClipboard=function(e){var r=e.files;return function(e,o){if(r.length)if(r.some((function(e){return e.isDeleted})))D.Snackbar.fail(U.intl.formatMessage({id:"jz7l+d",defaultMessage:"Deleted files cannot be added to the clipboard"}),"browse-clipboard-copy");else if(r.some(v.File.isTeamSharedFolder))D.Snackbar.fail(U.intl.formatMessage({id:"z6Evp9",defaultMessage:"Team Folders can’t be copied."}),"browse-clipboard-copy");else{var n=U.intl.formatMessage({id:"kUy5U4",defaultMessage:"{count, plural, one{Added {count} item to clipboard} other{Added {count} items to clipboard}}"},{count:r.length});D.Snackbar.complete(n,"browse-clipboard-copy"),e(t.setClipboardFiles({clipboardFiles:r}))}}},t.pasteFilesFromClipboard=function(e){var t=e.copyFiles;return function(e,r){t({user:h.user(r()),files:h.clipboardFiles(r()),newPath:h.path(r()),checkFSWs:!0,dataApi:u,onSuccess:function(e){var t=U.intl.formatMessage({id:"c+Kw+g",defaultMessage:"{count, plural, one{Pasted {count} item from clipboard} other{Pasted {count} items from clipboard}}"},{count:e.length});D.Snackbar.complete(t,"browse-clipboard-paste")}})}},t.setContext=function(e){var t=e.context;return{type:g.ActionTypes.SET_CONTEXT,payload:{context:t}}},t.setBrowsePostTTIExperiments=function(e){var t=e.browsePostTTIExperiments;return{type:g.ActionTypes.SET_BROWSE_POST_TTI_EXPERIMENTS,payload:{browsePostTTIExperiments:t}}};var W=function(e){var t=e.fileJumpFilter;return{type:g.ActionTypes.SET_FILE_JUMP_FILTER,payload:{fileJumpFilter:t}}};t.addFileJumpKeyCode=function(e){var r=e.keyChar;return function(e,o){var n=h.fileJumpFilter(o())+r.toLowerCase();e(W({fileJumpFilter:n}));for(var i=null,s=0,a=h.fileJumpIndex(o());s<a.length;s++){var l=a[s],c=l.fqPath;if(l.filename>=n){i=c;break}}null!=i&&e(t.selectFilesByFqPath({fqPathsToSelect:[i]}))}},t.resetFileJumpFilter=function(){return function(e,t){d.logKeyboardShortcutUsage({user_id:h.user(t()).id,keyboard_shortcut_type:"jump",view_type:y.viewType(t())}),e(W({fileJumpFilter:""}))}},t.setFilePathsToSelectOnNextUpdate=function(e){var t=e.filePathsToSelectOnNextUpdate;return{type:g.ActionTypes.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE,payload:{filePathsToSelectOnNextUpdate:t}}},t.setIsRewindButtonEnabled=function(e){return function(t,o){return r.__awaiter(void 0,void 0,void 0,(function(){var o,n,i;return r.__generator(this,(function(r){switch(r.label){case 0:return o=e.path,n=e.userId,e.userSkuHasRewind?[4,u.isRewindButtonEnabled(o,n)]:(t({type:g.ActionTypes.SET_IS_REWIND_ENABLED,payload:{value:!0}}),[2]);case 1:return i=r.sent(),t({type:g.ActionTypes.SET_IS_REWIND_ENABLED,payload:{value:!!i.can_rewind}}),[2]}}))}))}},t.showRewind=function(){return{type:g.ActionTypes.SHOW_TIMELINE,payload:{timestamp:(new Date).getTime()}}},t.hideRewind=function(){return{type:g.ActionTypes.HIDE_TIMELINE,payload:{}}},t.showFolderHistoryPanel=function(){return{type:g.ActionTypes.SHOW_FOLDER_HISTORY_PANEL,payload:{timestamp:(new Date).getTime()}}},t.hideFolderHistoryPanel=function(){return{type:g.ActionTypes.HIDE_FOLDER_HISTORY_PANEL,payload:{}}},t.refreshPinnedItems=function(){return function(e,t){return r.__awaiter(void 0,void 0,void 0,(function(){var o;return r.__generator(this,(function(r){return"V2"!==h.experiments(t()).browseWebFolderOverview&&"V3"!==h.experiments(t()).browseWebFolderOverview||(o=_.folderOverviewFolderFileId(t()),e(P.reloadContentReferences({folderFileId:o,componentNamespace:f.BrowseFolderOverviewComponentNamespace}))),[2]}))}))}},t.deleteFiles=function(e){var o=e.files,n=e.checkFSWs;return function(e,i){return r.__awaiter(void 0,void 0,void 0,(function(){var a,l,u,p,f,_,m,g,E,w,b,F,C,P,A,R,M,x;return r.__generator(this,(function(k){switch(k.label){case 0:return a=h.user(i()),l=h.path(i()),u=h.shouldShowDeletedFiles(i()),p=function(e){var t=e.eventName,r=e.num_files_selected,o=e.num_folders_selected,n=e.error_summary;d.logBrowseAction({uid:a.id,action:t,num_files_selected:r,num_folders_selected:o,view_type:y.viewType(i()),error_summary:n})},D.Snackbar.sync(U.intl.formatMessage({id:"VWSqi0",defaultMessage:"{count, plural, one{Deleting {count} item...} other{Deleting {count} items...}}"},{count:o.length}),!0,"browse-action"),1!==o.length||u||e(t.pushBoltIgnore({removed:new Set([o[0].fq_path])})),[4,T.deleteFiles(o,a.id,n)];case 1:return(f=k.sent()).isError?("path"===f.error[".tag"]&&"file_system_warnings"===f.error.path[".tag"]?(D.Snackbar.close("browse-action"),c.showFileSystemWarningsModal({fsws:f.error.path.details,onFinalAccept:function(){e(t.deleteFiles({files:o,checkFSWs:!1}))},confirmText:U.intl.formatMessage({id:"9v2+SN",defaultMessage:"Delete"})})):(1!==o.length||u||e(t.popBoltIgnore({removed:new Set([o[0].fq_path])})),D.Snackbar.fail(O.deleteError(o.length,f.error),"browse-action")),_=h.selectedFiles(i()),m=S.countFilesAndFolders(_),g=m.num_files_selected,E=m.num_folders_selected,p({eventName:L.WebUserActionLogEvent.DELETE_REQUEST_FAIL,num_files_selected:g,num_folders_selected:E,error_summary:f.error_summary})):(w=function(e){return"success"===e[".tag"]},b=f.result.entries.filter(w),s.paths_are_equal(h.path(i()),l)&&(F=b.map((function(e){return e.metadata.path_display})),C=h.unsortedFiles(i()),P=F.reduce((function(e,t){if(void 0===t)return e;var o=C.get(t);return u&&void 0!==o?e.set(t,new v.File(r.__assign(r.__assign({},o),{isDeleted:!0}))):e.delete(t)}),C),e(t.setUnsortedFiles({unsortedFiles:P}))),A=function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(e){return D.Snackbar.close("browse-action"),p({eventName:L.WebUserActionLogEvent.DELETE_UNDO,num_files_selected:f.result.changeset_data.length,num_folders_selected:0}),I.rollback({changeset_data:f.result.changeset_data,userId:a.id,onSuccess:function(){D.Snackbar.complete(U.intl.formatMessage({id:"xEfCmY",defaultMessage:"Delete undone."}),"browse-action"),p({eventName:L.WebUserActionLogEvent.DELETE_UNDO_REQUEST_SUCCESS,num_files_selected:f.result.changeset_data.length,num_folders_selected:0})}}),[2]}))}))},N.setHandleUndo(A),R=function(e){return"failure"===e[".tag"]},M=f.result.entries.filter(R),x=M.length>0?M[0].failure[".tag"]:void 0,M.length===f.result.entries.length?(D.Snackbar.fail(O.deleteCompleteError(M),"browse-action"),p({eventName:L.WebUserActionLogEvent.DELETE_REQUEST_FAIL,num_files_selected:f.result.changeset_data.length,num_folders_selected:0,error_summary:x})):(D.Snackbar.completeWithUndo(O.deleteCompleteSuccess(o.length,b.length),A,"browse-action"),p({eventName:L.WebUserActionLogEvent.DELETE_REQUEST_SUCCESS,num_files_selected:f.result.changeset_data.length,num_folders_selected:0,error_summary:x}))),[2]}}))}))}},t.renameFile=function(e){var o=e.file,n=e.name,i=e.checkFSWs;return function(e,a){return r.__awaiter(void 0,void 0,void 0,(function(){var l,u,p,f,_,m;return r.__generator(this,(function(g){switch(g.label){case 0:return-1!==n.indexOf("/")?(D.Snackbar.fail(U.intl.formatMessage({id:"rBgywO",defaultMessage:"Name was invalid."}),"browse-action"),e(b.setFileRename({file:o,renameState:null})),[2]):(l=h.user(a()),u=function(e,t,r){var o=h.selectedFiles(a()),n=S.countFilesAndFolders(o),i=n.num_files_selected,s=n.num_folders_selected;d.logBrowseAction({uid:l.id,action:e,num_files_selected:i,num_folders_selected:s,view_type:y.viewType(a()),result:t,error_summary:r})},-1!==n.indexOf("/")?(D.Snackbar.fail(U.intl.formatMessage({id:"rBgywO",defaultMessage:"Name was invalid."}),"browse-action"),e(b.setFileRename({file:o,renameState:null})),u(L.WebUserActionLogEvent.RENAME_REQUEST_FAIL,o,'Name contained "/"'),[2]):(e(b.setFileRename({file:o,renameState:C.RenameState.SAVING_INPUT})),p=h.path(a()),D.Snackbar.sync(U.intl.formatMessage({id:"gHw4XG",defaultMessage:"Renaming"}),!1,"browse-action"),e(t.pushBoltIgnore({moved:new Set([o.fq_path])})),[4,T.renameFile(o,n,l,i)]));case 1:return(f=g.sent()).isError?(e(t.popBoltIgnore({moved:new Set([o.fq_path])})),"to"===f.error[".tag"]&&"file_system_warnings"===f.error.to[".tag"]?(D.Snackbar.close("browse-action"),c.showFileSystemWarningsModal({fsws:f.error.to.details,onFinalAccept:function(){e(t.renameFile({file:o,name:n,checkFSWs:!1}))},onAbortAction:function(){e(b.setFileRename({file:o,renameState:null}))},confirmText:U.intl.formatMessage({id:"0/TLiY",defaultMessage:"Rename"})})):(e(b.setFileRename({file:o,renameState:null})),D.Snackbar.fail(O.renameError(f.error,o.fq_path),"browse-action")),u(L.WebUserActionLogEvent.RENAME_REQUEST_FAIL,o,f.error_summary)):(_=F.fileFromMetadata(o,f.result.metadata),s.paths_are_equal(h.path(a()),p)&&(e(t.setUnsortedFiles({unsortedFiles:h.unsortedFiles(a()).remove(o.fq_path).set(_.fq_path,_)})),e(t.refreshPinnedItems())),e(t.selectFilesByFqPath({fqPathsToSelect:[_.fq_path]})),e(b.setFileRename({file:o,renameState:null})),m=function(){return r.__awaiter(void 0,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){switch(r.label){case 0:return D.Snackbar.sync(U.intl.formatMessage({id:"0YL7Ex",defaultMessage:"Undoing rename..."}),!1,"browse-action"),e(t.pushBoltIgnore({added:new Set([o.fq_path]),removed:new Set([_.fq_path])})),u(L.WebUserActionLogEvent.RENAME_UNDO,o),[4,T.undo(f.result.changeset_data,l)];case 1:return(n=r.sent()).isError?(D.Snackbar.fail(U.intl.formatMessage({id:"AADwou",defaultMessage:"Undo failed."}),"browse-action"),e(t.popBoltIgnore({added:new Set([o.fq_path]),removed:new Set([_.fq_path])})),u(L.WebUserActionLogEvent.RENAME_UNDO_REQUEST_FAIL,o,n.error_summary)):(D.Snackbar.complete(U.intl.formatMessage({id:"kdpznu",defaultMessage:"Rename undone."}),"browse-action"),s.paths_are_equal(h.path(a()),p)&&(e(t.setUnsortedFiles({unsortedFiles:h.unsortedFiles(a()).remove(_.fq_path).set(o.fq_path,o)})),e(t.refreshPinnedItems())),e(t.selectFilesByFqPath({fqPathsToSelect:[o.fq_path]})),u(L.WebUserActionLogEvent.RENAME_UNDO_REQUEST_SUCCESS,o)),[2]}}))}))},N.setHandleUndo(m),D.Snackbar.completeWithUndo(U.intl.formatMessage({id:"sAZa2U",defaultMessage:"Rename complete."}),m,"browse-action"),u(L.WebUserActionLogEvent.RENAME_REQUEST_SUCCESS,_)),[2]}}))}))}},t.createFolder=function(e){var o=e.pathName,n=e.folderName,s=e.checkFSWs,a=e.showShareModalOnSuccess,l=e.redirectOnSuccess,c=e.redirectOnCancel,d=e.selectCreatedFolder,u=void 0===d||d,p=e.origin;return function(e,d){return r.__awaiter(void 0,void 0,void 0,(function(){var f,_,m;return r.__generator(this,(function(r){switch(r.label){case 0:return f=h.user(d()),e(t.setNewFolderCreationState({newFolderCreationState:C.NewFolderCreationState.SAVING_INPUT})),[4,i.createFolder({destination:o,name:n,user:f,checkFsw:s,origin:p})];case 1:return _=r.sent(),e(t.setNewFolderCreationState({newFolderCreationState:C.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),"success"===_.type?(m=F.folderFromFolderMetadata(_.folder),u&&e(t.selectFilesByFqPath({fqPathsToSelect:[m.fq_path]})),l&&l(m.fq_path),a&&a(m,M.SHARE_ACTION_ORIGIN_TYPE.BROWSE_NEW_FOLDER_MODAL)):c&&c(),[2]}}))}))}},t.setFolderSizes=function(e){var t=e.folderSizes;return{type:g.ActionTypes.SET_FOLDER_SIZES,payload:{folderSizes:t}}},t.setLoadingState=function(e){var t=e.loadingState,r=e.path;return{type:g.ActionTypes.SET_LOADING_STATE,payload:{loadingState:t,path:r}}},t.setMountPoints=function(e){var t=e.mountPoints;return{type:g.ActionTypes.SET_MOUNT_POINTS,payload:{mountPoints:t}}},t.setNewFolderCreationState=function(e){var t=e.newFolderCreationState;return{type:g.ActionTypes.SET_NEW_FOLDER_CREATION_STATE,payload:{newFolderCreationState:t}}},t.setPaginatedTotalNumFiles=function(e){var t=e.paginatedTotalNumFiles;return{type:g.ActionTypes.SET_PAGINATED_TOTAL_NUM_FILES,payload:{paginatedTotalNumFiles:t}}},t.setUrl=function(e){var n=e.path,i=void 0===n?"":n,s=e.qargs;return function(e,n){l.default.push_state(h.urlPrefix(n())+V.URI.encode_parts(i),o.omitBy(r.__assign(r.__assign({},o.pick(E.getQueryArgs(),["d"])),s),o.isUndefined)),e(t.clearSelection({skipLogging:!0}))}},t.setPath=function(e){var t=e.path;return{type:g.ActionTypes.SET_PATH,payload:{path:t}}},t.setPathData=function(e){var r=e.path,o=e.files,i=e.paginatedTotalNumFiles,l=e.context;return function(e,c){if(s.paths_are_equal(r,h.path(c()))){var d=n.Map(o.map((function(e){return[e.fq_path,e]})));e(t.setContext({context:l})),t.setUnsortedFiles({unsortedFiles:d})(e,c,R.mockExtraArguments),e(t.setPaginatedTotalNumFiles({paginatedTotalNumFiles:i})),e(t.clearSelection({skipLogging:!0})),j({unsortedFiles:d})(e,c,R.mockExtraArguments),setTimeout((function(){a.Dispatcher.dispatch({type:f.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:r,files:o}}),a.Dispatcher.dispatch({type:w.UploaderActionType.SET_PATH,data:{path:r,hasPermissionToUploadToFolder:l.isCurrentPathWriteable(),isMovingIntoVault:l.isInsideVaultFolder}})}),1)}}},t.setSelection=function(e){var t=e.selection,r=e.actionSource,o=e.skipLogging;return function(e,n){if(!o){var i=n(),s=S.makeSelectionEvent(h.selection(i),t),a=s.event,l=s.itemId,c=h.selectFileByFullPath(i,{path:l}),u=h.experiments(i).browseWebHqlPilot;if(c){var p=S.countFilesAndFolders(h.selectFilesForSelection(i,{selection:t})),f=p.num_files_selected,_=p.num_folders_selected;u&&a===L.WebUserActionLogEvent.SELECT_ROW&&B.logEvent({eventMessageName:"WebBrowseSelectRow",event:H.hql_events.WebBrowseSelectRow.create({actionSource:r})}),d.logBrowseAction({uid:h.user(i).id,action:a,action_source:r,num_files_selected:f,num_folders_selected:_,view_type:y.viewType(n()),result:c,extra:{entity_type:c.is_dir?"folder":"file"}})}}e({type:g.ActionTypes.SET_SELECTION,payload:{selection:t,actionSource:r}}),G(e,n,t)}},t.clearSelection=function(e){var r=void 0===e?{}:e,o=r.actionSource,n=r.skipLogging;return t.setSelection({actionSource:o,skipLogging:n,selection:A.createSelection()})},t.setShouldShowDeletedFiles=function(e){var t=e.shouldShowDeletedFiles;return{type:g.ActionTypes.SET_SHOULD_SHOW_DELETED_FILES,payload:{shouldShowDeletedFiles:t}}};var q=function(e){var t=e.sortOrder;return{type:g.ActionTypes.SET_SORT_ORDER,payload:{sortOrder:t}}};t.setAndStoreSortOrder=function(e){return function(t,r){x.Cookies.delete(f.BROWSE_SORT_COOKIE_NAME);var o=e.sortField+"|"+e.sortDirection;x.Cookies.create(f.BROWSE_SORT_COOKIE_NAME,o,1095),t(q({sortOrder:e}))}},t.setUnsortedFiles=function(e){var t=e.unsortedFiles;return function(e,o){return r.__awaiter(void 0,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){return n=h.user(o()),e({type:g.ActionTypes.SET_UNSORTED_FILES,payload:{unsortedFiles:t}}),p.asyncExtensions.initializeStore(n,t.toArray()),[2]}))}))}},t.requestFolderSizes=function(e){var t=e.fqPath;return{type:g.ActionTypes.REQUEST_FOLDER_SIZES,payload:{fqPath:t}}},t.setFolderSizesPending=function(e){var t=e.fetchFolderSizesResp;return{type:g.ActionTypes.SET_FOLDER_SIZES_PENDING,payload:{fetchFolderSizesResp:t}}},t.completeFolderSizes=function(e){var t=e.fetchFolderSizeState;return{type:g.ActionTypes.COMPLETE_FOLDER_SIZES,payload:{fetchFolderSizeState:t}}},t.applyBoltUpdates=function(e){var r=e.updates,o=e.setPath;return function(e,n){var i=r.parent_changes,l=h.user(n());if(i&&i.change_to_fq_path)return m.showUserNotificationForPathChange(l,i),void t.setUrl({path:i.change_to_fq_path})(e,n,R.mockExtraArguments);(function(e,r,o,n){var i=o.mount_points,s=h.path(r()),a=m.getMountPointUpdateForCurrentPath(i,s,h.mountPoints(r())),l=a[0],c=a[1];l&&!c&&D.Snackbar.complete(U.intl.formatMessage({id:"QB9ZqK",defaultMessage:"The folder was unshared."}),"browse-unshare");var d=m.getPathForNewMountPoint(l,c,s);if(d)return void n({path:d});e(t.setMountPoints({mountPoints:i}))})(e,n,r,o),(function(e,r,o){var n=o.added,i=o.moved,l=o.removed,c=h.path(r()),d=h.unsortedFiles(r()),u=h.folderSizes(r()),p=d.size,_={added:new Set([]),moved:new Set([]),removed:new Set([])};e(t.popBoltIgnore(_)),(d=d.withMutations((function(e){u=u.withMutations((function(t){for(var r=function(t){(function(e){return s.paths_are_equal(s.parent_dir(e.fq_path),c)})(t)&&(e.set(t.fq_path,v.File.fromServerObject(t)),p+=1)},o=function(o,n){var i=e.get(o);if(!(i&&i.sjid>=n.sjid&&o===n.fq_path)){e.remove(o),r(n);var s=t.get(o);s&&(t.remove(o),t.set(n.fq_path,s))}},a=0,d=n;a<d.length;a++){var u=d[a];e.has(u.fq_path)?o(u.fq_path,u):r(u)}for(var f=0,_=i;f<_.length;f++){var m=_[f],h=m[0];u=m[1];e.has(h)?o(h,u):r(u)}for(var g=function(r){var o=e.find((function(e){return e.fq_path.toLowerCase()===r.toLowerCase()}));o&&(function(r){e.remove(r),t.remove(r),p-=1})(o.fq_path)},S=0,E=l;S<E.length;S++){g(h=E[S])}}))}))).size!==p&&k.reportException({err:new Error("applyBoltUpdates ended up with unexpected number of items"),tags:["browse_file_collections_mismatch"],severity:k.SEVERITY.CRITICAL,exc_extra:{expected_unsorted_files_size:p,actual_unsorted_files_size:d.size,is_deleted_files_on:h.shouldShowDeletedFiles(r()),filesAdded:n,filesRemoved:l,filesMove:i}});d!==h.unsortedFiles(r())&&(t.setUnsortedFiles({unsortedFiles:d})(e,r,R.mockExtraArguments),a.Dispatcher.dispatch({type:f.SharedWithActionType.BROWSE_FILES_UPDATED,data:{parentPath:c,files:d.toArray()}}));u!==h.folderSizes(r())&&e(t.setFolderSizes({folderSizes:u}));j({unsortedFiles:d})(e,r,R.mockExtraArguments)})(e,n,r)}};var j=function(e){var r=e.unsortedFiles;return function(e,o){var i=h.filePathsToSelectOnNextUpdate(o()).toArray(),s=i.filter((function(e){return r.has(e)})),a=i.filter((function(e){return!r.has(e)}));0!==s.length&&(e(t.selectFilesByFqPath({fqPathsToSelect:s})),e(t.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:n.Set(a)})))}};t.appendFiles=function(e){var r=e.path,o=e.files;return function(e,i){if(s.paths_are_equal(r,h.path(i()))){var l=h.unsortedFiles(i()).size,c=h.unsortedFiles(i()).merge(n.Map(o.map((function(e){return[e.fq_path,e]}))));t.setUnsortedFiles({unsortedFiles:c})(e,i,R.mockExtraArguments),j({unsortedFiles:c})(e,i,R.mockExtraArguments),setTimeout((function(){a.Dispatcher.dispatch({type:f.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:r,files:o}})}),1),c.size!==l+o.length&&k.reportException({err:new Error("appendFiles ended up with unexpected number of files."),tags:["browse_file_collections_mismatch"],severity:k.SEVERITY.CRITICAL,exc_extra:{previous_unsorted_files_size:l,incoming_files_size:o.length,updated_unsorted_files_size:c.size,is_deleted_files_on:h.shouldShowDeletedFiles(i())}})}}},t.setIsFileViewerShown=function(e){var t=e.isShown;return{type:g.ActionTypes.SET_IS_FILE_VIEWER_SHOWN,payload:{isShown:t}}};var G=function(e,t,r){if(r&&0!==r.selected.count()){var o=h.unsortedFiles(t()),n=null==o?void 0:o.filter((function(e){return r.selected.has(e.fq_path)&&!e.thumbnail_url_tmpl})),i=[];if(null==n||n.forEach((function(e){i.push({file_id:e.file_id,sj_id:e.sjid,ns_id:e.ns_id})})),i.length>0){var s=h.user(t()).id;e(b.loadPreviewThumbnails(i,s))}}}})),define("modules/clean/react/browse/data/helpers",["require","exports","tslib","external/lodash","modules/clean/filepath","modules/clean/react/browse/data/selectors","modules/clean/react/snackbar","modules/core/i18n"],(function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),i=r.__importStar(i),t.showUserNotificationForPathChange=function(e,t){switch(null!=t.change_type?t.change_type.toLowerCase():null){case"moved":s.Snackbar.complete(a.intl.formatMessage({id:"dte+6z",defaultMessage:"This folder has been moved"}),"browse-notification");break;case"renamed":s.Snackbar.complete(a.intl.formatMessage({id:"y/ubfn",defaultMessage:"This folder has been renamed to “{folder_name}”"},{folder_name:r(t.change_to_fq_path)}),"browse-notification");break;case"deleted":s.Snackbar.fail(a.intl.formatMessage({id:"MK7bBv",defaultMessage:"The folder “{folder_name}” has been deleted"},{folder_name:r(t.old_fq_path)}),"browse-notification")}function r(e){return o.escape(n.filename(e))}},t.getMountPointUpdateForCurrentPath=function(e,t,r){var n,i,s=function(e){return t===e};return r&&r.find(s)?(i=r.find(s)||null,n=e[r.findKey(s)]||null):(i=null,n=o.find(e,s)||null),[i,n]},t.getPathForNewMountPoint=function(e,t,r){return e&&!t?r:e&&t?n.paths_are_equal(e,t)?null:t:!e&&t?r:null},t.getIndexOfFile=function(e,t){return i.sortedFiles(t).findIndex((function(t){return t.sjid===e.sjid&&t.ns_id===e.ns_id}))}})),define("modules/clean/react/browse/data/reducer",["require","exports","tslib","immutable","dropbox/proto/js_init_data/browse_web/browse_web","modules/clean/filepath","modules/clean/react/browse/data/types","modules/clean/react/browse/models","modules/clean/react/files_view/types","modules/clean/react/selection","modules/core/exception"],(function(e,t,r,o,n,i,s,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),i=r.__importStar(i),t.defaultBrowseState={boltIgnore:{added:new Set,moved:new Set,removed:new Set},canDisplayFolderSizes:!1,clipboardFiles:[],context:new a.BrowseContext,isRewindButtonEnabled:!1,experiments:n.browse_web.BrowseExperiments.create(),browsePostTTIExperiments:{},fileJumpFilter:"",filePathsToSelectOnNextUpdate:o.Set(),folderSizes:o.Map(),isRewindVisible:!1,isFolderHistoryVisible:!1,clickRewindTimestamp:void 0,clickFolderHistoryTimestamp:void 0,loadingState:l.LoadingState.LOADING_FIRST_PAGE,mountPoints:null,newFolderCreationState:l.NewFolderCreationState.CREATE_FOLDER_INACTIVE,paginatedTotalNumFiles:0,path:"",selection:c.createSelection(),shouldShowDeletedFiles:!1,sortOrder:{sortField:l.SortField.FILENAME,sortDirection:l.SortDirection.ASCENDING},user:null,unsortedFiles:o.Map(),viewer:null,currentFolderSizesQuery:o.Set(),isQueryingFolderSizes:!1,isSearchMode:!1},t.browseReducer=function(e,n){switch(void 0===e&&(e=t.defaultBrowseState),n.type){case s.ActionTypes.APP_INIT:return(function(e,t){var o=t.payload,n=o.experiments,i=o.shouldShowDeletedFiles,s=o.user,a=o.viewer;return d.assert(null===e.user,"Cannot reinitialize Browse store; changing invariants such as `user` is untested"),r.__assign(r.__assign({},e),{experiments:n,shouldShowDeletedFiles:i,user:s,viewer:a})})(e,n);case s.ActionTypes.PUSH_BOLT_IGNORE:return(function(e,t){var o=e.boltIgnore,n=o.added,i=o.moved,s=o.removed;return t.payload.added&&(n=new Set(n),t.payload.added.forEach((function(e){return n.add(e)}))),t.payload.moved&&(i=new Set(i),t.payload.moved.forEach((function(e){return i.add(e)}))),t.payload.removed&&(s=new Set(s),t.payload.removed.forEach((function(e){return s.add(e)}))),r.__assign(r.__assign({},e),{boltIgnore:{added:n,moved:i,removed:s}})})(e,n);case s.ActionTypes.POP_BOLT_IGNORE:return(function(e,t){var o=e.boltIgnore,n=o.added,i=o.moved,s=o.removed;return t.payload.added&&(n=new Set(n),t.payload.added.forEach((function(e){return n.delete(e)}))),t.payload.moved&&(i=new Set(i),t.payload.moved.forEach((function(e){return i.delete(e)}))),t.payload.removed&&(s=new Set(s),t.payload.removed.forEach((function(e){return s.delete(e)}))),r.__assign(r.__assign({},e),{boltIgnore:{added:n,moved:i,removed:s}})})(e,n);case s.ActionTypes.SELECT_FILES_BY_FQ_PATH:return(function(e,t){var n=t.payload.fqPathsToSelect.map((function(e){return e.toLowerCase()})),i=e.unsortedFiles.toList().filter((function(e){return n.includes(e.fq_path.toLowerCase())})).map((function(e){return e.fq_path})),s=o.OrderedSet(i),a=i.size?i.get(0):null;return r.__assign(r.__assign({},e),{selection:e.selection.set("selected",s).set("anchor",a)})})(e,n);case s.ActionTypes.SET_CAN_DISPLAY_FOLDER_SIZES:return(function(e,t){var o=t.payload.canDisplayFolderSizes;return r.__assign(r.__assign({},e),{canDisplayFolderSizes:o})})(e,n);case s.ActionTypes.SET_CLIPBOARD_FILES:return(function(e,t){var o=t.payload.clipboardFiles;return r.__assign(r.__assign({},e),{clipboardFiles:o})})(e,n);case s.ActionTypes.SET_CONTEXT:return(function(e,t){var o=t.payload.context;return r.__assign(r.__assign({},e),{context:o})})(e,n);case s.ActionTypes.SET_FILE_JUMP_FILTER:return(function(e,t){var o=t.payload.fileJumpFilter;return r.__assign(r.__assign({},e),{fileJumpFilter:o})})(e,n);case s.ActionTypes.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE:return(function(e,t){var o=t.payload.filePathsToSelectOnNextUpdate;return r.__assign(r.__assign({},e),{filePathsToSelectOnNextUpdate:o})})(e,n);case s.ActionTypes.SET_FOLDER_SIZES:return(function(e,t){var o=t.payload.folderSizes;return r.__assign(r.__assign({},e),{folderSizes:o})})(e,n);case s.ActionTypes.SET_LOADING_STATE:return(function(e,t){var n=t.payload,s=n.loadingState,a=n.path;return i.paths_are_equal(a,e.path)?s===l.LoadingState.LOADED?r.__assign(r.__assign({},e),{loadingState:s,filePathsToSelectOnNextUpdate:o.Set()}):r.__assign(r.__assign({},e),{loadingState:s}):e})(e,n);case s.ActionTypes.SET_MOUNT_POINTS:return(function(e,t){var n=t.payload.mountPoints;return r.__assign(r.__assign({},e),{mountPoints:o.Map(n)})})(e,n);case s.ActionTypes.SET_NEW_FOLDER_CREATION_STATE:return(function(e,t){var o=t.payload.newFolderCreationState;return r.__assign(r.__assign({},e),{newFolderCreationState:o})})(e,n);case s.ActionTypes.SET_PAGINATED_TOTAL_NUM_FILES:return(function(e,t){var o=t.payload.paginatedTotalNumFiles;return r.__assign(r.__assign({},e),{paginatedTotalNumFiles:o})})(e,n);case s.ActionTypes.SET_PATH:return(function(e,t){var o=t.payload.path;return r.__assign(r.__assign({},e),{path:o})})(e,n);case s.ActionTypes.SET_SELECTION:return(function(e,t){var o=t.payload.selection;return r.__assign(r.__assign({},e),{selection:o})})(e,n);case s.ActionTypes.SET_SHOULD_SHOW_DELETED_FILES:return(function(e,t){var o=t.payload.shouldShowDeletedFiles;return r.__assign(r.__assign({},e),{shouldShowDeletedFiles:o})})(e,n);case s.ActionTypes.SET_SORT_ORDER:return(function(e,t){var o=t.payload.sortOrder;return r.__assign(r.__assign({},e),{sortOrder:o})})(e,n);case s.ActionTypes.SET_UNSORTED_FILES:return(function(e,t){var o=t.payload.unsortedFiles;return r.__assign(r.__assign({},e),{unsortedFiles:o})})(e,n);case s.ActionTypes.SHOW_TIMELINE:return(function(e,t){return r.__assign(r.__assign({},e),{isRewindVisible:!0,clickRewindTimestamp:t.payload.timestamp})})(e,n);case s.ActionTypes.HIDE_TIMELINE:return(function(e,t){return r.__assign(r.__assign({},e),{isRewindVisible:!1})})(e);case s.ActionTypes.SHOW_FOLDER_HISTORY_PANEL:return(function(e,t){return r.__assign(r.__assign({},e),{isFolderHistoryVisible:!0,clickFolderHistoryTimestamp:t.payload.timestamp})})(e,n);case s.ActionTypes.HIDE_FOLDER_HISTORY_PANEL:return(function(e,t){return r.__assign(r.__assign({},e),{isFolderHistoryVisible:!1})})(e);case s.ActionTypes.SET_IS_FILE_VIEWER_SHOWN:return(function(e,t){return r.__assign(r.__assign({},e),{isFileViewerShown:t.payload.isShown})})(e,n);case s.ActionTypes.SET_IS_REWIND_ENABLED:return(function(e,t){return r.__assign(r.__assign({},e),{isRewindButtonEnabled:t.payload.value})})(e,n);case s.ActionTypes.REQUEST_FOLDER_SIZES:return(function(e,t){var o=t.payload.fqPath;if(e.isQueryingFolderSizes)return e;var n=e.folderSizes.withMutations((function(e){e.set(o,{size:0,state:l.FetchFolderSizeState.LOADING})}));return r.__assign(r.__assign({},e),{folderSizes:n,isQueryingFolderSizes:!0})})(e,n);case s.ActionTypes.SET_FOLDER_SIZES_PENDING:return(function(e,t){var o=t.payload.fetchFolderSizesResp,n=e.currentFolderSizesQuery,i=e.folderSizes.withMutations((function(e){for(var t=function(t){e.update(t.fq_path,{size:0,state:l.FetchFolderSizeState.LOADING},(function(){return{size:t.size,state:l.FetchFolderSizeState.LOADING}})),n=n.withMutations((function(e){return e.add(t.fq_path)}))},r=0,i=o.sizes_dict;r<i.length;r++){t(i[r])}}));return r.__assign(r.__assign({},e),{currentFolderSizesQuery:n,folderSizes:i})})(e,n);case s.ActionTypes.COMPLETE_FOLDER_SIZES:return(function(e,t){var n=t.payload.fetchFolderSizeState,i=e.folderSizes.withMutations((function(t){e.currentFolderSizesQuery.forEach((function(r){var o=e.folderSizes.get(r);o&&t.update(r,(function(){return{size:o.size,state:n}}))}))}));return r.__assign(r.__assign({},e),{currentFolderSizesQuery:o.Set(),folderSizes:i,isQueryingFolderSizes:!1})})(e,n);case s.ActionTypes.SET_BROWSE_POST_TTI_EXPERIMENTS:return(function(e,t){var o=t.payload.browsePostTTIExperiments;return r.__assign(r.__assign({},e),{browsePostTTIExperiments:o})})(e,n)}return e}})),define("modules/clean/react/browse/data/selectors",["require","exports","tslib","immutable","reselect","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/browse/data/reducer","modules/clean/react/browse/models","modules/clean/react/browse/uri_helper","modules/clean/react/browse/util","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/types","modules/clean/react/plusplus/utils","modules/clean/react/vault/lib/browse_utils","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/core/exception"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),i=r.__importStar(i),t.getBrowseState=function(e){return h.getStateAtNamespace(e,m.BROWSE_NAMESPACE_KEY)||a.defaultBrowseState},t.canDisplayFolderSizes=function(e){return t.getBrowseState(e).canDisplayFolderSizes},t.clipboardFiles=function(e){return t.getBrowseState(e).clipboardFiles},t.context=function(e){return t.getBrowseState(e).context},t.experiments=function(e){return t.getBrowseState(e).experiments},t.postTTIExperiments=function(e){return t.getBrowseState(e).browsePostTTIExperiments},t.fileJumpFilter=function(e){return t.getBrowseState(e).fileJumpFilter},t.filePathsToSelectOnNextUpdate=function(e){return t.getBrowseState(e).filePathsToSelectOnNextUpdate},t.folderSizes=function(e){return t.getBrowseState(e).folderSizes},t.isFileJumping=function(e){return t.getBrowseState(e).fileJumpFilter.length>0},t.isQueryingFolderSizes=function(e){return t.getBrowseState(e).isQueryingFolderSizes},t.browseLoadingState=function(e){return t.getBrowseState(e).loadingState},t.mountPoints=function(e){return t.getBrowseState(e).mountPoints},t.newFolderCreationState=function(e){return t.getBrowseState(e).newFolderCreationState},t.path=function(e){return t.getBrowseState(e).path},t.selection=function(e){return t.getBrowseState(e).selection},t.shouldShowDeletedFiles=function(e){return t.getBrowseState(e).shouldShowDeletedFiles},t.sortOrder=function(e){return t.getBrowseState(e).sortOrder},t.boltIgnore=function(e){return t.getBrowseState(e).boltIgnore},t.user=function(e){var r=t.getBrowseState(e).user;return g.assert(null!=r,"Browse store `user` accessed before APP_INIT action"),r},t.viewer=function(e){var r=t.getBrowseState(e).viewer;return g.assert(null!=r,"Browse store `viewer` accessed before APP_INIT action"),r},t.isRewindVisible=function(e){return t.getBrowseState(e).isRewindVisible},t.isFolderHistoryVisible=function(e){return t.getBrowseState(e).isFolderHistoryVisible},t.clickRewindTimestamp=function(e){return t.getBrowseState(e).clickRewindTimestamp},t.clickFolderHistoryTimestamp=function(e){return t.getBrowseState(e).clickFolderHistoryTimestamp},t.isFileViewerShown=function(e){return t.getBrowseState(e).isFileViewerShown},t.isRewindButtonEnabled=function(e){return t.getBrowseState(e).isRewindButtonEnabled},t.browsePostTTIExperiments=function(e){return t.getBrowseState(e).browsePostTTIExperiments||{}},t._unsortedFiles=function(e){return t.getBrowseState(e).unsortedFiles},t.unsortedFiles=n.createSelector(t._unsortedFiles,t.experiments,t.path,(function(e,t,r){return!t.plusPlusEnabled&&t.lifeVault&&_.shouldInjectVaultEntry(r,e)?e.set(_.getVaultFqPath(),_.makeVaultFileEntry()):e})),t.fileJumpIndex=n.createSelector(t.unsortedFiles,(function(e){return e.keySeq().toArray().map((function(e){return{filename:i.filename(e).toLowerCase(),fqPath:e}})).sort((function(e,t){return e.filename<t.filename?-1:e.filename>t.filename?1:0}))})),t.sortedFiles=n.createSelector(t.unsortedFiles,t.sortOrder,t.folderSizes,t.experiments,(function(e,t,r,o){var n=d.sortFiles(e.toList(),t,r);return o.plusPlusEnabled?n.filter((function(e){return!f.isPreSetupPlusFeature(e)})):n})),t.selectedFiles=n.createSelector(t.unsortedFiles,t.selection,(function(e,t){return S(e,t)})),t.selectedFilesForSidebar=n.createSelector(t.selectedFiles,u.previewThumbnails,(function(e,t){return e.count()>0?e.withMutations((function(e){e.forEach((function(o,n){var i;if(!o.thumbnail_url_tmpl&&(null===(i=t[o.file_id])||void 0===i?void 0:i.preview_url)){var s=t[o.file_id].preview_url;e.set(n,new l.File(r.__assign(r.__assign({},o),{thumbnail_url_tmpl:s})))}}))})):e})),t.selectFilesForSelection=function(e,r){return S(t.unsortedFiles(e),r.selection)};var S=function(e,t){return t.selected.isEmpty()||e.isEmpty()?o.OrderedMap():o.OrderedMap(t.selected.map((function(t){var r=e.find((function(e){return e.fq_path===t}));return r?[r.fq_path,r]:void 0})))};t.urlPrefix=n.createSelector(t.user,t.viewer,(function(e,t){return c.browse_root(t,e)})),t.teamFolders=n.createSelector(t.unsortedFiles,t.folderSizes,(function(e,t){var r={sortField:p.SortField.FILENAME,sortDirection:p.SortDirection.ASCENDING};return d.sortFiles(e.toList().filter((function(e){return e.type===s.FileTypes.TEAM_SHARED_FOLDER})),r,t)})),t.sortedFilesWithFolderSizes=n.createSelector(t.sortedFiles,t.folderSizes,(function(e,t){return e.map((function(e){var r=t.get(e.fq_path);return r?e.updateSize(r.size,r.state):e}))})),t.unsortedFilesWithFolderSizes=n.createSelector(t.unsortedFiles,t.folderSizes,(function(e,t){return e.withMutations((function(r){t.forEach((function(t,o){var n=e.get(o);if(n&&t){var i=n.updateSize(t.size,t.state);r.set(o,i)}}))}))})),t.sortedFilesWithFoldersSizesWithoutTeamFolders=n.createSelector(t.sortedFilesWithFolderSizes,(function(e){return e.filter((function(e){return e.type!==s.FileTypes.TEAM_SHARED_FOLDER}))})),t.shouldShowSidebarFolderOverview=n.createSelector(t.selectedFiles,(function(e){return e&&1===e.size&&e.first().is_dir&&!l.File.isNoAccessSharedFolder(e.first())})),t.selectFileByFullPath=function(e,r){return t.sortedFilesWithFolderSizes(e).find((function(e){return e.fq_path===r.path}))},t.preSetupPlusFeatures=n.createSelector(t._unsortedFiles,t.sortOrder,t.folderSizes,(function(e,t,r){return d.sortFiles(e.toList().filter((function(e){return f.isPreSetupPlusFeature(e)})),t,r)}))})),define("modules/clean/react/browse/data/folder_overview_selectors",["require","exports","tslib","modules/clean/react/browse/constants","modules/clean/react/folder_overview/data/selectors","modules/clean/react/browse/data/selectors","reselect","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/types","modules/clean/filepath"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),c=r.__importStar(c);var d=n.makeHaveAllComponentsLoadedSelector(),u=n.makeHasFailedToLoadSelector(),p=n.makeFolderFileIdSelector(),f=n.makeLoggingFileIdSelector(),_=n.makePinnedItemsSelector();t.haveAllComponentsLoaded=function(e){return d(e,{componentNamespace:o.BrowseFolderOverviewComponentNamespace})},t.hasFailedToLoad=function(e){return u(e,{componentNamespace:o.BrowseFolderOverviewComponentNamespace})},t.folderOverviewFolderFileId=function(e){return p(e,{path:i.path(e)})},t.folderOverviewLoggingFileId=function(e){return f(e,{path:i.path(e)})},t.folderOverviewPinnedItems=function(e){return _(e,{path:i.path(e)})},t.loadingState=s.createSelector(i.browseLoadingState,t.haveAllComponentsLoaded,t.hasFailedToLoad,i.experiments,(function(e,t,r,o){return r?e:t||"V1"!==o.browseWebFolderOverview&&"V2"!==o.browseWebFolderOverview&&"V3"!==o.browseWebFolderOverview?e:l.LoadingState.LOADING_FIRST_PAGE})),t.shouldShowPinnedTeamFolders=s.createSelector(i.context,t.loadingState,i.path,i.teamFolders,a.viewType,(function(e,t,r,o,n){return e.showPinnedTeamFolder&&!o.isEmpty()&&c.paths_are_equal(r,"/")&&n===l.ViewType.List&&(t===l.LoadingState.LOADED||t===l.LoadingState.LOADING_REMAINING_PAGES)})),t.emptyFolder=s.createSelector(i.sortedFilesWithFolderSizes,i.sortedFilesWithFoldersSizesWithoutTeamFolders,t.shouldShowPinnedTeamFolders,(function(e,t,r){return 0===(r?t:e).count()})),t.paginatedTotalNumFiles=function(e){return t.loadingState(e)===l.LoadingState.LOADED?i.sortedFiles(e).count():i.getBrowseState(e).paginatedTotalNumFiles}})),define("modules/clean/react/browse/data/store",["require","exports","modules/clean/redux/namespaces","modules/clean/react/browse/data/reducer","modules/clean/redux/store"],(function(e,t,r,o,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForBrowse=function(){var e;return i||(i=n.getStoreAndRegisterReducers(((e={})[r.BROWSE_NAMESPACE_KEY]=o.browseReducer,e))),i}})),define("modules/clean/react/browse/global_actions",["require","exports","tslib","external/lodash","react","modules/clean/analytics","modules/clean/file_actions/create-folder","modules/clean/filepath","modules/clean/filetypes","modules/clean/history","modules/clean/react/async_onboarding_move_modal","modules/clean/react/browse/action_logger","modules/clean/react/browse/actions","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/store","modules/clean/react/delorean/rewinds_upsell_util","modules/clean/react/extensions/data/types","modules/clean/react/extensions/split_share_button","modules/clean/react/file_uploader/utils","modules/clean/react/growth/async_joiner_personal_account_modal","modules/clean/react/modal","modules/clean/sharing/access_level","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/sharing/gating_util","modules/clean/user_education/user_education_client","modules/clean/viewer","modules/clean/web_user_action_events","modules/clean/web_user_action_logger","modules/core/browser","modules/core/browser_detection","modules/core/exception","modules/core/i18n","modules/core/notify"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S,v,E,w,b,y,T,F,I,O,C,P,A,D,R,M,N){"use strict";var L;Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importDefault(n),a=r.__importStar(a),c=r.__importDefault(c),_=r.__importStar(_),A=r.__importStar(A),D=r.__importStar(D),(function(e){e[e.UploadFiles=1]="UploadFiles",e[e.UploadFolder=2]="UploadFolder",e[e.Upload=3]="Upload",e[e.Files=4]="Files",e[e.Folder=5]="Folder",e[e.NewPaperDoc=6]="NewPaperDoc",e[e.NewFolder=7]="NewFolder",e[e.RestoreFolder=8]="RestoreFolder",e[e.ReAddSharedFolder=9]="ReAddSharedFolder",e[e.ShowDeletedFiles=10]="ShowDeletedFiles",e[e.HideDeletedFiles=11]="HideDeletedFiles",e[e.NewSharedFolder=12]="NewSharedFolder",e[e.ShareFolder=13]="ShareFolder",e[e.ShareFolderAbbreviated=14]="ShareFolderAbbreviated",e[e.ManageAsAdmin=15]="ManageAsAdmin",e[e.NewTeamFolder=16]="NewTeamFolder",e[e.RequestFiles=17]="RequestFiles",e[e.FolderHistory=18]="FolderHistory",e[e.RewindFolder=19]="RewindFolder",e[e.RewindDropbox=20]="RewindDropbox"})(L||(L={}));var x={},k=function(e){return e in x||(x[e]=(function(e){switch(e){case L.UploadFiles:return M.intl.formatMessage({id:"Qayhb5",defaultMessage:"Upload files"});case L.UploadFolder:return M.intl.formatMessage({id:"53oUlv",defaultMessage:"Upload folder"});case L.Upload:return M.intl.formatMessage({id:"i98Ff5",defaultMessage:"Upload"});case L.FolderHistory:return M.intl.formatMessage({id:"BxyH89",defaultMessage:"Folder history"});case L.RewindFolder:return M.intl.formatMessage({id:"4Wq7Cq",defaultMessage:"Rewind this folder"});case L.RewindDropbox:return M.intl.formatMessage({id:"hiHRLr",defaultMessage:"Rewind Dropbox"});case L.Files:return M.intl.formatMessage({id:"bObFEu",defaultMessage:"Files"});case L.Folder:return M.intl.formatMessage({id:"MLqiSW",defaultMessage:"Folder"});case L.NewPaperDoc:return M.intl.formatMessage({id:"Jfm8Pe",defaultMessage:"New Paper Document"});case L.NewFolder:return M.intl.formatMessage({id:"pxGZm3",defaultMessage:"New folder"});case L.RestoreFolder:return M.intl.formatMessage({id:"gx89em",defaultMessage:"Restore folder"});case L.ReAddSharedFolder:return M.intl.formatMessage({id:"1YhtdU",defaultMessage:"Re-add shared folder"});case L.ShowDeletedFiles:return M.intl.formatMessage({id:"WR5EDI",defaultMessage:"Show deleted files"});case L.HideDeletedFiles:return M.intl.formatMessage({id:"j500HF",defaultMessage:"Hide deleted files"});case L.NewSharedFolder:return M.intl.formatMessage({id:"J9ZdWw",defaultMessage:"New shared folder"});case L.ShareFolder:return M.intl.formatMessage({id:"aHwEwV",defaultMessage:"Share folder"});case L.ShareFolderAbbreviated:return M.intl.formatMessage({id:"CcpVyl",defaultMessage:"Share"});case L.ManageAsAdmin:return M.intl.formatMessage({id:"SrWnn5",defaultMessage:"View in admin console"});case L.NewTeamFolder:return M.intl.formatMessage({id:"dYs+4Q",defaultMessage:"New team folder"});case L.RequestFiles:return M.intl.formatMessage({id:"QeqSyk",defaultMessage:"Request files"})}})(e)),x[e]},U=new Set([k(L.UploadFiles),k(L.UploadFolder),k(L.NewFolder),k(L.RequestFiles)]),V=function(e,t,r,o,n){return function(){var i=r.currentFQPath;s.logCreateFolder({uid:e.id,view_type:t,origin:f.CREATE_FOLDER_ACTION_ORIGIN_TYPE.BROWSE_NEW_FOLDER_MODAL}),P.WebUserActionLog.log(e.id,C.WebUserActionLogEvent.NEW_FOLDER_CLICK,{});var a=e.is_cdm_member&&"/"===i;if(o&&(a=r.isInsideTeamFolderTree&&!!e.is_team),a){o||R.assert(!!n,"All CDM Users should have an auto team group in their team");var l=function(e){var t=e.pathName,r=e.folderName,o=e.checkFSWs;p.browseActions.createFolder({pathName:t,folderName:r,checkFSWs:o,redirectOnSuccess:p.browseActions.handleNewFolderRedirectOnSuccess,origin:f.CREATE_FOLDER_ACTION_ORIGIN_TYPE.BROWSE_CDM_NEW_FOLDER_MODAL})};y.asyncShowAppropriateNewFolderModalForCdmUser({user:e,context:r,autoTeamGroupId:n,showFileSystemWarningsModal:void 0,onPending:p.browseActions.createFolderPending,onComplete:function(e){e.user,e.folderName;var t=e.fqPath;p.browseActions.createFolderComplete(),p.browseActions.selectFilesByFqPath({fqPathsToSelect:[t]}),p.browseActions.handleNewFolderRedirectOnSuccess(t)},onCancel:function(e){N.Notify.error(e||M.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),p.browseActions.cancelCreateFolder()},autoTeamGroupDefaultAccessLevel:b.ACCESS_LEVEL.WRITER,setUrl:function(e){var t=e.path,r=e.qargs;return m.getStoreForBrowse().dispatch(_.setUrl({path:t,qargs:r}))},handleCreateFolder:l})}else{l=function(t){var o=t.folderName,n=t.isConfidential;p.browseActions.createFolderInNewFolderModal({folderName:o,isConfidential:n,user:e,context:r,redirectOnSuccess:p.browseActions.handleNewFolderRedirectOnSuccess,origin:f.CREATE_FOLDER_ACTION_ORIGIN_TYPE.BROWSE_NEW_FOLDER_MODAL})};y.asyncShowCdmNewFolderModal(l,e,r,!1,!1,!0)}}},B=function(e,t){return function(){P.WebUserActionLog.log(e.id,C.WebUserActionLogEvent.NEW_SHARED_FOLDER_CLICK,{origin:T.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS}),t.isCurrentlyInRoot?y.asyncShowShareAFolderWizardModal(e):y.asyncShowShareModal(e,t,{origin:T.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS},(function(e){var t=e.path,r=e.qargs;return m.getStoreForBrowse().dispatch(_.setUrl({path:t,qargs:r}))}))}},H=function(e,t,r,o){return function(){var n=v.getUploadLocationMetadataToLog(e,o);P.WebUserActionLog.log(e.id,C.WebUserActionLogEvent.SHOW_DELETED_FILES_CLICK,n),u.logToggleDeletedFiles({uid:e.id,show_deleted_files:!r,view_type:t}),p.browseActions.setShouldShowDeletedFiles({shouldShowDeletedFiles:!r})}},W=function(e,t,r){return function(){var o=r.currentNSID,n=r.currentFQPath;u.logRestore({uid:e.id,view_type:t,file_nsid:o,file_path:n,file_name:a.filename(n),num_files_selected:0,num_folders_selected:1}),p.browseActions.doRestoreFilesWithUnifiedTrashModal({})}},q=function(e,t){return function(){var r=t.currentFQPath.toLowerCase(),o=t.inactiveNSIDByFQPath[r],n=t.isInsideDeletedNestedSharedFolder;o&&y.asyncMountSharedFolder(o,e.role,T.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS,!1,null,n)}},j=function(t,o){return function(){(function(t){r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(o){switch(o.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/sharing/content_manager"],t,r)})).then(r.__importStar)];case 1:return(0,o.sent().goToContentManagerForPath)(t),[2]}}))}))})({containingFolder:o.currentFQPath})}},G=function(e,t){return function(){var r=v.getUploadLocationMetadataToLog(e,t.currentFQPath);P.WebUserActionLog.log(e.id,C.WebUserActionLogEvent.VIEW_IN_ADMIN_CONSOLE_CLICK,r),j(0,t)()}};function z(e){return function(){var t=e.currentNSID,r=e.currentNSPath;A.redirect("/requests?ns_id="+t+"&path="+r+"&referrer=web_browse_global_action")}}function K(e){return function(){u.logBrowseAction({uid:e.id,action:C.WebUserActionLogEvent.OPEN_SPLITSHARE,num_files_selected:0,num_folders_selected:0,action_surface:C.ActionSurfaceLogValue.RIGHT_SIDEBAR,action_source:C.ActionSourceValue.SPLIT_SHARE})}}function Y(e){return function(t){u.logBrowseAction({uid:e.id,action:C.WebUserActionLogEvent.SHARE,num_files_selected:0,num_folders_selected:0,action_surface:C.ActionSurfaceLogValue.RIGHT_SIDEBAR,action_source:C.ActionSourceValue.SPLIT_SHARE,extra:{splitshare_option:t}})}}function Q(e,t){var r=[],o=D.is_input_webkitdirectory_supported(),n={className:"action-upload",label:k(L.UploadFiles),popoverLabel:k(L.Files),iconName:o?"upload-file":"upload",performAction:function(){return t(!1)},disabled:!e,key:"upload-files"};if(r.push(n),o){var i={className:"action-upload",label:k(L.UploadFolder),popoverLabel:k(L.Folder),iconName:"upload-folder",performAction:function(){return t(!0)},disabled:!e,key:"upload-folder"};r.push(i)}return r}t.getGlobalActions=function(e){var t=e.context,r=e.user,s=e.viewType,a=e.showDeletedFiles,u=e.onUpload,p=void 0===u?o.noop:u,v=e.isNoComment,b=void 0!==v&&v,y=e.autoTeamGroupId,T=e.browseExperiments,C=e.isRewindButtonEnabled,P=e.expFolderHistoryRollbacks,A=e.responsive,D=e.hideRightsideActions,R=void 0!==D&&D,M=t.isCurrentlyInRoot,N=!t.canViewContainingNSMembers,x=t.isCurrentPathWriteable(),X=[];if(t.isInsideTeamFolderTree||!t.isInsideDeletedSharedFolder&&!t.isInsideDeletedNestedSharedFolder)if(t.isInsideDeletedFolder)X.push({action:{label:k(L.RestoreFolder),iconName:"restore",className:"action-restore",performAction:W(r,s,t),disabled:!x,key:"restore-folder"},isPrimary:!0});else{var J={label:k(L.NewFolder),iconName:"new-folder",performAction:V(r,s,t,T.goldenGateRaclsEnabled,y),disabled:!x,className:"action-new-folder",key:"new-folder"},Z={action:J,isPrimary:!1},$={label:k(M?L.NewSharedFolder:L.ShareFolderAbbreviated),iconName:"new-shared-folder",performAction:B(r,t),disabled:N,className:"action-share-folder",key:"new-shared-folder"},ee={file_id:"ns:"+t.currentNSID+t.currentNSPath,fq_path:t.currentFQPath,is_dir:!0,type:l.FileTypes.FOLDER,icon:"",is_cloud_doc:!1,is_symlink:!1},te={action:function(){return n.default.createElement(S.SplitShareButton,{file:ee,user:r,variant:"secondary",triggerType:g.TriggerType.SidebarPrimaryButton,onShowShare:B(r,t),logShareButtonClick:Y(r),onDropdownOpen:K(r),context:{surface:"browse"},shareButtonLabel:k(L.ShareFolder)})},isPrimary:!0},re={action:$,isPrimary:!1},oe={action:{label:k(L.NewTeamFolder),iconName:"new-team-folder",performAction:j(0,t),disabled:!1,className:"action-team-folder",key:"new-team-folder"},isPrimary:!1},ne=T.growthActSmbCreateConsolidation,ie=A&&A.isMatchedLarge&&("V1"===ne||"V2"===ne),se=ie&&"V2"===ne?[]:Q(x,p).map((function(e){return{action:e,isPrimary:!1}}));if(r.is_cdm_member&&"/"===t.currentFQPath){I.UEClient.registerBulkCallbackForEducationStep([{moduleName:"trial_admin_setup_team_space",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_v2",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_mobile",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_mobile_v2",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_folder_structure",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_folder_structure_v2",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_free_order",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_free_order_v2",stepName:"team_folder_modal"}],J.performAction);var ae=function(e){i.TeamsWebActionsLogger.log(e),window.setTimeout((function(){I.UEClient.sendEvent("SetStructureModal","Close")}),2500),w.Modal.close()},le=function(){return{user:r,teamName:O.Viewer.get_viewer().team_name,onSuccess:function(){return ae("uj_ss_modal_success")},onError:function(){return ae("uj_ss_modal_error")},onCancel:function(){return ae("uj_ss_modal_cancel")}}};I.UEClient.registerBulkCallbackForEducationStep([{moduleName:"trial_admin_shared_workspace",stepName:"set_structure_modal"},{moduleName:"trial_admin_shared_workspace_v2",stepName:"set_structure_modal"},{moduleName:"trial_admin_shared_workspace_free_order",stepName:"set_structure_modal"},{moduleName:"trial_admin_shared_workspace_free_order_v2",stepName:"set_structure_modal"}],(function(){d.showOnboardingMoveDialog(le())})),I.UEClient.registerCallbackForEducationStep("joiner_checklist_shared_workspace_files_decision","set_structure_modal",(function(){d.showOnboardingMoveDialogV2(le())})),I.UEClient.registerCallbackForEducationStep("joiner_checklist_inform_personal_account","team_space_tooltip",(function(){E.asyncWarmJoinerModalProps(r)})),I.UEClient.registerCallbackForEducationStep("joiner_checklist_inform_personal_account","joiner_personal_account_success_modal",(function(){E.asyncShowJoinerPersonalAccountModal(r)})),X.push.apply(X,se),ie||X.push(Z)}else M?(X.push.apply(X,se),!r.is_cdm_member&&F.GoldenGate.hasContentManagerAndSuperAdmin(r.id)&&X.push(oe),ie||X.push(Z,re)):(t.isInsideSandboxFolder||t.isInsideVaultFolder||X.push(te),X.push.apply(X,se),ie||X.push(Z));!x||r.is_cdm_member&&"/"===t.currentFQPath||X.push({action:{label:k(L.RequestFiles),iconName:"new-file-request",performAction:z(t),key:"new-file-request"},isPrimary:!1}),b||R||X.push({action:{label:k(a?L.HideDeletedFiles:L.ShowDeletedFiles),iconName:a?"hide":"show-deleted-files",performAction:H(r,s,a,t.currentFQPath),disabled:N,className:"action-deleted-files",key:"toggle-deleted",ariaLabel:k(L.ShowDeletedFiles),ariaPressed:a},isPrimary:!1}),O.Viewer.get_viewer().is_assume_user_session||!(F.GoldenGate.hasContentManagerAndSuperAdmin(r.id)&&F.GoldenGate.hasNewOwnershipModel(r.id)&&t.isInsideTeamFolderTree||!r.is_cdm_member&&F.GoldenGate.hasContentManagerAndSuperAdmin(r.id)&&t.isCurrentlyInRoot)||R||X.push({action:{label:k(L.ManageAsAdmin),iconName:"settings-gear",performAction:G(r,t),key:"manage-as-admin"},isPrimary:!1}),(P&&!R||h.shouldShowRewindsUpsell(r))&&X.push({action:{label:t.isCurrentlyInRoot?k(L.RewindDropbox):k(L.RewindFolder),iconName:"revert-folder",disabled:!C,performAction:function(){c.default.update_query_param(f.BrowseQueryArg.rewind,"true"),m.getStoreForBrowse().dispatch(_.showRewind())},key:"rewind-folder"},isPrimary:!1}),R||X.push({action:{label:k(L.FolderHistory),iconName:"view-folder-history",performAction:function(){c.default.update_query_param(f.BrowseQueryArg.folder_history,"true"),m.getStoreForBrowse().dispatch(_.showFolderHistoryPanel())},key:"folder-history"},isPrimary:!1})}else X.push({action:{label:k(L.ReAddSharedFolder),iconName:"restore",performAction:q(r,t),disabled:!x,key:"re-add-shared-folder"},isPrimary:!0});return t.isInsideVaultFolder?(function(e){return e.filter((function(e){var t=e.action;return!!o.isFunction(t)||!U.has(t.label)}))})(X):X},t.getConsolidatedFolderActions=function(e,t,r,o,n){var i=[];i.push({displayName:M.intl.formatMessage({id:"MLqiSW",defaultMessage:"Folder"}),iconName:"folder-small",className:"action-new-folder",handleClick:V(e,t,r,o,n)});var s=e.is_cdm_member&&"/"===r.currentFQPath,a=r.isInsideSandboxFolder;return s||a||i.push({displayName:M.intl.formatMessage({id:"r6q13e",defaultMessage:"Shared folder"}),iconName:"folder_shared-small",className:"action-shared-folder",handleClick:B(e,r)}),i},t.getUploadActions=Q,t.getCreateFolderAction=function(e,t,r,o,n){return{displayName:M.intl.formatMessage({id:"eXL9sz",defaultMessage:"Create new folder"}),className:"action-new-folder",handleClick:V(e,t,r,o,n),key:"new-folder"}}})),define("modules/clean/react/browse/scroll_position",["require","exports","tslib","modules/core/browser"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var n=(function(){function e(){var e=this;this.navigationHistory=[],this.onPopState=function(){var t=e.peekItem(1);t&&t.url===o.get_href()?e.wasLastNavigationBack=!0:(e.wasLastNavigationBack=!1,e.clear())}}return e.prototype.clear=function(){this.navigationHistory=[]},e.prototype.popItem=function(){return this.navigationHistory.pop()},e.prototype.pushItem=function(e){this.navigationHistory.push(e)},e.prototype.peekItem=function(e){if(void 0===e&&(e=0),this.navigationHistory.length>e)return this.navigationHistory[this.navigationHistory.length-1-e]},e.prototype.register=function(){window.addEventListener("popstate",this.onPopState),this.navigationHistory=[]},e.prototype.unregister=function(){window.removeEventListener("popstate",this.onPopState),this.navigationHistory=[]},e.prototype.getLastScrollPosition=function(e){if(this.wasLastNavigationBack||this.pushItem({url:o.get_href(),fq_path:e}),this.wasLastNavigationBack){this.wasLastNavigationBack=!1;var t=this.popItem();return t&&t.fq_path}if(this.wasNavigateUpFolder){this.wasNavigateUpFolder=!1;var r=this.peekItem(1);return r&&r.fq_path}},e.prototype.navigateUpFolder=function(){this.wasNavigateUpFolder=!0},e})();t.ScrollPositionHandler=new n})),define("modules/clean/react/browse/selection_preview/selection_preview_pane",["require","exports","tslib","react","modules/clean/react/async/loadable"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.SelectionPreviewPane=n.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/browse/selection_preview/selection_preview_component"],t,r)})).then(r.__importStar).then((function(e){return e.MemoizedSelectionPreviewComponent}))},loading:function(){return o.default.createElement("div",{className:"selection-preview-pane selection-preview-pane__empty"})}})})),define("modules/clean/react/browse/sidebar_view",["require","exports","tslib","react","react-redux","modules/clean/react/actions_menu/view","modules/clean/react/app_actions_view","modules/clean/react/browse/app_action_util","modules/clean/react/browse/data/folder_overview_selectors","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/store","modules/clean/react/browse/global_actions","modules/clean/react/browse/models","modules/clean/react/browse/selection_preview/selection_preview_pane","modules/clean/react/file_uploader/file_uploader","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/shortcuts/shortcut_feedback_toolbar_loader","modules/clean/react/files_view/types","modules/clean/react/folder_overview/sidebar_controller","modules/clean/react/folder_overview/utils","modules/clean/react/growth/continuous_onboarding/continuous_onboarding_loader","modules/clean/react/growth/invite_facepile_loader","modules/clean/react/upload_kit/uploader/context","modules/clean/web_timing_logger","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S,v,E,w,b,y,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),l=r.__importStar(l),c=r.__importStar(c),m=r.__importStar(m);var F=(function(t){function n(e){var r=t.call(this,e)||this;return r.renderSingleSelectionAudienceBox=function(e,t){var n=e.selectedFiles,i=e.context,s=e.user;if(!t||r.isFirstTaskPage())return null;var a=n.first(),l=t.SharedWithController;return o.default.createElement(l,{file:a,browseContext:i,user:s,isInAudienceBox:!0,key:"single"})},r.shouldShowFacePile=function(){return r.props.showInviteSidePanel||r.isFirstTaskPage()},r.shouldShowManageGroups=function(){return r.isFirstTaskPage()&&"V1"===r.props.browsePostTTIExperiments.expGrowthActSmbGroupsFirst},r.isFirstTaskPage=function(){return("V1"===r.props.browsePostTTIExperiments.expGrowthActSmbGroupsFirst||"V1"===r.props.browsePostTTIExperiments.expGrowthActSmbFirstTask)&&r.props.context.isInsideTeamFolderTree&&r.props.context.isCurrentlyInRoot},r.getBrowseContext=function(){return c.context(d.getStoreForBrowse().getState())},r.state={appActionsProps:r.getCurrentAppActionsProps(e)},r}return r.__extends(n,t),n.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(o){switch(o.label){case 0:return[4,y.waitForTTI()];case 1:return o.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/browse/shared_with"],t,r)})).then(r.__importStar)];case 2:return t=o.sent(),this.setState({appActionsProps:this.getCurrentAppActionsProps(this.props,t),sharedWithModule:t}),[2]}}))}))},n.prototype.componentDidUpdate=function(e){e.selectedFiles===this.props.selectedFiles&&e.isRewindButtonEnabled===this.props.isRewindButtonEnabled&&e.context===this.props.context&&e.user===this.props.user&&e.shouldShowDeletedFiles===this.props.shouldShowDeletedFiles&&e.isNoComment===this.props.isNoComment&&e.arePostTTIModulesLoaded===this.props.arePostTTIModulesLoaded&&e.viewType===this.props.viewType&&e.starredState===this.props.starredState&&e.canDisplayFolderSizes===this.props.canDisplayFolderSizes&&e.uploadAjaxInterceptor===this.props.uploadAjaxInterceptor&&e.responsive.isMatchedMedium===this.props.responsive.isMatchedMedium&&e.responsive.isMatchedLarge===this.props.responsive.isMatchedLarge&&e.uploaderExperiments===this.props.uploaderExperiments&&e.uploaderPostTTIExperiments===this.props.uploaderPostTTIExperiments&&e.browseExperiments===this.props.browseExperiments&&e.browsePostTTIExperiments===this.props.browsePostTTIExperiments&&e.pinnedItems===this.props.pinnedItems||this.setState({appActionsProps:this.getCurrentAppActionsProps(this.props,this.state.sharedWithModule)})},n.prototype.getCurrentAppActionsProps=function(e,t){var r,n=e.selectedFiles,i=e.autoTeamGroupId,s=e.context,l=e.canDisplayFolderSizes,c=e.onGetFileActionsForFiles,d=e.user,p=e.isRewindButtonEnabled,f=e.viewType,_=e.shouldShowDeletedFiles,m=e.onUploadButtonClick,h=e.isNoComment,g=e.browseExperiments,S=e.handleComponentTTI,v=e.responsive,E=e.scrollableSidebarRef,w=n.count(),b=o.default.createElement("div",null);if(w>0)r=c(n,l,v,!0,!0,E).map((function(e,t){return{action:e,isPrimary:0===t||"function"==typeof e}})),1===w&&(b=this.renderSingleSelectionAudienceBox(e,t));else if(r=u.getGlobalActions({context:s,user:d,isRewindButtonEnabled:p,viewType:f,showDeletedFiles:_,onUpload:m,isNoComment:h,autoTeamGroupId:i,browseExperiments:g,expFolderHistoryRollbacks:this.props.browseExperiments.folderHistoryRollbacks||!1,responsive:v,hideRightsideActions:this.props.hideRightsideActions}),t&&!this.isFirstTaskPage()){var y=t.SharedWithController;b=o.default.createElement(y,{browseContext:s,user:d,isInAudienceBox:!0,key:"global"})}for(var F=[],I=[],O=0,C=r;O<C.length;O++){var P=C[O];P.isPrimary?F.push(a.browseAppActionToPrimaryMenuItem(P.action)):I.push(a.browseAppActionToSecondaryMenuItem(P.action))}return e.isNoComment&&(b=o.default.createElement("div",null)),{popoverTriggerLabel:T.intl.formatMessage({id:"w81jal",defaultMessage:"Actions"}),primaryMenuItems:F,primarySubnode:b,secondaryMenuItems:I,handleComponentTTI:S}},n.prototype.render=function(){var e=this.props,t=e.responsive,n=e.isFileViewerShown,a=e.selectedFiles,l=e.scrollableSidebarRef,u=e.browsePostTTIExperiments,m=e.memberInfo,b=e.showInviteSidePanel,y=e.personalizationLogCtx,F=!(!t||!t.isResponsive||t.isMatchedLarge),I=d.getStoreForBrowse(),O=!F&&!this.props.hideSelectionPreviewPane,C=!F&&c.shouldShowSidebarFolderOverview(I.getState()),P=a&&0!==a.size,A=u.expEnableShortcutFeedbackToolbar&&!F&&h.isValidDropboxShortcutSelected(a),D={uploadItems:this.props.uploadItems,isUploading:this.props.isUploading,setInitialUploadedItems:this.props.setInitialUploadedItems,cancelUploadItem:this.props.cancelUploadItem,chooseFiles:this.props.chooseFiles,chooseFolder:this.props.chooseFolder,chooseDropboxFiles:this.props.chooseDropboxFiles,handleDrop:this.props.handleDrop,makeDirectory:this.props.makeDirectory,moveUploadItem:this.props.moveUploadItem,removeUploadItem:this.props.removeUploadItem,renameUploadItem:this.props.renameUploadItem,startUploading:this.props.startUploading,stopUploading:this.props.stopUploading},R=Object.keys(u).length>0;return o.default.createElement("div",{id:"brws-sidebar-view",className:"brws-sidebar-view"},this.shouldShowFacePile()&&o.default.createElement(w.InviteFacepileLoadable,{growthActSmbFirstTask:u.expGrowthActSmbFirstTask,growthActSmbGroupsFirst:u.expGrowthActSmbGroupsFirst,memberInfo:m,enableInviteSidePanel:b,personalizationLogCtx:y}),this.shouldShowManageGroups()&&o.default.createElement("div",{className:"brws-manage-groups-btn"},o.default.createElement("a",{href:this.props.user.is_team_admin?"/team/admin/groups":"/team"},T.intl.formatMessage({id:"jgB0j/",defaultMessage:"Manage groups"}))),null!=this.props.context.currentFQPath&&!n&&o.default.createElement(_.FileUploaderController,{key:"file-uploader-controller",ref:"fileUploader",autoTeamGroupId:this.props.autoTeamGroupId,loadOnRender:this.props.arePostTTIModulesLoaded,needToSetStoreValues:!1,ajaxInterceptor:this.props.uploadAjaxInterceptor,uploaderExperiments:this.props.uploaderExperiments,uploaderPostTTIExperiments:this.props.uploaderPostTTIExperiments,browseViewType:this.props.viewType,uploadConsumerInterface:D,useUploadKit:!!this.props.browsePostTTIExperiments.expUseUploadKit,getBrowseContext:this.getBrowseContext,parallelFileUploads:!!this.props.browsePostTTIExperiments.expParallelFileUploads,shouldInitialize:R}),O&&o.default.createElement(f.SelectionPreviewPane,{selectedFiles:a,folderSubscriptionsFileAddsFeatureGate:!!u.folderSubscriptionsFileAddsFeatureGate,isInsideSharedFolder:this.props.context.isInsideSharedFolder}),this.props.browseExperiments.browseDigActions?o.default.createElement(i.ActionsMenu,r.__assign({user:this.props.user},this.state.appActionsProps,{responsive:this.props.responsive,hideHeaderText:!!O,shouldCollapseActions:P,onContextMenuClick:this.props.onContextMenuClick,hideCreateButton:!0,isPrimaryActionSapphire:!0,scrollableSidebarRef:l,shouldUsePortalPopover:!0,hideSidebarCtas:this.props.hideSidebarCtas})):o.default.createElement(s.AppActionsView,r.__assign({user:this.props.user},this.state.appActionsProps,{responsive:this.props.responsive,hideHeaderText:!!O,shouldCollapseActions:P,onContextMenuClick:this.props.onContextMenuClick,hideCreateButton:!0,isPrimaryActionSapphire:!0,scrollableSidebarRef:l,shouldUsePortalPopover:!0,hideSidebarCtas:this.props.hideSidebarCtas})),A&&o.default.createElement(h.AsyncShortcutFeedbackToolbarLoader,{userId:this.props.user.id}),C&&o.default.createElement(S.SidebarFolderOverview,{key:a.first().fq_path,path:a.first().fq_path,componentNamespace:"SIDEBAR",isReadOnly:!v.canEditOverviewForFile(a.first()),browseLoadingState:g.LoadingState.LOADED,onlyRenderExistingFolderOverviews:!("V2"===this.props.browseExperiments.browseWebFolderOverview||"V3"===this.props.browseExperiments.browseWebFolderOverview),canShareFolder:!p.File.isNoAccessSharedFolder(a.first())}),u.expShouldShowContinuousOnboardingSidebar&&o.default.createElement(E.ContinuousOnboardingLoadable,{userId:this.props.user.id,isBackgroundActive:P}))},n})(o.default.PureComponent);t.BrowseSidebarViewComponent=F;t.BrowseSidebarView=b.withUploadConsumer(n.connect((function(e){return{isFileViewerShown:c.isFileViewerShown(e),browseExperiments:c.experiments(e),browsePostTTIExperiments:c.postTTIExperiments(e),context:c.context(e),viewType:m.viewType(e),isRewindVisible:c.isRewindVisible(e),selectedFiles:c.selectedFilesForSidebar(e),user:c.user(e),pinnedItems:l.folderOverviewPinnedItems(e),shouldShowDeletedFiles:c.shouldShowDeletedFiles(e),isRewindButtonEnabled:c.isRewindButtonEnabled(e),canDisplayFolderSizes:c.canDisplayFolderSizes(e),emptyFolder:l.emptyFolder(e)}}))(F))})),define("modules/clean/react/browse/title",["require","exports","tslib","react-redux","react","modules/clean/browse_uri_interface","modules/clean/filepath","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/selectors","modules/clean/react/file_uploader/file_uploader","modules/clean/react/path_breadcrumbs","modules/clean/viewer","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importStar(s),a=r.__importStar(a),l=r.__importStar(l);var f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleGetUrlForPath=function(e){return i.browse_uri_for_fq_path(t.props.user,e).toString()},t}return r.__extends(t,e),t.setPageTitle=function(e){e&&(document.title=p.intl.formatMessage({id:"dbYCaa",defaultMessage:"{folder_name} - Dropbox"},{folder_name:s.filename(e,p.intl.formatMessage({id:"bObFEu",defaultMessage:"Files"}))}))},t.prototype.componentDidMount=function(){t.setPageTitle(this.props.path)},t.prototype.componentDidUpdate=function(e){e.path!==this.props.path&&t.setPageTitle(this.props.path)},t.prototype.render=function(){var e=this.props,t=e.path,r=e.user,o=e.isDraggingInternalFiles,i=e.isDraggingExternalFiles,a=e.isUploadModalOpen,l=e.setUrl,f=e.expMobileWebInvites,_=s.filename("",u.Viewer.get_root_name(r)),m="work"===r.role?p.intl.formatMessage({id:"AAQLq4",defaultMessage:"Work"}):p.intl.formatMessage({id:"QPBzI3",defaultMessage:"Personal"});return n.default.createElement(d.PathBreadcrumbs,{path:t,isDraggingInternalFiles:o,setFileUploaderPath:c.FileUploaderController.setPathAndPermissions,getUrlForPath:this.handleGetUrlForPath,firstBreadcrumbName:_,firstBreadcrumbAlt:m,shouldHighlightDropTargets:o||i&&!a,disableDragging:i,setUrl:l,expMobileWebInvites:f})},t})(n.default.PureComponent);t.BrowseTitleComponent=f;var _={setUrl:a.setUrl};t.BrowseTitle=o.connect((function(e){return{path:l.path(e),user:l.user(e),expMobileWebInvites:l.browsePostTTIExperiments(e).expMobileWebInvites}}),_)(f)})),define("modules/clean/react/browse/web_team_sharing_experiment",["require","exports","tslib","react","modules/clean/react/file_uploader/constants","modules/clean/react/async_fileops_modals","modules/clean/analytics","immutable","modules/clean/react/async/loadable","modules/clean/web_timing_logger"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),i=r.__importStar(i),a=r.__importStar(a);var d=l.Loadable({loader:function(){return r.__awaiter(void 0,void 0,Promise,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,c.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/web_team_sharing_modal"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().WebTeamSharingModal]}}))}))}}),u=(function(t){function l(e){var r=t.call(this,e)||this;return r.removeUploadListener=function(){window.removeEventListener(n.ALL_UPLOADS_COMPLETE_EVENT,r.handleUploadsComplete)},r.closeTeamSharingModal=function(){return r.setState({isWebTeamSharingModalOpen:!1})},r.openFileMoveDialog=function(){r.closeTeamSharingModal(),s.TeamsWebActionsLogger.log("post_m1_sharing_modal_clicked"),i.showMove({files:r.props.selectedFiles.toArray(),path:r.props.context.currentFQPath,user:r.props.user})},r.state={isWebTeamSharingModalOpen:!1,uploadedFiles:[],expWebSharingActive:!1},r}return r.__extends(l,t),l.prototype.UNSAFE_componentWillReceiveProps=function(t){return r.__awaiter(this,void 0,void 0,(function(){var o,i,s,a=this;return r.__generator(this,(function(l){switch(l.label){case 0:return!t.browsePostTTIExperiments.expBizAddFilesTeamFolderRwls||this.handleUploadsComplete?[3,2]:[4,new Promise((function(t,r){e(["modules/clean/growth/experiments/web_sharing_helper"],t,r)})).then(r.__importStar)];case 1:o=l.sent(),i=o.logExposure,s=o.shouldShowModal,this.handleUploadsComplete=function(e){if(s(a.props.user,a.props.path)){i();var t=e.detail.files;a.setState({isWebTeamSharingModalOpen:!0,uploadedFiles:t,expWebSharingActive:!0})}},window.addEventListener(n.ALL_UPLOADS_COMPLETE_EVENT,this.handleUploadsComplete),l.label=2;case 2:return[2]}}))}))},l.prototype.componentWillUnmount=function(){this.handleUploadsComplete&&this.removeUploadListener()},l.prototype.render=function(){return this.state.expWebSharingActive?o.default.createElement(d,{context:this.props.context,files:this.state.uploadedFiles,handleModalClose:this.closeTeamSharingModal,handleAction:this.openFileMoveDialog,open:this.state.isWebTeamSharingModalOpen,user:this.props.user}):null},l.defaultProps={selectedFiles:a.OrderedMap()},l})(o.default.PureComponent);t.WebTeamSharingModalExperiment=u})),define("modules/clean/react/education/education_module_event_bridge",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){this.requestSectionHandler=null,this.requestSharingCalloutHandler=null}return e.prototype.registerRequestSectionHandler=function(e){this.requestSectionHandler=e},e.prototype.requestSection=function(e){this.requestSectionHandler&&this.requestSectionHandler(e)},e.prototype.registerRequestSharingCalloutHandler=function(e){this.requestSharingCalloutHandler=e},e.prototype.requestSharingCallout=function(){this.requestSharingCalloutHandler&&this.requestSharingCalloutHandler()},e})();t.educationEventBridge=new r}));__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/education/education_module_experiment",["require","exports","modules/clean/react/async/loadable","modules/clean/web_timing_logger","modules/clean/react/css"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.Loadable({loader:function(){return o.waitForTTI().then((function(){return new Promise((function(t,r){e(["modules/clean/react/education/education_module_experiment_sync"],t,r)})).then(__importStar)})).then((function(e){return e.UnstyledEducationModuleExperiment}))}});t.CXEducationModuleExperiment=n.requireCssWithComponent(i,["/static/js/premium-growth/index.web-vflHREsfC.css","/static/css/growth/experiments/education_module_experiment-vfl38KfzP.css","/static/css/font_sharp_grotesk-vfle4tE4q.css"])})),define("modules/clean/react/file_uploader/actions_adapter",["require","exports","tslib","eventemitter3","modules/clean/filepath","modules/clean/react/file_uploader/store","modules/clean/react/file_uploader/constants","modules/clean/react/upload_kit/lib/types"],(function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n);var l=new o.default;t.ActionsAdapter={emit:function(e,t){l.emit(e,t)},on:function(e,t){return l.on(e,t)},removeAllListeners:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return l.removeAllListeners.apply(l,e)},eventNames:function(){return l.eventNames()}},t.convertUploadItem=function(e,t){var o,a=e.bytes,l=e.destPath,c=e.id,d=e.parentPath,u=e.bytesUploaded;void 0===t&&(t={});var p=null===(o=i.uploaderStore.user())||void 0===o?void 0:o.id,f=n.parent_dir(l),_=n.normalize(d)+n.normalize(f);return new s.FileUpload(r.__assign({uploadId:c,dest:_,name:n.filename(l),size:a,userId:p,percentUploaded:a>0?Math.ceil(u/a*100):100},t))},t.convertValidationError=function(e){switch(e){case a.UploadValidationError.EmptyFile:return s.UploadErrorType.EMPTY_OR_FOLDER;case a.UploadValidationError.IgnoredFile:return s.UploadErrorType.IGNORED;case a.UploadValidationError.OverMaxFileSize:return s.UploadErrorType.FILE_SIZE_ERROR;case a.UploadValidationError.PointerFile:case a.UploadValidationError.TemporaryFile:return s.UploadErrorType.INVALID_EXTENSION;case a.UploadValidationError.CloudDoc:case a.UploadValidationError.Unknown:return s.UploadErrorType.GENERIC}}})),define("modules/clean/react/file_uploader/action_logger",["require","exports","tslib","modules/clean/filepath","modules/clean/react/file_uploader/constants","modules/clean/web_upload_action_logger","modules/clean/web_user_action_logger","modules/clean/web_upload_action_events","modules/clean/web_user_action_events","modules/core/browser","modules/clean/react/file_uploader/utils"],(function(e,t,r,o,n,i,s,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),c=r.__importStar(c),t.logUploadAction=function(e){var t=e.action,u=e.upload,p=e.chooser_type,f=e.upload_method,_=e.num_files,m=e.num_dirs,h=e.errorType,g=e.extra,S=e.batchId,v=e.user,E=e.uploadPath,w=e.useUploadKit,b={num_files:_,num_dirs:m,chooser_type:p,upload_method:f,extra:{origin:"/h"===c.get_pathname()?"HOME":"BROWSE",useUploadKit:w?"True":"False"}};if((function(e){return e&&!!e.uploadId})(u)){var y=u,T=t===a.WebUploadActionEvent.UPLOAD_FAILURE?y.errorType===n.UploadErrorType.GENERIC&&h?h:y.errorType:void 0;b=r.__assign(r.__assign({},b),{upload_id:y.uploadId,file_size:y.size,file_extension:o.file_extension(y.name),failure_reason:T,batch_id:y.batchId,upload_destination:y.dest,current_path:c.get_pathname(),file_name:y.name})}else if((function(e){return e&&!!e.batchId})(u)){y=u;b=r.__assign(r.__assign({},b),{file_size:y.size,file_extension:o.file_extension(y.name),batch_id:y.batchId})}!b.chooser_type&&u&&"chooserType"in u&&u.chooserType&&(b.chooser_type=u.chooserType),S&&(b.batch_id=S),E&&(b.batch_dest_folder_level=d.getFolderLevel(E),v&&(b.member_folder=d.isInMemberFolder(v,E))),g&&(b.extra=g),!(function(e){return e===l.WebUserActionLogEvent.UPLOAD_BUTTON_CLICK||e===l.WebUserActionLogEvent.ADD_MORE_FILES_CLICK||e===l.WebUserActionLogEvent.VIEW_DETAILS_CLICK||e===l.WebUserActionLogEvent.CLOSE_MODAL_CLICK||e===l.WebUserActionLogEvent.UPLOAD_CLICK||e===l.WebUserActionLogEvent.UPLOAD_FILES_CLICK||e===l.WebUserActionLogEvent.UPLOAD_FOLDER_CLICK||e===l.WebUserActionLogEvent.CANCEL_UPLOAD_CLICK})(t)?(t=t,b.client_timestamp=Math.round(Date.now()/1e3),i.WebUploadActionLog.log(v.id,t,b)):s.WebUserActionLog.log(v.id,t,b)}})),define("modules/clean/react/file_uploader/constants",["require","exports","tslib","immutable"],(function(e,t,r,o){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),(function(e){e.ALL_UPLOADS_COMPLETE="ALL_UPLOADS_COMPLETE",e.SET_PATH="UPLOADER_SET_PATH",e.SET_FOLDER_NS_ID="UPLOADER_SET_FOLDER_NS_ID",e.SET_USER="UPLOADER_SET_USER",e.SET_NUM_DRAGGING_FILES="SET_NUM_DRAGGING_FILES",e.QUEUE_UPLOADS="QUEUE_UPLOADS",e.START_UPLOAD="START_UPLOAD",e.COMPLETE_UPLOAD="COMPLETE_UPLOAD",e.CANCEL_UPLOADS="CANCEL_UPLOADS",e.SET_CURRENT_UPLOAD_PROGRESS="SET_CURRENT_UPLOAD_PROGRESS",e.UPLOAD_ERROR="UPLOAD_ERROR",e.SET_IS_UPLOAD_MODAL_OPEN="SET_IS_UPLOAD_MODAL_OPEN",e.SET_INLINE_STATUS_SHOULD_BE_DISMISSED="SET_INLINE_STATUS_SHOULD_BE_DISMISSED",e.ADD_NEW_FAILED_FILE="ADD_NEW_FAILED_FILE",e.CONFIRM_FSW="CONFIRM_FSW",e.ADD_FILES_TO_PLU="ADD_FILES_TO_PLU",e.ADD_DIRECTORIES_TO_PLU="ADD_DIRECTORIES_TO_PLU",e.REMOVE_FILES="REMOVE_FILES",e.SET_HAS_OVERQUOTA_ERROR="SET_HAS_OVERQUOTA_ERROR",e.SET_IS_PERMISSIONS_AT_UPLOAD_MODAL_OPEN="SET_IS_PERMISSIONS_AT_UPLOAD_MODAL_OPEN",e.ADD_TEAM_ACCESS_LEVEL="ADD_TEAM_ACCESS_LEVEL",e.RESET_TEAM_ACCESS_LEVELS="RESET_TEAM_ACCESS_LEVELS",e.SET_UPLOAD_PROGRESS="SET_UPLOAD_PROGRESS"})(t.UploaderActionType||(t.UploaderActionType={})),(function(e){e.PENDING="PENDING",e.UPLOADING="UPLOADING",e.COMPLETE="COMPLETE",e.CANCELLED="CANCELLED",e.FAILED="FAILED"})(n=t.FileStatusType||(t.FileStatusType={})),(function(e){e.WRITER="WRITER",e.READER="READER",e.NO_ACCESS="NO_ACCESS",e.INHERIT="INHERIT"})(t.TeamAccessLevel||(t.TeamAccessLevel={})),(function(e){e.FILE_SIZE_ERROR="FILE_SIZE_ERROR",e.HTTP_ERROR="HTTP_ERROR",e.CONNECTION_ERROR="CONNECTION_ERROR",e.OVER_QUOTA_ERROR="OVER_QUOTA_ERROR",e.LOCKED_TEAM_ERROR="LOCKED_TEAM_ERROR",e.IGNORED="IGNORED",e.INVALID_EXTENSION="INVALID_EXTENSION",e.EMPTY_OR_FOLDER="EMPTY_OR_FOLDER",e.FOLDER_SAFARI="FOLDER_SAFARI",e.PACKAGE_FILE="PACKAGE_FILE",e.GENERIC="GENERIC",e.BLOCKS_MISSING_ERROR="BLOCKS_MISSING_ERROR",e.COMMIT_HTTP_ERROR="COMMIT_HTTP_ERROR",e.UPLOAD_BLOCK_ERROR="UPLOAD_BLOCK_ERROR",e.CHUNKS_NOT_ENABLED_ERROR="CHUNKS_NOT_ENABLED_ERROR",e.SERVER_RESPONSE_ERROR="SERVER_RESPONSE_ERROR",e.SERVER_TOKEN_EMPTY_ERROR="SERVER_TOKEN_EMPTY_ERROR",e.SERVER_TOKENS_MISSING_ERROR="SERVER_TOKENS_MISSING_ERROR",e.SERVER_HASH_RESPONSE_ERROR="SERVER_HASH_RESPONSE_ERROR",e.BLOCK_RUNTIME_ID_MISSING_ERROR="BLOCK_RUNTIME_ID_MISSING",e.CLIENT_HASH_EMPTY_ERROR="CLIENT_HASH_EMPTY_ERROR",e.SERVER_HASH_EMPTY_ERROR="SERVER_HASH_EMPTY_ERROR",e.HASHES_NOT_EQUAL_ERROR="HASHES_NOT_EQUAL_ERROR",e.BLOCK_INDEX_ERROR="BLOCK_INDEX_ERROR",e.BLOCK_EMPTY_ERROR="BLOCK_EMPTY_ERROR",e.BLOB_EMPTY_ERROR="BLOB_EMPTY_ERROR",e.BLOB_MISSING_ERROR="BLOB_MISSING_ERROR",e.CLIENT_HASH_DIGEST_ERROR="CLIENT_HASH_DIGEST_ERROR",e.FILE_READER_NULL_RESULT_ERROR="FILE_READER_NULL_RESULT_ERROR",e.COMMIT_READINESS_ERROR="COMMIT_READINESS_ERROR",e.UPLOAD_PRECHECK_ERROR="UPLOAD_PRECHECK_ERROR",e.UPLOAD_PRECHECK_INVALID_CHAR_ERROR="UPLOAD_PRECHECK_INVALID_CHAR_ERROR",e.PERMISSIONS_AT_UPLOAD_ERROR="PERMISSIONS_AT_UPLOAD_ERROR"})(i=t.UploadErrorType||(t.UploadErrorType={})),(function(e){e.NONE="NONE",e.BASIC_OVER_QUOTA="BASIC_OVER_QUOTA",e.BASIC_NEAR_QUOTA="BASIC_NEAR_QUOTA",e.LIMITED_TEAM_USER_OVER_QUOTA="LIMITED_TEAM_USER_OVER_QUOTA",e.LIMITED_TEAM_TSD_OVER_QUOTA="LIMITED_TEAM_TSD_OVER_QUOTA",e.LOCKED_TEAM_USER_OVER_QUOTA="LOCKED_TEAM_USER_OVER_QUOTA"})(t.OverQuotaStatusType||(t.OverQuotaStatusType={}));var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})(o.Record({uploadId:void 0,dest:"",ns_id:null,ns_path:null,userId:null,name:"",size:0,percentUploaded:0,status:n.PENDING,errorType:i.GENERIC,errorMessage:"",batchId:void 0,chooserType:void 0},"FileUpload"));t.FileUpload=s,t.UPLOAD_BEGIN_EVENT="dbxUploadBegin",t.UPLOAD_COMPLETE_EVENT="dbxUploadComplete",t.ALL_UPLOADS_COMPLETE_EVENT="dbxAllUploadsComplete",t.UPLOAD_ERROR_EVENT="dbxUploadError",(function(e){e[e["4mb"]=0]="4mb",e[e["8mb"]=1]="8mb"})(t.ValidChunkSizeStrings||(t.ValidChunkSizeStrings={}))})),define("modules/clean/react/file_uploader/processors",["require","exports","tslib","modules/clean/filepath","modules/clean/react/file_uploader/utils","modules/clean/react/upload_kit/lib/types"],(function(e,t,r,o,n,i){"use strict";function s(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i;return r.__generator(this,(function(r){switch(r.label){case 0:return(i=e.map((function(e){var t=e.item;return o.filename(t.destPath)}))).length?[4,n.showInvalidFileWarning(i,t,!0)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.processFiles=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(o){switch(o.label){case 0:return[4,s(t,0===e.length)];case 1:return o.sent(),(function(e){r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){return e.forEach((function(e){e.file instanceof File&&!i.isChooserFile(e.file)&&!i.isWebkitFile(e.file)&&(e.file.webkitRelativePath="/")})),[2]}))}))})(e),[2,e]}}))}))}})),define("modules/clean/react/file_uploader/store",["require","exports","tslib","immutable","modules/clean/flux/base_store","modules/clean/react/file_uploader/constants","modules/clean/react/file_uploader/utils","modules/core/exception","modules/clean/react/file_uploader/team_access_levels_definition"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype._init=function(){this._path="/",this._hasPermissionToUploadToFolder=!0,this._folderNsId=null,this._user=null,this._fileList=o.OrderedMap(),this._currentUploadId=null,this._numDraggingFiles=0,this._isInternalTransfer=!1,this._isUploadModalOpen=!1,this._inlineStatusShouldBeDismissed=!1,this._isMovingIntoVault=!1,this._isPermissionsAtUploadModalOpen=!1,this._numSecondsLeft=0,this._confirmedFSWs=[],this._confirmedFSWBatchIds=[],this._hasOverquotaError=!1,this._allUploadsComplete=!1,this._teamAccessLevelsDefinition=new l.TeamAccessLevelsDefinition},t.prototype.fileList=function(){return this._fileList},t.prototype.currentUpload=function(){var e=this._currentUploadId;if(!e)return null;var t=this._fileList.get(e);return t||null},t.prototype.uploadById=function(e){var t;return e&&(t=this._fileList.get(e)),t||void 0},t.prototype.numSecondsLeft=function(){return this._numSecondsLeft},t.prototype.isUploadCancelled=function(e){var t=this._fileList.get(e);return!!t&&t.status===i.FileStatusType.CANCELLED},t.prototype.inlineStatusShouldBeDismissed=function(){return this._inlineStatusShouldBeDismissed},t.prototype.isMovingIntoVault=function(){return this._isMovingIntoVault},t.prototype.isPermissionsAtUploadModalOpen=function(){return this._isPermissionsAtUploadModalOpen},t.prototype.path=function(){return this._path},t.prototype.folderNsId=function(){return this._folderNsId},t.prototype.hasPermissionToUploadToFolder=function(){return this._hasPermissionToUploadToFolder},t.prototype.user=function(){return this._user},t.prototype.nextUpload=function(){return this._fileList.find((function(e){return e.status===i.FileStatusType.PENDING}))},t.prototype.numDraggingFiles=function(){return this._numDraggingFiles},t.prototype.isInternalTransfer=function(){return this._isInternalTransfer},t.prototype.isUploadModalOpen=function(){return this._isUploadModalOpen},t.prototype.confirmedFSWs=function(){return this._confirmedFSWs},t.prototype.confirmedFSWBatchIds=function(){return this._confirmedFSWBatchIds},t.prototype.hasOverquotaError=function(){return this._hasOverquotaError},t.prototype.allUploadsComplete=function(){return this._allUploadsComplete},t.prototype.getTeamAccessLevelsDefinition=function(){return this._teamAccessLevelsDefinition},t.prototype.getTeamAccessLevel=function(e){return this._teamAccessLevelsDefinition.getTeamAccessLevel(e)},t.prototype.setUser=function(e){var t=e.user;this._user=t,this.emit_change()},t.prototype.setPath=function(e){var t=e.path,r=e.hasPermissionToUploadToFolder,o=void 0===r||r,n=e.isMovingIntoVault,i=void 0!==n&&n;this._path=t,this._hasPermissionToUploadToFolder=o,this._confirmedFSWs=[],this._isMovingIntoVault=i,this.emit_change()},t.prototype.setFolderNsId=function(e){var t=e.folderNsId;this._folderNsId=t},t.prototype.setHasOverquotaError=function(e){var t=e.hasOverquotaError;this._hasOverquotaError=t,this.emit_change()},t.prototype.addTeamAccessLevel=function(e){var t=e.path,r=e.accessLevel;this._teamAccessLevelsDefinition=this._teamAccessLevelsDefinition.addTeamAccessLevel(t,r),this.emit_change()},t.prototype.resetTeamAccessLevels=function(){this._teamAccessLevelsDefinition=new l.TeamAccessLevelsDefinition,this.emit_change()},t.prototype.queueUploads=function(e){for(var t={},r=0,o=e.files;r<o.length;r++){var n=o[r];t[n.uploadId]=n}this._fileList=this._fileList.merge(t),this.emit_change()},t.prototype.handleAllUploadsComplete=function(){this._allUploadsComplete=!0,this.emit_change()},t.prototype.startUpload=function(e){var t=e.file,r=e.parallelFileUploads;r||a.assert(null==this.currentUpload(),"can't start an unload while one is ongoing"),a.assert(null!=t,"missing file to upload"),a.assert(this._fileList.get(t.uploadId)===t,"failed to find file in file list"),this._fileList.get(t.uploadId)&&(this._fileList=this._fileList.update(t.uploadId,(function(e){return e.set("status",i.FileStatusType.UPLOADING)})),this._currentUploadId=r?null:t.uploadId,this._allUploadsComplete=!1),this.emit_change()},t.prototype.completeUpload=function(e){var t=e.uploadId,r=e.parallelFileUploads,o=this._fileList.get(t);o&&((t!==this._currentUploadId&&!r||o.status!==i.FileStatusType.UPLOADING)&&a.reportStack("Tried to mark a file upload that is not currently uploading as complete",{exc_extra:{file:o.toString(),fileListLength:this._fileList.count(),uploadId:t,currentUploadId:this._currentUploadId}}),this._fileList=this._fileList.update(t,(function(e){return e.set("status",i.FileStatusType.COMPLETE)}))),this._currentUploadId=null,this.emit_change()},t.prototype.cancelUploads=function(e){for(var t=0,r=e.files;t<r.length;t++){var o=r[t];this._fileList=this._fileList.update(o.uploadId,(function(e){return e.status===i.FileStatusType.PENDING||e.status===i.FileStatusType.UPLOADING?e.set("status",i.FileStatusType.CANCELLED):e})),o.uploadId===this._currentUploadId&&(this._currentUploadId=null)}this.emit_change()},t.prototype.setCurrentUploadProgress=function(e){var t=e.percentComplete,r=e.numSecondsLeft,o=this._currentUploadId;o&&(this._fileList=this._fileList.update(o,(function(e){return e.set("percentUploaded",t)})),void 0!==r&&(this._numSecondsLeft=r)),this.emit_change()},t.prototype.handleUploadError=function(e){var t=e.uploadId,r=e.errorType,o=e.errorMessage,n=e.parallelFileUploads,s=this._fileList.get(t);s&&(s.uploadId===this._currentUploadId||n||a.reportStack("Error reported for file upload that is not the current upload",{exc_extra:{file:s.toString(),fileListLength:this._fileList.count(),uploadId:t,currentUploadId:this._currentUploadId,errorType:r,errorMessage:o}}),this._fileList=this._fileList.update(s.uploadId,(function(e){return e.set("status",i.FileStatusType.FAILED).set("errorType",r).set("errorMessage",o)}))),this._currentUploadId=null,this.emit_change()},t.prototype.setNumDraggingFiles=function(e){var t=e.numDraggingFiles,r=e.isInternalTransfer,o=void 0!==r&&r;this._numDraggingFiles=t,this._isInternalTransfer=o,this.emit_change()},t.prototype.setIsUploadModalOpen=function(e){var t=e.isUploadModalOpen;this._isUploadModalOpen=t,this.emit_change()},t.prototype.setInlineStatusShouldBeDismissed=function(e){var t=e.inlineStatusShouldBeDismissed;this._inlineStatusShouldBeDismissed=t,this.emit_change()},t.prototype.setIsPermissionsAtUploadModalOpen=function(e){var t=e.isPermissionsAtUploadModalOpen;this._isPermissionsAtUploadModalOpen=t,this.emit_change()},t.prototype.addNewFailedFile=function(e){var t=e.file,r=e.errorType,o=e.errorMessage;null==t.uploadId&&(t=t.set("uploadId",s.generateUploadId())),t=t.set("status",i.FileStatusType.FAILED).set("errorType",r).set("errorMessage",o),this._fileList=this._fileList.set(t.uploadId,t),this.emit_change()},t.prototype.confirmFSW=function(e){var t=this,r=e.fswIds,o=e.batchId;r.forEach((function(e){t._confirmedFSWs.includes(e)||t._confirmedFSWs.push(e)})),this._confirmedFSWBatchIds.includes(o)||this._confirmedFSWBatchIds.push(o)},t.prototype.setUploadProgress=function(e){var t=e.uploadId,r=e.percentComplete,o=e.numSecondsLeft;t&&(this._fileList=this._fileList.update(t,(function(e){return e.set("percentUploaded",r)})),void 0!==o&&(this._numSecondsLeft=o)),this.emit_change()},t.prototype._new_payload=function(e){var t=e.action;switch(t.type){case i.UploaderActionType.SET_USER:this.setUser(t.data);break;case i.UploaderActionType.SET_PATH:this.setPath(t.data);break;case i.UploaderActionType.SET_FOLDER_NS_ID:this.setFolderNsId(t.data);break;case i.UploaderActionType.QUEUE_UPLOADS:this.queueUploads(t.data);break;case i.UploaderActionType.START_UPLOAD:this.startUpload(t.data);break;case i.UploaderActionType.COMPLETE_UPLOAD:this.completeUpload(t.data);break;case i.UploaderActionType.ALL_UPLOADS_COMPLETE:this.handleAllUploadsComplete();break;case i.UploaderActionType.CANCEL_UPLOADS:this.cancelUploads(t.data);break;case i.UploaderActionType.SET_CURRENT_UPLOAD_PROGRESS:this.setCurrentUploadProgress(t.data);break;case i.UploaderActionType.UPLOAD_ERROR:this.handleUploadError(t.data);break;case i.UploaderActionType.SET_NUM_DRAGGING_FILES:this.setNumDraggingFiles(t.data);break;case i.UploaderActionType.SET_IS_UPLOAD_MODAL_OPEN:this.setIsUploadModalOpen(t.data);break;case i.UploaderActionType.SET_INLINE_STATUS_SHOULD_BE_DISMISSED:this.setInlineStatusShouldBeDismissed(t.data);break;case i.UploaderActionType.ADD_NEW_FAILED_FILE:this.addNewFailedFile(t.data);break;case i.UploaderActionType.CONFIRM_FSW:this.confirmFSW(t.data);break;case i.UploaderActionType.SET_HAS_OVERQUOTA_ERROR:this.setHasOverquotaError(t.data);break;case i.UploaderActionType.SET_IS_PERMISSIONS_AT_UPLOAD_MODAL_OPEN:this.setIsPermissionsAtUploadModalOpen(t.data);break;case i.UploaderActionType.ADD_TEAM_ACCESS_LEVEL:this.addTeamAccessLevel(t.data);break;case i.UploaderActionType.RESET_TEAM_ACCESS_LEVELS:this.resetTeamAccessLevels();break;case i.UploaderActionType.SET_UPLOAD_PROGRESS:this.setUploadProgress(t.data)}},t})(n.Store);t.UploaderStoreClass=c,t.uploaderStore=new c})),define("modules/clean/react/file_uploader/team_access_levels_definition",["require","exports","tslib","modules/clean/filepath"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){this.teamAccessLevelsDefinition=e||[]}return e.prototype.hasDefinitions=function(){return!!this.teamAccessLevelsDefinition.length},e.prototype.addTeamAccessLevel=function(t,o){var n=this.teamAccessLevelsDefinition.filter((function(e){return e.path!==t}));return new e(r.__spreadArrays(n,[{path:t,accessLevel:o}]))},e.prototype.getTeamAccessLevel=function(e){if(!this.teamAccessLevelsDefinition.length)return null;var t=this.teamAccessLevelsDefinition.reduce((function(t,r){var n=o.inSubDirectory(r.path,e)||o.paths_are_equal(r.path,e);if(!t)return n?r:null;var i=o.normalize(t.path),s=o.normalize(r.path),a=i.length<s.length;return n&&a?r:t}),null);return t?t.accessLevel:null},e})();t.TeamAccessLevelsDefinition=n})),define("modules/clean/react/file_uploader/utils",["require","exports","tslib","modules/clean/base64","modules/clean/filepath","modules/clean/react/async_file_modal_controller","modules/clean/react/file_uploader/constants","modules/core/browser","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l){"use strict";function c(){for(var e="",t=0;t<16;++t)e+=String.fromCharCode(Math.floor(256*Math.random()));var r=o.encode(e);return r=(r=(r=r.replace(/\+/g,"-")).replace(/\//g,"_")).replace(/\=*$/,"")}function d(e,t){return!e.is_team||!e.is_cdm_member||""!==n.normalize(t)&&(n.paths_are_equal(e.cdm_tmf_path,t)||n.inSubDirectory(e.cdm_tmf_path,t))}function u(e,t){for(var r=e.dest,o=f(t);f(r)-1>o;)r=n.parent_dir(r);return r}function p(e,t){var r=e.toArray().map((function(e){return u(e,t)}));return Array.from(new Set(r))}function f(e){return(n.normalize(e).match(/\//g)||[]).length+1}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),i=r.__importStar(i),a=r.__importStar(a),t.generateUploadId=function(){return c()},t.generateBatchId=function(){return"batch-"+c()},t.calculateSizeOfUploads=function(e,t){var r=0;return e.forEach((function(e){-1!==t.indexOf(e.status)&&(r+=e.size)})),r},t.getNsId=function(e,t,r){var o=t,n=0;return e.forEach((function(e,t){for(var i=0,s=e.split("/"),a=r.split("/");i<s.length&&i<a.length&&s[i]===a[i];)i++;i===s.length&&i>1&&i>n&&(n=i,o=Number(t))})),o},t.getOQmodalOQALocationCode=function(e){return"/h"===(e||a.get_uri().path)?"ho":"fb"},t.isInMemberFolder=d,t.getUploadLocationMetadataToLog=function(e,t){return{root_folder:""===n.normalize(t),member_folder:d(e,t),folder_level:n.normalize(t).split("/").length}},t.PERMISSION_FSW_IDS=["action_commit_to_tsd_root","action_missing_parent"],t.getFSWMetadataToLog=function(e){return{has_permissions:e.includes("action_commit_to_tsd_root"),has_permissions_nonroot:e.includes("action_missing_parent"),has_other:e.some((function(e){return!t.PERMISSION_FSW_IDS.includes(e)}))}},t.getRootDest=u,t.getRootDests=p,t.isMultifolderUpload=function(e,t){var r=p(e.filter((function(e){return[s.FileStatusType.PENDING,s.FileStatusType.UPLOADING].includes(e.status)})),t);return!r.every((function(e){return e===r[0]}))},t.uploadContainsFolder=function(e,t){var r=e.filter((function(e){return[s.FileStatusType.PENDING,s.FileStatusType.UPLOADING].includes(e.status)})),o=f(t);return p(r,t).some((function(e){return f(e)>o}))},t.isUploadInTmf=function(e,t){if(!t.cdm_tmf_path)return!1;var r=e.filter((function(e){return[s.FileStatusType.PENDING,s.FileStatusType.UPLOADING].includes(e.status)})),o=n.normalize(t.cdm_tmf_path);return r.some((function(e){return e.dest===o||n.inSubDirectory(o,e.dest)}))},t.getFileUploadsWithStatus=function(e,t){return e.valueSeq().toArray().filter((function(e){return t.includes(e.status)}))},t.getFolderLevel=f,t.showInvalidFileWarning=function(e,t,r){return new Promise((function(o,n){if(e.length){var s=(function(e){if(1===e.length)return{title:l.intl.formatMessage({id:"u1XyrU",defaultMessage:"Unable to upload {file}"},{file:e[0]}),text:l.intl.formatMessage({id:"+SyRtx",defaultMessage:"This file is not supported by Dropbox and cannot be uploaded."})};var t=l.intl.formatMessage({id:"Chf30m",defaultMessage:"Unable to upload one or more files"});if(e.length<=3)return{title:t,text:l.intl.formatMessage({id:"fKAsp7",defaultMessage:"The following files are not supported by Dropbox and cannot be uploaded: {files}"},{files:e.join(", ")})};var r=e.length-3;return{title:t,text:l.intl.formatMessage({id:"z9swUK",defaultMessage:"{count, plural, one{The following files are not supported by Dropbox and cannot be uploaded: {files} and {count} more} other{The following files are not supported by Dropbox and cannot be uploaded: {files} and {count} more}}"},{files:e.slice(0,3).join(", "),count:r})}})(e),a=s.title,c=s.text;i.showFileSystemWarningsModal({confirmText:l.intl.formatMessage({id:"Bmo28B",defaultMessage:"{count, plural, one{Skip this file} other{Skip these files}}"},{count:e.length}),fsws:[{id:"action_upload_invalid_extension",blocking:t,title:a,text:c,learn_more:"https://www.dropbox.com/help/syncing-uploads/web-based-files"}],onFinalAccept:o,onAbortAction:r?o:void 0})}else o()}))}})),define("modules/clean/react/fileops_actions",["require","exports","tslib","react","modules/clean/em_string","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/browse/api","modules/clean/react/browse/models","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/store","modules/clean/react/files_view/file_actions/api_v2","modules/clean/react/files_view/file_actions/file_from_metadata","modules/clean/react/files_view/file_actions/rollback","modules/clean/react/snackbar","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/undo","modules/clean/viewer","modules/clean/web_user_action_events","modules/core/i18n","modules/core/notify"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S,v,E,w,b,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),i=r.__importStar(i),s=r.__importStar(s),a=r.__importStar(a),c=r.__importStar(c),u=r.__importStar(u),f=r.__importStar(f);var T="view_only_access_error",F="off_team_owner_error",I="owner_only_manage_membership_error",O="team_space_owner_only_manage_membership_error",C="team_space_only_on_team_sharing_error",P="ns_have_mounted_children_ns_error";t.copyFiles=function(e){return e.useApiV2?D(e):A(e)};var A=function(e){var o=e.files,n=e.newPath,s=e.checkFSWs,l=e.onSuccess,d=e.onRequestNotSent,u=e.onUndo,p=e.user,f=e.dataApi;!(void 0===f?c:f).copyFiles({files:o,newPath:n,checkFSWs:s,userId:p.id,onSuccess:function(s){var c=s.newFiles,d=s.changesets,f=s.failureDetails;if(f){a.showFileSystemWarningsModal({fsws:f,onFinalAccept:function(){t.copyFiles(r.__assign(r.__assign({},e),{checkFSWs:!1}))},confirmText:b.intl.formatMessage({id:"r3T3xT",defaultMessage:"Copy"})})}else l&&l(c),i.notifyCopySuccess(o.length,p,d,n,(function(){u&&u()}))}})&&d&&d()};function D(e){return r.__awaiter(this,void 0,Promise,(function(){var t,o,n,i,s,a,l;return r.__generator(this,(function(r){switch(r.label){case 0:return t=e.files,o=e.newPath,n=e.onUndo,i=e.onSuccess,s=e.user,h.Snackbar.sync(b.intl.formatMessage({id:"tL3kkO",defaultMessage:"{count, plural, one{Copying {count} item...} other{Copying {count} items...}}"},{count:t.length}),!0,"browse-action"),[4,f.copyFiles(t,o,s.id,!1)];case 1:return a=r.sent(),l={successLogAction:w.WebUserActionLogEvent.COPY_REQUEST_SUCCESS,failedLogAction:w.WebUserActionLogEvent.COPY_REQUEST_FAIL,undoingLogAction:w.WebUserActionLogEvent.COPY_UNDO,undoFailedLogAction:w.WebUserActionLogEvent.COPY_UNDO_REQUEST_FAIL,undoSuccessLogAction:w.WebUserActionLogEvent.COPY_UNDO_REQUEST_SUCCESS,undoingSnackbarText:b.intl.formatMessage({id:"/M5Btv",defaultMessage:"Undoing copy..."}),undoFailedSnackbarText:b.intl.formatMessage({id:"zHeX5Y",defaultMessage:"Couldn’t undo copy."}),undoSuccessSnackbarText:b.intl.formatMessage({id:"hvAv6t",defaultMessage:"Copy undone."}),getFailureSnackbarText:function(e){return b.intl.formatMessage({id:"G2jO1n",defaultMessage:"{count, plural, one{Couldn’t copy {count} item.} other{Couldn’t copy {count} items.}}"},{count:e})},getPartialSuccessSnackbarText:function(e,t){return b.intl.formatMessage({id:"hR2/Hh",defaultMessage:"{count, plural, one{Copied {succesfully_copied_files} out of {count} item.} other{Copied {succesfully_copied_files} out of {count} items.}}"},{count:t,succesfully_copied_files:e})},getSuccessSnackbarText:function(e){return b.intl.formatMessage({id:"BDtFp+",defaultMessage:"{count, plural, one{Copied {count} item.} other{Copied {count} items.}}"},{count:e})}},L(a,s,t,o,l,i,n),[2]}}))}))}function R(e){return r.__awaiter(this,void 0,Promise,(function(){var t,o,n,i,a,l,c,d,u,p;return r.__generator(this,(function(r){switch(r.label){case 0:return t=e.path,o=e.files,n=e.newPath,i=e.onUndo,a=e.onSuccess,l=e.user,c=e.dataApiV2,d=void 0===c?f:c,void 0!==t&&s.paths_are_equal(t,n)?(h.Snackbar.fail(b.intl.formatMessage({id:"V6/bVk",defaultMessage:"Those files already exist in that folder."}),"browse-action"),[2]):(h.Snackbar.sync(b.intl.formatMessage({id:"ENlS4s",defaultMessage:"{count, plural, one{Moving {count} item...} other{Moving {count} items...}}"},{count:o.length}),!0,"browse-action"),[4,d.moveFiles(o,n,l.id,!1,!1)]);case 1:return u=r.sent(),p={successLogAction:w.WebUserActionLogEvent.MOVE_REQUEST_SUCCESS,failedLogAction:w.WebUserActionLogEvent.MOVE_REQUEST_FAIL,undoingLogAction:w.WebUserActionLogEvent.MOVE_UNDO,undoFailedLogAction:w.WebUserActionLogEvent.MOVE_UNDO_REQUEST_FAIL,undoSuccessLogAction:w.WebUserActionLogEvent.MOVE_UNDO_REQUEST_SUCCESS,undoingSnackbarText:b.intl.formatMessage({id:"BDPPA/",defaultMessage:"Undoing move..."}),undoFailedSnackbarText:b.intl.formatMessage({id:"ENMVb1",defaultMessage:"Couldn’t undo move."}),undoSuccessSnackbarText:b.intl.formatMessage({id:"O7CH0I",defaultMessage:"Move undone."}),getFailureSnackbarText:function(e){return b.intl.formatMessage({id:"Dr7iSB",defaultMessage:"{count, plural, one{Couldn’t move {count} item.} other{Couldn’t move {count} items.}}"},{count:e})},getPartialSuccessSnackbarText:function(e,t){return b.intl.formatMessage({id:"utUeHX",defaultMessage:"{count, plural, one{Moved {succesfully_moved_files} out of {count} item.} other{Moved {succesfully_moved_files} out of {count} items.}}"},{count:t,succesfully_moved_files:e})},getSuccessSnackbarText:function(e){return b.intl.formatMessage({id:"tFGyx0",defaultMessage:"{count, plural, one{Moved {count} item.} other{Moved {count} items.}}"},{count:e})}},L(u,l,o,n,p,a,i),[2]}}))}))}t.copyFiles_v2=D,t.moveFiles=function(e){return e.useApiV2?R(e):M(e)},t.moveFiles_v2=R;var M=function(e){var o=e.path,n=e.files,s=e.newPath,l=e.checkFSWs,d=e.onSuccess,u=e.onRequestNotSent,p=e.onUndo,f=e.user,_=e.dataApi,m=void 0===_?c:_,h=function(o){var l=o.newFiles,c=o.changesets,u=o.failureDetails;if(u){a.showFileSystemWarningsModal({fsws:u,onFinalAccept:function(){t.moveFiles(r.__assign(r.__assign({},e),{checkFSWs:!1}))},confirmText:b.intl.formatMessage({id:"ds25UH",defaultMessage:"Move"})})}else i.notifyMoveSuccess(n.length,f,c,s,(function(){p&&p()})),d&&d(l)};!m.moveFiles({path:o,files:n,newPath:s,checkFSWs:l,userId:f.id,onSuccess:h,onError:function(e){"This will result in losing ownership of these folders."===e?(y.Notify.clear(),a.showConfirmOwnershipTransferModal((function(){m.moveFiles({path:o,files:n,newPath:s,userId:f.id,onSuccess:h,allowOwnershipTransfer:!0})}))):N(f,e,n,s)},allowOwnershipTransfer:!1})&&u&&u()};function N(e,t,r,i,l){var c=E.Viewer.get_viewer().team_name,_=!1;"is_cdm_member"in e&&e.is_cdm_member&&s.inSubDirectory(e.cdm_tmf_path,i)&&(_=!0);var m=(function(e,t,r,i,s){var a=b.intl.formatMessage({id:"gVzSq7",defaultMessage:"You don’t have permission to move some of these items. Try moving items individually."}),l=null,c=(function(e){return 0===e.length?"":f.getFilenameFromActionInfo(e[0])})(i);t===F?l=1===i.length?null==r?b.intl.formatMessage({id:"eqzXgU",defaultMessage:"The owner of <strong>{file_name}</strong> is a member of another team."},{file_name:n.Emstring.em_snippet(c,S.SNIPPET_SIZES.FILENAME),strong:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.default.createElement("strong",{style:{fontWeight:500}},e)}}):b.intl.formatMessage({id:"F7A+9f",defaultMessage:"The owner of <strong>{file_name}</strong> isn’t a member of {team_name}."},{team_name:r,file_name:n.Emstring.em_snippet(c,S.SNIPPET_SIZES.FILENAME),strong:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.default.createElement("strong",{style:{fontWeight:500}},e)}}):null==r?b.intl.formatMessage({id:"1mkOQ2",defaultMessage:"The owner of some of these shared folders is a member of another team."}):b.intl.formatMessage({id:"kXptr+",defaultMessage:"The owner of some of these shared folders isn’t a member of {team_name}."},{team_name:r}):t===I?l=1===i.length?"is_cdm_member"in e&&e.is_cdm_member&&!s?b.intl.formatMessage({id:"rLKsQF",defaultMessage:"Only the owner of <strong>{file_name}</strong> can move it to the {team_name} team space."},{team_name:r,file_name:n.Emstring.em_snippet(c,S.SNIPPET_SIZES.FILENAME),strong:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.default.createElement("strong",{style:{fontWeight:500}},e)}}):b.intl.formatMessage({id:"Xkb8gG",defaultMessage:"Only the owner of <strong>{file_name}</strong> can move it to a team folder."},{file_name:n.Emstring.em_snippet(c,S.SNIPPET_SIZES.FILENAME),strong:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.default.createElement("strong",{style:{fontWeight:500}},e)}}):"is_cdm_member"in e&&e.is_cdm_member&&!s?b.intl.formatMessage({id:"Ic3QpQ",defaultMessage:"Only the owner can move some of these folders to the {team_name} team space."},{team_name:r}):b.intl.formatMessage({id:"AGXz3U",defaultMessage:"Only the owner can move some of these folders to a team folder."}):t===T?l=1===i.length?b.intl.formatMessage({id:"4nfaRz",defaultMessage:"You can only view <strong>{file_name}</strong>. Ask an owner or editor of the folder for access to edit it."},{file_name:n.Emstring.em_snippet(c,S.SNIPPET_SIZES.FILENAME),strong:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.default.createElement("strong",{style:{fontWeight:500}},e)}}):b.intl.formatMessage({id:"vSscn6",defaultMessage:"You can’t edit some of these folders. Ask an owner or editor of the folders for access to edit them."}):t===O||t===C?l=1===i.length?b.intl.formatMessage({id:"xYXgy4",defaultMessage:"If you need to move <strong>{file_name}</strong>, ask your admin to move it for you."},{file_name:n.Emstring.em_snippet(c,S.SNIPPET_SIZES.FILENAME),strong:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.default.createElement("strong",{style:{fontWeight:500}},e)}}):a:t===P&&(l=1===i.length?b.intl.formatMessage({id:"sFivS0",defaultMessage:"<strong>{file_name}</strong> has other shared folders inside it. Try moving each shared folder individually."},{file_name:n.Emstring.em_snippet(c,S.SNIPPET_SIZES.FILENAME),strong:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.default.createElement("strong",{style:{fontWeight:500}},e)}}):a);return l})(e,t,c,r,_);if(null!=m){y.Notify.clear();var h=t===O||t===C||t===P,v=(function(e,t,r,o,i){if(t)return 1===o?b.intl.formatMessage({id:"MHxxzk",defaultMessage:"Can’t move out of the team space"}):b.intl.formatMessage({id:"XJI7dZ",defaultMessage:"Can’t move {num_of_files} items"},{num_of_files:o});return"is_cdm_member"in e&&e.is_cdm_member&&!i?b.intl.formatMessage({id:"S+fFwb",defaultMessage:"{count, plural, one{Can’t move shared folder to the {team_name} team space} other{Can’t move shared folders to the {team_name} team space}}"},{count:o,team_name:n.Emstring.em_snippet(r,S.SNIPPET_SIZES.DISPLAY_NAME)}):b.intl.formatMessage({id:"thmzHN",defaultMessage:"{count, plural, one{Can’t move shared folder to a team folder} other{Can’t move shared folders to a team folder}}"},{count:o})})(e,h,c,r.length,_),w="";w=h?"/help/business/team-space-overview#out":"/help/business/team-space-overview#move";var A=1===r.length,D=r[0]instanceof d.File&&A&&!h?b.intl.formatMessage({id:"tHNeW4",defaultMessage:"See owner"}):void 0;a.showMoveErrorModal({title:v,content:m,learnMoreLink:w,buttonString:D,onClick:function(){r[0]instanceof d.File&&g.asyncShowShareModal(e.id,r[0],{origin:S.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS},(function(e){var t=e.path,r=e.qargs;return p.getStoreForBrowse().dispatch(u.setUrl({path:t,qargs:r}))}))}})}else l&&l()}function L(e,r,o,n,i,s,a){if(e.isError){h.Snackbar.close("browse-action");return N(r,e.error[".tag"],o,n,(function(){h.Snackbar.fail(i.getFailureSnackbarText(o.length),"browse-action")})),void l.logFileAction({uid:r.id,action:i.failedLogAction,num_files_selected:o.length,num_folders_selected:0,error_summary:e.error_summary,error:e.error[".tag"],jobId:e&&e.jobId})}var c=e.result.entries.filter((function(e){return"success"===e[".tag"]})),d=c.length,u=o.length-d,p=x(e,r,i,a);if(t.showBatchCompletedSnackbar(o.length,d,u,i,p),s){var f=[];c.forEach((function(e){if("file"===e.success[".tag"]||"folder"===e.success[".tag"]){var t=e.success,r=o.find((function(e){return e.file_id===t.id}));if(r){var n=_.fileFromMetadata(r,t);f.push(n)}}})),s([],f)}(function(e,t,r,o,n){var i=n,s=0,a=void 0,c=t.entries.filter((function(e){return"success"===e[".tag"]}));c&&(i=c.filter((function(e){return"file"===e.success[".tag"]})).length,s=c.filter((function(e){return"folder"===e.success[".tag"]})).length);var d=t.entries.filter((function(e){return"failure"===e[".tag"]}));d&&d.length>0&&(a=d[0].failure[".tag"]);l.logFileAction({uid:r,action:e,num_files_selected:i,num_folders_selected:s,jobId:o,error_summary:a})})(i.successLogAction,e.result,r.id,e.jobId,o.length)}function x(e,t,o,n){var i=this;return!e.isError&&e.result.changeset_data&&e.result.changeset_data.length>0?function(){return r.__awaiter(i,void 0,void 0,(function(){return r.__generator(this,(function(r){return h.Snackbar.close("browse-action"),l.logFileAction({uid:t.id,action:o.undoingLogAction,num_files_selected:e.result.entries.length,num_folders_selected:0}),m.rollback({changeset_data:e.result.changeset_data,userId:t.id,onSuccess:function(){h.Snackbar.complete(o.undoSuccessSnackbarText,"browse-action"),l.logFileAction({uid:t.id,action:o.undoSuccessLogAction,num_files_selected:e.result.entries.length,num_folders_selected:0}),n&&n(!0)}}),[2]}))}))}:void 0}t.getBatchUndoHandler=x,t.showBatchCompletedSnackbar=function(e,t,r,o,n){if(t>0&&r>0){var i=o.getPartialSuccessSnackbarText(t,e);n?(v.setHandleUndo(n),h.Snackbar.completeWithUndo(i,n,"browse-action")):h.Snackbar.complete(i,"browse-action")}else if(t>0){i=o.getSuccessSnackbarText(t);n?(v.setHandleUndo(n),h.Snackbar.completeWithUndo(i,n,"browse-action")):h.Snackbar.complete(i,"browse-action")}else h.Snackbar.fail(o.getFailureSnackbarText(r),"browse-action")}})),define("modules/clean/react/files_view/column_header_menu",["require","exports","tslib","classnames","spectrum/icon_form","spectrum/popover","react","modules/clean/react/files_view/constants","modules/clean/react/files_view/types","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePopoverSelection=function(e){var r=t.props,o=r.onSort,n=r.onSelection,i=r.column;if(e===l.SortDirection.ASCENDING||e===l.SortDirection.DESCENDING)o(i.sortField,e);else{if(n(e,i),t.props.isSearchMode)return void o(e.sortField,l.SortDirection.DESCENDING);1===t.props.visibleColumns.length&&o(e.sortField,t.props.sortDirection||l.SortDirection.ASCENDING)}},t}return r.__extends(t,e),t.prototype._columnMenuTitle=function(){switch(this.props.viewType){case l.ViewType.Grid:case l.ViewType.LargeGrid:return c.intl.formatMessage({id:"jw2Ng0",defaultMessage:"Group by"});case l.ViewType.List:default:return this.props.isSearchMode?c.intl.formatMessage({id:"oqW97K",defaultMessage:"Sort by"}):c.intl.formatMessage({id:"2X0e4z",defaultMessage:"Show"})}},t.prototype.render=function(){var e=this.props,t=e.column,r=e.columns,d=e.visibleColumns,u=e.sortDirection,p=e.isSearchMode;if(t.isSortDisabled)return s.default.createElement("div",{className:"normal brws-column-header-menu"},s.default.createElement("span",{className:"brws-column-header-menu-trigger-disabled"},t.label));var f,_=!(t.sortField!==l.SortField.RELEVANCE||!p),m=u!==l.SortDirection.ASCENDING||_?u!==l.SortDirection.DESCENDING||_?"caret-down":"sort-arrow-down":"sort-arrow-up",h=_?null:s.default.createElement(i.PopoverItemGroupSeparator,{key:"show-separator"}),g=p?a.SEARCH_LIST_VIEW_SORT_ENABLED_COLUMNS:r;return!t.isLocked&&r&&r.length&&(f=[h,s.default.createElement(i.PopoverItemGroup,{key:"show-item-group"},s.default.createElement(i.PopoverItemGroupTitle,{className:"brws-column-header-menu-title",key:"show-title"},this._columnMenuTitle()),g.filter((function(e){return!e.isLocked})).map((function(e){return s.default.createElement(i.PopoverSelectableItem,{key:e.sortField,disabled:d.map((function(e){return e.sortField})).includes(e.sortField)&&e.sortField!==t.sortField,selected:e.sortField===t.sortField,value:e},e.label)})))]),s.default.createElement(i.Popover,{className:"brws-column-header-menu",onSelection:this.handlePopoverSelection},s.default.createElement(i.PopoverTrigger,{className:o.default("brws-column-header-menu-trigger",{"brws-column-header-menu-trigger-active":!!u&&!_}),title:t.popoverTriggerLabel,"aria-label":c.intl.formatMessage({id:"Tsg7+6",defaultMessage:"Sort by {sort_by}"},{sort_by:t.label})},s.default.createElement("span",null,t.label),s.default.createElement("span",{className:"brws-column-header-menu-label-icon-wrapper"},s.default.createElement(n.IconForm,{className:"brws-column-header-menu-label-icon",name:m}))),s.default.createElement(i.PopoverContent,null,!_&&s.default.createElement(i.PopoverItemGroup,null,s.default.createElement(i.PopoverItemGroupTitle,{className:"brws-column-header-menu-title"},c.intl.formatMessage({id:"HXV3TA",defaultMessage:"Order"})),s.default.createElement(i.PopoverSelectableItem,{selected:u===l.SortDirection.ASCENDING,value:l.SortDirection.ASCENDING,disabled:t.isSortOrderOptionDisabled},c.intl.formatMessage({id:"KyJseU",defaultMessage:"Ascending"})),s.default.createElement(i.PopoverSelectableItem,{selected:u===l.SortDirection.DESCENDING,value:l.SortDirection.DESCENDING,disabled:t.isSortOrderOptionDisabled},c.intl.formatMessage({id:"Njd630",defaultMessage:"Descending"}))),f))},t})((s=r.__importDefault(s)).default.PureComponent);t.ColumnHeaderMenu=d})),define("modules/clean/react/files_view/column_header",["require","exports","tslib","classnames","react","spectrum/checkbox","spectrum/table","modules/clean/react/files_view/column_header_menu","modules/clean/react/files_view/fixed_table_head","modules/clean/react/files_view/sticky_table_head","modules/clean/react/files_view/types","modules/clean/react/files_view/view_type_column_header_menu","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isHovered:!1},t.handleChangeSelectAllCheckbox=function(e){"unchecked"===e?t.props.onDeselectAll():t.props.onSelectAll()},t.handleMouseEnter=function(){t.setState({isHovered:!0})},t.handleMouseLeave=function(){t.setState({isHovered:!1})},t}return r.__extends(t,e),t.prototype.getAriaSortValue=function(e){return e===d.SortDirection.ASCENDING?"ascending":e===d.SortDirection.DESCENDING?"descending":"none"},t.prototype.render=function(){var e=this,t=this.state.isHovered,d=this.props,f=d.columnFlex,_=d.isCompactMode,m=d.isSelectMode,h=d.currentSort,g=d.onSelection,S=d.onSort,v=d.onSwitchViewType,E=d.selectAllCheckboxState,w=void 0===E?"unchecked":E,b=d.showSelectAllCheckbox,y=void 0===b||b,T=d.stickyOffsetHeight,F=d.stickyOffsetTop,I=d.columns,O=d.visibleColumns,C=d.viewType,P=d.viewTypes,A=d.viewTypeLabels,D=d.onTTI,R=d.isSearchMode,M=d.presentationOnly,N=d.variant,L=!m&&!t&&!_,x=r.__spreadArrays([n.default.createElement(s.TableHeadCell,{className:"brws-column-header-table-cell brws-checkbox-cell",key:"checkbox-cell",role:M?"presentation":"columnheader",scope:"col"},n.default.createElement("div",{className:"brws-vertically-center"},y?n.default.createElement(i.Checkbox,{className:o.default("brws-checkbox",{"brws-checkbox-checked":"checked"===w}),checked:w,onChange:this.handleChangeSelectAllCheckbox,variant:L?"invisible":"default",ariaLabel:p.intl.formatMessage({id:"kTr/8f",defaultMessage:"Select all"})}):null))],O.map((function(t,r){var o=h&&h.sortField===t.sortField?h.sortDirection:void 0;return n.default.createElement(s.TableHeadCell,{key:r,role:M?"presentation":"columnheader",scope:"col","aria-sort":e.getAriaSortValue(o),className:"brws-column-header-table-cell"},n.default.createElement(a.ColumnHeaderMenu,{column:t,sortDirection:o,columns:I,visibleColumns:O,onSelection:g,onSort:S,viewType:C,isSearchMode:R}),r===O.length-1&&n.default.createElement(u.ViewTypeColumnHeaderMenu,{onTTI:D,viewType:C,viewTypes:P,viewTypeLabels:A,onSwitchViewType:v}))}))),k={onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave};return"default"===N?n.default.createElement(s.TableHead,r.__assign({className:"brws-column-header"},k),x):"fixed"===N?n.default.createElement(l.FixedTableHead,r.__assign({offsetHeight:T},k),x):"sticky-native"===N?n.default.createElement(s.TableHead,r.__assign({className:"brws-column-header brws-column-header--sticky",style:{position:"sticky",top:F,zIndex:1}},k),x):n.default.createElement(c.StickyTableHead,r.__assign({columnFlex:f,offsetHeight:T,offsetTop:F,className:"brws-column-header"},k),x)},t.defaultProps={variant:"fixed"},t})((n=r.__importDefault(n)).default.PureComponent);t.ColumnHeader=f})),define("modules/clean/react/files_view/column_helpers",["require","exports","modules/clean/immutability_helper"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.swapColumns=function(e,t,o){var n=e.map((function(e){return e.sortField})).indexOf(t),i=e.map((function(e){return e.sortField})).indexOf(o);if(n===i||-1===n||-1===i)return e;var s=e[n],a=e[i];return r.splice(r.splice(e,n,1,a),i,1,s)}})),define("modules/clean/react/files_view/column_manager",["require","exports","tslib","external/lodash","react","spectrum/dimensions","modules/clean/immutability_helper","modules/clean/react/files_view/column_helpers","modules/clean/react/files_view/types"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importDefault(n),t.ColumnManager=function(e){var t=e.responsiveContainer,o=r.__rest(e,["responsiveContainer"]);return(o.isMatchedLarge||o.isMatchedMedium)&&t?n.default.createElement(i.Dimensions,null,(function(e){var t=e.width,i=r.__assign({},o);return t&&(i.isMatchedLarge=t>824,i.isMatchedMedium=!i.isMatchedLarge&&t>588),n.default.createElement(c,r.__assign({},i,{containerWidth:t}))})):n.default.createElement(c,r.__assign({},o))};var c=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleSelection=function(e,t){var o=r.props,n=o.viewType,i=o.onColumnsChanged,c=o.viewTypeColumns,d=r.state.visibleColumns,u=c?c[l.ViewType.List]:void 0,p=c?c[l.ViewType.Grid]:void 0;if(u&&p){var f=d.indexOf(t);if(-1===f||d.includes(e))r.changeVisibleColumns(d);else{var _=s.splice(d,f,1,e);r.changeVisibleColumns(_);var m=r.isSizeColumnPresent(_);n===l.ViewType.List?i(a.swapColumns(u,t.sortField,e.sortField),l.ViewType.List,m):(i(a.swapColumns(p,t.sortField,e.sortField),n,m),e.sortField!==l.SortField.FILENAME&&i(a.swapColumns(u,u[1].sortField,e.sortField),l.ViewType.List,m))}}},r}return r.__extends(t,e),t.prototype.UNSAFE_componentWillMount=function(){this.changeVisibleColumns(this.computeVisibleColumns(this.props),!0)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this.props.viewTypeColumns,n=this.state.visibleColumns,i=this.getNumVisibleColumns(this.props),s=this.getNumVisibleColumns(e);if(o.isEqual(this.props.columns,e.columns)&&this.props.viewType===e.viewType){if(s<i)this.changeVisibleColumns(n.slice(0,s),!0);else if(s>i){u=this.props.columns;var c=s-n.length,d=o.filter(u,(function(e){return!o.find(n,(function(t){return t.sortField===e.sortField}))})).slice(0,c);this.changeVisibleColumns(r.__spreadArrays(n,d),!0)}}else if(1===s&&e.columns.length&&e.currentSort){var u=e.columns,p=e.viewType,f=t?t[l.ViewType.Grid]:void 0;switch(p){case l.ViewType.List:this.changeVisibleColumns([u[0]],!0);break;case l.ViewType.Grid:case l.ViewType.LargeGrid:if(f){var _=e.currentSort,m=u.find((function(e){return e.sortField===_.sortField}))||u[0];this.deferredOnColumnsChangedHandler([m],a.swapColumns(f,f[0].sortField,m.sortField),p)}}}else this.changeVisibleColumns(e.columns.slice(0,s),!0)},t.prototype.changeVisibleColumns=function(e,t){var r=this;void 0===t&&(t=!1),this.resetChangeVisibleColumnsTimeout();var o=this.isSizeColumnPresent(e);this.setState({visibleColumns:e,canDisplayFolderSizes:o}),t?this.changeVisibleColumnsTimeout=setTimeout((function(){r.resetChangeVisibleColumnsTimeout(),r.props.onCanDisplayFolderSizesChanged(o)})):this.props.onCanDisplayFolderSizesChanged(o)},t.prototype.resetChangeVisibleColumnsTimeout=function(){this.changeVisibleColumnsTimeout&&(clearTimeout(this.changeVisibleColumnsTimeout),this.changeVisibleColumnsTimeout=void 0)},t.prototype.deferredOnColumnsChangedHandler=function(e,t,r){var o=this;this.resetDeferredOnColumnsChangedHandler();var n=this.isSizeColumnPresent(e);this.setState({visibleColumns:e,canDisplayFolderSizes:n}),this.onColumnsChangesTimeout=setTimeout((function(){o.resetDeferredOnColumnsChangedHandler(),o.props.onColumnsChanged(t,r,n)}))},t.prototype.resetDeferredOnColumnsChangedHandler=function(){this.onColumnsChangesTimeout&&(clearTimeout(this.onColumnsChangesTimeout),this.onColumnsChangesTimeout=void 0)},t.prototype.computeVisibleColumns=function(e){return e.columns.slice(0,this.getNumVisibleColumns(e))},t.prototype.getNumVisibleColumns=function(e){var t=e.isMatchedLarge,r=e.isMatchedMedium;switch(e.viewType){case l.ViewType.Grid:case l.ViewType.LargeGrid:return 1;case l.ViewType.List:default:return t?3:r?2:1}},t.prototype.isSizeColumnPresent=function(e){return e.some((function(e){return e.sortField===l.SortField.SIZE}))},t.prototype.render=function(){var e=this.props,t=e.children,r=e.containerWidth,o=this.state,n=o.visibleColumns,i=o.canDisplayFolderSizes;if(!t)return null;var s=t;return"function"==typeof t&&(s=t({visibleColumns:n,canDisplayFolderSizes:i,handleSelection:this.handleSelection,containerWidth:r})),s},t})(n.default.PureComponent);t.ColumnManagerComponent=c})),define("modules/clean/react/files_view/controller",["require","exports","tslib","react-redux","react","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/store","modules/clean/react/files_view/files_view","modules/clean/react/files_view/prop_upserter","modules/clean/react/files_view/legacy_types"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),r.__exportStar(c,t),t.splitProps=function(e){var t=e.arePostTTIModulesLoaded,o=e.context,n=e.createNewFolderState,i=e.items,s=e.selection,a=e.user,l=e.viewType,c=e.responsive,d=e.currentSort,u=e.disabledMultiselect,p=e.dropTargetHighlightMode,f=e.enableUnity,_=e.expBizFoldersEmptyStateAdmin,m=e.expBizFoldersEmptyStateUser,h=e.expSnippets,g=e.extensionsFeatureFlags,S=e.fileRename,v=e.filteredContactName,E=e.renderFilenameSubtitleAsLink,w=e.highDensity,b=e.isOverFreeQuota,y=e.isSearchMode,T=e.loadingState,F=e.sharingServiceInfo,I=e.starredState,O=e.teamFolders,C=e.useSearchSuccessBanner,P=e.eligibleForFirstTaskSubtitle,A=e.eligibleForBasicToBizSubtitle,D=e.expVaultEnableViewOnlySharing;return{ownProps:r.__rest(e,["arePostTTIModulesLoaded","context","createNewFolderState","items","selection","user","viewType","responsive","currentSort","disabledMultiselect","dropTargetHighlightMode","enableUnity","expBizFoldersEmptyStateAdmin","expBizFoldersEmptyStateUser","expSnippets","extensionsFeatureFlags","fileRename","filteredContactName","renderFilenameSubtitleAsLink","highDensity","isOverFreeQuota","isSearchMode","loadingState","sharingServiceInfo","starredState","teamFolders","useSearchSuccessBanner","eligibleForFirstTaskSubtitle","eligibleForBasicToBizSubtitle","expVaultEnableViewOnlySharing"]),upsertedProps:{arePostTTIModulesLoaded:t,context:o,createNewFolderState:n,items:i,selection:s,user:a,viewType:l,responsive:c,currentSort:d,disabledMultiselect:u,dropTargetHighlightMode:p,enableUnity:f,expBizFoldersEmptyStateAdmin:_,expBizFoldersEmptyStateUser:m,expSnippets:h,extensionsFeatureFlags:g,fileRename:S,filteredContactName:v,renderFilenameSubtitleAsLink:E,highDensity:w,isOverFreeQuota:b,isSearchMode:y,loadingState:T,sharingServiceInfo:F,starredState:I,teamFolders:O,useSearchSuccessBanner:C,eligibleForFirstTaskSubtitle:P,eligibleForBasicToBizSubtitle:A,expVaultEnableViewOnlySharing:D}}};var d={deleteInstance:i.deleteInstance},u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentWillUnmount=function(){var e=this.props;(0,e.deleteInstance)(e.id)},t.prototype.render=function(){return null},t})(n.default.Component);t.FilesViewUnmountCleanupComponent=u;var p=o.connect(null,d)(u);t.FilesViewWithUpserter=function(e){var o=e.id,i=t.splitProps(e),s=i.ownProps,c=i.upsertedProps;return n.default.createElement(n.default.Fragment,null,n.default.createElement(l.FilesViewPropUpserter,r.__assign({id:o},c)),n.default.createElement(a.FilesView,r.__assign({id:o},s)),n.default.createElement(p,{id:o}))};var f=(function(e){function t(r){var o=e.call(this,r)||this;return o.id=r.id||r.namespace+":"+t.counter++,o}return r.__extends(t,e),t.prototype.render=function(){return this.props.children(this.id)},t.counter=0,t})(n.default.Component);t.ProvideDefaultId=f,t.ConnectedFilesViewController=function(e){var o=e.id,i=r.__rest(e,["id"]);return n.default.createElement(f,{id:o,namespace:"files-view"},(function(e){return n.default.createElement(t.FilesViewWithUpserter,r.__assign({id:e},i))}))};var _=s.getStoreForFilesView();t.FilesViewController=function(e){return n.default.createElement(o.Provider,{store:_},n.default.createElement(t.ConnectedFilesViewController,r.__assign({},e)))}})),define("modules/clean/react/files_view/culled_table_body",["require","exports","tslib","spectrum/table","modules/clean/react/files_view/util","react"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),t.CulledTableBodyWithScrollContainer=function(e){var t=e.scrollContainer,o=r.__rest(e,["scrollContainer"]);if(t){var a=t.current;if(!a)return null;var l=i.default.useMemo((function(){return n.createFakeWindow(a)}),[a]);return i.default.createElement(s,r.__assign({},o,{shouldUseWindowAsScrollContainer:!0,window:l}))}return i.default.createElement(s,r.__assign({},o))};var s=(function(e){function n(t){var r=e.call(this,t)||this;return r.updateOffsetCache(),r}return r.__extends(n,e),n.prototype.componentDidMount=function(){this.updateScroll(!0)},n.prototype.componentDidUpdate=function(e){e.listItemHeight!==this.props.listItemHeight&&this.updateOffsetCache(),e.scrollToRow!==this.props.scrollToRow&&this.updateScroll(void 0===e.scrollToRow||e.scrollToRow<0)},n.prototype.updateOffsetCache=function(e){var r=(void 0===e?this.props:e).listItemHeight;this.offsetCache=Array.isArray(r)?t.computeOffsetCache(r):void 0},n.prototype.updateScroll=function(e){var r=this.props,o=r.scrollToRow,n=r.listItemHeight,i=r.viewportTopOffset,s=void 0===i?0:i,a=r.scrollPositionOffset,l=void 0===a?0:a,c=r.window;if(void 0!==o&&o>=0){var d=(Array.isArray(n)?this.offsetCache[o]:(o+1)*n)+l,u=d-(Array.isArray(n)?n[o]:n);t.scrollTo([u,d],s,c,e)}},n.prototype.render=function(){var e=this.props,t=e.viewportTopOffset,n=(e.scrollToRow,r.__rest(e,["viewportTopOffset","scrollToRow"]));return i.default.createElement(o.CulledTableBody,r.__assign({viewportHeight:window.innerHeight-t},n))},n.defaultProps={viewportTopOffset:0},n})(i.default.PureComponent);t.CulledTableBodyWithScrollToRow=s;t.scrollTo=function(e,t,r,o){var n=e[0],i=e[1];void 0===t&&(t=0),void 0===r&&(r=window);var s=r.innerHeight-t,a=(function(e){return void 0===e&&(e=window),"scrollingElement"in e.document&&e.document.scrollingElement?e.document.scrollingElement.scrollTop:e.document.documentElement.scrollTop})(r),l=a+s;n<a?r.scrollTo(0,n):i>l&&(o&&i-n<s/2?r.scrollTo(0,i-s/2):r.scrollTo(0,i-s))},t.computeOffsetCache=function(e){return e.reduce((function(e,t){return e.push(t+(e[e.length-1]||0)),e}),[])}})),define("modules/clean/react/files_view/data/action_creators",["require","exports","tslib","external/lodash","modules/clean/api_v2/user_client","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/types","modules/clean/storage","modules/core/cookies","external/lodash","modules/clean/react/browse/action_logger","modules/clean/web_user_action_events"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importStar(s),a=r.__importStar(a),u=r.__importStar(u),t.setViewType=function(e){var t=e.user,r=e.viewType;return function(e,o){e({type:l.ActionTypes.SET_VIEW_TYPE,payload:{viewType:r}}),c.UserLocalStorage.set(t.id,i.VIEW_TYPE_STORAGE_KEY,s.viewTypes(o()))}},t.loadViewTypes=function(e){var t=e.user;return function(e,r){var o,n=c.UserLocalStorage.get(t.id,i.VIEW_TYPE_STORAGE_KEY);if(n)e({type:l.ActionTypes.SET_VIEW_TYPES,payload:{viewTypes:n}});else{var a=d.Cookies.read(i.VIEW_TYPE_COOKIE_NAME);d.Cookies.delete(i.VIEW_TYPE_COOKIE_NAME),a&&(e({type:l.ActionTypes.SET_VIEW_TYPES,payload:{viewTypes:(o={},o[i.VIEW_TYPE_GLOBAL_SCOPE]=a,o)}}),c.UserLocalStorage.set(t.id,i.VIEW_TYPE_STORAGE_KEY,s.viewTypes(r())))}}},t.setViewTypeScope=function(e){var t=e.viewTypeScope;return{type:l.ActionTypes.SET_VIEW_TYPE_SCOPE,payload:{viewTypeScope:t}}},t.setViewTypeColumns=function(e){var t=e.columns,o=e.viewType,n=e.user;return function(e,a){var d;c.UserLocalStorage.set(n.id,i.COLUMNS_STORAGE_KEY+"_"+o,t);var u=r.__assign(r.__assign({},s.viewTypeColumns(a())),((d={})[o]=t,d));e({type:l.ActionTypes.SET_VIEW_TYPE_COLUMNS,payload:{viewTypeColumns:u}})}},t.loadViewTypeColumns=function(e){var t=e.user;return function(e,o){var n=s.viewTypeColumns(o());i.AllViewTypes.forEach((function(e){var o,s=c.UserLocalStorage.get(t.id,i.COLUMNS_STORAGE_KEY+"_"+e);s&&(n=r.__assign(r.__assign({},n),((o={})[e]=s,o)))})),e({type:l.ActionTypes.SET_VIEW_TYPE_COLUMNS,payload:{viewTypeColumns:n}})}},t.setFileRename=function(e){var t=e.file,r=e.renameState;return{type:l.ActionTypes.SET_FILE_RENAME,payload:{file:t,renameState:r}}},t.resetScroll=function(){return{type:l.ActionTypes.SET_SCROLL,payload:{scrollTop:0}}};t.upsertInstance=function(e,t){return function(r,n){var i,a;i=t,(!(a=s.selectInstances(n()).get(e))||Object.keys(i).some((function(e){return!o.isEqual(i[e],a[e])})))&&r({type:l.ActionTypes.UPSERT_INSTANCE,payload:{id:e,instance:t}})}},t.deleteInstance=function(e){return{type:l.ActionTypes.DELETE_INSTANCE,payload:{id:e}}},t.openKeyboardShortcutsModal=function(t){return function(o,n){(function(t){r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(o){switch(o.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/files_view/keyboard_shortcuts_modal"],t,r)})).then(r.__importStar)];case 1:return(0,o.sent().showKeyboardShortcutsModal)(t),[2]}}))}))})(a.selectIsListView(n(),t))}};t.batchLoadPreviewThumbnails=function(e,t,o,i){return r.__awaiter(void 0,void 0,void 0,(function(){var a,c,d,u,_;return r.__generator(this,(function(r){switch(r.label){case 0:a=s.previewThumbnailsToLoad(t()),c=s.viewType(t()),r.label=1;case 1:return r.trys.push([1,4,,5]),a.length>0?[4,(new n.UserApiV2Client).ns("previews").rpc("get_preview_data_batch",{files:a},{subjectUserId:o})]:[3,3];case 2:d=r.sent(),u=[],d.results.forEach((function(e){var t,r=null===(t=e.preview)||void 0===t?void 0:t.content,o=e.file.file_id;o&&r&&(r.hasOwnProperty("thumbnail_url_tmpl")?u.push({file_id:o,preview_url:r.thumbnail_url_tmpl}):r.hasOwnProperty("placeholder_image_url")&&u.push({file_id:o,preview_url:r.placeholder_image_url}))})),u.length>0&&(e((function(e){var t=e.preview_thumbnails;return{type:l.ActionTypes.PREVIEW_THUMBNAILS_LOADED,payload:{preview_thumbnails:t}}})({preview_thumbnails:u})),m={view_type:c,userId:o,num_files_requested:a.length,num_files_retrieved:u.length,elapsed_ms:Date.now()-i},p.logWebUserAction({user_id:m.userId,event_name:f.WebUserActionLogEvent.PREVIEW_THUMBNAIL_SUCCESS,extra:{view_type:m.view_type,num_files_requested:m.num_files_requested.toString(),num_files_retrieved:m.num_files_retrieved.toString(),elapsed_ms:m.elapsed_ms.toString()}})),r.label=3;case 3:return[3,5];case 4:return _=r.sent(),e((function(e){var t=e.files;return{type:l.ActionTypes.PREVIEW_THUMBNAILS_REMOVED,payload:{files:t}}})({files:a})),(function(e){p.logWebUserAction({user_id:e.userId,event_name:f.WebUserActionLogEvent.PREVIEW_THUMBNAIL_ERROR,extra:{view_type:e.view_type,error_summary:e.error_summary||"unknown"}})})({view_type:c,userId:o,error_summary:null==_?void 0:_.toString()}),[3,5];case 5:return[2]}var m}))}))};var _=u.debounce((function(e,r,o,n){t.batchLoadPreviewThumbnails(e,r,o,n)}),300);t.loadPreviewThumbnails=function(e,t){return function(r,o){var n=s.previewThumbnails(o()),i=e.filter((function(e){return e.file_id&&!n.hasOwnProperty(e.file_id)}));i.length>0&&(r((function(e){var t=e.files;return{type:l.ActionTypes.PREVIEW_THUMBNAILS_LOADING,payload:{files:t}}})({files:i})),_(r,o,t,Date.now()))}}})),define("modules/clean/react/files_view/data/reducer",["require","exports","tslib","immutable","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/types","modules/clean/react/files_view/types"],(function(e,t,r,o,n,i,s){"use strict";var a,l;Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.defaultFilesViewState={viewTypes:(a={},a[n.VIEW_TYPE_GLOBAL_SCOPE]=s.ViewType.List,a),viewTypeScope:n.VIEW_TYPE_GLOBAL_SCOPE,viewTypeColumns:(l={},l[s.ViewType.List]=n.LIST_VIEW_COLUMNS,l[s.ViewType.Grid]=n.GRID_VIEW_COLUMNS,l[s.ViewType.LargeGrid]=n.GRID_VIEW_COLUMNS,l),fileRename:null,instances:o.Map(),previewThumbnails:{}};t.defaultFilesViewInstance={dropTargetHighlightMode:s.DropTargetHighlightMode.NONE,enableUnity:!0,loadingState:s.LoadingState.LOADING_FIRST_PAGE,fileRename:null,renderFilenameSubtitleAsLink:!0,eligibleForFirstTaskSubtitle:!1,eligibleForBasicToBizSubtitle:!1};t.filesViewReducer=function(e,o){switch(void 0===e&&(e=t.defaultFilesViewState),o.type){case i.ActionTypes.SET_VIEW_TYPE:return(function(e,t){var o,n=t.viewType;return r.__assign(r.__assign({},e),{viewTypes:r.__assign(r.__assign({},e.viewTypes),(o={},o[e.viewTypeScope]=n,o))})})(e,o.payload);case i.ActionTypes.SET_VIEW_TYPES:return(function(e,t){var o=t.viewTypes;return r.__assign(r.__assign({},e),{viewTypes:r.__assign(r.__assign({},e.viewTypes),o)})})(e,o.payload);case i.ActionTypes.SET_VIEW_TYPE_COLUMNS:return(function(e,t){var o=t.viewTypeColumns;return r.__assign(r.__assign({},e),{viewTypeColumns:o})})(e,o.payload);case i.ActionTypes.SET_VIEW_TYPE_SCOPE:return(function(e,t){var o=t.viewTypeScope;return r.__assign(r.__assign({},e),{viewTypeScope:o})})(e,o.payload);case i.ActionTypes.SET_FILE_RENAME:return(function(e,t){var o=t.payload,n=o.file,i=o.renameState;return i?r.__assign(r.__assign({},e),{fileRename:{file:n,state:i}}):r.__assign(r.__assign({},e),{fileRename:null})})(e,o);case i.ActionTypes.SET_SCROLL:return(function(e,t){return r.__assign(r.__assign({},e),{currentScroll:{scrollTop:t.scrollTop}})})(e,o.payload);case i.ActionTypes.UPSERT_INSTANCE:return(function(e,o){var n=o.payload,i=n.instance,s=n.id,a=e.instances.get(s);return r.__assign(r.__assign({},e),{instances:e.instances.set(s,r.__assign(r.__assign({},a||t.defaultFilesViewInstance),i))})})(e,o);case i.ActionTypes.DELETE_INSTANCE:return(function(e,t){var o=t.payload.id;return r.__assign(r.__assign({},e),{instances:e.instances.delete(o)})})(e,o);case i.ActionTypes.PREVIEW_THUMBNAILS_LOADING:return(function(e,t){var o=t.payload.files,n=r.__assign({},e.previewThumbnails);return o.forEach((function(e){var t;e.file_id&&!(null===(t=n[e.file_id])||void 0===t?void 0:t.isLoading)&&(n[e.file_id]={isLoading:!0,file_info:e})})),r.__assign(r.__assign({},e),{previewThumbnails:n})})(e,o);case i.ActionTypes.PREVIEW_THUMBNAILS_LOADED:return(function(e,t){var o=t.payload.preview_thumbnails,n=r.__assign({},e.previewThumbnails);return o.forEach((function(e){e.file_id&&(n[e.file_id]={isLoading:!1,preview_url:e.preview_url})})),r.__assign(r.__assign({},e),{previewThumbnails:n})})(e,o);case i.ActionTypes.PREVIEW_THUMBNAILS_REMOVED:return(function(e,t){var o=t.payload.files,n=r.__assign({},e.previewThumbnails);return o.forEach((function(e){e.file_id&&delete n[e.file_id]})),r.__assign(r.__assign({},e),{previewThumbnails:n})})(e,o)}return e}})),define("modules/clean/react/files_view/data/selectors/files_view_selectors",["require","exports","reselect","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/reducer","modules/clean/redux/namespaces","modules/clean/redux/selectors"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return s.getStateAtNamespace(e,i.FILES_VIEW_NAMESPACE_KEY)||n.defaultFilesViewState};t.viewTypes=function(e){return a(e).viewTypes},t.viewTypeScope=function(e){return a(e).viewTypeScope},t.viewTypeColumns=function(e){return a(e).viewTypeColumns},t.viewType=r.createSelector(t.viewTypes,t.viewTypeScope,(function(e,t){return t in e?e[t]:t in o.defaultViewTypes?o.defaultViewTypes[t]:e[o.VIEW_TYPE_GLOBAL_SCOPE]})),t.fileRename=function(e){return a(e).fileRename},t.currentScroll=function(e){return a(e).currentScroll},t.selectInstances=function(e){return a(e).instances},t.previewThumbnails=function(e){return a(e).previewThumbnails},t.previewThumbnailsToLoad=function(e){var r=[],o=t.previewThumbnails(e);for(var n in o)!0===o[n].isLoading&&o[n].file_info&&r.push(o[n].file_info);return r}})),define("modules/clean/react/files_view/data/selectors/instance_selectors",["require","exports","tslib","reselect","modules/clean/react/browse/models","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/file_grouper","modules/clean/react/files_view/types","modules/core/exception"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a),t.selectInstance=function(e,t){var r=i.selectInstances(e).get(t.instanceId);return l.assert(!!r,"[FilesView] Instance '"+t.instanceId+"' must be defined in redux store before mounting"),r};var c=function(e){return function(r,o){return e(t.selectInstance(r,o))}};t.selectDropTargetHighlightMode=c((function(e){return e.dropTargetHighlightMode})),t.selectMainItems=c((function(e){return e.items})),t.selectTeamFolders=c((function(e){return e.teamFolders})),t.selectContext=c((function(e){return e.context})),t.selectUser=c((function(e){return e.user})),t.selectArePostTTIModulesLoaded=c((function(e){return e.arePostTTIModulesLoaded})),t.selectViewType=c((function(e){return e.viewType})),t.selectIsGridView=function(e,r){return[a.ViewType.Grid,a.ViewType.LargeGrid].indexOf(t.selectViewType(e,r))>=0},t.selectIsListView=function(e,r){return t.selectViewType(e,r)===a.ViewType.List},t.selectCurrentSort=c((function(e){return e.currentSort})),t.selectIsSearchMode=c((function(e){return e.isSearchMode})),t.selectDisabledMultiselect=c((function(e){return!!e.disabledMultiselect})),t.selectSelection=c((function(e){return e.selection})),t.selectResponsive=c((function(e){return e.responsive})),t.selectFileRename=c((function(e){return e.fileRename})),t.selectHighDensity=c((function(e){return e.highDensity})),t.selectRenderFilenameSubtitleAsLink=c((function(e){return e.renderFilenameSubtitleAsLink})),t.selectUseSearchSuccessBanner=c((function(e){return e.useSearchSuccessBanner})),t.selectEligibleForFirstTaskSubtitle=c((function(e){return e.eligibleForFirstTaskSubtitle})),t.selectEligibleForBasicToBizSubtitle=c((function(e){return e.eligibleForBasicToBizSubtitle})),t.selectIsCompactMode=function(e,r){return!t.selectResponsive(e,r).isMatchedLarge},t.selectIsMobileMode=function(e,r){var o=t.selectResponsive(e,r);return!o.isMatchedLarge&&!o.isMatchedMedium},t.selectShouldShowFileNameHighlights=function(e,r){return t.selectIsSearchMode(e,r)},t.selectShouldShowFileNameLocation=function(e,r){return t.selectIsSearchMode(e,r)},t.selectNumItemsSelected=function(e,r){return t.selectSelection(e,r).selected.size},t.selectHasItemsSelected=function(e,r){return t.selectNumItemsSelected(e,r)>0},t.selectSections=o.createSelector(t.selectIsGridView,t.selectCurrentSort,t.selectMainItems,t.selectIsSearchMode,(function(e,t,r,o){return e&&t?s.getSections(r,t.sortField,t.sortDirection,o):s.EMPTY_SECTIONS})),t.selectItemIds=o.createSelector(t.selectMainItems,(function(e){return e.toArray().map((function(e){return e instanceof n.File?e.fq_path:e instanceof n.FileSharedWithMe?e.file_id:""}))})),t.selectExpSnippets=c((function(e){return!!e.expSnippets}))})),define("modules/clean/react/files_view/data/selectors/item_selectors",["require","exports","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/selectors/list_selectors","modules/core/exception"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectItem=function(e,t){var r=i.selectItemList(e,t),o=r&&r.get(t.itemIndex);return s.assert(!!o,"Item undefined at index: "+t.itemIndex),o},t.selectItemAssertFileOrFileSharedWithMe=function(e,o){var n=t.selectItem(e,o);return s.assert(n instanceof r.File||n instanceof r.FileSharedWithMe,"item must be File or FileSharedWithMe at index: "+o.itemIndex),n},t.selectItemSelectionId=function(e,o){var n=t.selectItemAssertFileOrFileSharedWithMe(e,o);return n instanceof r.File?o.fileToId(n):n.file_id},t.selectIsItemSelected=function(e,r){return n.selectSelection(e,r).selected.has(t.selectItemSelectionId(e,r))},t.selectIsCheckboxVisible=function(e,t){return t.isHovered||n.selectHasItemsSelected(e,t)||n.selectIsCompactMode(e,t)},t.selectShouldShowUserEducationEffects=function(e,t){var r=t.listId;return 0===t.rowIndex||"main"===r&&n.selectUser(e,t).is_cdm_member&&(2===t.rowIndex||1===t.rowIndex)},t.selectUserEducationEffectName=function(e,r){return t.selectShouldShowUserEducationEffects(e,r)?"FileNameLabel-"+r.rowIndex:void 0},t.selectRenameState=function(e,o){var i=n.selectFileRename(e,o),s=t.selectItem(e,o);if(i&&s instanceof r.File)return i.file.fq_path===s.fq_path?i.state:void 0},t.selectIsNoAccessSharedFolder=function(e,o){var n=t.selectItem(e,o);return n instanceof r.File&&r.File.isNoAccessSharedFolder(n)},t.selectShouldShowStar=function(e,r){return n.selectArePostTTIModulesLoaded(e,r)&&!t.selectIsNoAccessSharedFolder(e,r)&&!n.selectContext(e,r).isInsideVaultFolder},t.selectShowCDMUserEducationEffects=function(e,o){var n=t.selectItem(e,o);return n instanceof r.File&&r.File.isTeamMemberFolder(n)},t.selectIsTooltipEnabled=function(e,t){return n.selectArePostTTIModulesLoaded(e,t)},t.selectSnippets=function(e,o){var n=t.selectItem(e,o);if(n instanceof r.Paper||n instanceof r.File||n instanceof r.FileSharedWithMe)return n.snippets},t.selectFirstValidSnippet=function(e,r){var o=t.selectSnippets(e,r);return o&&o.find((function(e){var t=e.highlight_spans;return!!t&&t.length>0}))},t.selectShouldShowSnippets=function(e,r){return Boolean(n.selectExpSnippets(e,r)&&!n.selectIsMobileMode(e,r)&&t.selectFirstValidSnippet(e,r))},t.selectRowHeight=function(e,r){var i=t.selectShouldShowSnippets(e,r),s=n.selectHighDensity(e,r);if(i){var a=t.selectSnippetRows(e,r);return a?o.ROW_VERTICAL_PADDING+o.ROW_TITLE_HEIGHT+o.ROW_SUBTITLE_HEIGHT+o.ROW_SNIPPET_VERTICAL_MARGIN+o.SNIPPET_HEIGHT_PER_ROW*a:o.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS}return s?o.DEFAULT_ROW_HEIGHT_DENSE:o.DEFAULT_ROW_HEIGHT};t.selectSnippetRows=function(e,r){var n=t.selectFirstValidSnippet(e,r);if(!n||!n.highlight_spans)return 0;var i=r.containerWidth,s=r.numVisibleColumns,a=i?i*o.FILE_NAME_CELL_WITH_SNIPPETS_FLEX_BASIS[s]/100:void 0;if(!a)return 3;var l=n.highlight_spans.map((function(e){return e.highlight_str})).join().length,c=Math.max(a-o.MEDIA_CELL_ICON_WIDTH-o.SNIPPET_HORIZONTAL_PADDING,1),d=6*l;return Math.min(Math.ceil(d/c),3)},t.selectShouldShowFirstTaskSubtitle=function(e,t){return Boolean(n.selectEligibleForFirstTaskSubtitle(e,t)&&a(e,t))},t.selectShouldShowBasicToBizSubtitle=function(e,t){return Boolean(n.selectEligibleForBasicToBizSubtitle(e,t)&&a(e,t))};var a=function(e,o){var i=n.selectContext(e,o),s=t.selectItem(e,o),a=n.selectUser(e,o);return s instanceof r.File&&(i.isInsideMyTeamFolderTree&&i.isCurrentlyInRoot&&s.fq_path===a.cdm_tmf_path)}})),define("modules/clean/react/files_view/data/selectors/list_selectors",["require","exports","tslib","reselect","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/file_list_utils"],(function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectItemList=function(e,t){return"main"===t.listId?s.selectMainItems(e,t):s.selectTeamFolders(e,t)},t.selectShouldRenderCheckboxes=function(e,t){return"team_folders"!==t.listId},t.selectListItems=function(e,o){var n=s.selectMainItems(e,o),i=!!s.selectDisabledMultiselect(e,o);return t.getFilesViewListRowItems(r.__assign(r.__assign({},o),{isCheckboxDisabled:i,items:n}))},t.selectListItemHeights=o.createSelector(t.selectListItems,(function(e){return e.map((function(e){return e.height}))}));var l=o.createSelectorCreator(o.defaultMemoize,(function(e,t){return Object.keys(e).length===Object.keys(t).length&&Object.keys(e).every((function(r){return t.hasOwnProperty(r)&&e[r]===t[r]}))}));t.getFilesViewListRowItems=l((function(e){return{activeDropTarget:e.activeDropTarget,arePostTTIModulesLoaded:e.arePostTTIModulesLoaded,canDisplayFolderSizes:e.canDisplayFolderSizes,context:e.context,createNewFolderState:e.createNewFolderState,dropTargetHighlightMode:e.dropTargetHighlightMode,extensionsFeatureFlags:e.extensionsFeatureFlags,fileRename:e.fileRename,focusedFileIndex:e.focusedFileIndex,isCheckboxDisabled:e.isCheckboxDisabled,isCompactMode:e.isCompactMode,isSearchMode:e.isSearchMode,isSelectMode:e.isSelectMode,items:e.items,selection:e.selection,sharingServiceInfo:e.sharingServiceInfo,starredState:e.starredState,user:e.user,visibleColumns:e.visibleColumns,responsive:e.responsive,expSnippets:e.expSnippets,containerWidth:e.containerWidth,highDensity:e.highDensity,fileToId:e.fileToId,renderSharedWithController:e.renderSharedWithController,expVaultEnableViewOnlySharing:e.expVaultEnableViewOnlySharing}}),(function(e){var o=e.activeDropTarget,s=e.context,l=e.createNewFolderState,c=e.dropTargetHighlightMode,d=e.items,u=e.fileRename,p=e.focusedFileIndex,f=e.selection,_=e.user,m=e.visibleColumns,h=e.responsive,g=e.expSnippets,S=e.containerWidth,v=e.highDensity,E=e.fileToId,w=r.__rest(e,["activeDropTarget","context","createNewFolderState","dropTargetHighlightMode","items","fileRename","focusedFileIndex","selection","user","visibleColumns","responsive","expSnippets","containerWidth","highDensity","fileToId"]),b=!!e.expVaultEnableViewOnlySharing,y=d.toArray().map((function(e,l){if(e instanceof n.UserDefinedItem)return{type:"UserDefinedItemRow",props:{userDefinedItem:e},height:v?i.DEFAULT_ROW_HEIGHT_DENSE:i.DEFAULT_ROW_HEIGHT};var d=S?S*i.FILE_NAME_CELL_WITH_SNIPPETS_FLEX_BASIS[m.length]/100:void 0,y=t.shouldShowSnippets({file:e,expSnippets:g,responsive:h}),T=t.estimateSnippetRowsNeeded({snippets:e.snippets,fileNameCellWidth:d}),F=t.getFileRowHeight({file:e,showSnippets:y,snippetRows:T,highDensity:v});if(e instanceof n.Paper)return{type:"PaperRow",props:{isSearchMode:w.isSearchMode,paper:e,visibleColumns:m,arePostTTIModulesLoaded:w.arePostTTIModulesLoaded,showSnippets:y,snippetRows:T,height:F},height:F};var I="fq_path"in e?E(e):e.file_id,O=f.selected.has(I);if(e instanceof n.FileSharedWithMe)return{type:"FileSharedWithMeRow",props:{file:e,visibleColumns:m,showSnippets:y,snippetRows:T,height:F,isSelected:O,arePostTTIModulesLoaded:w.arePostTTIModulesLoaded,isSelectMode:w.isSelectMode,isFocused:l===p},height:F};var C=a.shouldFileBeHighlightedDropTarget({file:e,isSelected:O,dropTargetHighlightMode:c});return{type:"FileRow",key:"file:"+encodeURIComponent(e.file_id)+":"+encodeURIComponent(e.fq_path),itemIndex:l,props:r.__assign(r.__assign({},w),{file:e,isActiveDropTarget:C&&o===e,isAvailableDropTarget:C,isFocused:l===p,isSelected:O,isExtensionsMenuDisabled:a.isExtensionsMenuDisabledForContext({context:s}),isSharingDisabled:a.isSharingDisabledForFile({context:s,file:e,user:_,expVaultEnableViewOnlySharing:b}),renameState:u&&u.file.fq_path===e.fq_path?u.state:void 0,visibleColumns:m,height:F,containerWidth:S}),height:F}}));return l&&"CREATE_FOLDER_INACTIVE"!==l&&y.unshift({type:"NewFolderRow",props:{createNewFolderState:l,isInsideMyTeamFolderTree:s.isInsideTeamFolderTree},height:v?i.DEFAULT_ROW_HEIGHT_DENSE:i.DEFAULT_ROW_HEIGHT}),y})),t.getFirstValidSnippet=function(e){return e.find((function(e){var t=e.highlight_spans;return!!t&&t.length>0}))},t.shouldShowSnippets=function(e){var r=e.file.snippets,o=e.expSnippets,n=void 0!==o&&o,i=e.responsive;return!!n&&!!r&&!!t.getFirstValidSnippet(r)&&(i.isMatchedLarge||i.isMatchedMedium)},t.getFileRowHeight=function(e){var t=e.file,r=e.showSnippets,o=e.snippetRows,n=e.highDensity;return t.snippets&&r?o?i.ROW_VERTICAL_PADDING+i.ROW_TITLE_HEIGHT+i.ROW_SUBTITLE_HEIGHT+i.ROW_SNIPPET_VERTICAL_MARGIN+i.SNIPPET_HEIGHT_PER_ROW*o:i.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS:n?i.DEFAULT_ROW_HEIGHT_DENSE:i.DEFAULT_ROW_HEIGHT};t.estimateSnippetRowsNeeded=function(e){var r=e.snippets,o=e.fileNameCellWidth;if(!r)return 0;var n=t.getFirstValidSnippet(r);if(!n||!n.highlight_spans)return 0;if(!o)return 3;var s=n.highlight_spans.map((function(e){return e.highlight_str})).join().length,a=Math.max(o-i.MEDIA_CELL_ICON_WIDTH-i.SNIPPET_HORIZONTAL_PADDING,1),l=6*s;return Math.min(Math.ceil(l/a),3)}})),define("modules/clean/react/files_view/data/store",["require","exports","modules/clean/react/files_view/data/reducer","modules/clean/redux/namespaces","modules/clean/redux/store"],(function(e,t,r,o,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForFilesView=function(){var e;return i||(i=n.getStoreAndRegisterReducers(((e={})[o.FILES_VIEW_NAMESPACE_KEY]=r.filesViewReducer,e))),i}})),define("modules/clean/react/files_view/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.SET_VIEW_TYPE="FILES_VIEW/SET_VIEW_TYPE",e.SET_VIEW_TYPES="FILES_VIEW/SET_VIEW_TYPES",e.SET_VIEW_TYPE_COLUMNS="FILES_VIEW/SET_VIEW_TYPE_COLUMNS",e.SET_VIEW_TYPE_SCOPE="FILES_VIEW/SET_VIEW_TYPE_SCOPE",e.SET_FILE_RENAME="FILES_VIEW/SET_FILE_RENAME",e.SET_SCROLL="FILES_VIEW/SET_SCROLL",e.UPSERT_INSTANCE="FILES_VIEW/UPSERT_INSTANCE",e.DELETE_INSTANCE="FILES_VIEW/DELETE_INSTANCE",e.PREVIEW_THUMBNAILS_LOADING="FILES_VIEW/PREVIEW_THUMBNAILS_LOADING",e.PREVIEW_THUMBNAILS_LOADED="FILES_VIEW/PREVIEW_THUMBNAILS_LOADED",e.PREVIEW_THUMBNAILS_REMOVED="FILES_VIEW/PREVIEW_THUMBNAILS_REMOVED"})(t.ActionTypes||(t.ActionTypes={}))})),define("modules/clean/react/files_view/file_actions/api_v2",["require","exports","tslib","modules/clean/api_v2/user_client","modules/clean/filepath"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n);function i(e){return null!=e.fq_path}function s(e){return i(e)?n.filename(e.fq_path):e.name}function a(e,t){return r.__awaiter(this,void 0,Promise,(function(){var o,n,i;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,9,,10]),[4,e()];case 1:return"complete"!==(o=r.sent())[".tag"]?[3,2]:[2,{isError:!1,result:o}];case 2:n=void 0,r.label=3;case 3:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 4:return r.sent(),[4,t(o.async_job_id)];case 5:n=r.sent(),r.label=6;case 6:if(n&&"in_progress"===n[".tag"])return[3,3];r.label=7;case 7:return"complete"===n[".tag"]?[2,{isError:!1,result:n,jobId:o.async_job_id}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error",jobId:o.async_job_id}];case 8:return[3,10];case 9:return(i=r.sent())&&i.error&&i.error[".tag"]?[2,{isError:!0,error:i.error,error_summary:i.summary}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 10:return[2]}}))}))}function l(e,t){return r.__awaiter(this,void 0,Promise,(function(){var o,n,i;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,10,,11]),[4,e()];case 1:return"complete"!==(o=r.sent())[".tag"]?[3,2]:[2,{isError:!1,result:o}];case 2:return"other"!==o[".tag"]?[3,3]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 3:n=void 0,r.label=4;case 4:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 5:return r.sent(),[4,t(o.async_job_id)];case 6:n=r.sent(),r.label=7;case 7:if(n&&"in_progress"===n[".tag"])return[3,4];r.label=8;case 8:return"complete"===n[".tag"]?[2,{isError:!1,result:n,jobId:o.async_job_id}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error",jobId:o.async_job_id}];case 9:return[3,11];case 10:return(i=r.sent())&&i.error&&i.error[".tag"]?[2,{isError:!0,error:i.error,error_summary:i.summary}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 11:return[2]}}))}))}t.fileInfoIsFqPathBased=i,t.getFilenameFromActionInfo=s,t.renameFile=function(e,t,i,s){return r.__awaiter(this,void 0,Promise,(function(){var a,l,c,d;return r.__generator(this,(function(r){switch(r.label){case 0:a=n.parent_dir(e.fq_path),l=n.normalize(a)+"/"+t,c=new o.UserApiV2Client,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,c.ns("files").rpc("move_v2",{from_path:e.fq_path,to_path:l,allow_shared_folder:!0,autorename:!0,allow_ownership_transfer:!1,fsw_request:s?{".tag":"confirm",confirm:["action_commit_to_tsd_root"]}:void 0},{subjectUserId:i.id})];case 2:return[2,{isError:!1,result:r.sent()}];case 3:return(d=r.sent())&&d.error&&d.error[".tag"]?[2,{isError:!0,error:d.error,error_summary:d.summary}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 4:return[2]}}))}))},t.undo=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){var n,i;return r.__generator(this,(function(r){switch(r.label){case 0:n=new o.UserApiV2Client,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n.ns("files").rpc("undo_batch",{entries:e},{subjectUserId:t.id})];case 2:return[2,{isError:!1,result:r.sent()}];case 3:return(i=r.sent())&&i.error&&i.error[".tag"]?[2,{isError:!0,error:i.error,error_summary:i.summary}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 4:return[2]}}))}))},t.moveFiles=function(e,t,n,l,c){return r.__awaiter(this,void 0,Promise,(function(){var d,u;return r.__generator(this,(function(r){switch(r.label){case 0:return d=new o.UserApiV2Client,u=function(e){var r=t+"/"+s(e);return i(e)?{from_path:e.fq_path,to_path:r}:{from_path:e.id,to_path:r}},[4,a((function(){return d.ns("files").rpc("move_batch_v2",{entries:e.map(u),autorename:!0,allow_ownership_transfer:!!l,fsw_request:c?{".tag":"check"}:void 0},{subjectUserId:n})}),(function(e){return d.ns("files").rpc("move_batch/check_v2",{async_job_id:e},{subjectUserId:n})}))];case 1:return[2,r.sent()]}}))}))},t.copyFiles=function(e,t,i,s){return r.__awaiter(this,void 0,Promise,(function(){var l;return r.__generator(this,(function(r){switch(r.label){case 0:return l=new o.UserApiV2Client,[4,a((function(){return l.ns("files").rpc("copy_batch_v2",{entries:e.map((function(e){return{from_path:e.fq_path,to_path:t+"/"+n.filename(e.fq_path)}})),autorename:!0,fsw_request:s?{".tag":"check"}:void 0},{subjectUserId:i})}),(function(e){return l.ns("files").rpc("copy_batch/check_v2",{async_job_id:e},{subjectUserId:i})}))];case 1:return[2,r.sent()]}}))}))},t.deleteFiles=function(e,t,n){return r.__awaiter(this,void 0,Promise,(function(){var i;return r.__generator(this,(function(r){switch(r.label){case 0:return i=new o.UserApiV2Client,[4,l((function(){return i.ns("files").rpc("delete_batch",{entries:e.map((function(e){return{path:e.fq_path}})),fsw_request:n?{".tag":"check"}:void 0},{subjectUserId:t})}),(function(e){return i.ns("files").rpc("delete_batch/check",{async_job_id:e},{subjectUserId:t})}))];case 1:return[2,r.sent()]}}))}))},t.createFolder=function(e,t,i,s){return r.__awaiter(this,void 0,Promise,(function(){var a,l;return r.__generator(this,(function(r){switch(r.label){case 0:a=new o.UserApiV2Client,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a.ns("files").rpc("create_folder_v2",{path:n.normalize(e)+"/"+t,autorename:!0,fsw_request:s?{".tag":"check"}:void 0},{subjectUserId:i.id})];case 2:return[2,{isError:!1,result:r.sent()}];case 3:return(l=r.sent())&&l.error&&l.error[".tag"]?[2,{isError:!0,error:l.error,error_summary:l.summary}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 4:return[2]}}))}))}})),define("modules/clean/react/files_view/file_actions/file_from_metadata",["require","exports","tslib","modules/clean/react/browse/models"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fileFromMetadata=function(e,t){if("file"===t[".tag"]){var n=t,i=r.__assign(r.__assign({},e),{fq_path:n.path_display||e.fq_path,icon:n.icon+"_32",revision_id:n.rev,file_id:n.id});return new o.File(i)}return"folder"===t[".tag"]?new o.File(r.__assign(r.__assign({},e),{fq_path:t.path_display||e.fq_path})):e},t.folderFromFolderMetadata=function(e){return new o.File({file_id:e.id,fq_path:e.path_display||"",icon:e.icon,is_dir:!0})}})),define("modules/clean/react/files_view/file_actions/rollback",["require","exports","tslib","modules/clean/react/browse/api","modules/core/i18n"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.rollback=function(e){for(var t=e.changeset_data,r=e.userId,i=e.onSuccess,s={},a=0,l=t;a<l.length;a++){var c=l[a],d=c.ns_id,u=c.op_id,p=parseInt(u.slice(6),10);s.hasOwnProperty(d)?s[d].push(p):s[d]=[p]}o.rollbackChangeSets({changesets:s,onSuccess:i,userId:r,progressText:n.intl.formatMessage({id:"wKzr7W",defaultMessage:"Undoing…"})})}})),define("modules/clean/react/files_view/file_actions/snackbars",["require","exports","modules/core/i18n"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renameError=function(e,t){return"to"===e[".tag"]&&"malformed_path"===e.to[".tag"]?r.intl.formatMessage({id:"rBgywO",defaultMessage:"Name was invalid."}):"from_write"===e[".tag"]&&"team_folder"===e.from_write[".tag"]?r.intl.formatMessage({id:"zqiuDZ",defaultMessage:"Team folders can’t be renamed."}):"from_lookup"===e[".tag"]&&"not_found"===e.from_lookup[".tag"]?r.intl.formatMessage({id:"kdizeA",defaultMessage:"Couldn’t find the file."}):r.intl.formatMessage({id:"pUBm7w",defaultMessage:"Rename failed."})},t.deleteError=function(e,t){return r.intl.formatMessage({id:"pjyJun",defaultMessage:"{count, plural, one{Couldn’t delete {count} item.} other{Couldn’t delete {count} items.}}"},{count:e})},t.deleteCompleteSuccess=function(e,t){return t<e?r.intl.formatMessage({id:"QGz6Gm",defaultMessage:"{count, plural, one{Deleted {succesfully_deleted_files} out of {count} item.} other{Deleted {succesfully_deleted_files} out of {count} items.}}"},{count:e,succesfully_deleted_files:t}):r.intl.formatMessage({id:"THAbub",defaultMessage:"{count, plural, one{Deleted {count} item.} other{Deleted {count} items.}}"},{count:t})},t.deleteCompleteError=function(e){if(1===e.length){var t=e[0].failure;if("too_many_files"===t[".tag"]||"too_many_write_operations"===t[".tag"])return r.intl.formatMessage({id:"ane1pD",defaultMessage:"There are too many files in one request. Please retry with fewer files."});if("path_lookup"===t[".tag"]&&"not_found"===t.path_lookup[".tag"])return r.intl.formatMessage({id:"9suezP",defaultMessage:"File does not exist."})}return r.intl.formatMessage({id:"pjyJun",defaultMessage:"{count, plural, one{Couldn’t delete {count} item.} other{Couldn’t delete {count} items.}}"},{count:e.length})}})),define("modules/clean/react/files_view/file_grouper",["require","exports","modules/core/i18n","modules/clean/datetime","modules/clean/react/browse/constants","modules/clean/react/files_view/types","modules/clean/react/browse/models"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r.intl.formatMessage({id:"RzhnRl",defaultMessage:"Extensionless"}),l=r.intl.formatMessage({id:"DcKHEo",defaultMessage:"Missing dates"}),c=r.intl.formatMessage({id:"GYhJ5f",defaultMessage:"Deleted content isn’t sorted by last modified"});t.EMPTY_SECTIONS={sectionLabels:[],sectionStartIndices:[]},t.getSections=function(e,t,d,u){void 0===u&&(u=!1);var p=[],f=[],_=null;if(t===i.SortField.CATEGORY)e.forEach((function(e,t){if(e){var r=(function(e){return e instanceof s.File?s.File.getCategoryDescription(e,!0):n.ExtensionCategories.DOCUMENT})(e);r!==_&&(p.push(r),f.push(t),_=r)}}));else if(t===i.SortField.EXTENSION)e.forEach((function(e,t){if(e){var r=(function(e){return e instanceof s.File?e.is_dir?n.FileTypeCapitalizedCategoryTranslations.FOLDER:s.File.getExtension(e).toUpperCase():a})(e);if(r!==_){var o=r;""===r&&(o=a),p.push(o),f.push(t),_=r}}}));else if(t===i.SortField.MODIFIED)if(d===i.SortDirection.DESCENDING){var m=o.getTimeBands(Date.now());e.forEach((function(e,t){if(e){var o;if(u&&e instanceof s.File&&e.isDeleted)o=c;else{var n=s.itemTimestampInMs(e);o=n>=m.today?r.intl.formatMessage({id:"JDRaFD",defaultMessage:"Today"}):n>=m.yesterday?r.intl.formatMessage({id:"2iSDDx",defaultMessage:"Yesterday"}):n>=m.thisWeek?r.intl.formatMessage({id:"e3KIPg",defaultMessage:"This week"}):n>=m.lastWeek?r.intl.formatMessage({id:"dsHtkw",defaultMessage:"Last week"}):n>=m.thisMonth?r.intl.formatMessage({id:"G0eFMx",defaultMessage:"This month"}):n>=m.lastMonth?r.intl.formatMessage({id:"nM5Fv4",defaultMessage:"Last month"}):n>=m.lastThreeMonths?r.intl.formatMessage({id:"U7dFRR",defaultMessage:"Three months ago"}):r.intl.formatMessage({id:"Y/NN0h",defaultMessage:"Older"})}o!==_&&(p.push(o),f.push(t),_=o)}}))}else e.forEach((function(e,t){var o;e&&((o=u&&e instanceof s.File&&e.isDeleted?c:s.itemTimestampInMs(e)?r.intl.formatDate(s.itemTimestampInMs(e),{year:"numeric",month:"long"}):l)!==_&&(p.push(o),f.push(t),_=o))}));return{sectionLabels:p,sectionStartIndices:f}}})),define("modules/clean/react/files_view/file_media_actions",["require","exports","tslib","react","spectrum/button","spectrum/icon_table","spectrum/media_table","modules/clean/react/app_actions/app_actions_menu","modules/clean/react/extensions/split_share_button","modules/clean/react/files_view/files_view_logging","modules/clean/react/files_view/overflow_menu","modules/clean/react/files_view/util","modules/clean/react/vault/lib/browse_utils","modules/clean/web_user_action_events","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.ViewFileButton=function(e){var t=e.isVisible,r=e.onClick;return o.default.createElement(n.Button,{className:"brws-file-row-view-file-button","aria-label":_.intl.formatMessage({id:"K8mY77",defaultMessage:"View File"}),onClick:r,tabIndex:t?void 0:-1,variant:t?"secondary":"invisible"},o.default.createElement(i.IconTable,{name:"view"}))};var m=(function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isActionDropdownOpen:!1},t.onSplitShareDropdownOpen=function(){t.logEvent(f.WebUserActionLogEvent.OPEN_SPLITSHARE,f.ActionSourceValue.SPLIT_SHARE),t.onActionDropdownOpen()},t.onExtensionsDropdownOpen=function(){t.logEvent(f.WebUserActionLogEvent.OPEN_EXTENSIONS),t.onActionDropdownOpen()},t.onExtensionClick=function(e){t.logEvent(f.WebUserActionLogEvent.EXTENSIONS_SELECTED,void 0,{extensions_option:e||"unknown"})},t.onActionDropdownOpen=function(){t.setState({isActionDropdownOpen:!0})},t.onActionDropdownClose=function(){t.setState({isActionDropdownOpen:!1})},t.logSplitShareButton=function(e){t.logEvent(f.WebUserActionLogEvent.SHARE,f.ActionSourceValue.SPLIT_SHARE,{splitshare_option:e}),t.logVaultShareIfInsideVault()},t.logVaultShareIfInsideVault=function(){u.isFile(t.props.file)&&t.props.file.is_in_vault_folder&&p.logShareFromInsideVault(t.props.file.is_dir)},t.logEvent=function(e,r,o){var n=t.props,i=n.isSearchMode,s=n.file,a=n.user;c.logEventWithNumberOfFiles({isSearchMode:i,file:s,user:a,action_surface:f.ActionSurfaceLogValue.CENTER_PANE,action_source:r,extra:o,action:e})},t}return r.__extends(n,e),n.prototype.render=function(){var e=this.props,n=e.arePostTTIModulesLoaded,i=e.canDisplayFolderSizes,c=e.file,p=e.getOverflowMenuActions,f=e.isCompactMode,_=e.isExtensionsMenuDisabled,m=e.isHovered,h=e.isSearchMode,g=e.isSelectMode,S=e.isSelected,v=e.isSharingDisabled,E=e.onPresentInZoom,w=e.shareButtonLabel,b=e.showShareButton,y=e.showBorders,T=e.thumbStore,F=e.user,I=e.viewportTopOffset,O=e.scrollContainer,C=this.props.onOpenFileClick||function(){},P=this.props.onShowShare||function(){},A=h?"search":"browse";if(u.isFswm(c))return o.default.createElement(o.default.Fragment,null,g?o.default.createElement(s.MediaActions,null,o.default.createElement(t.ViewFileButton,{isVisible:S||f||m,onClick:C})):o.default.createElement(s.MediaActions,null,o.default.createElement(d.FilesViewOverflowMenu,{canDisplayFolderSizes:i,file:c,getOverflowMenuActions:p,showBorders:m||!!y,thumbStore:T,viewportTopOffset:I,onMenuOpen:this.props.logOverflowMenuOpen,ariaHidden:!0,scrollContainer:O})));var D={file:c,shareButtonLabel:w,showShareButton:b};return g?o.default.createElement(s.MediaActions,null,!v&&o.default.createElement(l.SplitShareButton,r.__assign({},D,{context:{surface:A},file:c,isVisible:!f&&(S||m),onDropdownClose:this.onActionDropdownClose,onDropdownOpen:this.onSplitShareDropdownOpen,onPresentInZoom:E,onShowShare:P,logShareButtonClick:this.logSplitShareButton,user:F,variant:"secondary"})),f||_||!m&&!S?null:o.default.createElement(a.ExtensionsMenu,{file:c,onDropdownClose:this.onActionDropdownClose,onDropdownOpen:this.onExtensionsDropdownOpen,onExtensionClick:this.onExtensionClick,onPresentInZoom:E,telemetryContext:{surface:A},user:this.props.user}),o.default.createElement(t.ViewFileButton,{isVisible:S||f||m,onClick:C})):o.default.createElement(s.MediaActions,null,!v&&o.default.createElement(l.SplitShareButton,r.__assign({},D,{onShowShare:P,logShareButtonClick:this.logSplitShareButton,isVisible:m&&!f||this.state.isActionDropdownOpen,user:F,file:c,onDropdownOpen:this.onSplitShareDropdownOpen,onDropdownClose:this.onActionDropdownClose,onPresentInZoom:E,context:{surface:A},variant:"secondary"})),!_&&(m&&!f||this.state.isActionDropdownOpen)?o.default.createElement(a.ExtensionsMenu,{file:c,onDropdownClose:this.onActionDropdownClose,onDropdownOpen:this.onExtensionsDropdownOpen,onExtensionClick:this.onExtensionClick,onPresentInZoom:E,telemetryContext:{surface:A},user:this.props.user}):null,n&&o.default.createElement(d.FilesViewOverflowMenu,{canDisplayFolderSizes:i,file:c,getOverflowMenuActions:p,showBorders:m||!!y,thumbStore:T,viewportTopOffset:I,onMenuOpen:this.props.logOverflowMenuOpen,ariaHidden:!0,scrollContainer:O}))},n})(o.default.PureComponent);t.FileMediaActions=m})),define("modules/clean/react/files_view/file_name_cell",["require","exports","tslib","classnames","react","react-redux","retrieval-components/highlighted-truncated-string","spectrum/dimensions","spectrum/media_table","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filename_highlights","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/browse/models","modules/clean/react/files_view/beta_tag","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/selectors/item_selectors","modules/clean/react/files_view/file_snippets","modules/clean/react/files_view/name_input","modules/clean/react/files_view/star","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/retrieval_success_banner/util","modules/clean/react/title_bubble","modules/clean/user_education/react/user_education_effect","modules/core/i18n","modules/core/browser","modules/clean/analytics","spectrum/tertiary_link"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S,v,E,w,b,y,T,F,I,O,C,P,A){"use strict";function D(e,t,r,o){if(o&&o>N){var n=(o-N)/t,i=Math.max(r,n-r);return d.Emstring.em_snippet(e,Math.floor(i),.5)}return e}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),p=r.__importStar(p),C=r.__importStar(C),t.FileSubtitle=function(e){var t=e.file,r=e.renameState,i=e.renderAsLink,s=void 0===i||i,a=e.showLocation,l=e.user,d=e.containerWidth,u=e.onClick,f=e.focusable,_=e.showFirstTaskSubtitle,m=e.showBasicToBizSubtitle,h=e.logBasicToBizClick;if(!y.isFile(t))return n.default.createElement(n.default.Fragment,null,O.intl.formatMessage({id:"cvKw36",defaultMessage:"Shared with you"}));if(r)return null;if(m){return n.default.createElement(A.TertiaryLink,{className:o.default("basic-to-biz-subtitle-cta","button-as-link"),onClick:function(e){e.preventDefault(),h?h().finally((function(){C.redirect("/team/setup/folders")})):C.redirect("/team/setup/folders")}},O.intl.formatMessage({id:"bSEl45",defaultMessage:"Organize your existing files"}))}if(_)return n.default.createElement("span",{className:"first-task-content-subtitle"},O.intl.formatMessage({id:"mlMhoU",defaultMessage:"Your existing files moved here."}));if(!a)return null;var g=p.parent_dir(t.fq_path),S="/"===g?c.get_browse_root_name(l):g.slice(1);if(t.is_unmounted)return n.default.createElement(n.default.Fragment,null,O.intl.formatMessage({id:"hY0d5Z",defaultMessage:"not added yet, in {location}"},{location:S}));var v=D(O.intl.formatMessage({id:"yR1l4z",defaultMessage:"in {location}"},{location:S}),M,R,d);if(!s||t.isDeleted)return n.default.createElement(n.default.Fragment,null,v);var E=c.browse_uri_for_fq_path(l,g);return n.default.createElement("a",{className:"brws-file-name-cell-location",href:E.toString(),onClick:u,tabIndex:f?0:-1},v)};var R=6,M=12,N=32,L=function(e){return e instanceof _.FileSharedWithMe},x=(function(e){function i(t){var r=e.call(this,t)||this;return r.timeMounted=0,r.handleNameInputSubmit=function(e){r.props.onRenameSubmit&&y.isFile(r.props.file)&&r.props.onRenameSubmit(r.props.file,e)},r.handleNameInputCancel=function(){r.props.onRenameCancel&&y.isFile(r.props.file)&&r.props.onRenameCancel(r.props.file)},r.handleOnClickNameInput=function(e){e.stopPropagation()},r.handleOnClickName=function(e){r.updateSearchSuccessBannerVisible(),r.props.onNameClick(e)},r.handleOnClickLocationLink=function(e){r.updateSearchSuccessBannerVisible();var t=r.props,o=t.file,n=t.onLocationLinkClick,i=!y.shouldHandleClick(e);i||(e.preventDefault(),e.stopPropagation()),n&&y.isFile(o)&&n(o,i)},r._setFilenameRef=function(e){return r._filenameDiv=e},r.onStarClick=function(e){var t=r.props,o=t.file,n=t.onStarClick;n&&y.isFile(o)&&n(o,e)},r.getTimeInSeconds=function(){return Math.ceil(Date.now()/1e3)},r.logBasicToBizClick=function(){var e={experiment:"content_basic_upgrade",timeInSeconds:r.getTimeInSeconds()-r.timeMounted,url:C.get_uri().path};return P.TeamsWebActionsLogger.log("setup_folders_clicked",e)},r.state={shouldShowTooltip:r.shouldShowTooltip(t)},r}return r.__extends(i,e),i.prototype.componentDidMount=function(){this.timeMounted=this.getTimeInSeconds()},i.prototype.componentDidUpdate=function(e,t){var r=this.shouldShowTooltip(this.props);r!==t.shouldShowTooltip&&this.setState({shouldShowTooltip:r})},i.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this.shouldShowTooltip(e);t!==this.state.shouldShowTooltip&&this.setState({shouldShowTooltip:t})},i.prototype.shouldShowTooltip=function(e){if(L(e.file))return!1;var t=this._filenameDiv,r=p.filename(e.file.fq_path);return!!(e.isTooltipEnabled&&t&&(t.offsetWidth<t.scrollWidth||t.textContent!==r))},i.prototype.updateSearchSuccessBannerVisible=function(){var e=this.props,t=e.useSearchSuccessBanner,r=e.isSearchMode;t&&r&&T.setSearchSuccessBannerVisible()},i.prototype.renderScreenReaderExtraInfo=function(){var e=[],t=this.props,r=t.file,o=t.isSelected;if(y.isFile(r)&&r.isDeleted&&e.push(O.intl.formatMessage({id:"RBvabN",defaultMessage:"Deleted"})),o&&e.push(O.intl.formatMessage({id:"mpdvwi",defaultMessage:"Selected"})),y.isFile(r)&&r.is_dir&&(r.type===f.FileTypes.SHARED_FOLDER?_.File.isReadOnlySharedFolder(r)?e.push(O.intl.formatMessage({id:"513aYe",defaultMessage:"Read-only shared folder"})):e.push(O.intl.formatMessage({id:"r6q13e",defaultMessage:"Shared folder"})):r.type===f.FileTypes.TEAM_SHARED_FOLDER?_.File.isReadOnlySharedFolder(r)?e.push(O.intl.formatMessage({id:"dNfvWF",defaultMessage:"Read-only team shared folder"})):e.push(O.intl.formatMessage({id:"8zuxGM",defaultMessage:"Team shared folder"})):e.push(O.intl.formatMessage({id:"MLqiSW",defaultMessage:"Folder"}))),e.length>0)return n.default.createElement("span",{className:"ax-visually-hidden"},""+e.join(" "))},i.prototype.splitTruncatedParts=function(e,t){for(var r=0;r<e.length&&e.charAt(r)===t.charAt(r);)++r;return r===e.length||"…"!==e.charAt(r)?[e]:[e.substring(0,r),e.substring(r+1)]},i.prototype.getHighlightedSpan=function(e,t){var r,o,i=y.getFilename(t),s=this.splitTruncatedParts(e,i);return 1===s.length?y.isFile(t)&&!t.highlight_spans?u.highlightMatchReact(e,t.filename_highlights):u.highlightReactFromHighlightSpans(e,t.highlight_spans):(y.isFile(t)&&!t.highlight_spans?(r=u.highlightMatchReact(i,t.filename_highlights,0,s[0].length),o=u.highlightMatchReact(i,t.filename_highlights,i.lastIndexOf(s[1]))):(r=u.highlightReactFromHighlightSpans(i,t.highlight_spans,0,s[0].length),o=u.highlightReactFromHighlightSpans(i,t.highlight_spans,i.lastIndexOf(s[1]))),n.default.createElement("span",null,r,"…",o))},i.prototype.getHighlightedSpansForHighlightedTruncatedString=function(e,t){if(y.isFile(t)||L(t))return t.highlight_spans?t.highlight_spans.map((function(e){return{string:e.highlight_str,isHighlighted:e.is_highlighted}})):y.isFile(t)&&t.filename_highlights?u.highlightMatchSections(e,t.filename_highlights).map((function(e){return{string:e.text,isHighlighted:e.isHighlighted}})):void 0},i.prototype.renderTitle=function(e){var t=this.props,r=t.file,o=t.renameState,i=t.user,a=t.hrefForFile;if(o===b.RenameState.SAVING_INPUT)return n.default.createElement("span",{role:"status"},O.intl.formatMessage({id:"OefYpa",defaultMessage:"Renaming…"}));var l,c=y.getFilename(r);if(e)l=n.default.createElement(s.HighlightedTruncatedString,{text:c,className:"brws-file-name-element",fontSize:14,availableWidth:e,highlightSpans:this.getHighlightedSpansForHighlightedTruncatedString(c,r),cellBuffer:3});else{var d=D(c,14,3,e);if(l=this.props.showHighlights&&(r.highlight_spans||y.isFile(r)&&r.filename_highlights)?this.getHighlightedSpan(d,r):n.default.createElement("span",null,d),l=n.default.createElement("div",{className:"brws-file-name-element",ref:this._setFilenameRef},l),this.state.shouldShowTooltip){var u=c.length<=h.FILE_NAME_TOOLTIP_MAX_LINE_LENGTH?c:n.default.createElement("div",{className:"brws-file-name-cell-tooltip"},c);l=n.default.createElement(F.TitleBubble,{content:u,position:F.TitleBubble.POSITIONS.BOTTOM,className:"list-label__title-bubble"},l)}}if(y.isFile(r)&&a&&!(r.is_unmounted||r.isDeleted)||L(r)){var p=L(r)?r.href:a(i,r);l=n.default.createElement("a",{className:"brws-file-name-cell-filename",href:p,onClick:this.handleOnClickName,tabIndex:this.props.isSelected?0:-1},l)}return this.props.showUserEducationEffects?n.default.createElement(I.UserEducationEffect,{containerName:"FileItemRow",name:this.props.userEducationEffectName||"FileNameLabel",useSpan:!0},l):l},i.prototype.renderContent=function(e){var r,o=void 0===e?{}:e,i=o.width,s=o.hasMediaActions,a=this.props,c=a.file,d=a.renameState,u=a.showLocation,f=a.showSnippets,_=a.snippetRows,m=a.user;if(y.isFile(c)&&d===b.RenameState.PENDING_INPUT){var h=c.is_dir?O.intl.formatMessage({id:"NvVKD7",defaultMessage:"Rename directory…"}):O.intl.formatMessage({id:"NZdYzd",defaultMessage:"Rename file…"});r=n.default.createElement(E.NameInput,{defaultValue:p.filename(c.fq_path),label:h,onClick:this.handleOnClickNameInput,onSubmit:this.handleNameInputSubmit,onCancel:this.handleNameInputCancel,isDir:c.is_dir})}else if(r=[n.default.createElement(l.MediaCellText,{key:"title",highlight:this.props.isHovered},n.default.createElement("div",{className:"brws-file-name-cell-title-container"},this.renderTitle(i),this.renderBetaTag(),this.renderScreenReaderExtraInfo(),this.renderStar())),n.default.createElement(l.MediaCellText,{key:"subtitle",variant:"subtitle"},n.default.createElement(t.FileSubtitle,{containerWidth:i,file:c,onClick:this.handleOnClickLocationLink,renameState:d,renderAsLink:this.props.renderFilenameSubtitleAsLink,showLocation:u,user:m,focusable:this.props.isSelected,showFirstTaskSubtitle:this.props.showFirstTaskSubtitle,showBasicToBizSubtitle:this.props.showBasicToBizSubtitle,logBasicToBizClick:this.logBasicToBizClick}))],f){var g=i?{width:s?i-48:i}:void 0;r.push(n.default.createElement(l.MediaCellText,{key:"snippets",variant:"subtitle",style:g},n.default.createElement(v.FileSnippets,{snippets:c.snippets,lineClamp:_})))}return r},i.prototype.renderBetaTag=function(){var e=this.props,t=e.file,r=e.renameState;return y.isFile(t)&&t.type===f.FileTypes.VAULT_FOLDER&&!r?n.default.createElement(m.BetaTag,null):null},i.prototype.renderStar=function(){var e=this.props,t=e.file,r=e.renameState,o=e.user,i=e.showStar,s=e.isMobileMode;return i&&!r?n.default.createElement(w.StarContainer,{item:t,user:o,className:"brws-file-name-cell-star",onStarClick:this.onStarClick,isReadOnly:s,tabIndex:-1}):null},i.prototype.render=function(){var e=this,t=this.props,r=t.mediaActions,i=t.file,s=t.fileNameCellWidth,l=o.default("brws-file-name-cell-text","brws-vertically-center",{"brws-file-name-cell-text-rename":!!this.props.renameState});return this.props.shouldTruncateMiddleFilename?L(i)&&s?n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:"brws-file-name-container"},n.default.createElement("div",{className:l},this.renderContent({width:s,hasMediaActions:!!r}))),r):n.default.createElement(n.default.Fragment,null,n.default.createElement(a.Dimensions,{className:"brws-file-name-container"},(function(t){var o=t.width;return n.default.createElement("div",{className:"brws-file-name-container"},n.default.createElement("div",{className:l},e.renderContent({width:s||o,hasMediaActions:!!r})))})),r):n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:l},this.renderContent()),r)},i})(n.default.Component);t.FileNameCellComponent=x;t.FileNameCell=i.connect((function(e,t){return{file:S.selectItemAssertFileOrFileSharedWithMe(e,t),isSelectMode:g.selectHasItemsSelected(e,t),isSelected:S.selectIsItemSelected(e,t),renameState:S.selectRenameState(e,t),renderFilenameSubtitleAsLink:g.selectRenderFilenameSubtitleAsLink(e,t),isMobileMode:g.selectIsMobileMode(e,t),showHighlights:g.selectShouldShowFileNameHighlights(e,t),showLocation:g.selectShouldShowFileNameLocation(e,t),showStar:S.selectShouldShowStar(e,t),showUserEducationEffects:S.selectShouldShowUserEducationEffects(e,t),userEducationEffectName:S.selectUserEducationEffectName(e,t),isTooltipEnabled:S.selectIsTooltipEnabled(e,t),user:g.selectUser(e,t),shouldTruncateMiddleFilename:g.selectArePostTTIModulesLoaded(e,t),showSnippets:S.selectShouldShowSnippets(e,t),snippetRows:S.selectSnippetRows(e,r.__assign(r.__assign({},t),{numVisibleColumns:t.visibleColumns.length})),useSearchSuccessBanner:g.selectUseSearchSuccessBanner(e,t),isSearchMode:g.selectIsSearchMode(e,t),showFirstTaskSubtitle:S.selectShouldShowFirstTaskSubtitle(e,t),showBasicToBizSubtitle:S.selectShouldShowBasicToBizSubtitle(e,t)}}))((function(e){return n.default.createElement(x,r.__assign({},e))}))})),define("modules/clean/react/files_view/file_row",["require","exports","tslib","classnames","react","spectrum/media_table","modules/clean/cloud_docs/constants","modules/clean/filepath","modules/clean/react/browse/models","modules/clean/react/files_view/file_media_actions","modules/clean/react/files_view/file_name_cell","modules/clean/react/files_view/file_row_checkbox","modules/clean/react/files_view/row","modules/clean/react/files_view/thumbnail_media_cell","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/selectable_list","modules/clean/react/title_bubble","modules/core/browser","modules/core/exception","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S,v,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),a=r.__importStar(a),S=r.__importStar(S),v=r.__importStar(v);var w=function(){return n.default.createElement("span",{"aria-hidden":!0},"--")},b=function(){return n.default.createElement("svg",{width:"20px",height:"20px",viewBox:"0 0 20 20",version:"1.1"},n.default.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.default.createElement("g",{id:"Group",transform:"translate(2.000000, 2.000000)"},n.default.createElement("circle",{id:"Oval-65",cx:"8",cy:"8",r:"8"}),n.default.createElement("path",{d:"M8,13 L8,14.5 L5.5,12.5 L8,10.5 L8,12 C10.209139,12 12,10.209139 12,8 C12,6.93104698 11.5806921,5.96002857 10.8975817,5.24245012 L11.4674192,4.39763124 C12.4121861,5.30722218 13,6.58496544 13,8 C13,10.7614237 10.7614237,13 8,13 Z M8,3 L8,1.5 L10.5,3.5 L8,5.5 L8,4 C5.790861,4 4,5.790861 4,8 C4,8.96511539 4.34180174,9.8503987 4.91095749,10.5414022 L4.33270318,11.3986995 C3.5056268,10.5066799 3,9.3123877 3,8 C3,5.23857625 5.23857625,3 8,3 Z",id:"Oval-67",fill:"#637282"}))))},y=function(){return n.default.createElement("svg",{width:"20px",height:"20px",viewBox:"0 0 20 20",version:"1.1"},n.default.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.default.createElement("g",{id:"icon-warning",fill:"#637282"},n.default.createElement("path",{d:"M13.9298189,16.125 C16.4624689,16.125 17.5138484,14.3377448 16.2785476,12.1337797 L12.238298,4.92535765 C11.002815,2.72106753 8.99951926,2.72139251 7.76421846,4.92535765 L3.7239688,12.1337797 C2.48848585,14.3380698 3.54098311,16.125 6.07269759,16.125 L13.9298189,16.125 Z M11.002944,14.0995516 L8.99957244,14.0995516 L8.99957244,12.0741033 L11.002944,12.0741033 L11.002944,14.0995516 L11.002944,14.0995516 Z M11.002944,11.0613791 L8.99957244,11.0613791 L8.99957244,7.01048239 L11.002944,7.01048239 L11.002944,11.0613791 L11.002944,11.0613791 Z",id:"Shape"}))))},T=function(){return n.default.createElement("div",{className:"error-tooltip"},n.default.createElement("div",{className:"error-tooltip__title"},E.intl.formatMessage({id:"K7S0+X",defaultMessage:"This folder is too large"})),E.intl.formatMessage({id:"Ygodgp",defaultMessage:"We can’t calculate the full size of this folder right now. This can happen when there are a large number of files inside of the folder or if the request takes too long."}))};function F(e){switch(m.isFile(e)?a.split_filename(e.fq_path).ext:e.ext.slice(1)){case s.PaperFileTypes.PAPER:case s.PaperFileTypes.PAPER_TEMPLATE:return!0;default:return!1}}t.isCloudDocProviderStored=F;var I=function(e){var t=e.file;if(!t.is_dir)return t.is_cloud_doc&&F(t)?n.default.createElement(w,null):n.default.createElement("span",null,t.size);switch(t.fetchFolderSizesStatus){case _.FetchFolderSizeState.LOADING:return n.default.createElement("span",{className:"item-cell-title item-cell-title--loading"},n.default.createElement("span",{className:"ax-visually-hidden"},E.intl.formatMessage({id:"i6z+mD",defaultMessage:"Calculating folder sizes..."})),n.default.createElement(b,null),E.intl.formatMessage({id:"96Ftx7",defaultMessage:"Calculating..."}));case _.FetchFolderSizeState.ERROR:return n.default.createElement("span",{className:"item-cell-title"},n.default.createElement(g.TitleBubble,{content:n.default.createElement(T,null),position:g.TitleBubble.POSITIONS.TOP,isTargetPositionFixed:!1},n.default.createElement("span",{className:"item-cell-title item-cell-title--error"},n.default.createElement("span",{className:"ax-visually-hidden"},E.intl.formatMessage({id:"Aro/Jz",defaultMessage:"Error in calculating folder sizes"})),n.default.createElement(y,null))));case _.FetchFolderSizeState.COMPLETE:return n.default.createElement("span",{className:"item-cell-title"},t.size);default:return n.default.createElement(w,null)}},O={topOffset:0,controlsFocusable:!1,logOverflowMenuOpen:function(){},fileToId:function(e){return e.fq_path}},C=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checkboxTargetRef=n.default.createRef(),t.handleOpenFileClick=function(e){return t.handleOpenNewTabOrNavigate(e,_.FilesViewActionSource.ROW_PREVIEW_ICON)},t.handleTitleClick=function(e){return t.handleOpenNewTabOrNavigate(e,_.FilesViewActionSource.ROW_TITLE)},t.handleOpenNewTabOrNavigate=function(e,r){0===e.button&&(e.preventDefault(),e.stopPropagation(),t.onNavigateToItem({openInNewTab:m.hasModifierKey(e),actionSource:r}))},t.handleCheckboxTouchTargetClick=function(e){if(!e.defaultPrevented&&!t.props.isCheckboxDisabled&&t.props.onDeselect&&t.props.onSelect){e.preventDefault();var r=t.props.fileToId(t.props.file);t.props.isSelected?t.props.onDeselect(r,e.shiftKey,_.FilesViewActionSource.SINGLE_CHECKBOX):t.props.onSelect(r,e.shiftKey?h.SelectOptions.EXTEND:h.SelectOptions.DEFAULT,_.FilesViewActionSource.SINGLE_CHECKBOX)}},t.onSelect=function(e,r){t.props.onSelect&&t.props.onSelect(t.props.fileToId(t.props.file),e,r)},t.onDeselect=function(e,r){t.props.onDeselect&&t.props.onDeselect(t.props.fileToId(t.props.file),e,r)},t.onNavigateToItem=function(e){var r=e.openInNewTab,o=e.actionSource;if(r){var n=t.props,i=n.file,s=n.user,a=n.hrefForFile;S.open_tab(a(s,i))}else t.props.onNavigateToFileOrFolder(t.props.file,{actionSource:o})},t.onDragEnter=function(e){var r=t.props,o=r.file,n=r.isSelected,i=r.isActiveDropTarget;t.props.onDragEnter(e,o,!!n,!!i)},t.onDragStart=function(e){var r=t.props,o=r.file,n=r.isSelected,i=r.onDragStart;i&&(n?i(e):i(e,[o]))},t.getCheckboxNode=function(){return t.checkboxTargetRef.current&&t.checkboxTargetRef.current.querySelector("input")},t.onShowShare=function(){t.props.onShowShare(t.props.file,"BROWSE_FILE_ROW")},t.onPresentInZoom=function(){t.props.onPresentInZoom&&t.props.onPresentInZoom(t.props.file)},t.getAriaLabelForColumn=function(e,t){switch(e.sortField){case _.SortField.FILENAME:return e.label+" "+a.filename(t.fq_path);case _.SortField.MODIFIED:return e.label+" "+t.ago;case _.SortField.CATEGORY:return e.label+" "+l.File.getCategoryDescription(t);case _.SortField.EXTENSION:return e.label+" "+l.File.getExtension(t);case _.SortField.SIZE:return e.label+" "+t.size;case _.SortField.SHARED_WITH:default:return}},t}return r.__extends(t,e),t.prototype.componentDidUpdate=function(e){if(this.props.isFocused&&!e.isFocused||this.props.isFocused&&this.props.isSelected&&!e.isSelected){var t=this.getCheckboxNode();t&&t.focus()}},t.prototype.renderModifiedCell=function(e,t,r){var o=r&&e.agoFromLastActionByUserTs,s=e.is_dir&&!this.props.isSearchMode?void 0:o?e.agoFromLastActionByUserTs:e.ago,a=o?r:e.last_modified_name||void 0,l=a&&E.intl.formatMessage({id:"ACVnV9",defaultMessage:"by {modified_by}"},{modified_by:a});return n.default.createElement(i.MediaCell,{className:"brws-file-modified-at-cell",key:"modifiedAt",subtitle:l,title:s||n.default.createElement(w,null)},t)},t.prototype.renderCell=function(e){var t=e.isHovered,r=e.isLastCell,o=e.sortField,s=e.renderCell,a=e.isKeyboardFocused,u=this.props,p=u.instanceId,m=u.listId,h=u.itemIndex,g=u.rowIndex,S=u.fileToId,E=u.visibleColumns,b=u.containerWidth,y=u.height,T=u.arePostTTIModulesLoaded,F=u.canDisplayFolderSizes,O=u.extensionsFeatureFlags,C=u.file,P=u.getOverflowMenuActions,A=u.hrefForFile,D=u.isCompactMode,R=u.isExtensionsMenuDisabled,M=u.isSearchMode,N=u.isSelectMode,L=u.isSelected,x=u.isSharingDisabled,k=u.onLocationLinkClick,U=u.onRenameCancel,V=u.onRenameSubmit,B=u.onStarClick,H=u.renameState,W=u.shareButtonLabel,q=u.sharingServiceInfo,j=u.showShareButton,G=u.thumbStore,z=u.useSearchSuccessBanner,K=u.user,Y=u.viewportTopOffset,Q=u.filteredContactName,X=u.logOverflowMenuOpen,J=u.scrollContainer,Z=u.showCDMUserEducationEffects,$=r&&!(D&&H)?n.default.createElement(c.FileMediaActions,{arePostTTIModulesLoaded:T,canDisplayFolderSizes:F,extensionsFeatureFlags:O,file:C,getOverflowMenuActions:P,isCompactMode:!!D,isExtensionsMenuDisabled:!!R,isHovered:t,isSearchMode:!!M,isSelectMode:!!N,isSelected:!!L,isSharingDisabled:!!x,onOpenFileClick:this.handleOpenFileClick,onPresentInZoom:this.onPresentInZoom,onShowShare:this.onShowShare,shareButtonLabel:W,sharingServiceInfo:q,showShareButton:j,showBorders:a,thumbStore:G,useSearchSuccessBanner:z,user:K,viewportTopOffset:Y,logOverflowMenuOpen:X,scrollContainer:J}):void 0;if(s)return s({file:C,mediaActions:$});switch(o){case _.SortField.FILENAME:return n.default.createElement(f.ThumbnailMediaCell,{file:C,thumbStore:G,height:y,showCDMUserEducationEffects:Z},n.default.createElement(d.FileNameCell,{key:"fileName",instanceId:p,listId:m,itemIndex:h,rowIndex:g,isHovered:t,fileToId:S,visibleColumns:E,containerWidth:b,mediaActions:$,onLocationLinkClick:k,onRenameCancel:U,onRenameSubmit:V,onStarClick:B,hrefForFile:A,onNameClick:this.handleTitleClick}));case _.SortField.RELEVANCE:case _.SortField.MODIFIED:return this.renderModifiedCell(C,$,Q);case _.SortField.SHARED_WITH:return n.default.createElement(i.MediaCell,{className:"brws-file-shared-with-cell",key:"sharedWith"},this.props.renderSharedWithController(C,this.props.isSelected?0:void 0),$);case _.SortField.CATEGORY:return n.default.createElement(i.MediaCell,{className:"brws-file-category-cell",key:"category",title:l.File.getCategoryDescription(C)},$);case _.SortField.EXTENSION:return n.default.createElement(i.MediaCell,{className:"brws-file-extension-cell",key:"extension",title:l.File.getExtension(C)},$);case _.SortField.SIZE:return n.default.createElement(i.MediaCell,{className:"brws-file-size-cell",key:"size",title:n.default.createElement(I,{file:C})},$);case _.SortField.LOCKED_FILES:return n.default.createElement(i.MediaCell,{className:"brws-file-size-cell",key:"locked_files",title:""},$);default:return v.reportException({err:new Error("renderCell function for "+o+"is not implemented"),severity:v.SEVERITY.NONCRITICAL,tags:["js:browse"]}),n.default.createElement(w,null)}},t.prototype.render=function(){var e=this,t=this.props,s=t.file,a=t.fileToId,c=t.instanceId,d=t.isActiveDropTarget,f=t.isAvailableDropTarget,_=t.isPinned,m=t.isSearchMode,h=t.isSelectMode,g=t.isSelected,S=t.itemIndex,v=t.listId,E=t.onDeselect,w=t.onSelect,b=t.renameState,y=t.rowIndex,T=t.topOffset,F=t.visibleColumns,I=t.isFirstTaskEmptyState,O="";return F.forEach((function(t){var r=e.getAriaLabelForColumn(t,s);r&&(O+=r+", ")})),n.default.createElement(p.FilesViewRow,{componentType:_?"MediaRow":"CulledMediaRow",className:o.default({"brws-file-row-no-access":l.File.isNoAccessSharedFolder(s),"brws-file-row-pinned":_}),isActiveDropTarget:d,isSelected:g,isDeleted:s.isDeleted,isDroppable:f&&!d&&!I,isDraggable:!(b||m||l.File.isTeamMemberFolder(s)||l.File.isReadOnlySharedFolder(s)||l.File.isNoAccessSharedFolder(s)),topOffset:T,rowIndex:y,isSelectMode:h,filename:String(s.fq_path.split("/").slice(-1)),ariaLabel:O,onSelect:this.onSelect,onDeselect:this.onDeselect,onNavigateToItem:this.onNavigateToItem,onDragEnter:this.onDragEnter,onDragStart:this.onDragStart},(function(t){var o=t.isHovered,s=t.isKeyboardFocused;return r.__spreadArrays([n.default.createElement(i.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"},n.default.createElement("div",{ref:e.checkboxTargetRef,className:"brws-vertically-center brws-file-row-checkbox-target",onClick:e.handleCheckboxTouchTargetClick,"aria-controls":"brws-sidebar-view"},n.default.createElement(u.FileRowCheckbox,{instanceId:c,listId:v,itemIndex:S,rowIndex:y,isHovered:o,fileToId:a,onSelect:w,onDeselect:E})))],F.map((function(t,r){return e.renderCell({isHovered:o,isLastCell:r===F.length-1,sortField:t.sortField,renderCell:t.renderCell,isKeyboardFocused:s})})))}))},t.defaultProps=O,t})(n.default.PureComponent);t.FileRow=C})),define("modules/clean/react/files_view/file_row_checkbox",["require","exports","tslib","classnames","react","react-redux","spectrum/checkbox","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/selectors/item_selectors","modules/clean/react/files_view/data/selectors/list_selectors","modules/clean/react/files_view/types","modules/clean/react/selectable_list","modules/clean/user_education/react/user_education_effect","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var _=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleChangeCheckbox=function(e,r){var o=t.props,n=o.onSelect,i=o.onDeselect,s=o.selectionId;n&&i&&("checked"===e?n(s,r.shiftKey?u.SelectOptions.EXTEND:u.SelectOptions.DEFAULT,d.FilesViewActionSource.SINGLE_CHECKBOX):i(s,r.shiftKey,d.FilesViewActionSource.SINGLE_CHECKBOX))},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.shouldRenderCheckboxes,r=e.isSelected,i=e.isDisabled,a=e.shouldShowUserEducationEffects,l=e.isCheckboxVisible;if(!t)return null;var c=n.default.createElement(s.Checkbox,{disabled:i,checked:r?"checked":"unchecked",className:o.default("brws-checkbox",{"brws-checkbox-checked":r}),onChange:this.handleChangeCheckbox,variant:l?"default":"invisible",ariaLabel:f.intl.formatMessage({id:"sJRsRx",defaultMessage:"Select item"}),tabIndex:r?0:-1});return a?n.default.createElement(p.UserEducationEffect,{containerName:"FileItemRow",name:"FirstFileSelectCheckbox",useSpan:!0},c):c},t})((n=r.__importDefault(n)).default.Component);t.FileRowCheckboxComponent=_;t.FileRowCheckbox=i.connect((function(e,t){return{isCheckboxDisabled:a.selectDisabledMultiselect(e,t),isCheckboxVisible:l.selectIsCheckboxVisible(e,t),isSelected:l.selectIsItemSelected(e,t),shouldRenderCheckboxes:c.selectShouldRenderCheckboxes(e,t),shouldShowUserEducationEffects:l.selectShouldShowUserEducationEffects(e,t),isDisabled:a.selectDisabledMultiselect(e,t),selectionId:l.selectItemSelectionId(e,t)}}))(_)})),define("modules/clean/react/files_view/file_shared_with_me_row",["require","exports","tslib","classnames","react","react-dom","spectrum/checkbox","spectrum/media_table","spectrum/util/raf_throttle","modules/clean/react/files_view/file_media_actions","modules/clean/react/files_view/file_name_cell","modules/clean/react/files_view/file_row","modules/clean/react/files_view/row","modules/clean/react/files_view/thumbnail_media_cell","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/selectable_list","modules/clean/user_education/react/user_education_effect","modules/core/browser","modules/core/exception","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S,v,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),i=r.__importStar(i),S=r.__importStar(S),v=r.__importStar(v);var w=function(){return n.default.createElement("span",{"aria-hidden":!0},"--")},b=function(e){var t=e.file;return t.is_cloud_doc&&u.isCloudDocProviderStored(t)?n.default.createElement(w,null):n.default.createElement("span",null,t.size)},y=(function(e){function t(t){var r=e.call(this,t)||this;return r.setRef=function(e){r.brwsFilenameContainerDiv=e},r.checkboxRef=null,r.handleWindowResize=function(){r.throttledWindowResize.request()},r.handleResize=function(){if(r.brwsFilenameContainerDiv){var e=r.state.brwsFilenameContainerDivWidth,t=r.brwsFilenameContainerDiv.getBoundingClientRect().width;t&&t!==e&&r.setState({brwsFilenameContainerDivWidth:t})}},r.handleOpenFileClick=function(e){return r.handleOpenNewTabOrNavigate(e,_.FilesViewActionSource.ROW_PREVIEW_ICON)},r.handleTitleClick=function(e){return r.handleOpenNewTabOrNavigate(e,_.FilesViewActionSource.ROW_TITLE)},r.handleOpenNewTabOrNavigate=function(e,t){0===e.button&&(e.preventDefault(),e.stopPropagation(),r.onNavigateToItem({openInNewTab:m.hasModifierKey(e),actionSource:t}))},r.onSelect=function(e,t){r.props.onSelect&&r.props.onSelect(r.props.file.file_id,e,t)},r.onDeselect=function(e,t){r.props.onDeselect&&r.props.onDeselect(r.props.file.file_id,e,t)},r.onNavigateToItem=function(e){var t=e.openInNewTab,o=e.actionSource;t?S.open_tab(r.props.file.href):r.props.onOpenFileSharedWithMe(r.props.file,{actionSource:o})},r.getCheckboxNode=function(){return r.checkboxRef&&i.findDOMNode(r.checkboxRef)},r.isCheckboxNode=function(e){var t=r.getCheckboxNode();return!!t&&t.contains(e)},r.handleChangeCheckbox=function(e,t){if(r.props.onSelect&&r.props.onDeselect){var o=r.props.file.file_id;"checked"===e?r.props.onSelect(o,t.shiftKey?h.SelectOptions.EXTEND:h.SelectOptions.DEFAULT,_.FilesViewActionSource.SINGLE_CHECKBOX):r.props.onDeselect(o,t.shiftKey,_.FilesViewActionSource.SINGLE_CHECKBOX)}},r.setCheckboxRef=function(e){r.checkboxRef=e},r.handleCheckboxTouchTargetClick=function(e){if(r.shouldHandleClick(e)){if(!r.props.isCheckboxDisabled&&r.props.onDeselect&&r.props.onSelect){e.preventDefault();var t=r.props.file.file_id;r.props.isSelected?r.props.onDeselect(t,e.shiftKey,_.FilesViewActionSource.SINGLE_CHECKBOX):r.props.onSelect(t,e.shiftKey?h.SelectOptions.EXTEND:h.SelectOptions.DEFAULT,_.FilesViewActionSource.SINGLE_CHECKBOX)}}else e.preventDefault()},r.renderCheckbox=function(e){var t=r.props,i=t.isCompactMode,a=t.isSelectMode,l=t.isSelected,c=t.showUserEducationEffects,d=null,u=!(e||l||a||i);return d=n.default.createElement(s.Checkbox,{disabled:r.props.isCheckboxDisabled,checked:l?"checked":"unchecked",className:o.default("brws-checkbox",{"brws-checkbox-checked":l}),onChange:r.handleChangeCheckbox,ref:r.setCheckboxRef,variant:u?"invisible":"default",ariaLabel:E.intl.formatMessage({id:"sJRsRx",defaultMessage:"Select item"}),tabIndex:l?0:-1}),c&&(d=n.default.createElement(g.UserEducationEffect,{containerName:"FileSharedWithMeRow",name:"FirstFileSelectCheckbox",useSpan:!0},d)),d},r.state={brwsFilenameContainerDivWidth:void 0},r.throttledWindowResize=new l.RafThrottle((function(){return r.handleResize()})),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.handleResize(),window.addEventListener("resize",this.handleWindowResize)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.handleWindowResize)},t.prototype.componentDidUpdate=function(e){var t=this;(this.props.isFocused&&!e.isFocused||this.props.isFocused&&this.props.isSelected&&!e.isSelected)&&this.checkboxRef&&Promise.resolve().then((function(){var e=t.getCheckboxNode();e&&e.focus()}))},t.prototype.renderModifiedCell=function(e,t,r){var o=r&&e.agoFromLastActionByUserTs,i=o?e.agoFromLastActionByUserTs:e.ago,s=o?r:e.last_modified_name||void 0,l=s&&E.intl.formatMessage({id:"ACVnV9",defaultMessage:"by {modified_by}"},{modified_by:s});return n.default.createElement(a.MediaCell,{className:"brws-file-modified-at-cell",key:"modifiedAt",subtitle:l,title:i||n.default.createElement(w,null)},t)},t.prototype.renderCell=function(e){var t=e.isHovered,o=e.isKeyboardFocused,i=e.sortField,s=e.isLastCell,l=this.props,u=l.arePostTTIModulesLoaded,p=l.file,m=l.getOverflowMenuActions,h=l.thumbStore,g=l.isCompactMode,S=l.isSelectMode,E=l.isSelected,y=l.responsive,T=l.user,F=l.showSnippets,I=l.snippetRows,O=l.height,C=l.useSearchSuccessBanner,P=l.filteredContactName,A=l.logOverflowMenuOpen,D=l.scrollContainer,R=m(p,!1).some((function(e){return e.length>0})),M=s&&!g&&u&&R?n.default.createElement(c.FileMediaActions,{arePostTTIModulesLoaded:u,canDisplayFolderSizes:!1,file:p,getOverflowMenuActions:m,isCompactMode:!!g,isHovered:t,isSearchMode:!0,isSelectMode:!!S,isSelected:!!E,isSharingDisabled:!0,showBorders:o,thumbStore:h,useSearchSuccessBanner:C,user:T,onOpenFileClick:this.handleOpenFileClick,logOverflowMenuOpen:A,scrollContainer:D}):void 0;switch(i){case _.SortField.FILENAME:var N={file:p,isHovered:t,isSelectMode:!!S,isSelected:!!E,isMobileMode:!y.isMatchedLarge&&!y.isMatchedMedium,user:T,mediaActions:M,shouldTruncateMiddleFilename:u,showHighlights:!0,showLocation:!0,showStar:!1,showSnippets:!!F,snippetRows:I,onNameClick:this.handleTitleClick,isSearchMode:!0,useSearchSuccessBanner:C,renameState:void 0,renderFilenameSubtitleAsLink:!1,showUserEducationEffects:!1,userEducationEffectName:"",isTooltipEnabled:!1,showFirstTaskSubtitle:!1,showBasicToBizSubtitle:!1},L=this.state.brwsFilenameContainerDivWidth;return n.default.createElement("div",{className:"brws-file-name-container",ref:this.setRef},n.default.createElement(f.ThumbnailMediaCell,{file:p,thumbStore:h,height:O},n.default.createElement(d.FileNameCellComponent,r.__assign({},N,{fileNameCellWidth:L?L-64:void 0}))));case _.SortField.RELEVANCE:case _.SortField.MODIFIED:return this.renderModifiedCell(p,M,P);case _.SortField.SIZE:return n.default.createElement(a.MediaCell,{className:"brws-file-size-cell",key:"size",title:n.default.createElement(b,{file:p})},M);default:case _.SortField.CATEGORY:case _.SortField.EXTENSION:case _.SortField.SHARED_WITH:return v.reportException({err:new Error("FileSharedWithMe.renderCell is not implemented for "+i),severity:v.SEVERITY.NONCRITICAL,tags:["js:search"]}),n.default.createElement(a.MediaCell,{key:i,title:n.default.createElement(w,null)})}},t.prototype.shouldHandleClick=function(e){return!e.defaultPrevented&&!this.isCheckboxNode(e.target)},t.prototype.render=function(){var e=this,t=this.props,o=t.rowIndex,i=t.topOffset,s=t.isSelected,l=t.isSelectMode,c=t.visibleColumns;return n.default.createElement(p.FilesViewRow,{componentType:"CulledMediaRow",className:"brws-filesharedwithme-row",isSelected:s,topOffset:i,rowIndex:o,isSelectMode:l,onSelect:this.onSelect,onDeselect:this.onDeselect,onNavigateToItem:this.onNavigateToItem},(function(t){var o=t.isHovered,i=t.isKeyboardFocused;return r.__spreadArrays([n.default.createElement(a.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"},n.default.createElement("div",{className:"brws-vertically-center brws-file-row-checkbox-target",onClick:e.handleCheckboxTouchTargetClick},e.renderCheckbox(o)))],c.map((function(t,r){return e.renderCell({isHovered:o,isKeyboardFocused:i,sortField:t.sortField,isLastCell:r===c.length-1})})))}))},t})(n.default.PureComponent);t.FileSharedWithMeRow=y})),define("modules/clean/react/files_view/file_snippets",["require","exports","tslib","react","modules/clean/filename_highlights","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/list_selectors"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n);var a=(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(n,e),n.prototype.render=function(){var e=this.props,r=e.snippets,n=e.lineClamp,a={maxHeight:i.SNIPPET_HEIGHT_PER_ROW*n,WebkitLineClamp:n},l=s.getFirstValidSnippet(r);return l?o.default.createElement("span",{className:"brws-file-snippets",style:a},o.default.createElement(t.FileSnippet,{snippet:l})):null},n.defaultProps={lineClamp:3},n})(o.default.PureComponent);t.FileSnippets=a,t.FileSnippet=function(e){var t=e.snippet;return n.highlightReactFromAllHighlightSpans(t.highlight_spans||[])}})),define("modules/clean/react/files_view/files_view",["require","exports","tslib","classnames","external/lodash","immutable","react","react-dom","react-redux","spectrum/media_table_skeleton","spectrum/table","modules/clean/photos/thumb_loading/buffered_thumb_store","modules/clean/photos/thumb_loading/generic_thumb_store","modules/clean/react/browse/action_logger","modules/clean/react/browse/models","modules/clean/react/files_view/column_header","modules/clean/react/files_view/column_manager","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/drag_and_drop","modules/clean/react/files_view/file_list_empty_folder_table","modules/clean/react/files_view/internal_drag_status","modules/clean/react/files_view/list","modules/clean/react/files_view/pinned_team_folder_view","modules/clean/react/files_view/scroll_updater","modules/clean/react/files_view/tile_grid","modules/clean/react/files_view/types","modules/clean/react/icon/file_folder_icon","modules/clean/react/selectable_list","modules/clean/sharing/access_level","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/core/browser_detection","modules/core/i18n","modules/core/notify"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S,v,E,w,b,y,T,F,I,O,C,P,A,D,R,M,N,L,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n),i=r.__importStar(i),s=r.__importDefault(s),a=r.__importStar(a),R=r.__importStar(R);var k=function(){},U=[A.NameSpaceAccess.ACCESS_NO_ACCESS,A.NameSpaceAccess.ACCESS_READER,A.NameSpaceAccess.ACCESS_READER_NO_COMMENT],V={keyboard:O.FilesViewActionSource.KEYBOARD};function B(e){return e.filter(H).size>0}function H(e){return e instanceof _.File||e instanceof _.FileSharedWithMe}t.getShouldShowSelectAllCheckbox=B;var W=(function(t){function l(){var e=null!==t&&t.apply(this,arguments)||this;return e.gridViewPrewarmedThumbnailRequestIds=[],e.state={thumbStore:new u.BufferedThumbStore,dropTarget:null,tilesPerRow:1},e.handleCopyToClipboard=function(){var t=e.props,r=t.selectedFiles,o=t.onCopyToClipboard;r.size&&o(r.toArray())},e.handleNewFolderSubmit=function(t){""===t?(e.props.onNewFolderCancel(),e.handleNewFolderCancel({source:O.NameInputActionSource.SUBMIT})):e.props.onNewFolderSubmit(t)},e.handleNewFolderCancel=function(t){t.source!==O.NameInputActionSource.ESC&&x.Notify.error(L.intl.formatMessage({id:"9xXIAi",defaultMessage:"Please provide a name for the new folder."})),e.props.onNewFolderCancel()},e.handleSetFileUploaderPath=function(t){var r=t?t.path:e.props.path,o=e.props.context.isCurrentPathWriteable();t&&t.hasOwnProperty("hasPermissionToUploadToFolder")&&(o=!!t.hasPermissionToUploadToFolder);var n=!!(null==t?void 0:t.isMovingIntoVault);e.props.setFileUploaderPath({path:r,hasPermissionToUploadToFolder:o,isMovingIntoVault:n})},e.handleDragStart=function(t,o){void 0===o&&(o=[]);var i=e.props,s=i.path,l=i.selectedFiles,c=i.user,d=n.keyBy(o,"fq_path");d=r.__assign(r.__assign({},d),l.toJS());var u=n.values(d);if(u.some((function(e){return _.File.isTeamSharedFolder(e)})))x.Notify.error(L.intl.formatMessage({id:"1cIg3V",defaultMessage:"Team folders can’t be moved."}));else if(u.some((function(e){return _.File.isTeamMemberFolder(e)})))x.Notify.error(L.intl.formatMessage({id:"ZxTpZJ",defaultMessage:"Your member folder can’t be moved."}));else{var p=t.dataTransfer;p&&(p.setDragImage&&e.internalDragStatusRef&&p.setDragImage(a.findDOMNode(e.internalDragStatusRef),-10,-10),p.setData(N.INTERNAL_FILE_DATA_TRANSFER_TYPE,JSON.stringify({userId:c.id,fromPath:s,filePaths:u.map((function(e){return e.fq_path}))})),p.effectAllowed="copyMove")}},e.handleDragEnter=function(t,r,o,n){E.onFileDragEnterItem(r,!!e.props.isDraggingExternalFiles,!!e.props.isDraggingInternalFiles,o,n,e.props.context,e.handleSetDropTarget,e.handleSetFileUploaderPath)},e.handleSetDropTarget=function(t){e.setState({dropTarget:t}),e.props.updateDropTarget&&e.props.updateDropTarget(t)},e.handleSelectionChange=function(t,r){D.UEClient.sendEvent("FileItemRow","CheckboxToggled");var o=r?r in P.SelectableListActionSource?V[r]:r:void 0;e.props.onSelectionChange(t,o)},e.onAllCheckboxDeselectAll=function(){var t=e.props,r=t.selection;(0,t.onSelectionChange)(r.set("selected",i.OrderedSet()),O.FilesViewActionSource.ALL_CHECKBOX)},e.onAllCheckboxSelectAll=function(){var t=e.props,r=t.items,o=t.selection;(0,t.onSelectionChange)(o.set("selected",i.OrderedSet(r.filter(H).map((function(t){return"fq_path"in t?e.props.fileToId(t):t.file_id})))),O.FilesViewActionSource.ALL_CHECKBOX)},e._handleGetOverflowMenuActions=function(t,r){var o=e.props;return(0,o.getOverflowMenuActions)(t,r,o.responsive)},e.handleTTI=function(){e.props.onComponentTTI("FilesViewController")},e.setInternalDragStatusRef=function(t){e.internalDragStatusRef=t},e.getIsCurrentPathWriteable=function(){return e.props.context.isCurrentPathWriteable()},e.onTilesPerRowChange=function(t){e.setState({tilesPerRow:t})},e.onDeselectAll=function(){e.props.isSearchMode&&e.props.onFocusSearchBar()},e.logRightClick=function(t){var r=e.props,o=r.selectedFiles,n=r.user,i=r.viewType,s=o?o.count((function(e){return e.is_dir})):0,a=o?o.count()-s:0;f.logRightClickItems({uid:n.id,viewType:i,action_surface:M.ActionSurfaceLogValue.CENTER_PANE,numFilesSelected:a,numFoldersSelected:s})},e}return r.__extends(l,t),l.prototype.componentDidMount=function(){var e=this;this.setupUnity(),D.UEClient.registerForAllEducationSteps((function(t){t.step&&t.step.effect&&["FileItemRow","PinnedTeamFolder","PathBreadcrumbs"].includes(t.step.effect.containerName)&&e.props.onSwitchViewType(O.ViewType.List)})),R.waitForTTI().then((function(){e.prewarmGridViewThumbStore()}))},l.prototype.UNSAFE_componentWillReceiveProps=function(e){if(e.context&&this.props.context&&e.context.currentFQPath!==this.props.context.currentFQPath){this.undoPrewarmGridViewThumbStore();var t=this.props.arePostTTIModulesLoaded?new p.GenericThumbStore:new u.BufferedThumbStore;this.setState({thumbStore:t})}},l.prototype.componentDidUpdate=function(e){e.context&&this.props.context&&e.context.currentFQPath!==this.props.context.currentFQPath&&this.prewarmGridViewThumbStore(),this.props.enableUnity&&e.items!==this.props.items&&this.triggerUnityChangeCallback&&this.triggerUnityChangeCallback()},l.prototype.componentWillUnmount=function(){this.triggerUnityChangeCallback=void 0},l.prototype.setupUnity=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,o=this;return r.__generator(this,(function(n){switch(n.label){case 0:return[4,R.waitForTTI()];case 1:return n.sent(),[4,new Promise((function(t,r){e(["modules/clean/unity_browse_interface"],t,r)})).then(r.__importStar)];case 2:return t=n.sent().default,this.triggerUnityChangeCallback=function(){t.browse_visible_change_callback(o.props.items.toArray(),o.props.user.id,0,o.props.items.size-1)},[2]}}))}))},l.prototype.prewarmGridViewThumbStore=function(){var e=this;if(this.props.viewType!==O.ViewType.Grid){var t=this.state.thumbStore;this.props.items.slice(0,100).forEach((function(r){if(r instanceof _.File||r instanceof _.FileSharedWithMe){var o=C.getThumbnailUrlForItem(r.thumbnail_url_tmpl,g.ViewTypeThumbnailSizes[O.ViewType.Grid]);if(o){var n=t.bind_url(o,{onSuccess:k});n&&e.gridViewPrewarmedThumbnailRequestIds.push(n)}}}))}},l.prototype.undoPrewarmGridViewThumbStore=function(){var e=this;this.gridViewPrewarmedThumbnailRequestIds.length&&(this.gridViewPrewarmedThumbnailRequestIds.forEach((function(t){e.state.thumbStore.unbind_url(t)})),this.gridViewPrewarmedThumbnailRequestIds=[])},l.prototype.renderEmptyFolderView=function(){var e=this.props,t=e.context,r=e.responsive,o=e.onFocusSearchBar,n=e.onPasteFromClipboard,i=e.onNavigateToParentFolder;if(this.props.customEmptyFolderView)return this.props.customEmptyFolderView(r);var a=t.isInsideSharedFolder,l=t.currentSharedFolderPermissionRole,c=a&&U.includes(l)?void 0:L.intl.formatMessage({id:"jXqkXG",defaultMessage:"Drag and drop files onto this window to upload."});return s.default.createElement(w.EmptyFolderTable,{title:L.intl.formatMessage({id:"YLBqRL",defaultMessage:"This folder is empty"}),subtitle:c,onTTI:this.handleTTI,onFocusSearchBar:o,onPasteFromClipboard:n,onNavigateToParentFolder:i,onOpenKeyboardShortcutModal:this.props.openKeyboardShortcutsModal})},l.prototype.getSelectAllCheckboxCheckedVariant=function(){var e=this.props,t=e.selectedFiles,r=e.items,o="unchecked";return t.size===r.filter(H).size?o="checked":t.size&&(o="mixed"),o},l.prototype.isCreateFolderUIActive=function(){var e=this.props.createNewFolderState;return e&&"CREATE_FOLDER_INACTIVE"!==e},l.prototype.shouldShowEmptyFolderView=function(){return this.props.loadingState===O.LoadingState.LOADED&&!this.props.items.size&&!this.isCreateFolderUIActive()},l.prototype.shouldComponentUpdate=function(e){return e.loadingState!==this.props.loadingState||e.loadingState!==O.LoadingState.LOADING_FIRST_PAGE},l.prototype.render=function(){var e=this,t=this.props,n=t.id,i=t.onDelete,a=t.onShowRename,l=t.onRenameSubmit,u=t.onRenameCancel,p=t.onSwitchViewType,f=t.onPasteFromClipboard,_=t.onColumnsChanged,S=t.onCanDisplayFolderSizesChanged,v=t.onFocusSearchBar,E=t.currentSort,w=t.createNewFolderState,C=t.context,A=t.columns,D=t.dropTargetHighlightMode,R=t.fileRename,M=t.getIsFileJumping,N=t.onAddFileJumpKeyCode,L=t.onResetFileJump,x=t.items,k=t.itemIds,U=t.isCompactMode,V=t.isSearchMode,H=t.isDraggingExternalFiles,W=t.isDraggingInternalFiles,q=t.isQueryingFolderSizes,j=t.isFileViewerShown,G=t.loadingState,z=t.onSortChange,K=t.path,Y=t.responsive,Q=t.selectedFiles,X=t.selection,J=t.shouldShowPinnedTeamFolders,Z=t.renderSharedWithController,$=t.onShowShare,ee=t.onPresentInZoom,te=t.teamFolders,re=t.totalNumFiles,oe=t.user,ne=t.viewType,ie=t.viewTypes,se=t.viewTypeLabels,ae=t.viewTypeColumns,le=t.onLocationLinkClick,ce=t.onNavigateToFileOrFolder,de=t.onNavigateToParentFolder,ue=t.onOpenFileSharedWithMe,pe=t.onOpenPaper,fe=t.arePostTTIModulesLoaded,_e=t.onStarClick,me=t.extensionsFeatureFlags,he=t.scrollContainer,ge=t.sharingServiceInfo,Se=t.stickyOffsetTop,ve=t.disabledMultiselect,Ee=t.isStickyColumnHeader,we=t.onRangeInView,be=t.highDensity,ye=t.filteredContactName,Te=t.sections,Fe=Y.isMatchedLarge,Ie=Y.isMatchedMedium,Oe=this.state,Ce=Oe.dropTarget,Pe=Oe.thumbStore,Ae=Oe.tilesPerRow;if(G===O.LoadingState.LOADING_FIRST_PAGE)return fe?s.default.createElement(c.MediaTableSkeleton,{numRows:15}):null;var De=!!Q.size,Re=J&&s.default.createElement(T.PinnedTeamFolderView,{instanceId:n,activeDropTarget:Ce,columnFlex:g.LIST_VIEW_COLUMN_FLEX[1],getOverflowMenuActions:this._handleGetOverflowMenuActions,onDragEnter:this.handleDragEnter,onNavigateToFileOrFolder:this.props.onNavigateToFileOrFolder,onRenameCancel:u,onRenameSubmit:l,thumbStore:Pe,onShowShare:$,renderSharedWithController:Z,scrollContainer:he});if(this.shouldShowEmptyFolderView())return s.default.createElement("div",{className:"brws-files-view"},Re,this.renderEmptyFolderView());var Me=Fe?g.DEFAULT_COLUMN_HEADER_HEIGHT:g.COMPACT_COLUMN_HEADER_HEIGHT,Ne=Me+Se,Le=this.props.scrollPositionOffset||0;return J&&(Le+=Me+Me+g.PINNED_TEAM_FOLDER_SECONDARY_HEADER_PADDING_TOP+te.size*g.DEFAULT_ROW_HEIGHT),s.default.createElement("div",{className:o.default(["brws-files-view","brws-files-view--"+ne.toLowerCase()]),onContextMenu:this.logRightClick},Re,s.default.createElement(h.ColumnManager,{columns:A,viewTypeColumns:ae,currentSort:E,onCanDisplayFolderSizesChanged:S,onColumnsChanged:_,isMatchedLarge:Fe,isMatchedMedium:Ie,isSearchMode:V,viewType:ne,responsiveContainer:!!this.props.expSnippets},(function(t){var c=t.visibleColumns,_=t.handleSelection,h=t.canDisplayFolderSizes,S=t.containerWidth,b=(V?e.props.expSnippets?g.LIST_VIEW_SEARCH_MODE_WITH_SNIPPETS_COLUMN_FLEX:g.LIST_VIEW_SEARCH_MODE_COLUMN_FLEX:g.LIST_VIEW_COLUMN_FLEX)[c.length],T={columnFlex:b,currentSort:E,isCompactMode:U,isSelectMode:De,onDeselectAll:e.onAllCheckboxDeselectAll,onSelectAll:e.onAllCheckboxSelectAll,onSelection:_,onSort:z,onSwitchViewType:p,selectAllCheckboxState:e.getSelectAllCheckboxCheckedVariant(),showSelectAllCheckbox:B(e.props.items),stickyOffsetHeight:Me,stickyOffsetTop:Se,columns:A,visibleColumns:c,viewType:ne,viewTypes:ie,viewTypeLabels:se,onTTI:e.handleTTI,isSearchMode:V,presentationOnly:ne!==O.ViewType.List};return ne===O.ViewType.List?s.default.createElement(P.SelectableList,{itemIds:k,keyScope:P.SELECTABLE_LIST_KEY_SCOPE,onSelectionChange:e.handleSelectionChange,selection:X,tilesPerRow:Ae,onDeselectAll:e.onDeselectAll},(function(t){var p=t.focusedFileId,_=t.handleDeselect,g=t.handleFocusFile,E=t.handleSelect,F=t.isSelectableListEvent;return s.default.createElement(d.Table,{"aria-rowcount":re,className:o.default("brws-files-view-list",{"brws-files-view-list-compact":U,"brws-files-view-list-high-density":be}),columnFlex:b},s.default.createElement(m.ColumnHeader,r.__assign({},T,{variant:he?"sticky-native":Ee?"sticky":"fixed"})),s.default.createElement(y.FilesViewList,{instanceId:n,onDelete:i,onShowRename:a,activeDropTarget:Ce,context:C,createNewFolderState:w,dropTargetHighlightMode:D,extensionsFeatureFlags:me,fileRename:R,focusedFileIndex:p?k.indexOf(p):void 0,getOverflowMenuActions:e._handleGetOverflowMenuActions,getIsCurrentPathWriteable:e.getIsCurrentPathWriteable,getIsFileJumping:M,onAddFileJumpKeyCode:N,onResetFileJump:L,isCompactMode:U,isDraggingExternalFiles:H,isDraggingInternalFiles:W,isFileViewerShown:j,isSearchMode:V,isSelectMode:De,isSelectableListEvent:F,arePostTTIModulesLoaded:fe,keyScope:P.SELECTABLE_LIST_KEY_SCOPE,onCopyToClipboard:e.handleCopyToClipboard,onDragStart:e.handleDragStart,onDragEnter:e.handleDragEnter,onDeselectFile:_,onFocusFile:g,onFocusSearchBar:v,onOpenKeyboardShortcutModal:e.props.openKeyboardShortcutsModal,onLocationLinkClick:le,onNavigateToFileOrFolder:ce,onNavigateToParentFolder:de,onNewFolderCancel:e.handleNewFolderCancel,onNewFolderSubmit:e.handleNewFolderSubmit,onOpenFileSharedWithMe:ue,onOpenPaper:pe,onPasteFromClipboard:f,onRenameCancel:u,onRenameSubmit:l,onSelectFile:E,onSetDropTarget:e.handleSetDropTarget,onSetFileUploaderPath:e.handleSetFileUploaderPath,onStarClick:_e,responsive:Y,scrollPositionOffset:Le,selectedFiles:Q,selection:X,renderSharedWithController:Z,hrefForFile:e.props.hrefForFile,onShowShare:$,onPresentInZoom:ee,user:oe,viewportTopOffset:Ne,visibleColumns:c,canDisplayFolderSizes:h,thumbStore:Pe,scrollContainer:he,shareButtonLabel:e.props.shareButtonLabel,sharingServiceInfo:ge,showShareButton:e.props.showShareButton,starredState:e.props.starredState,useSearchSuccessBanner:e.props.useSearchSuccessBanner,onRangeInView:we,expSnippets:e.props.expSnippets,containerWidth:S,highDensity:be,filteredContactName:ye,fileToId:e.props.fileToId,eligibleForFirstTaskSubtitle:e.props.eligibleForFirstTaskSubtitle,eligibleForBasicToBizSubtitle:e.props.eligibleForBasicToBizSubtitle,expVaultEnableViewOnlySharing:e.props.expVaultEnableViewOnlySharing,isFirstTaskEmptyState:e.props.isFirstTaskEmptyState}))})):s.default.createElement(P.SelectableList,{itemIds:k,keyScope:P.SELECTABLE_TILE_GRID_KEY_SCOPE,onSelectionChange:e.handleSelectionChange,selection:X,tilesPerRow:Ae,sectionStartIndices:Te.sectionStartIndices},(function(t){var o=t.handleDeselect,n=t.handleDeselectAll,c=t.handleFocusFile,p=t.handleSelect,_=t.handleSelectAll,h=t.focusedFileId;return s.default.createElement("div",null,s.default.createElement(d.Table,{columnFlex:g.GRID_VIEW_COLUMN_FLEX,role:"presentation",style:he?{position:"sticky",top:Se,zIndex:1}:void 0},s.default.createElement(m.ColumnHeader,r.__assign({},T,{variant:he?"default":Ee?"sticky":"fixed"}))),s.default.createElement(I.FilesViewTileGrid,{onDelete:i,disabledMultiselect:ve||!1,onShowRename:a,activeDropTarget:Ce,arePostTTIModulesLoaded:fe,createNewFolderState:w,context:C,deselectAll:n,dropTargetHighlightMode:D,fileRename:R,getOverflowMenuActions:e._handleGetOverflowMenuActions,getIsCurrentPathWriteable:e.getIsCurrentPathWriteable,getIsFileJumping:M,onAddFileJumpKeyCode:N,onResetFileJump:L,onTTI:e.handleTTI,items:x,isCreateFolderUIActive:e.isCreateFolderUIActive(),isDraggingExternalFiles:H,isDraggingInternalFiles:W,isQueryingFolderSizes:q,isSearchMode:V,onCopyToClipboard:e.handleCopyToClipboard,onDeselectFile:o,onDragEnter:e.handleDragEnter,onDragStart:e.handleDragStart,onFocusFile:c,onFocusSearchBar:v,onNewFolderCancel:e.handleNewFolderCancel,onNewFolderSubmit:e.handleNewFolderSubmit,onNavigateToFileOrFolder:ce,onOpenFileSharedWithMe:ue,onOpenPaper:pe,onOpenKeyboardShortcutModal:e.props.openKeyboardShortcutsModal,onPasteFromClipboard:f,onRangeInView:we,onRenameCancel:u,onRenameSubmit:l,onSelectFile:p,onSetDropTarget:e.handleSetDropTarget,onSortChange:z,onStarClick:_e,onTilesPerRowChange:e.onTilesPerRowChange,path:K,sections:Te,selectAll:_,selectedFiles:Q,selection:X,onSetFileUploaderPath:e.handleSetFileUploaderPath,thumbStore:Pe,tilesPerRow:Ae,totalNumItems:re,user:oe,viewportTopOffset:Ne,viewType:ne,starredState:e.props.starredState,hrefForFile:e.props.hrefForFile,focusedFileIndex:h?k.indexOf(h):void 0,scrollContainer:he,scrollPositionOffset:Le}))}))})),s.default.createElement(F.ScrollUpdater,{scrollContainer:he,path:K}),s.default.createElement(b.InternalDragStatus,{className:"offscreen-drag-icon",files:Q.toArray(),ref:this.setInternalDragStatusRef}))},l.defaultProps={fileToId:function(e){return e.fq_path}},l})(s.default.Component);t.FilesViewComponent=W;t.FilesView=l.connect((function(e,t){var o=t.id;return r.__assign(r.__assign({},v.selectInstance(e,{instanceId:o})),{itemIds:v.selectItemIds(e,{instanceId:o}),sections:v.selectSections(e,{instanceId:o}),responsive:v.selectResponsive(e,{instanceId:o}),isCompactMode:v.selectIsCompactMode(e,{instanceId:o})})}),(function(e,t){var r=t.id;return{openKeyboardShortcutsModal:function(){return e(S.openKeyboardShortcutsModal({instanceId:r}))}}}))(W)})),define("modules/clean/react/files_view/files_view_logging",["require","exports","tslib","modules/clean/react/browse/logger_util"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logEventWithNumberOfFiles=function(t){var n=t.isSearchMode,i=t.file,s=t.extra,a=t.action,l=t.action_source,c=t.action_surface,d=t.user;if(n){var u=new Promise((function(t,r){e(["modules/clean/search/single_page/logger"],t,r)})).then(r.__importStar),p=new Promise((function(t,r){e(["modules/clean/search/single_page/data/selectors/index"],t,r)})).then(r.__importStar),f=new Promise((function(t,r){e(["modules/clean/search/single_page/data/store"],t,r)})).then(r.__importStar);Promise.all([u,p,f]).then((function(e){var t=e[0],n=e[1],d=e[2].getStoreForSearch().getState(),u=n.selectedFiles(d),p=o.countFilesAndFolders(u),f=p.num_files_selected,_=p.num_folders_selected,m=r.__assign(r.__assign({},s),{num_files_selected:f.toString(),num_folders_selected:_.toString()});t.logResultAction(a,n.resultsList(d),i,c,l,m)}))}else{var _=new Promise((function(t,r){e(["modules/clean/react/browse/action_logger"],t,r)})).then(r.__importStar),m=new Promise((function(t,r){e(["modules/clean/react/browse/data/store"],t,r)})).then(r.__importStar),h=new Promise((function(t,r){e(["modules/clean/react/browse/data/selectors"],t,r)})).then(r.__importStar);Promise.all([_,m,h]).then((function(e){var t=e[0].logBrowseAction,r=e[1].getStoreForBrowse,n=e[2].selectedFiles(r().getState()),u=o.countFilesAndFolders(n),p=u.num_files_selected,f=u.num_folders_selected;t({uid:d.id,action:a,result:i,num_files_selected:p,num_folders_selected:f,action_surface:c,action_source:l,extra:s})}))}}})),define("modules/clean/react/files_view/fixed_table_head",["require","exports","tslib","spectrum/vertically_fixed","spectrum/table","react"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),t.FixedTableHead=function(e){var t=e.children,s=e.offsetHeight,a=e.style,l=void 0===a?{}:a,c=r.__rest(e,["children","offsetHeight","style"]),d=void 0===s?l:r.__assign({flexBasis:s},l);return i.default.createElement("thead",r.__assign({className:"mc-table-head mc-table-head-fixed brws-column-header",style:d},c),i.default.createElement(o.VerticallyFixed,{tag:function(e){var o=e.style;return i.default.createElement(n.TableRow,{className:"mc-table-head-row mc-table-head-row-fixed",style:r.__assign({height:s},o),role:"presentation"},t)}}))}})),define("modules/clean/react/files_view/internal_drag_status",["require","exports","tslib","classnames","react","modules/clean/react/icon/file_folder_icon"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,r=e.files,s=o.default("active",t);return n.default.createElement("div",{id:"drag-status",className:s,"aria-hidden":"true"},n.default.createElement("div",{id:"drag-selection-status"},r.slice(0,4).map((function(e,t){return e.thumbnail_url_tmpl?n.default.createElement("img",{key:t,src:e.thumbnail_url_tmpl,className:"icon icon"+t,alt:""}):n.default.createElement(i.FileOrFolderIcon,{key:t,file:e,className:"icon icon"+t})})),n.default.createElement("span",{className:"badge"},r.length)))},t})((n=r.__importDefault(n)).default.PureComponent);t.InternalDragStatus=s})),define("modules/clean/react/files_view/legacy_types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("modules/clean/react/files_view/list",["require","exports","tslib","react","react-redux","modules/clean/react/browse/action_logger","modules/clean/react/browse/models","modules/clean/react/files_view/culled_table_body","modules/clean/react/files_view/data/selectors/list_selectors","modules/clean/react/files_view/drag_and_drop","modules/clean/react/files_view/row_container","modules/clean/react/files_view/file_shared_with_me_row","modules/clean/react/files_view/keyboard_shortcuts","modules/clean/react/files_view/new_folder_row","modules/clean/react/files_view/paper_row","modules/clean/react/files_view/types","modules/clean/react/files_view/user_defined_item_row","modules/clean/web_user_action_events"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var S=function(){},v=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getIsListEvent=function(e){return t.props.isSelectableListEvent()&&(!(e.target instanceof Element)||"BUTTON"!==e.target.tagName)},t.getSelectedFiles=function(){return t.props.selectedFiles},t.getActiveDropTarget=function(){return t.props.activeDropTarget},t.getIsDraggingInternalFiles=function(){return!!t.props.isDraggingInternalFiles},t.getIsDraggingExternalFiles=function(){return!!t.props.isDraggingExternalFiles},t.logOverflowMenuOpen=function(){var e=t.props,r=e.selectedFiles,o=e.user,n=r?r.count((function(e){return e.is_dir})):0,s=r?r.count()-n:0;i.logContextMenuClick({uid:o.id,viewType:m.ViewType.List,action_surface:g.ActionSurfaceLogValue.CENTER_PANE,numFilesSelected:s,numFoldersSelected:n})},t.renderRow=function(e,r,n){if("NewFolderRow"===e.type)return o.default.createElement(f.NewFolderRow,{createNewFolderState:e.props.createNewFolderState,isInsideMyTeamFolderTree:e.props.isInsideMyTeamFolderTree,onCancel:t.props.onNewFolderCancel,onSubmit:t.props.onNewFolderSubmit,rowIndex:r,topOffset:n});if("PaperRow"===e.type)return o.default.createElement(_.PaperRow,{paper:e.props.paper,rowIndex:r,topOffset:n,user:t.props.user,visibleColumns:e.props.visibleColumns,onOpenPaper:t.props.onOpenPaper,arePostTTIModulesLoaded:e.props.arePostTTIModulesLoaded,showSnippets:e.props.showSnippets,snippetRows:e.props.snippetRows,height:e.props.height});if("UserDefinedItemRow"===e.type)return o.default.createElement(h.UserDefinedItemRow,{userDefinedItem:e.props.userDefinedItem,rowIndex:r,topOffset:n});var i=t.props.selection,a=e.props.file instanceof s.File?i.selected.last()===t.props.fileToId(e.props.file):i.selected.last()===e.props.file.file_id;return"FileSharedWithMeRow"===e.type?o.default.createElement(u.FileSharedWithMeRow,{arePostTTIModulesLoaded:t.props.arePostTTIModulesLoaded,file:e.props.file,visibleColumns:t.props.visibleColumns,isCompactMode:e.props.isCompactMode,getOverflowMenuActions:t.props.getOverflowMenuActions,onOpenFileSharedWithMe:t.props.onOpenFileSharedWithMe,rowIndex:r,controlsFocusable:a,topOffset:n,thumbStore:t.props.thumbStore,user:t.props.user,responsive:t.props.responsive,showSnippets:e.props.showSnippets,snippetRows:e.props.snippetRows,height:e.props.height,isSelectMode:e.props.isSelectMode,isSelected:e.props.isSelected,onSelect:t.props.onSelectFile,onDeselect:t.props.onDeselectFile,isFocused:e.props.isFocused,useSearchSuccessBanner:t.props.useSearchSuccessBanner,filteredContactName:t.props.filteredContactName,logOverflowMenuOpen:t.logOverflowMenuOpen,scrollContainer:t.props.scrollContainer}):o.default.createElement(d.RowContainer,{key:e.key,instanceId:t.props.instanceId,listId:"main",itemIndex:e.itemIndex,containerWidth:e.props.containerWidth,extensionsFeatureFlags:e.props.extensionsFeatureFlags,sharingServiceInfo:e.props.sharingServiceInfo,getOverflowMenuActions:t.props.getOverflowMenuActions,isActiveDropTarget:e.props.isActiveDropTarget,isAvailableDropTarget:e.props.isAvailableDropTarget,isCompactMode:e.props.isCompactMode,isExtensionsMenuDisabled:e.props.isExtensionsMenuDisabled,isFocused:e.props.isFocused,isSearchMode:e.props.isSearchMode,isSelectMode:e.props.isSelectMode,isSelected:e.props.isSelected,isSharingDisabled:e.props.isSharingDisabled,onDeselect:t.props.onDeselectFile,onDragStart:t.props.onDragStart,onDragEnter:t.props.onDragEnter,onLocationLinkClick:t.props.onLocationLinkClick,onNavigateToFileOrFolder:t.props.onNavigateToFileOrFolder,onRenameCancel:t.props.onRenameCancel,onRenameSubmit:t.props.onRenameSubmit,onSelect:t.props.onSelectFile,onStarClick:t.props.onStarClick,renameState:e.props.renameState,rowIndex:r,controlsFocusable:a,topOffset:n,user:t.props.user,visibleColumns:t.props.visibleColumns,canDisplayFolderSizes:t.props.canDisplayFolderSizes,thumbStore:t.props.thumbStore,renderSharedWithController:t.props.renderSharedWithController,hrefForFile:t.props.hrefForFile,onShowShare:t.props.onShowShare,onPresentInZoom:t.props.onPresentInZoom,shareButtonLabel:t.props.shareButtonLabel,showShareButton:t.props.showShareButton,filteredContactName:t.props.filteredContactName,useSearchSuccessBanner:t.props.useSearchSuccessBanner,logOverflowMenuOpen:t.logOverflowMenuOpen,scrollContainer:t.props.scrollContainer,fileToId:t.props.fileToId,isFirstTaskEmptyState:t.props.isFirstTaskEmptyState})},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this.props.onTTI;e&&e(),this.setupKeyboardShortcuts(),this.setupExternalDragHandler()},t.prototype.componentWillUnmount=function(){this.cleanupKeyboardShortcuts(),c.cleanupExternalDragHandler(this.props.keyScope)},t.prototype.cleanupKeyboardShortcuts=function(){p.resetFilesViewKeyboardShortcuts(this.props.keyScope),p.resetFileJumpKeyboardShortcuts(this.props.keyScope)},t.prototype.setupKeyboardShortcuts=function(){var e=this,t=this.props,r=t.user,o=t.onDelete,n=t.onShowRename,i=t.getIsFileJumping,s=t.onAddFileJumpKeyCode,a=t.onResetFileJump,l=t.keyScope,c=t.onCopyToClipboard,d=t.onNavigateToParentFolder,u=t.onPasteFromClipboard;p.setupFileJumpKeyboardShortcuts({scope:l,getIsFileJumping:i,onAddFileJumpKeyCode:s,onResetFileJump:a}),p.setupFilesViewKeyboardShortcuts({user:r,viewType:m.ViewType.List,getIsGlobalEvent:this.getIsGlobalEvent(),getIsItemEvent:this.getIsListEvent,getSelectedFiles:this.getSelectedFiles,isCurrentPathWriteable:this.props.getIsCurrentPathWriteable,selectAllAction:S,deselectAllAction:S,onCopyToClipboard:c,onDelete:o,onFocusSearchBar:this.props.onFocusSearchBar,onNavigateToFileOrFolder:function(t){return e.props.onNavigateToFileOrFolder(t,{actionSource:m.FilesViewActionSource.KEYBOARD})},onNavigateToParentFolder:d,onPasteFromClipboard:u,onShowRename:n,scope:l,onShowHelpMenu:function(){return e.props.onOpenKeyboardShortcutModal()}})},t.prototype.setupExternalDragHandler=function(){c.setupExternalDragHandler(this.props.keyScope,this.getIsDraggingInternalFiles,this.getIsDraggingExternalFiles,this.props.onSetFileUploaderPath,".brws-file-row",this.getActiveDropTarget,this.props.onSetDropTarget)},t.prototype.getIsGlobalEvent=function(){return function(){return!0}},t.prototype.render=function(){var e=this.props,t=e.scrollPositionOffset,r=e.viewportTopOffset,n=e.focusedFileIndex,i=e.onRangeInView,s=e.scrollContainer,l=e.listItems,c=e.heights;return o.default.createElement(a.CulledTableBodyWithScrollContainer,{items:l,listItemHeight:c,renderRow:this.renderRow,scrollPositionOffset:t,scrollToRow:n,shouldUseWindowAsScrollContainer:!0,viewportTopOffset:r,onRangeInView:i,scrollContainer:s})},t.defaultProps={isFileViewerShown:function(){return!1}},t})(o.default.Component);t.FilesViewListComponent=v;t.FilesViewList=n.connect((function(e,t){return{listItems:l.selectListItems(e,t),heights:l.selectListItemHeights(e,t)}}))(v)})),define("modules/clean/react/files_view/new_folder_row",["require","exports","tslib","spectrum/media_table","spectrum/table","react","spectrum/icon_content","modules/clean/react/files_view/name_input","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),t.NewFolderRow=function(e){var r,s=e.createNewFolderState,c=e.isInsideMyTeamFolderTree,d=void 0!==c&&c,u=e.onCancel,p=e.onSubmit,f=e.rowIndex,_=e.topOffset;r="SAVING_INPUT"===s?i.default.createElement("p",{className:"brws-new-folder-row-status",role:"status","aria-live":"polite"},l.intl.formatMessage({id:"p58M12",defaultMessage:"Creating new folder…"})):i.default.createElement(a.NameInput,{defaultValue:"",label:l.intl.formatMessage({id:"ss4CO0",defaultMessage:"Folder name"}),onSubmit:p,onCancel:u});var m=i.default.createElement(t.NewFolderIcon,{isInsideMyTeamFolderTree:d});return i.default.createElement(o.CulledMediaRow,{"aria-rowindex":void 0!==f?f+1:void 0,className:"brws-new-folder-row",topOffset:_},i.default.createElement(n.TableCell,{className:"brws-checkbox-cell"}),i.default.createElement(o.MediaCell,{icon:m},i.default.createElement("div",{className:"brws-new-folder-row-content brws-vertically-center"},r)),i.default.createElement(n.TableCell,null),i.default.createElement(n.TableCell,null))},t.NewFolderIcon=function(e){var t=e.isInsideMyTeamFolderTree,r=e.className||"";return i.default.createElement(s.IconContent,{className:r,name:t?"folder_team-small":"folder-small"})}})),define("modules/clean/react/files_view/paper_row",["require","exports","tslib","react","retrieval-components/highlighted-truncated-string","spectrum/media_table","spectrum/util/raf_throttle","modules/clean/emoji_utils","modules/clean/filename_highlights","modules/clean/paper_formatting_utils","modules/clean/react/files_view/double_click","modules/clean/react/files_view/file_snippets","modules/clean/react/files_view/star","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/core/browser","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),a=r.__importStar(a),c=r.__importStar(c),m=r.__importStar(m);var g=(function(e){function t(t){var r=e.call(this,t)||this;return r.setRef=function(e){r.brwsFilenameContainerDiv=e},r.handleWindowResize=function(){r.throttledWindowResize.request()},r.handleResize=function(){if(r.brwsFilenameContainerDiv){var e=r.state.brwsFilenameContainerDivWidth,t=r.brwsFilenameContainerDiv.getBoundingClientRect().width;t&&t!==e&&r.setState({brwsFilenameContainerDivWidth:t})}},r.handleOpenNewTabOrNavigate=function(e){if(0===e.button){e.preventDefault(),e.stopPropagation();var t=r.props.paper;if(_.hasModifierKey(e))return void m.open_tab(t.url);r.props.onOpenPaper(t)}},r.throttledWindowResize=new s.RafThrottle((function(){return r.handleResize()})),r.state=r.calcState(t),r}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){if(this.props.paper.title!==e.paper.title||this.props.paper.highlight_spans!==e.paper.highlight_spans){var t=this.calcState(e);this.setState(t)}},t.prototype.componentDidMount=function(){this.handleResize(),window.addEventListener("resize",this.handleWindowResize)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.handleWindowResize)},t.prototype.calcState=function(e){return{titleParts:c.getPaperDocTitleParts(e.paper,"brws-file-name-cell-icon","brws-file-name-cell-icon-emoji")}},t.prototype.getHighlightedSpansForHighlightedTruncatedString=function(e){var t=e.title,o=e.highlight_spans,n=e.title_highlights,i=o&&o.length>0,s=a.getFirstEmojiFromTitle(t);if(i){if(s){var c={highlight_str:o[0].highlight_str.substr(s.length),is_highlighted:o[0].is_highlighted};o=r.__spreadArrays([c],o.slice(1))}return o.map((function(e){return{string:e.highlight_str,isHighlighted:e.is_highlighted}}))}if(n){if(s){t=t.substr(s.length);var d=s.length/2;n=n.slice().map((function(e){return{pos:e.pos-d,len:e.string.length,string:e.string}}))}return l.highlightMatchSections(t,n).map((function(e){return{string:e.text,isHighlighted:e.isHighlighted}}))}},t.prototype.renderTitleElement=function(e){var t=this.props,r=t.paper,i=t.showHighlights,s=this.state.titleParts,a=s.title,l=s.highlightedTitle;if(e){var c=o.default.createElement(n.HighlightedTruncatedString,{text:a,className:"brws-file-name-element",fontSize:14,highlightSpans:this.getHighlightedSpansForHighlightedTruncatedString(r),cellBuffer:3,availableWidth:e});return o.default.createElement("a",{className:"brws-paper-doc-name-cell-title",href:r.url,onClick:this.handleOpenNewTabOrNavigate},i?c:o.default.createElement("span",null,a))}return o.default.createElement("a",{className:"brws-paper-doc-name-cell-title",href:r.url,onClick:this.handleOpenNewTabOrNavigate},i?l:o.default.createElement("span",null,a))},t.prototype.renderPaperCellContent=function(e,t){var r=this.props,n=r.paper,s=r.user,a=r.arePostTTIModulesLoaded,l=r.showSnippets,c=r.snippetRows,d=a?o.default.createElement(p.StarContainer,{item:n,user:s,key:"paperStar",className:"brws-file-name-cell-star"}):null;return o.default.createElement("div",{className:"brws-paper-doc-name-cell-content brws-vertically-center"},o.default.createElement("div",{className:"brws-paper-doc-name-cell-title-container"},o.default.createElement(i.MediaCellText,{highlight:e},this.renderTitleElement(t)),d),o.default.createElement(i.MediaCellText,{variant:"subtitle"},h.intl.formatMessage({id:"mvOTrD",defaultMessage:"in Paper"})),l&&o.default.createElement(i.MediaCellText,{key:"snippets",variant:"subtitle"},o.default.createElement(u.FileSnippets,{snippets:n.snippets,lineClamp:c})))},t.prototype.renderDocName=function(e){var t=this.props.height,n={highlight:e,icon:this.state.titleParts.icon,style:{minHeight:t-1}},s=this.state.brwsFilenameContainerDivWidth;return o.default.createElement(i.MediaCell,r.__assign({key:"docName"},n),o.default.createElement("div",{className:"brws-file-name-container",ref:this.setRef},this.renderPaperCellContent(e,s)))},t.prototype.renderDocInfo=function(){var e=this.props.paper,t=e.last_modified_date||"",r=h.intl.formatMessage({id:"ACVnV9",defaultMessage:"by {modified_by}"},{modified_by:e.last_editor_name});return o.default.createElement(i.MediaCell,{key:"docInfo",subtitle:r,title:t})},t.prototype.renderCell=function(e){var t=e.isHovered,r=e.sortField;switch(r){case f.SortField.FILENAME:return this.renderDocName(t);case f.SortField.RELEVANCE:case f.SortField.MODIFIED:return this.renderDocInfo();default:return o.default.createElement(i.MediaCell,{key:r,title:o.default.createElement("span",{"aria-hidden":!0},"--")})}},t.prototype.render=function(){var e=this,t=this.props,n=t.rowIndex,s=t.topOffset,a=t.visibleColumns,l=this.handleOpenNewTabOrNavigate;return o.default.createElement(d.WithDoubleClick,{onClick:function(e){e.preventDefault()},onDoubleClick:l},(function(t){var l=t.onClick;return o.default.createElement(i.CulledMediaRow,{"aria-rowindex":void 0!==n?n+1:void 0,className:"brws-paper-row brws-row-click-selection-method",draggable:!1,onClick:l,topOffset:s,variant:"default"},(function(t){var n=t.isHovered;return r.__spreadArrays([o.default.createElement(i.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"})],a.map((function(t){return e.renderCell({isHovered:n,sortField:t.sortField})})))}))}))},t.defaultProps={showHighlights:!0},t})(o.default.PureComponent);t.PaperRow=g})),define("modules/clean/react/files_view/pinned_team_folder_view",["require","exports","tslib","classnames","react","react-redux","dig-components/icons","dig-components/icons/src","spectrum/table","modules/clean/browse_uri_interface","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/file_list_utils","modules/clean/react/files_view/row_container","modules/clean/react/tooltip","modules/clean/user_education/react/user_education_effect","modules/clean/user_education/user_education_client","modules/constants/trademark","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var v=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.displayName="PinnedTeamFolderView",t.renderTeamFolderRow=function(e,r){var o=t.props,i=o.activeDropTarget,s=o.dropTargetHighlightMode,a=o.getOverflowMenuActions,l=o.onDragEnter,u=o.onNavigateToFileOrFolder,_=o.onRenameCancel,h=o.onRenameSubmit,g=o.user,S=o.thumbStore,v=o.onShowShare,E=o.renderSharedWithController,w=o.instanceId,b=p.shouldFileBeHighlightedDropTarget({dropTargetHighlightMode:s,file:e,isSelected:!1}),y=n.default.createElement(f.RowContainer,{instanceId:w,listId:"team_folders",itemIndex:r,rowIndex:r,getOverflowMenuActions:a,key:encodeURI(e.fq_path),isAvailableDropTarget:b,isActiveDropTarget:e===i,isPinned:!0,onDragEnter:l,onNavigateToFileOrFolder:u,onRenameCancel:_,onRenameSubmit:h,user:g,visibleColumns:d.LIST_VIEW_COLUMNS.slice(0,1),canDisplayFolderSizes:!1,thumbStore:S,onShowShare:v,renderSharedWithController:E,hrefForFile:c.href_for_file,scrollContainer:t.props.scrollContainer});return r>0?y:n.default.createElement(m.UserEducationEffect,{containerName:"PinnedTeamFolder",name:"TeamFolder",key:encodeURI(e.fq_path)+"-UserEducationEffect"},y)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){h.UEClient.sendEvent(this.displayName,"componentDidMount",JSON.stringify(this.props.context))},t.prototype.renderHeaderTitle=function(e,t){var r=t?n.default.createElement("div",{className:"brws-pinned-team-folder-info-button"},n.default.createElement(_.Tooltip,{position:_.TooltipPosition.RIGHT,tooltip_contents:n.default.createElement("div",null,t),tooltip_classname:"brws-pinned-team-folder-tooltip"},n.default.createElement(s.UIIcon,{src:a.InfoLine}))):null;return n.default.createElement("div",{className:"brws-pinned-team-folder-header-title-button-group"},n.default.createElement("h2",{className:"brws-pinned-team-folder-header-title"},e),r)},t.prototype.render=function(){var e=this.props,t=e.columnFlex,r=e.isCompactMode,i=e.teamFolders;if(!i)return null;var s=S.intl.formatMessage({id:"gjVAYF",defaultMessage:"{count, plural, one{Team folder} other{Team folders}}"},{count:i.size});return n.default.createElement("div",{className:"brws-pinned-team-folder-view"},n.default.createElement(l.Table,{columnFlex:t},n.default.createElement(l.TableHead,{className:o.default("brws-column-header","brws-pinned-team-folder-header",{"brws-column-header-compact brws-pinned-team-folder-header-compact ":r})},n.default.createElement(l.TableHeadCell,{className:"brws-checkbox-cell"}),n.default.createElement(l.TableHeadCell,{className:"brws-vertically-center"},this.renderHeaderTitle(s,S.intl.formatMessage({id:"h5GI+v",defaultMessage:"Team folders are the hub of content for a team and contents are automatically shared with team folder members. {trademark_business} team admins own and manage team folders."},{trademark_business:g.TRADEMARK_BUSINESS})))),n.default.createElement(l.TableBody,null,i.map(this.renderTeamFolderRow))),n.default.createElement(l.Table,{columnFlex:t},n.default.createElement(l.TableHead,{className:o.default("brws-column-header","brws-pinned-team-folder-header","brws-pinned-team-folder-header-secondary",{"brws-column-header-compact brws-pinned-team-folder-header-compact ":r})},n.default.createElement(l.TableHeadCell,{className:"brws-checkbox-cell"}),n.default.createElement(l.TableHeadCell,{className:"brws-vertically-center"},this.renderHeaderTitle(S.intl.formatMessage({id:"sxqZnj",defaultMessage:"Everything else"}))))))},t})((n=r.__importDefault(n)).default.Component);t.PinnedTeamFolderView=i.connect((function(e,t){return{teamFolders:u.selectTeamFolders(e,t),context:u.selectContext(e,t),dropTargetHighlightMode:u.selectDropTargetHighlightMode(e,t),user:u.selectUser(e,t),isCompactMode:u.selectIsCompactMode(e,t)}}))(v)})),define("modules/clean/react/files_view/prop_upserter",["require","exports","tslib","react-redux","react","modules/clean/react/files_view/data/action_creators"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);var s={upsertInstance:i.upsertInstance},a=(function(e){function t(t){var r=e.call(this,t)||this;return r.onPropsUpdated(t),r}return r.__extends(t,e),t.prototype.componentDidUpdate=function(){this.onPropsUpdated()},t.prototype.onPropsUpdated=function(e){void 0===e&&(e=this.props);var t=e.id;(0,e.upsertInstance)(t,r.__rest(e,["id","upsertInstance"]))},t.prototype.render=function(){return null},t})(n.default.PureComponent);t.FilesViewPropUpserter=o.connect(null,s)(a)})),define("modules/clean/react/files_view/row",["require","exports","tslib","classnames","react","spectrum/media_table","modules/clean/keycode","modules/clean/react/files_view/double_click","modules/clean/react/files_view/keyboard_focus","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/selectable_list"],(function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isKeyboardFocused:!1},t.handleClick=function(e){t.shouldHandleClick(e)?(e.preventDefault(),e.shiftKey?t.props.onSelect(u.SelectOptions.EXTEND,c.FilesViewActionSource.ROW_SINGLE_CLICK):e.ctrlKey||e.metaKey?t.props.isSelected?t.props.onDeselect(!1,c.FilesViewActionSource.ROW_SINGLE_CLICK):t.props.onSelect(u.SelectOptions.DEFAULT,c.FilesViewActionSource.ROW_SINGLE_CLICK):t.props.onSelect(u.SelectOptions.ONLY,c.FilesViewActionSource.ROW_SINGLE_CLICK)):e.preventDefault()},t.handleDoubleClick=function(e){t.shouldHandleClick(e)?t.handleOpenNewTabOrNavigate(e,c.FilesViewActionSource.ROW_DOUBLE_CLICK):e.preventDefault()},t.handleOpenNewTabOrNavigate=function(e,r){0===e.button&&(e.preventDefault(),e.stopPropagation(),t.props.onNavigateToItem({openInNewTab:Boolean(d.hasModifierKey(e)),actionSource:r}))},t.handleDragStart=function(e){var r=t.props,o=r.isSelected,n=r.onDragStart,i=r.onSelect;n&&(o||i(u.SelectOptions.DEFAULT,c.FilesViewActionSource.ROW_SINGLE_CLICK),n(e))},t.onRowFocus=function(){t.setState({isKeyboardFocused:!0})},t.onRowBlur=function(){t.setState({isKeyboardFocused:!1})},t.handleKeyPress=function(e){if(t.shouldHandleClick(e)){if(e.which===s.KeyCode.SPACE||e.which===s.KeyCode.ENTER){var r=t.props,o=r.isSelectMode,n=r.onSelect;t.state.isKeyboardFocused&&!o&&(e.preventDefault(),e.stopPropagation(),n(u.SelectOptions.DEFAULT,c.FilesViewActionSource.KEYBOARD))}}else e.preventDefault()},t}return r.__extends(t,e),t.prototype.shouldHandleClick=function(e){return!e.defaultPrevented},t.prototype.render=function(){var e=this,t=this.props,r=t.className,s=t.isSelected,c=t.isDeleted,d=t.isDraggable,u=t.isDroppable,p=t.isActiveDropTarget,f=t.componentType,_=t.topOffset,m=t.rowIndex,h=t.ariaLabel,g=t.filename,S=t.children,v=t.onDragEnter,E="CulledMediaRow"===f?i.CulledMediaRow:i.MediaRow,w=this.props.isSelectMode?-1:0===m?0:-1;return n.default.createElement(a.WithDoubleClick,{onClick:this.handleClick,onDoubleClick:this.handleDoubleClick},(function(t){var i=t.onClick;return n.default.createElement(l.WithKeyboardFocus,{onKeyboardFocus:e.onRowFocus},(function(t){var a=t.onMouseDown,l=t.onFocus;return n.default.createElement(E,{className:o.default(r,"brws-file-row",{"brws-file-row-selected":s,"brws-file-row-deleted":c,"brws-file-row-droppable":u,"brws-file-row-dragover":p,"brws-row-click-selection-method":!0}),variant:(p?"dragover":u&&"droppable")||s&&"selected"||"default",onClick:i,onMouseDown:a,draggable:d,topOffset:_,onDragEnter:v,onDragStart:e.handleDragStart,onFocus:l,"aria-rowindex":void 0!==m?m+1:void 0,"aria-controls":"brws-sidebar-view","aria-label":h,"data-filename":g,tabIndex:w},S)}))}))},t.defaultProps={componentType:"MediaRow",topOffset:0},t})((n=r.__importDefault(n)).default.PureComponent);t.FilesViewRow=p})),define("modules/clean/react/files_view/row_container",["require","exports","tslib","react","react-redux","modules/clean/react/browse/models","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/selectors/item_selectors","modules/clean/react/files_view/file_row"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.item;return e instanceof i.File?o.default.createElement(l.FileRow,r.__assign({},this.props,{file:e})):null},t})((o=r.__importDefault(o)).default.Component);t.RowContainer=n.connect((function(e,t){return{arePostTTIModulesLoaded:s.selectArePostTTIModulesLoaded(e,t),context:s.selectContext(e,t),isCheckboxDisabled:s.selectDisabledMultiselect(e,t),item:a.selectItem(e,t),responsive:s.selectResponsive(e,t),showCDMUserEducationEffects:a.selectShowCDMUserEducationEffects(e,t),height:a.selectRowHeight(e,r.__assign(r.__assign({},t),{numVisibleColumns:t.visibleColumns.length}))}}))(c)})),define("modules/clean/react/files_view/scroll_updater",["require","exports","tslib","react-redux","react","modules/clean/react/files_view/data/selectors/files_view_selectors"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),i=r.__importStar(i);var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.updateScroll()},t.prototype.componentDidUpdate=function(e){var t=e.currentScroll,r=e.path;t!==this.props.currentScroll?this.updateScroll():r!==this.props.path&&this.scrollTo(0)},t.prototype.updateScroll=function(){var e=this.props.currentScroll;if(e){var t=e.scrollTop;this.scrollTo(t)}},t.prototype.scrollTo=function(e){var t=this.props.scrollContainer;t&&t.current?t.current.scrollTop=e:window.scrollTo(0,e)},t.prototype.render=function(){return null},t})(n.default.Component);t.ScrollUpdater=o.connect((function(e){return{currentScroll:i.currentScroll(e)}}))(s)}));__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/files_view/shortcuts/shortcut_feedback_toolbar_loader",["require","exports","modules/clean/react/async/loadable"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidDropboxShortcutSelected=function(e){return 1===e.size&&Boolean(e.find((function(e){return".web"===e.ext&&e.is_cloud_doc&&"string"==typeof e.open_to_url&&-1!==new URL(e.open_to_url).host.indexOf("dropbox.com")})))},t.AsyncShortcutFeedbackToolbarLoader=r.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/files_view/shortcuts/shortcut_feedback_toolbar"],t,r)})).then(__importStar).then((function(e){return e.ShortcutFeedbackToolbar}))}})})),define("modules/clean/react/files_view/sticky_table_head",["require","exports","tslib","spectrum/dimensions","spectrum/table","react","modules/clean/react/sticky/sticky","modules/clean/react/sticky/container"],(function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),t.StickyTableHead=function(e){var t=e.children,l=e.columnFlex,c=(e.offsetHeight,e.offsetTop),d=r.__rest(e,["children","columnFlex","offsetHeight","offsetTop"]),u=i.default.createElement(o.Dimensions,{tagName:"tr"},(function(e){var o=e.width;return i.default.createElement("td",{className:"brws-sticky-table-cell"},i.default.createElement(a.StickyContainer,{offsetTop:c},i.default.createElement(s.Sticky,null,i.default.createElement(n.Table,{columnFlex:l,style:{width:o}},i.default.createElement(n.TableHead,r.__assign({},d),t)))))}));return i.default.createElement("thead",{className:"brws-sticky-table-head"},u)}})),define("modules/clean/react/files_view/thumbnail_media_cell",["require","exports","tslib","react","spectrum/media_table","modules/clean/react/files_view/file_thumbnail"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.ThumbnailMediaCell=function(e){var t=e.height,s=e.children,a=r.__rest(e,["height","children"]);return o.default.createElement(n.MediaCell,{icon:o.default.createElement(i.FileThumbnail,r.__assign({},a)),style:{minHeight:t-1},children:s})}})),define("modules/clean/react/files_view/user_defined_item_row",["require","exports","tslib","react"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(t){return e.call(this,t)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.rowIndex,r=e.topOffset;return e.userDefinedItem.renderUserDefinedItemRow({rowIndex:t,topOffset:r})},t})((o=r.__importDefault(o)).default.PureComponent);t.UserDefinedItemRow=n})),define("modules/clean/react/files_view/view_type_column_header_menu",["require","exports","tslib","react","spectrum/icon_form","spectrum/icon_mode","spectrum/popover","modules/clean/react/files_view/types","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSelection=function(e){e!==t.props.viewType&&t.props.onSwitchViewType(e)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.onTTI()},t.prototype.viewTypeIcon=function(e){switch(e){case a.ViewType.List:return"list";case a.ViewType.Grid:return"grid";case a.ViewType.LargeGrid:return"tiles"}return"list"},t.prototype.viewTypeLabel=function(e){switch(e){case a.ViewType.List:return l.intl.formatMessage({id:"B5HGiK",defaultMessage:"Layout: List"});case a.ViewType.Grid:return l.intl.formatMessage({id:"IuTWMX",defaultMessage:"Layout: Grid"});case a.ViewType.LargeGrid:return l.intl.formatMessage({id:"hYH0ds",defaultMessage:"Layout: Large Grid"})}return l.intl.formatMessage({id:"B5HGiK",defaultMessage:"Layout: List"})},t.prototype.render=function(){var e=this,t=this.props,r=t.viewType,a=t.viewTypes,c=t.viewTypeLabels;return 1===a.length?null:o.default.createElement(s.Popover,{className:"brws-view-type-column-header-menu",onSelection:this.handleSelection,closeOnSelection:!0},o.default.createElement(s.PopoverTrigger,{className:"brws-view-type-column-header-menu-trigger","aria-label":l.intl.formatMessage({id:"NtfviE",defaultMessage:"Select view type"})},o.default.createElement(i.IconMode,{name:this.viewTypeIcon(r)}),o.default.createElement(n.IconForm,{name:"caret-down"})),o.default.createElement(s.PopoverContent,{attachment:"right",className:"brws-view-type-column-header-menu-content"},o.default.createElement(s.PopoverItemGroup,null,o.default.createElement(s.PopoverItemGroupTitle,null,l.intl.formatMessage({id:"S31+EG",defaultMessage:"View As"})),a.map((function(t){return o.default.createElement(s.PopoverSelectableItem,{"data-viewtype":t,key:t,icon:o.default.createElement(i.IconMode,{name:e.viewTypeIcon(t)}),selected:r===t,value:t,"aria-label":e.viewTypeLabel(t)},c[t])})))))},t})((o=r.__importDefault(o)).default.PureComponent);t.ViewTypeColumnHeaderMenu=c}));__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/folder_dialog/async",["require","exports","modules/clean/css"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showFolderDialog=function(t){new Promise((function(t,r){e(["modules/clean/react/folder_dialog/folder_dialog"],t,r)})).then(__importStar).then((function(e){return e.FolderDialog.show(t)}))},t.prewarmFolderDialog=function(){new Promise((function(t,r){e(["modules/clean/react/folder_dialog/folder_dialog"],t,r)})).then(__importStar).then((function(){r.require_css("/static/css/react/folder_picker-vflqmLUB7.css")}))}}));__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/growth/continuous_onboarding/continuous_onboarding_loader",["require","exports","modules/clean/react/async/loadable"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContinuousOnboardingLoadable=r.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/growth/continuous_onboarding/continuous_onboarding"],t,r)})).then(__importStar).then((function(e){return e.ContinuousOnboarding}))}})})),define("modules/clean/react/growth/personalization/team_space_empty_zone/team_space_empty_zone",["require","exports","tslib","react","modules/clean/react/async/loadable","modules/clean/web_timing_logger","modules/clean/react/growth/personalization/util","modules/clean/react/growth/personalization/team_space_empty_zone/logger"],(function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),a=r.__importStar(a),t.AsyncEmptyStateDropTarget=n.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,i.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/growth/empty_state_drop_target"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().EmptyStateDropTarget]}}))}))}}),t.AsyncSuggestedFolders=n.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,i.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/growth/personalization/suggested_folders/suggested_folders"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().SuggestedFolders]}}))}))}}),t.AsyncInviteEmptyZone=n.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,i.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/growth/personalization/invite_empty_zone"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().InviteEmptyZone]}}))}))}}),t.AsyncDownloadAppZone=n.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,i.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/growth/personalization/download_app_zone/download_app_zone"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().DownloadAppZone]}}))}))}});var l=(function(e){function n(t){var r=e.call(this,t)||this;return r.onToggleSuggestedFolders=function(e){r.setState({curSuggestedFoldersType:e})},r.onToggleSuggestedFolders=r.onToggleSuggestedFolders.bind(r),r.state={curSuggestedFoldersType:s.getSuggestedFoldersType(r.props.personalizedConfigs)},r}return r.__extends(n,e),n.prototype.isEmpty=function(){return 1===this.props.numItems},n.prototype.notInvited=function(){return this.props.numMembers<=1},n.prototype.canShowInviteEmptyZone=function(){return s.enableInvitePanel(this.props.personalizedConfigs)&&this.notInvited()&&this.isEmpty()},n.prototype.canShowSuggestedFolders=function(){return s.getSuggestedFoldersType(this.props.personalizedConfigs)!==s.SuggestedFoldersType.None&&this.props.numInitialItems<=4},n.prototype.canShowSuggestionBarAndDropTarget=function(){return this.state.curSuggestedFoldersType===s.SuggestedFoldersType.SuggestedFoldersAsBar&&this.isEmpty()},n.prototype.getPersonalizationCtx=function(e,t){var r,o=this.props.personalizedConfigs,n=s.getRole(o),i=s.getFirstPath(o);return o&&(r={enableSlimMode:e,dropTargetBgColor:t,role:n,firstPath:i}),r},n.prototype.getDropTargetViewHelper=function(e,n){if(this.isEmpty()){var i=this.getPersonalizationCtx(e,n);return o.default.createElement(t.AsyncEmptyStateDropTarget,r.__assign({},this.props.dropTargetProps,{personalizationCtx:i}))}return null},n.prototype.canShowDownloadAppZone=function(){var e=this.props,t=e.numItems,r=e.personalizedConfigs;return s.enableDownloadAppPanel(t,r)},n.prototype.getSuggestedFoldersView=function(e){var n=this.props,i=n.personalizedConfigs,a=n.suggestedFoldersContext,l=n.numInitialItems,c=s.getRole(i),d=e||s.getSuggestedFoldersType(i),u={userRole:c,numInitialItems:l,activeFirstPath:s.getFirstPath(i)};return o.default.createElement(t.AsyncSuggestedFolders,r.__assign({},a,{logCtx:u,suggestedFoldersExpType:d,onToggle:this.onToggleSuggestedFolders}))},n.prototype.getSuggestionBarAndDropTargetView=function(){return o.default.createElement(o.default.Fragment,null,this.getSuggestedFoldersView(s.SuggestedFoldersType.SuggestedFoldersAsBar),this.getDropTargetViewHelper())},n.prototype.getInviteViewHelper=function(){var e=this.props.personalizedConfigs,r=s.getRole(e),n=s.getFirstPath(e);return this.props.dropTargetProps.isDraggingFiles?this.getDropTargetViewHelper(!0):this.canShowInviteEmptyZone()?o.default.createElement(t.AsyncInviteEmptyZone,{role:r,path:n}):!this.isEmpty()&&this.notInvited()?null:(a.userViewExploreContentState(r,n,this.props.numItems),this.getSuggestedFoldersViewHelper())},n.prototype.getSuggestedFoldersViewHelper=function(){return this.props.dropTargetProps.isDraggingFiles?this.getDropTargetViewHelper(!0):this.canShowSuggestedFolders()?this.getSuggestedFoldersView():null},n.prototype.getUploadViewHelper=function(){return this.getDropTargetViewHelper(!1,s.DropTargetBgColorType.Blue)},n.prototype.getExploreViewHelper=function(){var e=this.props.personalizedConfigs;return this.props.dropTargetProps.isDraggingFiles?this.getDropTargetViewHelper():this.canShowSuggestionBarAndDropTarget()?(a.userViewExploreEmptyState(s.getRole(e),this.props.numItems),this.getSuggestionBarAndDropTargetView()):this.canShowSuggestedFolders()?(a.userViewExploreContentState(s.getRole(e),s.getFirstPath(e),this.props.numItems),this.getSuggestedFoldersView()):this.getDropTargetViewHelper()},n.prototype.getDownloadAppViewHelper=function(){var e=this.props,r=e.dropTargetProps.isDraggingFiles,n=e.personalizedConfigs,i=e.numInitialItems;return r?this.getDropTargetViewHelper():this.canShowDownloadAppZone()?o.default.createElement(t.AsyncDownloadAppZone,{userRole:s.getRole(n),path:s.getFirstPath(n),numInitialItems:i}):i>1?this.getSuggestedFoldersView(s.SuggestedFoldersType.SuggestedFoldersAsBar):this.getDropTargetViewHelper()},n.prototype.render=function(){var e=this.props.personalizedConfigs;if(!e)return this.getDropTargetViewHelper();var t=s.getFirstPath(e);return t===s.FirstPathId.INVITE_MEMBER.valueOf()?this.getInviteViewHelper():t===s.FirstPathId.SUGGESTED_FOLDERS.valueOf()?this.getSuggestedFoldersViewHelper():t===s.FirstPathId.UPLOAD_FOLDERS.valueOf()?this.getUploadViewHelper():t===s.FirstPathId.EXPLORE.valueOf()?this.getExploreViewHelper():t===s.FirstPathId.DOWNLOAD_APP.valueOf()?this.getDownloadAppViewHelper():this.getDropTargetViewHelper()},n})(o.default.PureComponent);t.TeamSpaceEmptyZone=l})),define("modules/clean/react/growth/personalization/team_space_empty_zone/logger",["require","exports","tslib","modules/clean/analytics","modules/clean/react/growth/teams_web_actions_logger_events"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t){void 0===t&&(t={}),o.TeamsWebActionsLogger.log(e,r.__assign({},t))};t.userViewExploreContentState=function(e,t,r){var o={};o.role=e,o.path=t,o.items_in_team_space=r,i(n.TeamSpaceEmptyZoneLoggerEvents.VIEW_EXPLORE_CONTENT_STATE,o)},t.userViewExploreEmptyState=function(e,t){var r={};r.role=e,r.items_in_team_space=t,i(n.TeamSpaceEmptyZoneLoggerEvents.VIEW_EXPLORE_EMPTY_STATE,r)}})),define("modules/clean/react/growth/personalization/util",["require","exports"],(function(e,t){"use strict";var r,o,n;function i(e){return(null==e?void 0:e.firstPath)||r.NONE}function s(e,t){var n=null==t?void 0:t.desktopCtaType;return n?i(t)===r.DOWNLOAD_APP.valueOf()?a(e,t)?n:o.ShowWithText:n:null}function a(e,t){return!!(null==t?void 0:t.enableDownloadAppPanel)&&e<=1}Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.INVITE_MEMBER="invite",e.UPLOAD_FOLDERS="upload",e.SUGGESTED_FOLDERS="folder",e.DOWNLOAD_APP="download",e.EXPLORE="explore",e.NONE=""})(r=t.FirstPathId||(t.FirstPathId={})),(function(e){e[e.ShowWithoutText=1]="ShowWithoutText",e[e.ShowWithText=2]="ShowWithText",e[e.ShowWithTextAsPrimary=3]="ShowWithTextAsPrimary"})(o=t.DesktopCtaType||(t.DesktopCtaType={})),(function(e){e[e.SuggestedFoldersAsBar=1]="SuggestedFoldersAsBar",e[e.SuggestedFolders=2]="SuggestedFolders",e[e.None=3]="None"})(n=t.SuggestedFoldersType||(t.SuggestedFoldersType={})),(function(e){e[e.Blue=1]="Blue"})(t.DropTargetBgColorType||(t.DropTargetBgColorType={})),(function(e){e.DROP_TARGET_VIEW="drop_target_view",e.INVITE_VIEW="invite_view",e.SUGGESTED_FOLDERS_VIEW="suggested_folders_view",e.SUGGESTED_FOLDERS_TOGGLE_VIEW="suggested_folders_toggle_view",e.DOWNLOAD_APP_VIEW="download_app_view"})(t.emptyStateType||(t.emptyStateType={})),(function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.SHARING=1]="SHARING",e[e.SPREADSHEET=2]="SPREADSHEET",e[e.PAPER=3]="PAPER",e[e.FEEDBACK=4]="FEEDBACK"})(t.CollectionFolderType||(t.CollectionFolderType={})),t.getFirstPath=i,t.getRole=function(e){return(null==e?void 0:e.role)||""},t.getDesktopCtaType=s,t.getSuggestedFoldersType=function(e){return(null==e?void 0:e.suggestedFoldersType)||n.None},t.enableHideFolderOverview=function(e,t){var r;return!!(null===(r=null==t?void 0:t.hiddenState)||void 0===r?void 0:r.hideFolderOverview)&&e<=4},t.enableHideRightsideActions=function(e){var t;return!!(null===(t=null==e?void 0:e.hiddenState)||void 0===t?void 0:t.hideRightsideActions)},t.enableInvitePanel=function(e){return!!(null==e?void 0:e.enableInvitePanel)},t.enableDesktopCta=function(e,t,o){if(!s(t,o))return!1;var n=i(o);return n===r.UPLOAD_FOLDERS.valueOf()||n===r.SUGGESTED_FOLDERS.valueOf()?t>1:n!==r.INVITE_MEMBER.valueOf()||(e>1||t>1)},t.enableDownloadAppPanel=a})),define("modules/clean/react/path_breadcrumbs",["require","exports","tslib","classnames","react","spectrum/icon_arrow","spectrum/icon_content","spectrum/popover","modules/clean/em_string","modules/clean/filepath","modules/clean/react/icon/icon_helper","modules/clean/react/title_bubble","modules/clean/user_education/react/user_education_effect","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),c=r.__importStar(c);var h;function g(e,t,r){return void 0===r&&(r=20),r-(t?2.625:new l.Emstring(e).length)}function S(e,t,r,o,n){void 0===n&&(n=20);for(var i=e.split("/").filter(Boolean),s=[{path:"",icon:"folder_dropbox-small",folderName:t,alt:r}],a=d.spectrumFolderIcon({size:d.SpectrumIconSize.Small}),u=0;u<i.length;u++)e="/"+i.slice(0,u+1).join("/"),s.push({path:e,folderName:c.filename(e),icon:a,alt:m.intl.formatMessage({id:"MLqiSW",defaultMessage:"Folder"})});if(s.length<3)return{dropdownCrumbs:[],inlineCrumbs:s,root:s[0]};var p=g(s[0]&&s[0].folderName||"",!1,n),f=s.map((function(e){return new l.Emstring(e.folderName||"").length})),_=1,S=f[s.length-1];for(u=s.length-2;u>=1&&(S+=1.64,!((S+=f[u])>p));u--)_+=1;s.length===_+1&&(_+=1),1===_&&o===h.SMALL&&_++;var v=s.length-_;return{dropdownCrumbs:s.slice(0,v),inlineCrumbs:s.slice(v),root:s[0]}}function v(e){switch(e){case h.LARGE:return"right";case h.SMALL:return"right-small"}}t.generateBreadcrumbData=S,(function(e){e.LARGE="LARGE",e.SMALL="SMALL"})(h=t.PathBreadcrumbsSize||(t.PathBreadcrumbsSize={}));var E=(function(e){function t(t){var r=e.call(this,t)||this;r._breadcrumbContainerElement=null,r.resizeListener=function(){var e=r.getBreadcrumbsContainerSpan();if(e){var t=e.getBoundingClientRect().width;r.props.expMobileWebInvites&&(t-=20);var o=Math.max(0,r.getMaxWidthInEm(t));o!==r.state.maxWidthInEm&&o>0&&r.setState({maxWidthInEm:o})}};var o=r.getBreadcrumbsContainerSpan();return r.state={maxWidthInEm:o?r.getMaxWidthInEm(o.getBoundingClientRect().width):20},r}return r.__extends(t,e),t.prototype.getBreadcrumbsContainerSpan=function(){if(!this._breadcrumbContainerElement){var e=document.getElementsByClassName("maestro-app-content");e&&1===e.length&&(this._breadcrumbContainerElement=e[0])}return this._breadcrumbContainerElement},t.prototype.getMaxWidthInEm=function(e){return(e-100)/22},t.prototype.componentDidMount=function(){var e=this;window.addEventListener("resize",this.resizeListener),_.waitForTTI().then((function(){return e.resizeListener()}))},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.resizeListener)},t.prototype.componentDidUpdate=function(e){e.expMobileWebInvites!==this.props.expMobileWebInvites&&this.resizeListener()},t.prototype.render=function(){var e=this.props.path,t=this.props,i=t.firstBreadcrumbName,s=t.firstBreadcrumbAlt,a=t.isDraggingInternalFiles,l=t.shouldHighlightDropTargets,d=t.setFileUploaderPath,u=t.getUrlForPath,f=t.setUrl,_=t.size,v=t.disableDragging,E=this.state.maxWidthInEm?this.state.maxWidthInEm:20,b=S(e,i,s,_,E),T=b.dropdownCrumbs,F=b.inlineCrumbs,I=b.root,O=g(I&&I.folderName||"",T.length>0,E),C=o.default({"brws-path-breadrumbs":!0,"brws-path-breadrumbs--small":this.props.size===h.SMALL}),P="page-header-text u-l-fl";return F.length>1||T.length>0?n.default.createElement("span",{className:C},n.default.createElement("h1",{className:"ax-visually-hidden"},c.filename(e)),n.default.createElement("nav",{className:P,id:"path-breadcrumbs","aria-label":m.intl.formatMessage({id:"SzftTr",defaultMessage:"Folder hierarchy"}),role:"navigation"},T.length>0&&n.default.createElement(y,{crumbs:T,currentPath:e,isDraggingInternalFiles:a,shouldHighlightDropTargets:l,setFileUploaderPath:d,setUrl:f,size:_,disableDragging:v}),F.map((function(t,o){return n.default.createElement(w,r.__assign({},t,{key:encodeURI(t.path),isOnlyCrumb:0===o&&1===F.length&&0===T.length,index:o,isLastCrumb:o===F.length-1,maxWidth:O,currentPath:e,isDraggingInternalFiles:a,isHighlightedDropTarget:l,setFileUploaderPath:d,getUrlForPath:u,setUrl:f,size:_,disableDragging:v}))})))):n.default.createElement("span",{className:C},n.default.createElement("h1",{className:P},n.default.createElement(p.UserEducationEffect,{containerName:"PathBreadcrumbs",name:"HomeTitle",useSpan:!0},i)))},t.defaultProps={path:"/",isDraggingInternalFiles:!1,shouldHighlightDropTargets:!1,setFileUploaderPath:function(){},size:h.LARGE,disableDragging:!1},t})(n.default.PureComponent);t.PathBreadcrumbs=E;var w=(function(e){function t(t){var r=e.call(this,t)||this;return r.onDragEnterBreadcrumb=function(e){e.preventDefault(),e.target!==r.lastEnteredElement&&(r.props.disableDragging||(r.lastEnteredElement=e.target,r.dragEnterCount+=1,r.setState({isDraggedOver:!0}),r.props.isLastCrumb||r.props.setFileUploaderPath({path:r.props.path})))},r.onDragLeaveBreadcrumb=function(e){e.preventDefault(),r.props.disableDragging||(r.lastEnteredElement=null,r.dragEnterCount-=1,r.dragEnterCount<1&&(r.dragEnterCount=0,r.state.isDraggedOver&&(r.props.setFileUploaderPath({path:r.props.currentPath}),r.setState({isDraggedOver:!1}))))},r.onDropBreadcrumb=function(){r.setState({isDraggedOver:!1})},r.onDragOverBreadcrumb=function(e){e.preventDefault(),e.stopPropagation()},r.handleMouseEnter=function(){r.props.isDraggingInternalFiles&&r.setState({isDraggedOver:!0})},r.handleMouseLeave=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1})},r.handleMouseUp=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1})},r.navigateToFolder=function(e){var t=r.props.path;f.UEClient.sendEvent("BreadCrumbSegment","linkClicked",{path:t}),e.preventDefault(),r.props.setUrl({path:t})},r.eventHandlers={onDragEnter:r.onDragEnterBreadcrumb,onDragLeave:r.onDragLeaveBreadcrumb,onDrop:r.onDropBreadcrumb,onDragOver:r.onDragOverBreadcrumb,onMouseEnter:r.handleMouseEnter,onMouseLeave:r.handleMouseLeave,onMouseUp:r.handleMouseUp},r.state={isDraggedOver:!1},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0,this.lastEnteredElement=null},t.prototype.render=function(){var e,t=this.props,s=t.getUrlForPath,a=t.path,c=t.index,d=t.isOnlyCrumb,f=t.maxWidth,_=t.isLastCrumb,m=t.isHighlightedDropTarget,h=t.size,g=d?this.props.folderName:l.Emstring.em_snippet(this.props.folderName,f),S={"breadcrumb-segment":!0,"breadcrumb-segment--is-drop-target":!_&&m,"breadcrumb-segment--file-dragged-over":!_&&this.state.isDraggedOver},E=v(h);return e=_?n.default.createElement("span",r.__assign({"aria-current":"page"},this.eventHandlers),g):n.default.createElement("span",r.__assign({className:"breadcrumb-segment__wrapper"},this.eventHandlers),n.default.createElement(p.UserEducationEffect,{containerName:"BreadCrumbSegment",name:"link-"+c,useSpan:!0},n.default.createElement("a",{href:s(a).toString(),onClick:this.navigateToFolder,className:o.default(S)},g)),n.default.createElement(i.IconArrow,{name:E})),this.props.folderName!==g?n.default.createElement(u.TitleBubble,{content:this.props.folderName,position:u.TitleBubble.POSITIONS.BOTTOM,className:"list-label__title-bubble"},e):e},t.defaultProps={isOnlyCrumb:!1,isDraggingInternalFiles:!1,isHighlightedDropTarget:!1,disableDragging:!1},t})(n.default.Component),b=(function(e){function t(t){var r=e.call(this,t)||this;return r.onDragEnter=function(e){e.preventDefault(),e.target!==r.lastEnteredElement&&(r.props.disableDragging||(r.lastEnteredElement=e.target,r.dragEnterCount+=1,r.setState({isDraggedOver:!0}),r.props.setFileUploaderPath({path:r.props.path})))},r.onDragLeave=function(e){e.preventDefault(),r.props.disableDragging||(r.lastEnteredElement=null,r.dragEnterCount-=1,r.dragEnterCount<1&&(r.dragEnterCount=0,r.state.isDraggedOver&&(r.props.setFileUploaderPath({path:r.props.currentPath}),r.setState({isDraggedOver:!1}))))},r.onDrop=function(e){r.setState({isDraggedOver:!1}),r.dragEnterCount=0,r.props.closeFunc()},r.onDragOver=function(e){e.preventDefault(),e.stopPropagation()},r.handleMouseEnter=function(){r.props.isDraggingInternalFiles&&r.setState({isDraggedOver:!0})},r.handleMouseLeave=function(){r.state.isDraggedOver&&(r.setState({isDraggedOver:!1}),r.props.closeFunc())},r.handleMouseUp=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1}),r.props.isDraggingInternalFiles&&!r.props.isLastCrumb&&r.props.closeFunc()},r.state={isDraggedOver:!1},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0,this.lastEnteredElement=null},t.prototype.render=function(){var e=this.props,t=e.icon,i=e.alt,c=e.folderName,d={"breadcrumb-menu-item":!0,"breadcrumb-menu-item--is-drop-target":this.props.isHighlightedDropTarget,"breadcrumb-menu-item--file-dragged-over":this.state.isDraggedOver},u=n.default.createElement("span",{title:c,className:"breadcrumb-menu-item-wrapper"},n.default.createElement("span",{className:"breadcrumb-menu-item-icon"},n.default.createElement(s.IconContent,{name:t,"aria-label":i,role:"img"})),n.default.createElement("span",{className:"breadcrumb-menu-item-text"},l.Emstring.em_snippet(c,20)));return n.default.createElement(a.PopoverContentItem,r.__assign({value:this.props.path,className:o.default(d)},{onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDrop:this.onDrop,onDragOver:this.onDragOver,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onMouseUp:this.handleMouseUp}),u)},t.defaultProps={isHighlightedDropTarget:!1,closeFunc:function(){},alt:"",isDraggingInternalFiles:!1,disableDragging:!1},t})(n.default.Component),y=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={menuVisible:!1},t.onDragEnter=function(e){t.props.disableDragging||(e.preventDefault(),t.setState({menuVisible:!0}))},t.onInnerDragEnter=function(e){e.preventDefault(),t.dragEnterCount++},t.onDragLeave=function(e){e.preventDefault(),t.dragEnterCount--,t.dragEnterCount<1&&(t.dragEnterCount=0,t.state.menuVisible&&t.setState({menuVisible:!1}))},t.onMouseEnter=function(e){t.props.disableDragging||t.props.isDraggingInternalFiles&&!t.props.disableDragging&&(e.preventDefault(),t.setState({menuVisible:!0}))},t.onCrumbSelected=function(e){t.props.setUrl({path:e})},t.onPopoverToggle=function(e){var r=e.isOpen;t.setState({menuVisible:r})},t.onClose=function(){t.dragEnterCount=0,t.onPopoverToggle({isOpen:!1})},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0},t.prototype.render=function(){var e=this,t=r.__spreadArrays(this.props.crumbs).reverse(),o=this.props,l=o.currentPath,c=o.shouldHighlightDropTargets,d=o.isDraggingInternalFiles,u=o.setFileUploaderPath,p=o.size,f=o.disableDragging,_=m.intl.formatMessage({id:"JY5LSc",defaultMessage:"Show parent folders (descending)"}),h=n.default.createElement(s.IconContent,{name:"folder_dropdown-small","aria-label":_,role:"img",className:"breadcrumb-menu-icon"}),g=v(p);return n.default.createElement(a.Popover,{onSelection:this.onCrumbSelected,onMenuToggle:this.onPopoverToggle,className:"breadcrumb-dropdown-container"},n.default.createElement(a.PopoverTrigger,{onDragOver:this.onDragEnter,onMouseEnter:this.onMouseEnter,tag:"button"},n.default.createElement("span",{className:"u-unbutton breadcrumb-overflow-button u-l-fl"},h)),n.default.createElement(a.PopoverContent,{isRevealed:this.state.menuVisible,onDragEnter:this.onInnerDragEnter,onDragLeave:this.onDragLeave},t.map((function(t){return n.default.createElement(b,{key:encodeURI(t.path),path:t.path,icon:t.icon,alt:t.alt,folderName:t.folderName,currentPath:l,isHighlightedDropTarget:c,isDraggingInternalFiles:d,setFileUploaderPath:u,closeFunc:e.onClose,disableDragging:f})}))),n.default.createElement(i.IconArrow,{name:g,className:"breadcrumb__spacer"}))},t.defaultProps={shouldHighlightDropTargets:!1,isDraggingInternalFiles:!1,disableDragging:!1},t})(n.default.Component)})),define("modules/clean/react/share_download/api",["require","exports","tslib","modules/clean/ajax_as_promised"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var n=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})((function(e){this.message=e}));t.DownloadError=n;var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})(n);t.TooLargeError=i,t.testDownload=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,o.SilentBackgroundRequest({url:e})];case 1:return t=r.sent(),[3,3];case 2:throw r.sent(),new n;case 3:if("OK"!==t)throw 0===t.indexOf("err:")?new i:new n;return[2]}}))}))},t.fetchDownloadUrl=function(e){return o.SilentBackgroundRequest({url:"/sharing/fetch_user_content_link",data:{url:e}})}})),define("modules/clean/react/snackbar_manager",["require","exports","tslib","external/lodash","react","modules/clean/react/portal","modules/clean/react/snackbar","modules/core/accessible_announce","modules/core/exception"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importDefault(n),l=r.__importStar(l);var c=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleActionClick=function(){var e=r.state,t=e.displayedSnackbar,o=e.queue;if(t){var n=o[0].onActionClick;n&&n()}},r.handleCloseClick=function(){var e=r.dequeue();e&&e.onCloseClick&&e.onCloseClick()},r.handleTimeout=function(){var e=r.dequeue();e&&e.onTimeout&&e.onTimeout()},r.getAccessibleAnnouncement=function(e){return e.accessibleAnnouncement?e.accessibleAnnouncement:"string"==typeof e.title?e.title:null},r.state={queue:[],displayedSnackbar:null,isVisible:!0},r}return r.__extends(t,e),t.prototype.showContainer=function(){this.setState({isVisible:!0})},t.prototype.hideContainer=function(){this.setState({isVisible:!1})},t.prototype.show=function(e){e.id||l.reportStack("Missing `id` in Snackbar.show",{severity:l.SEVERITY.NONCRITICAL}),this.update(e)},t.prototype.update=function(e){e.id||l.reportStack("Missing `id` in Snackbar.update",{severity:l.SEVERITY.NONCRITICAL});var t=this.state.queue,n=o.findIndex(t,(function(t){return t.id===e.id}));if(-1!==n){0===n&&this.displayNewSnackbar(e);var i=r.__spreadArrays(t);i[n]=e,this.setState({queue:i})}else this.enqueue(e)},t.prototype.close=function(e){e||l.reportStack("Missing `id` in Snackbar.close",{severity:l.SEVERITY.NONCRITICAL}),this.dequeue(e)},t.prototype.displayNewSnackbar=function(e){var t=n.default.createElement(s.ControlledSnackbar,r.__assign({},e,{onActionClick:this.handleActionClick,onCloseClick:this.handleCloseClick,onTimeout:this.handleTimeout,key:e.id})),o=this.getAccessibleAnnouncement(e);o&&(this.state.displayedSnackbar?o!==this.getAccessibleAnnouncement(this.state.displayedSnackbar.props)&&a.AccessibleAnnounce.polite(o):a.AccessibleAnnounce.polite(o));this.setState({displayedSnackbar:t})},t.prototype.enqueue=function(e){var t=this.state.queue,n=r.__assign({id:Date.now().toString()},e);if(t.length||this.displayNewSnackbar(n),n.isLowPriority)this.setState({queue:r.__spreadArrays(t,[n])});else{var i=o.findIndex(t,(function(e){return!!e.isLowPriority}));-1===i?this.setState({queue:r.__spreadArrays(t,[n])}):0===i?(this.setState({queue:r.__spreadArrays([n],t)}),this.displayNewSnackbar(n)):this.setState({queue:r.__spreadArrays(t.slice(0,i),[n],t.slice(i))})}},t.prototype.dequeue=function(e){var t=this.state.queue,n=e?o.findIndex(t,(function(t){return t.id===e})):0,i=t[n];if(i)return t.length>1?(this.setState({queue:r.__spreadArrays(t.slice(0,n),t.slice(n+1))}),0===n&&this.displayNewSnackbar(t[1])):this.setState({queue:[],displayedSnackbar:null}),i},t.prototype.render=function(){var e=this.state,t=e.displayedSnackbar,r=e.isVisible;if(!t||!r)return null;var o=this.props.getParentElement?this.props.getParentElement():void 0;return n.default.createElement(i.Portal,{className:"snackbar-container",parentElement:o},t)},t})(n.default.PureComponent);t.SnackbarManager=c})),define("modules/clean/redux/tests/store",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mockExtraArguments=function(){return{}}})),define("modules/clean/react/upload_kit/lib/processors",["require","exports","tslib","modules/clean/react/upload_kit/lib/types","modules/clean/react/upload_kit/utils/makers","modules/clean/react/upload_kit/utils/path","modules/clean/react/upload_kit/utils/file","modules/clean/filepath","modules/core/uri"],(function(e,t,r,o,n,i,s,a,l){"use strict";function c(e){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(t){return[2,e.map((function(e){var t=e[0],r=e[1];return n.makeFileUploadItem(t,o.isWebkitFile(t)&&""!==t.webkitRelativePath?t.webkitRelativePath:t.name,r)}))]}))}))}function d(e,t,r){return Promise.resolve([n.makeFileUploadItem(e,t,r)])}function u(e,t){return r.__awaiter(this,void 0,Promise,(function(){var o,a,l=this;return r.__generator(this,(function(c){switch(c.label){case 0:return[4,Promise.all(e.map((function(e){return r.__awaiter(l,void 0,void 0,(function(){var o;return r.__generator(this,(function(r){switch(r.label){case 0:return e.isFile?[4,s.getFile(e)]:[3,2];case 1:return o=r.sent(),[2,[n.makeFileUploadItem(o,i.getDestPath(e),t)]];case 2:return e.isDirectory?[4,p(e)]:[3,4];case 3:return[2,u(r.sent(),t)];case 4:return[2,null]}}))}))})))];case 1:return o=c.sent(),a=[],o.forEach((function(e){e&&a.push.apply(a,e)})),[2,a]}}))}))}function p(e){return r.__awaiter(this,void 0,Promise,(function(){function t(e){return r.__awaiter(this,void 0,Promise,(function(){var o=this;return r.__generator(this,(function(n){return[2,new Promise((function(n,i){return e.readEntries((function(i){return r.__awaiter(o,void 0,void 0,(function(){var o,s;return r.__generator(this,(function(a){switch(a.label){case 0:return i.length>0?(o=n,s=[i],[4,t(e)]):[3,2];case 1:return o.apply(void 0,[r.__spreadArrays.apply(void 0,s.concat([a.sent()]))]),[3,3];case 2:n(i),a.label=3;case 3:return[2]}}))}))}),(function(e){return i(e)}))}))]}))}))}return r.__generator(this,(function(r){return[2,t(e.createReader())]}))}))}function f(e){var t={};return e.map((function(e){return a.parent_dir(e.destPath)})).forEach((function(e){""!==e&&"/"!==e&&(t[e]=e)})),Object.keys(t).map((function(e){return n.makeDirectoryUploadItem(e)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.preprocessFiles=c,t.preprocessBlob=d,t.preprocessDropboxFiles=function(e){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(t){return[2,e.map((function(e){var t=e[0],r=e[1];return n.makeChooserUploadItem(t,r)}))]}))}))},t.preprocessDataTransfer=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){var o,n,i,a,p;return r.__generator(this,(function(r){return o=e.files,n=e.items,(i=e.types)&&i.length>0&&-1===i.indexOf("Files")?(a=s.getDataTransferUrl(e),p=l.URI.parse(a).getAuthority(),[2,d(s.makeLinkBlob(a),"#"+p+".url",t)]):n&&n.length>0&&n[0]&&n[0].webkitGetAsEntry?[2,u(Array.from(n).map((function(e){return e.webkitGetAsEntry()})),t)]:o&&o.length>0?[2,c(Array.from(o).map((function(e){return[e,t||{}]})))]:[2,Promise.resolve([])]}))}))},t.preprocessFileSystemEntries=u,t.readDirectory=p,t.collectDirectories=f,t.resolveDuplicates=function(e,t){void 0===t&&(t=[]);var r=new Set,o=new Set,n=[];return t&&t.forEach((function(e){o.add(e.id),r.add(i.getNameAtRoot(e.destPath).toLowerCase())})),e.forEach((function(e){if(!o.has(e.id)){var t,s=-1!==e.destPath.indexOf("/"),l=1,c=i.getNameAtRoot(e.destPath),d=a.split_filename(c);if(r.has(c.toLowerCase()))do{t=d.name+" ("+l+")",c=d.ext?t+"."+d.ext:t,l++}while(r.has(c.toLowerCase()));if(s){var u=e.destPath.split("/");u[0]=c,e.destPath=u.join("/")}else e.destPath=c;o.add(e.id),r.add(e.destPath.toLowerCase()),n.push(e)}})),n},t.processFilesWithRenaming=function(e,r,o){return Promise.resolve(t.resolveDuplicates(e,o)).then((function(e){return{errors:r,items:e.concat(f(e))}}))}})),define("modules/clean/react/upload_kit/lib/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWebkitFile=function(e){return"webkitRelativePath"in e},t.isChooserFile=function(e){return"bytes"in e},(function(e){e.Dropbox="dropbox",e.Computer="computer",e.Server="server"})(t.FileSource||(t.FileSource={})),(function(e){e.Staged="staged",e.Queued="queued",e.Uploading="uploading",e.Success="success",e.Error="error",e.Cancelling="cancelling"})(t.UploadStatus||(t.UploadStatus={})),(function(e){e.CloudDoc="cloud_doc",e.EmptyFile="empty_file",e.IgnoredFile="ignored_file",e.OverMaxFileSize="over_max_file_size",e.PointerFile="pointer_file",e.TemporaryFile="temporary_file",e.Unknown="unknown"})(t.UploadValidationError||(t.UploadValidationError={}))})),define("modules/clean/react/upload_kit/lib/upload_block",["require","exports","modules/clean/csrf","modules/core/uri"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uploadBlock=function(e,t,n,i){var s=new o.URI({scheme:"https",authority:"dl-web.dropbox.com",path:"/put_block_returning_token",query:{owner_id:e.toString(),_subject_uid:e.toString(),t:r.readCsrfToken()||"",reported_block_size:i.size.toString(),num_blocks:Math.ceil(n/i.size).toString(),ns_id_for_routing:t.toString()}});return new Promise((function(e,t){var r=new XMLHttpRequest;return r.withCredentials=!0,r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE)if(200===r.status){var o=JSON.parse(r.responseText);o.token?e(o.token):t("Server token empty or undefined error.")}else t("Server error "+r.status)},r.open("POST",s.toString(),!0),r.setRequestHeader("Content-Type","application/octet-stream"),r.send(i),r}))}})),define("modules/clean/react/upload_kit/uploader/async_controller",["require","exports","tslib"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function t(e){var t=e.onLoaded,o=r.__rest(e,["onLoaded"]);this.onLoaded=t,this.controllerProps=o}return t.prototype.get=function(){var t=this;return this.promise||(this.promise=new Promise((function(o){return r.__awaiter(t,void 0,void 0,(function(){var t,n;return r.__generator(this,(function(i){switch(i.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/upload_kit/uploader/controller"],t,r)})).then(r.__importStar)];case 1:return t=i.sent().UploadController,n=new t(this.controllerProps),this.onLoaded(n),o(n),[2]}}))}))}))),this.promise},t})();t.AsyncUploadController=o})),define("modules/clean/react/upload_kit/uploader/context",["require","exports","tslib","react","modules/clean/react/helpers","modules/clean/react/upload_kit/uploader/async_controller","modules/clean/react/upload_kit/lib/processors"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(o=r.__importDefault(o)).default.createContext({}),l=0;var c=(function(e){function t(t){var n,a,c,d=e.call(this,t)||this;return d.fileField=o.default.createRef(),d.folderField=o.default.createRef(),d.chooseHandled=new Set,d.state={uploadItems:[],isUploading:!1},d.setInitialUploadedItems=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).setInitialUploadedItems.apply(t,e)]}}))}))},d.cancelUploadItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).cancelUploadItem.apply(t,e)]}}))}))},d.chooseFiles=function(){return r.__awaiter(d,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){return e=this.fileField?this.fileField.current:null,[2,this.chooseLocalFiles(e)]}))}))},d.chooseFolder=function(){return r.__awaiter(d,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){return e=this.folderField?this.folderField.current:null,[2,this.chooseLocalFiles(e)]}))}))},d.chooseLocalFiles=(n=function(e){return void 0===e&&(e=null),d.asyncController.get(),new Promise((function(t,o){if(e){e.dataset.uploadKitId||(e.dataset.uploadKitId=String(l++));var n=e.dataset.uploadKitId,i=function(){return r.__awaiter(d,void 0,void 0,(function(){var s,a;return r.__generator(this,(function(r){switch(r.label){case 0:if(this.chooseHandled.delete(n),e.removeEventListener("change",i),!e.files)return[3,6];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,this.asyncController.get()];case 2:return[4,r.sent().addFiles(Array.from(e.files))];case 3:return s=r.sent(),t(s),[3,5];case 4:return a=r.sent(),o(a),[3,5];case 5:return[3,7];case 6:o(),r.label=7;case 7:return[2]}}))}))};d.chooseHandled.has(n)||(d.chooseHandled.add(n),e.addEventListener("change",i)),e.value="",e.click()}else o()}))},void 0===a&&(a=100),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c||(c=n.apply(void 0,e),setTimeout((function(){c=void 0}),a)),c}),d.chooseDropboxFiles=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).chooseDropboxFiles.apply(t,e)]}}))}))},d.handleDrop=function(e,t){return r.__awaiter(d,void 0,void 0,(function(){var o,n;return r.__generator(this,(function(r){switch(r.label){case 0:return e?[4,Promise.all([s.preprocessDataTransfer(e,{parentPath:t}),this.asyncController.get()])]:[2,Promise.reject()];case 1:return o=r.sent(),n=o[0],[2,o[1].addUploadItems(n)]}}))}))},d.makeDirectory=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).makeDirectory.apply(t,e)]}}))}))},d.moveUploadItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).moveUploadItem.apply(t,e)]}}))}))},d.removeUploadItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).removeUploadItem.apply(t,e)]}}))}))},d.renameUploadItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).renameUploadItem.apply(t,e)]}}))}))},d.startUploading=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).startUploading.apply(t,e)]}}))}))},d.stopUploading=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).stopUploading.apply(t,e)]}}))}))},d.asyncController=new i.AsyncUploadController(r.__assign(r.__assign({},t),{onLoaded:function(e){d.subscription=function(e){d.setState(e)},e.subscribe(d.subscription)}})),d}return r.__extends(t,e),t.prototype.componentWillUnmount=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return this.subscription?[4,this.asyncController.get()]:[3,2];case 1:e.sent().unsubscribe(this.subscription),e.label=2;case 2:return[2]}}))}))},t.prototype.render=function(){var e=this.props,t=e.children,n=e.fileExtensions,i=e.selectMultiple,s=r.__assign(r.__assign({},this.state),{setInitialUploadedItems:this.setInitialUploadedItems,cancelUploadItem:this.cancelUploadItem,chooseFiles:this.chooseFiles,chooseFolder:this.chooseFolder,chooseDropboxFiles:this.chooseDropboxFiles,handleDrop:this.handleDrop,makeDirectory:this.makeDirectory,moveUploadItem:this.moveUploadItem,removeUploadItem:this.removeUploadItem,renameUploadItem:this.renameUploadItem,startUploading:this.startUploading,stopUploading:this.stopUploading});return o.default.createElement(a.Provider,{value:s},t,o.default.createElement("input",{type:"file",ref:this.fileField,style:{display:"none"},multiple:!!i,accept:n?n.join(","):void 0}),o.default.createElement("input",r.__assign({type:"file",ref:this.folderField,style:{display:"none"}},{webkitdirectory:""})))},t})(o.default.PureComponent);t.UploadProvider=c,t.withCustomUploadProvider=function(e,t){var i=function(n){return o.default.createElement(t,r.__assign({},n),o.default.createElement(e,r.__assign({},n)))};return i.displayName="withCustomUploadProvider("+n.getDisplayName(e)+", "+n.getDisplayName(t)+")",i},t.UploadConsumer=a.Consumer,t.withUploadConsumer=function(e){var i=function(n){return o.default.createElement(t.UploadConsumer,null,(function(t){return o.default.createElement(e,r.__assign({},n,t))}))};return i.displayName="WithUploadConsumer("+n.getDisplayName(e)+")",i}})),define("modules/clean/react/upload_kit/utils/file",["require","exports","tslib","modules/clean/react/upload_kit/lib/types"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFile=function(e){return r.__awaiter(void 0,void 0,Promise,(function(){return r.__generator(this,(function(t){return[2,new Promise((function(t){return e.file((function(e){return t(e)}))}))]}))}))},t.getSize=function(e){return e?o.isChooserFile(e)?e.bytes:e.size:0},t.getDataTransferUrl=function(e){return(e.getData("Url")||e.getData("text/x-moz-url")||e.getData("text/uri-list")||"").split("\n")[0]},t.makeLinkBlob=function(e){return new Blob(["[InternetShortcut]\r\nURL="+e+"\r\n"],{type:"text/plain"})}})),define("modules/clean/react/upload_kit/utils/makers",["require","exports","tslib","modules/clean/react/upload_kit/lib/types","modules/clean/uuid"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeFileUploadItem=function(e,t,i){return r.__assign(r.__assign({},i),{bytes:e.size,bytesUploaded:0,destPath:t,file:e,id:n.UUID.v4(),isDir:!1,source:o.FileSource.Computer,status:o.UploadStatus.Staged})},t.makeDirectoryUploadItem=function(e){return{bytes:0,bytesUploaded:0,destPath:e,id:n.UUID.v4(),isDir:!0,source:o.FileSource.Computer,status:o.UploadStatus.Staged}},t.makeChooserUploadItem=function(e,t){return r.__assign(r.__assign({},t),{bytes:e.bytes,bytesUploaded:0,destPath:e.name,file:e,id:e.id,isDir:e.isDir,source:o.FileSource.Dropbox,status:o.UploadStatus.Staged})}})),define("modules/clean/react/upload_kit/utils/path",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renameFilename=function(e,t){var r=e.split("/");return r[r.length-1]=t,r.join("/")},t.reparentFilename=function(e,t){return t+"/"+e.split("/").pop()},t.getDestPath=function(e){return e.fullPath?e.fullPath.startsWith("/")?e.fullPath.substring(1):e.fullPath:e.name},t.getRootDir=function(e){return-1===e.indexOf("/")?"/":e.split("/")[0]},t.getNameAtRoot=function(e){return e.split("/")[0]}})),define("modules/clean/search/api",["require","exports","tslib","modules/clean/ajax","modules/clean/analytics","modules/clean/api_v2/user_client","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/filetypes","modules/clean/search/api_helpers","modules/clean/search/constants","modules/clean/search/models","modules/clean/search/search_helpers","modules/clean/search/types","modules/core/exception","modules/clean/api_v2/error"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),d=r.__importStar(d),p=r.__importStar(p);var h=(function(){function e(){this._activeRequestId=0,this._activeRequest=null}return e.prototype.abortPreviousLoading=function(){null!=this._activeRequest&&this._activeRequest.abort()},e.prototype.loadResults=function(e){var t=e.user,r=e.path,o=e.query,n=e.start,i=e.maxResults,s=e.searchSessionId,a=e.nsId,l=e.fileNameOnly,u=e.loadDeleted,f=e.showPaperResults,_=e.isDropdown,m=e.isAdminConsole,h=e.webTimer,g=e.onSuccess,S=e.onError,v=e.overrideUrl,E=e.searchResultsExperiments,w=c.getCurrentTimezoneOffset(),b={query:o,search_token:p.getSearchCsrfToken(),fq_path:r,ns_id:a,filename_only:!!l,max_results:i,deleted:!!u,start:n,show_paper_results:!!f,is_dropdown:!!_,is_admin_console:!!m,show_unmounted_results:!0,timezone_offset:w,include_browse_context:!0,include_shared_docs:!0,include_snippets:!!E.expSnippets},y=v||d.SEARCH_FRONTEND_SERVICE_ENDPOINT;this._fetchResults({requestData:b,nextOffset:n,user:t,searchSessionId:s,url:y,onSuccess:g,onError:S,webTimer:h,useApiV2:!!E.expSearchApiV2})},e.prototype._extractSearchV2ResultsList=function(e,t,r){for(var o=[],n=t,i=0,s=e;i<s.length;i++){var l=s[i];switch(_.assert("other"!==l.metadata[".tag"],"Search result metadata should not be MetadataV2Other type",{tags:["search"]}),this._getSearchResultTypesFromSearchMatchV2(l)){case f.SearchResultTypes.FILE:o.push(a.File.fromServerObject(this._convertSearchMatchV2ToFileServerObject(l,n,r)));break;case f.SearchResultTypes.FILE_SHARED_WITH_ME:o.push(a.FileSharedWithMe.fromServerObject(this._convertSearchMatchV2ToFileSharedWithMeServerObject(l,n,r)));break;case f.SearchResultTypes.PAPER:o.push(a.Paper.fromServerObject(this._convertSearchMatchV2ToPaperServerObject(l,n,r)))}n++}return o},e.prototype._extractSearchResultsList=function(e,t){for(var r=[],o=t,n=0,i=e;n<i.length;n++){var s=i[n];switch(s.sort_rank=o,s.sort_key=o.toString(),s.search_result_type){case f.SearchResultTypes.FILE:r.push(a.File.fromServerObject(s));break;case f.SearchResultTypes.FILE_SHARED_WITH_ME:r.push(a.FileSharedWithMe.fromServerObject(s));break;case f.SearchResultTypes.PAPER:r.push(a.Paper.fromServerObject(s));break;case f.SearchResultTypes.PAPER_FOLDER:r.push(a.PaperFolder.fromServerObject(s))}o++}return r},e.prototype._extractSpellCorrection=function(e,t){return{query:e.query,score:e.score,isCorrected:e.is_corrected,requestId:t}},e.prototype._getSearchType=function(e){return e.is_image_content_search?"image_search":e.is_dropdown?"dropdown":e.deleted?"full_page_deleted":"full_page"},e.prototype.loadPartialResults=function(e){var t=this,o=e.user,n=e.maxResults,i=e.start,s=e.cursor,a=e.path,l=e.query,c=e.fileCategories,u=e.isPaperEnabled,f=void 0===u||u,_=e.searchSessionId,m=e.includeBrowseContext,h=e.webTimer,g=e.sortOrder,S=e.searchType,v=e.onSuccess,E=e.onError,w=e.searchResultsExperiments,b=e.skipLogging,y=e.deleted,T=e.filteredAccountId,F=e.artificialLatency;S===d.SearchType.IMAGE&&(c=void 0);var I=c&&!p.allCategoriesChecked(c,f)?p.fileCategoriesToString(c):"",O=g?p.sortFieldToOrderBy(g.sortField):"",C=g?p.sortDirectionToReverseOrder(g.sortDirection):"",P=r.__assign(r.__assign({query:l,search_token:p.getSearchCsrfToken(),fq_path:a,cursor:s,max_results:n,deleted:y,show_paper_results:S!==d.SearchType.IMAGE,include_browse_context:m,search_session_id:_},I&&{file_categories:I}),{is_image_content_search:S===d.SearchType.IMAGE,order_by:O,reverse_order:C,include_shared_docs:!0,include_snippets:!!w.expSnippets&&S===d.SearchType.ALL,user_filter_account_id:T}),A=function(){t._fetchResults({requestData:P,nextOffset:i,user:o,searchSessionId:_,url:d.SEARCH_FRONTEND_SERVICE_ENDPOINT,onSuccess:v,onError:E,webTimer:h,skipLogging:b,useApiV2:!!w.expSearchApiV2})};F?setTimeout((function(){A()}),F):A()},e.prototype._fetchResults=function(e){var t=this,r=e.requestData,s=e.nextOffset,a=e.user,l=e.searchSessionId,c=e.url,d=e.onSuccess,f=e.onError,_=e.webTimer,h=e.skipLogging,g=e.useApiV2;if(null!=this._activeRequest&&this._activeRequest.abort(),""!==r.query||r.user_filter_account_id){var S=p.fileCategoryStringToLogValue(r.file_categories),v={path_scoped:"/"!==r.fq_path,search_type:this._getSearchType(r),query_string:r.query,start:s,search_session_id:l,timezone_offset:r.timezone_offset,file_type_filters:S,user_filter_account_id:r.user_filter_account_id};h||n.SearchClientActivityLogger.log("query_started",a.id,v);var E=(new Date).getTime();if(g){this._activeRequestId++;var w=this._activeRequestId,b=new i.UserApiV2Client,y=function(e){if(w===t._activeRequestId){var o;e.spell_correction&&(o={query:e.spell_correction.query,score:0,isCorrected:e.spell_correction.is_corrected,requestId:"mockRequestId"});var n={results:t._extractSearchV2ResultsList(e.matches,s,"mockRequestId"),hasMore:e.has_more,cursor:e.cursor,spellCorrection:o};d({context:void 0,searchResults:n,deleted:!!r.deleted,requestId:"mockRequestId"}),_&&_.end("mockRequestId")}},T=function(e){if(w===t._activeRequestId){var r="",o="";(m.isApiError(e)||m.isBadRequestError(e)||m.isAuthError(e)||m.isAppError(e)||m.isServerError(e)||m.isRateLimitError(e))&&(r=e.toString(),e.headers&&(o=e.headers["x-dropbox-request-id"])),"function"==typeof f&&f(r,o),_&&_.abort()}};if(r.cursor)b.ns("files").rpc("search_internal/continue",{cursor:r.cursor},{subjectUserId:a.id}).then(y).catch(T);else{var F=this._convertRequestDataToV2(r);b.ns("files").rpc("search_internal",F,{subjectUserId:a.id}).then(y).catch(T)}}else this._activeRequest=o.WebRequest({url:c,data:r,dataType:"json",subject_user:a,success:function(e,o,i){var c;r.include_browse_context&&(c=u.extractBrowseContext(e));var p=e.search_results,f=i.getResponseHeader("x-dropbox-request-id");p.forEach((function(e){return e.request_id=f}));var m={results:t._extractSearchResultsList(p,s),hasMore:!!e.more,cursor:e.cursor,spellCorrection:e.spell_correction?t._extractSpellCorrection(e.spell_correction,f):void 0};if(d({context:c,searchResults:m,deleted:!!r.deleted,requestId:f}),!h){var g=n.SearchClientActivityLogger.create_search_log_dict(v,f,E,r.query,m.results.length,null,l);n.SearchClientActivityLogger.log("query_completed",a.id,g)}_&&_.end(f||void 0)},error:function(e,t,o){var i=e.getResponseHeader("x-dropbox-request-id");if("abort"!==t&&"function"==typeof f&&f(o,i),!h){var s=n.SearchClientActivityLogger.create_search_log_dict(v,i,E,r.query,null,t,l);n.SearchClientActivityLogger.log("query_failed",a.id,s)}_&&_.abort()},complete:function(){this._activeRequest=null}})}},e.prototype._convertRequestDataToV2=function(e){var t,r,o;e.order_by===s.SEARCH_ORDER_BY_TYPE.RELEVANCE?r={".tag":"relevance"}:e.order_by===s.SEARCH_ORDER_BY_TYPE.LAST_MODIFIED_TIME&&(r={".tag":"last_modified_time"}),e.reverse_order&&(o=e.reverse_order===s.SEARCH_REVERSE_ORDER_TYPE.TRUE);var n,i=[];return null===(t=e.file_categories)||void 0===t||t.split(",").forEach((function(e){i.push({".tag":e})})),e.deleted&&(n={".tag":"deleted"}),{query:e.query,options:{path:e.fq_path,max_results:e.max_results,filename_only:e.filename_only,file_categories:i.length>0?i:void 0,account_id:e.user_filter_account_id,image_content_search:e.is_image_content_search,order_by:r,reverse_order:o,file_status:n},match_field_options:{include_highlights:!0,include_snippets:!!e.include_snippets},session_id:e.search_session_id}},e.prototype._convertSearchMatchV2ToFileServerObject=function(e,t,r){var o,n,i=e.match_type?e.match_type[".tag"]:null,s=this._translateFileType(e.file_type),l=e.highlight_spans?e.highlight_spans:void 0,c=e.metadata.metadata,d=e.internal_metadata,u=e.snippets,p="folder"===c[".tag"],f=[];"folder"===c[".tag"]&&c.sharing_info&&!c.sharing_info.no_access&&(f=c.sharing_info.traverse_only?["can_view"]:c.sharing_info.read_only?["can_view","can_view_members"]:["can_edit","can_view","can_view_members"]);var _,m,h=("file"===c[".tag"]||"folder"===c[".tag"])&&(null===(o=c.sharing_info)||void 0===o?void 0:o.read_only),g="file"===c[".tag"]||"folder"===c[".tag"]?c.icon:"",S=0,v="",E=c.path_display||"",w=!E,b="",y=!1,T=!1,F=0,I=!1,O=!1;if("file"===c[".tag"]){S=c.size,v=c.id,b=c.rev,y=!!c.cloud_doc_info,_=null===(n=c.cloud_doc_info)||void 0===n?void 0:n.open_url,T=!!c.is_in_vault_folder;var C=c.file_lock_info?c.file_lock_info:void 0;F=(null==C?void 0:C.created)?new Date(null==C?void 0:C.created).getTime():0,I=!!C,m=C?{is_lockholder:null==C?void 0:C.is_lockholder,lockholder_name:null==C?void 0:C.lockholder_name,ts_locked:F}:void 0,O=!!c.symlink_info}"deleted"===c[".tag"]&&(S=-1);var P=0;d.is_shared_file&&(P=Math.floor(Math.random()*Math.floor(1e11)));var A=d.ns_id,D=d.ns_path,R=d.sjid,M=d.url,N=d.is_in_team_folder_tree;return{highlight_spans:l,match_type:i,snippets:u,last_action_by_user_ts:d.last_action_by_user_ts,direct_blockserver_link:"",is_in_team_folder_tree:N,ns_id:A,ns_path:D,sjid:R,thumbnail_url_tmpl:d.thumbnail_url,href:M,last_modified_name:d.modified_by,ext:a.File.getExtensionFromPath(p,E),is_dir:p,fq_path:E,bytes:S,type:s,mount_access_perms:f,read_only:h,is_cloud_doc:y,open_to_url:_,is_in_vault_folder:T,lock_info:m,is_locked:I,is_lockholder:null==m?void 0:m.is_lockholder,lockholder_name:null==m?void 0:m.lockholder_name,ts_locked:F,sort_key:t.toString(),sort_rank:t,event_type:0,file_id:v,icon:g,is_symlink:O,is_unmounted:w,is_versionable:!0,revision_id:b,target_ns:P,request_id:r}},e.prototype._convertSearchMatchV2ToFileSharedWithMeServerObject=function(e,t,r){var o=e.match_type?e.match_type[".tag"]:null,n=this._translateFileType(e.file_type),i=e.highlight_spans?e.highlight_spans:[],s=e.metadata.metadata,l=e.internal_metadata,c=e.snippets;if(_.assert("file"===s[".tag"],"Search result metadata should be FileMetadataReference for FileSharedWithMe",{tags:["search"]}),"file"!==s[".tag"])throw Error("Search result metadata should be FileMetadataReference for FileSharedWithMe");var d=s.name,u=new Date(s.client_modified).getTime(),p=s.icon,f=s.size,m=s.id,h=s.path_display||"",g=new Date(s.server_modified).getTime(),S=!!s.cloud_doc_info,v=l.url,E=l.thumbnail_url;return{bytes:f,ext:a.File.getExtensionFromPath(!1,h),file_id:m,filename:d,highlight_spans:i,href:v,icon:p,is_cloud_doc:S,last_modified_name:l.modified_by,match_type:o,request_id:r,server_timestamp:g,sort_rank:t,snippets:c,thumbnail_url_tmpl:E,ts:u,type:n,last_action_by_user_ts:l.last_action_by_user_ts}},e.prototype._convertSearchMatchV2ToPaperServerObject=function(e,t,r){var o=e.highlight_spans?e.highlight_spans:[],n=e.metadata.metadata,i=e.internal_metadata,s=e.snippets;if(_.assert("file"===n[".tag"],"Search result metadata should be FileMetadataReference for legacy Paper",{tags:["search"]}),"file"!==n[".tag"])throw Error("Search result metadata should be FileMetadataReference for legacy Paper");var a=n.name,l=n.id,c=n.client_modified;return{title:a,pad_id:l,url:i.url,title_highlights:[],highlight_spans:o,last_editor_name:i.modified_by,request_id:r,snippets:s,sort_rank:t,last_modified_date:c,ts:c}},e.prototype._getSearchResultTypesFromSearchMatchV2=function(e){var t=e.metadata.metadata,r=e.internal_metadata,o=f.SearchResultTypes.FILE;return r.is_shared_file?o=f.SearchResultTypes.FILE_SHARED_WITH_ME:"file"===t[".tag"]&&"000000000"===t.rev&&(o=f.SearchResultTypes.PAPER),o},e.prototype._translateFileType=function(e){return void 0===e?0:l.FileTypeMap.get(e[".tag"])||0},e.prototype.fetchAdditionalFileMetadata=function(e){var t=e.searchResults,r=e.user,n=e.onSuccess,i=e.onError,s=t.filter((function(e){return e instanceof a.File})).map((function(e){return[e.ns_id,e.sjid,e.fq_path.substr(0,e.fq_path.length-e.ns_path.length)]}));s.length>0&&o.WebRequest({url:d.FILE_INFO_ENDPOINT,data:{nsid_sjid_fq_mount_point_tuples:JSON.stringify(s)},dataType:"json",subject_user:r,success:function(e,t,r){for(var o=[],i=0,s=e.file_results;i<s.length;i++){var a=s[i];o.push(a)}n(o)},error:function(e,t,r){"abort"!==t&&"function"==typeof i&&i(r,e.getResponseHeader("x-dropbox-request-id"))}})},e})();t.SearchApiClient=h,t.searchApiClient=new h})),define("modules/clean/search/single_page/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.SET_VARIANT="SEARCH/SET_VARIANT",e.SET_USER="SEARCH/SET_USER",e.SET_EXPERIMENTS="SEARCH/SET_EXPERIMENTS",e.SET_PATH="SEARCH/SET_PATH",e.SET_QUERY="SEARCH/SET_QUERY",e.SET_FILE_CATEGORIES="SEARCH/SET_FILE_CATEGORIES",e.SET_RESULTS="SEARCH/SET_RESULTS",e.CLEAR_RESULTS="SEARCH/CLEAR_RESULTS",e.APPEND_RESULTS="SEARCH/APPEND_RESULTS",e.SET_LOADING_STATE="SEARCH/SET_LOADING_STATE",e.SET_SESSION_ID="SEARCH/SET_SESSION_ID",e.SET_REQUEST_ID="SEARCH/SET_REQUEST_ID",e.SET_SELECTION="SEARCH/SET_SELECTION",e.SET_PREVIEW_FILE_ID="SEARCH/SET_PREVIEW_FILE",e.SET_SORT_ORDER="SEARCH/SET_SORT_ORDER",e.ADD_TTI_COMPONENT="SEARCH/ADD_TTI_COMPONENT",e.CLEAR_TTI_COMPONENTS="SEARCH/CLEAR_TTI_COMPONENTS",e.SET_LOADING_DELETED_RESULTS="SEARCH/SET_LOADING_DELETED_RESULTS",e.SET_SEARCH_TYPE="SEARCH/SET_SEARCH_TYPE",e.SET_IMAGE_SUGGESTION="SEARCH/SET_IMAGE_SUGGESTION",e.UPDATE_FILE_IN_RESULTS="SEARCH/UPDATE_FILE_IN_RESULTS",e.UPDATE_RESULTS="SEARCH/UPDATE_RESULTS",e.REMOVE_RESULTS="SEARCH/REMOVE_RESULTS",e.RENAME_FILE="SEARCH/RENAME_FILE",e.DELETE_FILES="SEARCH/DELETE_FILES",e.PURGE_FILES="SEARCH/PURGE_FILES",e.RESTORE_FILES="SEARCH/RESTORE_FILES",e.SET_QUERY_HISTORY="SEARCH/SET_QUERY_HISTORY",e.SET_HIGHLIGHTED_ROW="SEARCH/SET_HIGHLIGHTED_ROW",e.UPDATE_QUERY_SUGGESTIONS_CACHE="SEARCH/UPDATE_QUERY_SUGGESTIONS_CACHE",e.SET_LAST_QUERY_WITH_QUERY_SUGGESTIONS_LOADED="SEARCH/SET_LAST_QUERY_WITH_QUERY_SUGGESTIONS_LOADED",e.SET_FILTERED_ACCOUNT_ID="SEARCH/SET_FILTERED_ACCOUNT_ID",e.UPDATE_PEOPLE_SUGGESTIONS_CACHE="SEARCH/UPDATE_PEOPLE_SUGGESTIONS_CACHE",e.SET_LAST_QUERY_WITH_PEOPLE_SUGGESTIONS_LOADED="SEARCH/SET_LAST_QUERY_WITH_PEOPLE_SUGGESTIONS_LOADED",e.SET_DWELL_TIME="SEARCH/SET_DWELL_TIME",e.SET_QUERY_START_TIME="SEARCH/SET_QUERY_START_TIME"})(t.ActionTypes||(t.ActionTypes={}))}));__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/growth/invite_facepile_loader",["require","exports","modules/clean/react/async/loadable"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InviteFacepileLoadable=r.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/growth/invite_facepile"],t,r)})).then(__importStar).then((function(e){return e.InviteFacepile}))}})})),define("modules/clean/react/growth/teams_web_actions_logger_events",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.INSTALL_PAGE_ESCAPE="install_page_escape",e.OPEN_DESKTOP_BANNER="open_desktop_banner",e.OPEN_DESKTOP_CLICK="open_desktop_click",e.RESEND_VERIFICATION_EMAIL="resend_verification_email",e.STEP_RENDER="setup_render",e.SUBMIT_TEAM_INFO="submit_team_info",e.TRANSITION_OPEN_GMAIL="transition_open_gmail",e.TRANSITION_OPEN_OUTLOOK="transition_open_outlook",e.TRIGGER_CLIENT_CHECK="trigger_client_check",e.TRIGGER_CLIENT_RESULT="trigger_client_result",e.TRIGGER_DOWNLOAD="trigger_download",e.TRIGGER_DOWNLOAD_AGAIN="trigger_download_again",e.TRIGGER_MAGIC_PAIRING="trigger_magic_pairing",e.UJ_CLINK_DOWNLOAD="uj_clink_download",e.ROLE_OPTION_SELECTED="role_option_selected",e.FIRST_PATH_OPTION_SELECTED="first_path_option_selected",e.SETUP_SKIP_ADD_MEMBERS="setup_skip_add_members",e.SETUP_INVITE_MEMBERS_IMPORT="setup_invite_members_import",e.SETUP_INVITE_MEMBERS_COPY_LINK="setup_invite_members_copy_link",e.SETUP_INVITE_MEMBERS_ADD_EMAIL="setup_invite_members_add_email",e.SETUP_INVITE_MEMBERS_ADD_MORE_CLICKED="setup_invite_members_add_more_clicked",e.SETUP_ADD_MEMBERS="setup_add_members",e.SETUP_ADD_MEMBERS_SUBMITTED="setup_add_members_submitted",e.SETUP_ADD_MEMBERS_FAILED="setup_add_members_failed",e.SHARE_INVITE_CLICK="share_invite_click",e.SHARE_INVITE_SHEET_ACTION="share_invite_sheet_action",e.SHARE_INVITE_SHEET_DISMISS="share_invite_sheet_dismiss",e.SHARE_INVITE_COPIED="share_invite_copied",e.INVITE_PAGE_ESCAPE="invite_page_escape",e.MW_APP_STORE_REDIRECT="mw_app_store_redirect",e.MW_CLINK_FLOW_REDIRECT="mw_clink_flow_redirect",e.INSTALL_APP_PAGE_ESCAPE="install_app_page_escape",e.INSTALL_PAGE_REDIRECT="install_page_redirect",e.MOBILE_ICON_CLICK="mobile_icon_click",e.SEND_MOBILE_APP_LINK="send_mobile_app_link",e.MW_STEP_NOT_RENDER="mw_step_not_render",e.REC_FOLDER_LOADED="rec_folder_loaded",e.REC_FOLDER_LOAD_FAILED="rec_folder_load_failed",e.SETUP_ADD_MEMBERS_REC_LOADED="setup_add_members_rec_loaded",e.SETUP_ADD_MEMBERS_REC_LOAD_FAILED="setup_add_members_rec_load_failed",e.REC_FOLDER_CHECK="rec_folder_check",e.REC_FOLDER_UNCHECK="rec_folder_uncheck",e.REC_FOLDER_CLK_NEXT="rec_folder_clk_next",e.CONF_FOLDER_CLK_MOVE="conf_folder_clk_move",e.CONF_FOLDER_MOVE_SUCCEEDED="conf_folder_move_succeeded",e.CONF_FOLDER_MOVE_FAILED="conf_folder_move_failed",e.SETUP_CONFIRM_MOVE_FOLDERS_IMPRESSION="setup_confirm_move_folders_impression",e.SETUP_SELECT_FOLDERS_IMPRESSION="setup_select_folders_impression",e.SETUP_MOVE_FOLDERS_KEEP_PERSONAL="setup_move_folders_keep_personal",e.SETUP_ADD_MEMBERS_UNCHECK="setup_add_members_uncheck",e.SETUP_ADD_MEMBERS_CHECK="setup_add_members_check",e.SETUP_ADD_MEMBERS_MORE_RECOS="setup_add_members_more_recos",e.SCROLL_EVENT="scroll_event",e.ACCESS_FOLDER_CHECK="access_folder_check",e.ACCESS_FOLDER_UNCHECK="access_folder_uncheck",e.FLOW_STEPS_DOES_NOT_MATCH="flow_steps_does_not_match",e.FLOW_STEPS_DOES_NOT_MATCH_V2="flow_steps_does_not_match_v2",e.FLOW_CONT_URL_DOES_NOT_MATCH="flow_cont_url_does_not_match"})(t.OnboardingLoggerEvents||(t.OnboardingLoggerEvents={})),(function(e){e.UJ_CLINK_DOWNLOAD_AGAIN="uj_clink_download_again",e.UJ_CLINK_SKIP_AFTER_DOWNLOAD="uj_clink_skip_after_download",e.SETUP_RENDER="setup_render",e.UJ_CLINK_DOWNLOAD_MOBILE_REROUTE="uj_clink_download_mobile_reroute",e.UJ_CLINK_DOWNLOAD="uj_clink_download",e.UJ_CLINK_SKIP="uj_clink_skip",e.OPEN_DESKTOP_CLICK="open_desktop_click"})(t.TeamInstallLoggerEvents||(t.TeamInstallLoggerEvents={})),(function(e){e.CLICK_MULTIPLE="rightsizing_clk_filter_screen_multiple",e.CLICK_YOU="rightsizing_clk_filter_screen_you",e.VIEW="rightsizing_view_filter_screen"})(t.RightsizingLoggerEvents||(t.RightsizingLoggerEvents={})),(function(e){e.VIEW_CONTENT_EMPTY_STATE="view_content_empty_state",e.CLICK_BROWSE_UPLOAD_CTA="click_browse_upload_cta"})(t.EmptyStateDropTargetLoggerEvents||(t.EmptyStateDropTargetLoggerEvents={})),(function(e){e.VIEW_INVITE_EMPTY_STATE="view_invite_empty_state",e.INVITE_MEMBERS_PRIMARY_CTA_CLK="invite_members_primary_cta_clk"})(t.InviteFacepileLoggerEvents||(t.InviteFacepileLoggerEvents={})),(function(e){e.DESKTOP_ICON_TOOLTIP="desktop_icon_tooltip",e.DESKTOP_ICON_CLICK="desktop_icon_click",e.DESKTOP_ICON_CLICK_RESULT="desktop_icon_click_result",e.DESKTOP_ICON_TOOLTIP_DISMISS="desktop_icon_tooltip_dismiss"})(t.OpenInDesktopCtaLoggerEvents||(t.OpenInDesktopCtaLoggerEvents={})),(function(e){e.VIEW_MOBILE_EMPTY_STATE="view_mobile_empty_state",e.DISMISS_MOBILE_EMPTY_STATE="dismiss_mobile_empty_state",e.SEND_MOBILE_LINK_CLK="send_mobile_link_clk",e.SEND_MOBILE_LINK_SUCCESS="send_mobile_link_success",e.SEND_MOBILE_LINK_FAIL="send_mobile_link_fail"})(t.DownloadAppZoneLoggerEvents||(t.DownloadAppZoneLoggerEvents={})),(function(e){e.VIEW_SUGGESTED_FOLDERS="view_suggested_folders",e.SUGGESTED_FOLDER_ADD_CLICKED="suggested_folder_add_clicked",e.SUGGESTED_FOLDERS_HIDE_CLICKED="suggested_folders_hide_clicked",e.SUGGESTED_FOLDER_CREATED="suggested_folder_created",e.SUGGESTED_FOLDER_FAILED="suggested_folder_failed",e.SUGGESTED_FOLDER_ACCESS_VIEW="suggested_folder_access_view",e.SUGGESTED_FOLDER_ACCESS_CHANGE="suggested_folder_access_change",e.VIEW_SUGGESTED_FOLDERS_MINIMIZED="view_suggested_folders_minimized",e.VIEW_SUGGESTED_FOLDERS_OPEN="view_suggested_folders_open"})(t.SuggestedFoldersLoggerEvents||(t.SuggestedFoldersLoggerEvents={})),(function(e){e.VIEW_EXPLORE_CONTENT_STATE="view_explore_content_state",e.VIEW_EXPLORE_EMPTY_STATE="view_explore_empty_state"})(t.TeamSpaceEmptyZoneLoggerEvents||(t.TeamSpaceEmptyZoneLoggerEvents={}))})),define("modules/clean/upsell/top_notification_listener",["require","exports","modules/clean/upsell/prompt_event_emitter"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTopNotificationListener=function(e){var t=function(t){return function(r){"TOP_NOTIFICATION"===r&&e(t)}},o=t(!0),n=t(!1);return r.promptBufferedEventEmitter.on(r.Events.ON_PROMPT_SHOWN,o),r.promptBufferedEventEmitter.on(r.Events.ON_PROMPT_DISMISSED,n),{unsubscribe:function(){r.promptBufferedEventEmitter.off(r.Events.ON_PROMPT_SHOWN,o),r.promptBufferedEventEmitter.off(r.Events.ON_PROMPT_DISMISSED,n)}}}})),define("modules/clean/web_upload_action_logger",["require","exports","tslib","modules/clean/ajax"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.MAX_ERRORS=3;var n=(function(){function e(){this.errorCount=0,this.lastError=Date.now(),this.shouldReport=!0}return e.prototype.log=function(e,r,n){var i=this;return this.shouldReport&&(this.errorCount<t.MAX_ERRORS||Date.now()-this.lastError>6e5)?new Promise((function(s,a){o.SilentBackgroundRequest({url:"/log/web_upload_action",data:{_subject_uid:e,event_type:r,extra_params:JSON.stringify(n)},error:function(e){429===e.status?i.errorCount=t.MAX_ERRORS:i.errorCount++,i.lastError=Date.now(),a(e)},success:function(e){try{var t=JSON.parse(e);t&&!t.continue_sending&&(i.shouldReport=!1),i.errorCount=0,s(e)}catch(e){throw i.errorCount++,i.lastError=Date.now(),a(e),e}}})})):Promise.resolve({})},e})();t.WebUploadActionLog=new n,t.WebUploadActionLogClass=n})),define("modules/core/custom_protocol",["require","exports","tslib","modules/core/browser_detection"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o=r.__importStar(o)).chrome?1e3:2e3;function i(e){var t=document.createElement("iframe");t.src=e,t.setAttribute("style","display: none;"),document.body.appendChild(t)}function s(e,t,r){var o=window.navigator;o&&o.msLaunchUri?o.msLaunchUri(e,t,r):r()}t.launchUri=function(e){var t=0;return new Promise((function(r,a){function l(){window.removeEventListener("blur",l),clearTimeout(t),r()}window.addEventListener("blur",l),t=setTimeout((function(){window.removeEventListener("blur",l),a()}),n),o.chrome?window.location.assign(e):o.mozilla||o.safari?i(e):(o.msie||o.edge)&&s(e,r,a)}))},t.launchUriByIframe=i,t.launchUriForMicrosoftBrowsers=s,t.canLaunchUri=function(){return o.msie?o.windowsInfo.win8OrHigher:!!(o.mozilla||o.safari||o.chrome)}})),define("modules/clean/react/growth/open_in_desktop",["require","exports","tslib","react","react-redux","dig-components/buttons","dig-components/icons","dig-components/typography","dig-components/tooltips","dig-components/icons/src","modules/clean/viewer","modules/clean/analytics","modules/clean/react/growth/teams_web_actions_logger_events","modules/clean/react/css","modules/core/i18n","modules/clean/growth/user_action/tracker","modules/clean/react/growth/first_task/first_task","modules/clean/react/growth/first_task/data/store","modules/clean/react/growth/first_task/data/selectors","modules/clean/react/growth/personalization/util","modules/clean/react/growth/open_in_util"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,g,S,v,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.OPEN_IN_DESKTOP_TEXT=_.intl.formatMessage({id:"6mltsz",defaultMessage:"Open in desktop"});var w={CONTENT_FIRST:{title:_.intl.formatMessage({id:"c6i6ys",defaultMessage:"Work offline"}),body:_.intl.formatMessage({id:"lyDaYm",defaultMessage:"The desktop app keeps teamwork going—with or without an internet connection."})},INVITE_FIRST:{title:_.intl.formatMessage({id:"AIHxJP",defaultMessage:"Never miss an update"}),body:_.intl.formatMessage({id:"KxMBYG",defaultMessage:"The desktop app helps you stay in the loop with your team’s progress in real time."})}},b={module_name:"clink_first_task",framework:"team_setup_essential"},y=(function(e){function n(t){var n=e.call(this,t)||this;return n.user=d.Viewer.get_viewer().work_user,n.addClickAnywhereHandler=function(){var e;u.TeamsWebActionsLogger.log(p.OpenInDesktopCtaLoggerEvents.DESKTOP_ICON_TOOLTIP,r.__assign({version:n.loggingVersion},b)),document.addEventListener("mousedown",n.handleClickOutside,!0),null===(e=n.actionTracker)||void 0===e||e.track(E.ESSENTIAL_SETUP_SEEN_DESKTOP_TOOLTIP)},n.handleClick=function(){var e=n.props,t=e.textType,r=e.needsPairingToken,o=e.growthActSmbMpIteration;E.openInDesktopApp({user:n.user,needsPairingToken:r,textType:t,growthActSmbMpIteration:o})},n.handleClickOutside=function(){u.TeamsWebActionsLogger.log(p.OpenInDesktopCtaLoggerEvents.DESKTOP_ICON_TOOLTIP_DISMISS,r.__assign({version:n.loggingVersion},b)),document.removeEventListener("mousedown",n.handleClickOutside,!0),h.markClinkTooltipSeenAndHide()},n.shouldShowButtonText=function(){var e=n.props.textType;return e===v.DesktopCtaType.ShowWithText||e===v.DesktopCtaType.ShowWithTextAsPrimary},n.getButtonVariant=function(){var e="transparent";switch(n.props.textType){case v.DesktopCtaType.ShowWithText:case v.DesktopCtaType.ShowWithoutText:e="outline";break;case v.DesktopCtaType.ShowWithTextAsPrimary:e="primary"}return e},n.tooltipRef=o.default.createRef(),n.user&&(n.actionTracker=new m.GrowthUserActionTracker(n.user.id,{project:E.ESSENTIAL_SETUP_ACTION_TRACKER}),t.clinkTooltipVisible!==h.TooltipType.None&&n.addClickAnywhereHandler(),t.totalNumItems>1&&h.showClinkTooltip(h.TooltipType.Files)),n}return r.__extends(n,e),n.prototype.componentDidUpdate=function(e){var t=this.props,r=t.totalNumItems,o=t.clinkTooltipVisible;r>1&&h.showClinkTooltip(h.TooltipType.Files),e.clinkTooltipVisible===h.TooltipType.None&&o!==h.TooltipType.None&&this.addClickAnywhereHandler()},Object.defineProperty(n.prototype,"loggingVersion",{get:function(){return this.props.clinkTooltipVisible===h.TooltipType.Members?"added_members":"added_content"},enumerable:!0,configurable:!0}),n.prototype.componentWillUnmount=function(){document.removeEventListener("mousedown",this.handleClickOutside,!0)},n.prototype.render=function(){var e,r=this.props,n=r.clinkTooltipVisible,d=r.hasSeenClinkTooltip,u=r.textType;if(!u&&(!this.user||!d&&n===h.TooltipType.None))return null;n===h.TooltipType.Files&&(e=w.CONTENT_FIRST),n===h.TooltipType.Members&&(e=w.INVITE_FIRST);var p=this.shouldShowButtonText(),f=this.getButtonVariant(),_=p?o.default.createElement(i.Button,{onClick:this.handleClick,variant:f,"aria-label":t.OPEN_IN_DESKTOP_TEXT},t.OPEN_IN_DESKTOP_TEXT,o.default.createElement(s.UIIcon,{src:c.OpenLine,style:{marginLeft:4}})):o.default.createElement(l.Tooltip,{placement:"bottom",title:t.OPEN_IN_DESKTOP_TEXT,onClick:this.handleClick},o.default.createElement(i.IconButton,{variant:"outline","aria-label":t.OPEN_IN_DESKTOP_TEXT},o.default.createElement(s.UIIcon,{src:c.OpenLine}))),m=e&&!u&&o.default.createElement(l.Tooltip.Control,{auto:!0,open:!0,placement:"bottom",variant:"rich",triggerRef:this.tooltipRef},o.default.createElement(o.default.Fragment,null,o.default.createElement(a.Title,{inverse:!0},e.title),o.default.createElement(a.Text,{tagName:"p",inverse:!0},e.body)));return o.default.createElement("div",{className:"open-in-desktop"},o.default.createElement("div",{ref:this.tooltipRef},_),m)},n})(o.default.PureComponent),T=n.connect((function(e){return{hasSeenClinkTooltip:S.getHasClinkTooltipDisplayed(e),clinkTooltipVisible:S.getClinkTooltipVisible(e)}}))(y),F=g.getStoreForFirstTask();t.ProvidedOpenInDesktop=function(e){return o.default.createElement(n.Provider,{store:F},o.default.createElement(T,r.__assign({},e)))},t.OpenInDesktop=f.requireCssWithComponent(t.ProvidedOpenInDesktop,["/static/css/dig-components/index.web-vfliFNMrU.css","/static/css/growth/experiments/open_in_desktop-vfln4XIZg.css"])})),define("modules/clean/react/vault/vault_browse_root_async",["require","exports","tslib","react"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o=r.__importStar(o)).lazy,i=o.Suspense,s=n((function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/vault/vault_browse_root"],t,r)})).then(r.__importStar)];case 1:return[2,{default:t.sent().VaultRoot}]}}))}))}));t.AsyncVaultRoot=function(e){return o.createElement(i,{fallback:o.createElement("div",null)},o.createElement(s,r.__assign({},e)))}})),define("modules/clean/react/vault/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VAULT_URL="/vault",t.VAULT_NAME="Vault",t.VAULT_STYLESHEETS=["/static/css/spectrum/index.web-vfl6Z83yw.css","/static/css/dig-components/index.web-vfliFNMrU.css","/static/js/vault/index.web-vflbsGFg3.css","/static/css/vault/vault-vfl0FIwGE.css"],t.SECURITY_CHECKUP_RELATIVE_URL="/security_checkup"})),define("modules/clean/react/vault/lib/browse_utils",["require","exports","tslib","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/browse/models","modules/clean/react/vault/constants"],(function(e,t,r,o,n,i,s){"use strict";function a(){return o.normalize(s.VAULT_NAME)}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.logShareFromInsideVault=function(t){return r.__awaiter(this,void 0,void 0,(function(){var o,n,i,s,a;return r.__generator(this,(function(l){switch(l.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/vault/lib/api"],t,r)})).then(r.__importStar)];case 1:return o=l.sent().logProductAnalyticsEvent,[4,new Promise((function(t,r){e(["modules/clean/react/vault/logging_types"],t,r)})).then(r.__importStar)];case 2:return n=l.sent(),i=n.AnalyticsEventAction,s=n.AnalyticsEventObject,a=n.AnalyticsEventActionSurface,o({eventAction:i.SELECT,eventObject:t?s.SHARE_FOLDER:s.SHARE_FILE,actionSurface:a.VAULT_HOME}),[2]}}))}))},t.isInsideVault=function(e){var t=e.split("/");return("/"===e[0]?t[1]:t[0])===s.VAULT_NAME},t.shouldInjectVaultEntry=function(e,t){return o.paths_are_equal(e,"")&&!t.find((function(e){return e.type===n.FileTypes.VAULT_FOLDER||o.filename(e.fq_path)===s.VAULT_NAME}))},t.getVaultFqPath=a,t.makeVaultFileEntry=function(){return new i.File({bytes:0,direct_blockserver_link:"",event_type:0,ext:"",file_id:"",fq_path:a(),href:s.VAULT_URL,icon:"folder_vault",is_cloud_doc:!1,is_dir:!0,is_in_team_folder_tree:!1,is_in_vault_folder:!1,is_locked:!1,is_symlink:!1,is_unmounted:!1,is_versionable:!1,ns_id:0,ns_path:"",revision_id:"0",sjid:0,sort_key:"",type:n.FileTypes.VAULT_FOLDER,target_ns:0})}})),define("premium-growth/classnames",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={}.hasOwnProperty;t.default=function e(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];for(var n=[],i=0;i<t.length;i++){var s=t[i];if(s)if("string"==typeof s||"number"==typeof s)n.push(s);else if(Array.isArray(s)&&s.length){var a=e.apply(null,s);a&&n.push(a)}else if("object"==typeof s)for(var l in s)r.call(s,l)&&s[l]&&n.push(l)}return n.join(" ")}})),define("comments2/components/folder_overview_utils",["require","exports","comments2/components/folder_overview_utils/description_utils"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyDescription=r.isEmptyDescription})),define("comments2/components/folder_overview_utils/description_utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyDescription=function(e){return!e||(0===e.blocks.length||!(e.blocks.length>1)&&("unstyled"===e.blocks[0].type&&0===e.blocks.map((function(e){return e.text})).join("\n").replace(/%u200B/g,"").trim().length))}})),define("retrieval-components/collapsable-section",["require","exports","tslib","react","classnames","spectrum/button"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),t.CollapsableSection=function(e){var t=e.title,r=e.isOpen,s=e.onHeaderClick,a=e.children,l=e.top,c=e.strings,d=e.containerClassName;return o.default.createElement("div",{className:n.default({"rc-collapsable-section":!0,"rc-collapsable-section--closed":!r}),style:{top:l}},o.default.createElement("div",{className:"rc-collapsable-section__header"},o.default.createElement("h2",{className:"rc-collapsable-section__header-tag"},o.default.createElement("span",null,t),o.default.createElement(i.Button,{onClick:s,className:"rc-collapsable-section__toggle",variant:"styleless"},r?c.buttonClose:c.buttonOpen))),o.default.createElement("div",{className:d,style:{display:r?void 0:"none"}},a))}})),define("retrieval-components/highlighted-truncated-string",["require","exports","tslib","classnames","react","spectrum/tooltip","retrieval-components/highlighted-truncated-string/em-string","retrieval-components/highlighted-truncated-string/text-highlights"],(function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n);var l=(function(e){function t(t){var r=e.call(this,t)||this;return r.setRef=function(e){r.textContainerSpan=e},r.updateDisplayTextIfNecessary=function(e){if(r.textContainerSpan){var t=e.fontSize,o=e.text,n=e.availableWidth,i=e.cellBuffer,a=e.variant,l=r.textContainerSpan,c=n||l.getBoundingClientRect().width;if(r.props.text!==o||r.state.cellWidth!==c||r.props.fontSize!==t||r.props.variant!==a){r.setState({cellWidth:c});var d=c/t-i,u=s.Emstring.em_snippet(o,d,.5,a);u!==r.state.truncatedText&&r.setState({truncatedText:u}),r.updateTooltip(u,o)}}},r.updateTooltip=function(e,t){e&&t&&r.setState({showTooltip:e!==t})},r.state={truncatedText:t.text,showTooltip:!1},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.updateDisplayTextIfNecessary(this.props)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.updateDisplayTextIfNecessary(e)},t.prototype.render=function(){var e=this.props,t=e.className,r=e.ariaLabel,s=e.highlightSpans,l=e.text,c=e.tooltipPosition,d=e.tooltipId,u=this.state,p=u.truncatedText,f=u.showTooltip;return n.createElement(i.Tooltip,{id:d,positioning:c,tooltipContent:s?a.generateHighlightedTooltipSpans(a.highlightSectionsFromHighlightSpans(l,s)):l,showOnMouseMove:f,wrapperClassName:"rc-truncated-string__tooltip"},n.createElement("span",{className:o.default(t,"rc-hl-truncated-string__container"),"aria-label":r,ref:this.setRef,style:{display:"block"}},s?this.getHighlightedSpan(p,l,s):p))},t.prototype.splitTruncatedParts=function(e,t){for(var r=0;r<e.length&&e.charAt(r)===t.charAt(r);)++r;return r===e.length||"…"!==e.charAt(r)?[e]:[e.substring(0,r),e.substring(r+1)]},t.prototype.getHighlightedSpan=function(e,t,r){var o=this.splitTruncatedParts(e,t);if(1===o.length)return a.highlightReactFromHighlightSpans(e,r);var i=a.highlightReactFromHighlightSpans(t,r,0,o[0].length),s=a.highlightReactFromHighlightSpans(t,r,t.lastIndexOf(o[1])),l=a.highlightEllipsisFromHighlightSpans(o[0].length+1,t.lastIndexOf(o[1])-1,r);return n.createElement("span",null,i,l,s)},t})(n.PureComponent);t.HighlightedTruncatedString=l,l.defaultProps={tooltipPosition:"above",cellBuffer:1,variant:"HIGHLIGHTED_TRUNCATED_STRING_MIDDLE"}})),define("retrieval-components/highlighted-truncated-string/em-string",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(t){if(!(this instanceof e))return new e(t);this.s=t,this.info=this.widthInfo(),this.length=t.length?this.info[this.s.length-1]:0}return e.initClass=function(){this.ACCURACY=2,this.CODEPOINT_TO_WIDTH={32:38,33:25,34:42,35:67,36:58,37:92,38:75,39:25,40:33,41:33,42:58,43:58,44:25,45:33,46:25,47:42,48:58,49:58,50:58,51:58,52:58,53:58,54:58,55:58,56:58,57:58,58:25,59:25,60:58,61:58,62:58,63:50,64:100,65:67,66:67,67:67,68:75,69:58,70:58,71:75,72:83,73:33,74:25,75:67,76:58,77:100,78:83,79:83,80:67,81:83,82:67,83:58,84:58,85:75,86:67,87:100,88:67,89:58,90:58,91:33,92:42,93:33,94:58,95:50,96:67,97:58,98:67,99:50,100:67,101:58,102:33,103:58,104:67,105:25,106:25,107:58,108:25,109:100,110:67,111:67,112:67,113:67,114:42,115:50,116:42,117:67,118:58,119:83,120:58,121:58,122:50,123:42,124:58,125:42,126:58,161:25,162:58,163:58,164:58,165:58,166:58,167:58,168:67,169:92,170:42,171:50,172:58,174:92,175:58,176:50,177:58,178:42,179:42,180:67,181:67,182:75,183:25,184:25,185:42,186:42,187:50,188:83,189:83,190:83,191:50,192:67,193:67,194:67,195:67,196:67,197:67,198:92,199:67,200:58,201:58,202:58,203:58,204:33,205:33,206:33,207:33,208:75,209:83,210:83,211:83,212:83,213:83,214:83,215:58,216:83,217:75,218:75,219:75,220:75,221:58,222:67,223:67,224:58,225:58,226:58,227:58,228:58,229:58,230:92,231:50,232:58,233:58,234:58,235:58,236:25,237:25,238:25,239:25,240:67,241:67,242:67,243:67,244:67,245:67,246:67,247:58,248:67,249:67,250:67,251:67,252:67,253:58,254:67,255:58,256:75,257:67,258:75,259:67,260:75,261:67,262:75,263:58,264:75,265:58,266:75,267:58,268:75,269:58,270:83,271:83,272:83,273:75,274:67,275:67,276:67,277:67,278:67,279:67,280:67,281:67,282:67,283:67,284:83,285:75,286:83,287:75,288:83,289:75,290:83,291:75,292:83,293:75,294:92,295:75,296:33,297:33,298:33,299:33,300:33,301:33,302:33,303:33,304:33,305:25,306:67,307:67,308:42,309:33,310:75,311:67,312:67,313:58,314:33,315:58,316:33,317:58,318:42,319:58,320:50,321:67,322:42,323:83,324:75,325:83,326:75,327:83,328:75,329:83,330:83,331:75,332:92,333:67,334:92,335:67,336:92,337:67,338:100,339:100,340:75,341:50,342:75,343:50,344:75,345:50,346:67,347:58,348:67,349:58,350:67,351:58,352:67,353:58,354:75,355:42,356:75,357:42,358:75,359:42,360:83,361:75,362:83,363:75,364:83,365:75,366:83,367:75,368:83,369:75,370:83,371:75,372:100,373:92,374:75,375:58,376:75,377:67,378:67,379:67,380:67,381:67,382:67,383:42,384:75,385:83,386:67,387:75,388:75,389:67,390:75,391:83,392:58,393:83,394:100,395:67,396:75,397:67,398:67,399:75,400:58,401:58,402:75,403:83,404:75,405:100,406:50,407:50,408:75,409:67,410:50,411:67,412:117,413:83,414:75,415:92,416:92,417:75,418:117,419:100,420:75,421:75,422:75,423:67,424:58,425:67,426:58,427:42,428:75,429:42,430:75,431:83,432:75,433:92,434:83,435:75,436:75,437:67,438:67,439:67,440:67,441:58,442:58,443:75,444:75,445:58,446:50,447:67,448:33,449:50,450:50,451:33,452:142,453:142,454:133,455:100,456:92,457:67,458:117,459:117,460:100,461:75,462:67,463:33,464:33,465:92,466:67,467:83,468:75,469:83,470:75,471:83,472:75,473:83,474:75,475:83,476:75,477:67,478:75,479:67,480:75,481:67,482:100,483:100,484:92,485:75,486:83,487:75,488:75,489:67,490:92,491:67,492:92,493:67,494:67,495:58,496:33,497:142,498:142,499:133,500:83,501:75,502:117,503:67,504:83,505:75,506:75,507:67,508:100,509:100,510:92,511:67,512:75,513:67,514:75,515:67,516:67,517:67,518:67,519:67,520:33,521:33,522:33,523:33,524:92,525:67,526:92,527:67,528:75,529:50,530:75,531:50,532:83,533:75,534:83,535:75,536:67,537:58,538:75,539:42,540:58,541:58,542:83,543:75,544:83,545:100,546:92,547:67,548:67,549:67,550:75,551:67,552:67,553:67,554:92,555:67,556:92,557:67,558:92,559:67,560:92,561:67,562:75,563:58,564:67,565:100,566:67,567:33,568:100,569:100,570:75,571:75,572:58,573:58,574:67,575:58,576:58,577:67,578:50,579:75,580:75,581:75,582:75,583:58,584:58,585:25,586:83,587:58,588:75,589:33,590:75,591:58,880:67,881:50,882:67,883:50,884:33,885:33,886:75,887:67,888:108,889:108,890:67,891:58,892:58,893:58,894:42,895:108,896:108,897:108,898:108,899:108,900:67,901:67,902:75,903:42,904:83,905:100,906:58,907:108,908:100,909:108,910:100,911:100,912:42,913:75,914:67,915:58,916:83,917:67,918:67,919:83,920:92,921:33,922:75,923:75,924:100,925:83,926:75,927:92,928:83,929:67,930:108,931:67,932:75,933:75,934:83,935:75,936:83,937:92,938:33,939:75,940:83,941:58,942:75,943:42,944:67,945:83,946:67,947:67,948:67,949:58,950:75,951:75,952:67,953:42,954:67,955:67,956:75,957:67,958:67,959:67,960:92,961:67,962:67,963:75,964:67,965:67,966:92,967:67,968:92,969:100,970:42,971:67,972:67,973:67,974:100,975:108,976:58,977:75,978:75,979:100,980:75,981:92,982:100,983:67,984:92,985:67,986:75,987:58,988:58,989:58,990:67,991:58,992:75,993:92,994:100,995:92,996:75,997:58,998:75,999:58,1e3:75,1001:75,1002:67,1003:67,1004:83,1005:58,1006:50,1007:42,1008:67,1009:67,1010:58,1011:33,1012:92,1013:58,1014:58,1015:67,1016:67,1017:75,1018:100,1019:83,1020:58,1021:75,1022:75,1023:75,1024:67,1025:67,1026:92,1027:58,1028:75,1029:67,1030:33,1031:33,1032:42,1033:108,1034:108,1035:83,1036:75,1037:83,1038:75,1039:83,1040:75,1041:67,1042:67,1043:58,1044:83,1045:67,1046:92,1047:67,1048:83,1049:83,1050:75,1051:83,1052:100,1053:83,1054:92,1055:83,1056:67,1057:75,1058:75,1059:75,1060:83,1061:75,1062:83,1063:75,1064:108,1065:108,1066:75,1067:92,1068:67,1069:75,1070:108,1071:75,1072:67,1073:67,1074:58,1075:58,1076:75,1077:67,1078:83,1079:58,1080:75,1081:75,1082:67,1083:67,1084:83,1085:75,1086:67,1087:75,1088:75,1089:58,1090:58,1091:58,1092:92,1093:67,1094:75,1095:58,1096:92,1097:100,1098:67,1099:83,1100:58,1101:58,1102:92,1103:58,1104:67,1105:67,1106:75,1107:58,1108:58,1109:58,1110:33,1111:33,1112:42,1113:92,1114:92,1115:75,1116:67,1117:75,1118:58,1119:75,1120:100,1121:75,1122:75,1123:67,1124:83,1125:83,1126:75,1127:67,1128:100,1129:92,1130:92,1131:83,1132:117,1133:108,1134:67,1135:67,1136:83,1137:83,1138:92,1139:67,1140:83,1141:67,1142:83,1143:67,1144:133,1145:125,1146:92,1147:67,1148:100,1149:75,1150:100,1151:75,1152:75,1153:58,1154:75,1155:0,1156:0,1157:0,1158:0,1159:108,1160:0,1161:0,1162:83,1163:75,1164:67,1165:58,1166:67,1167:75,1168:58,1169:58,1170:67,1171:58,1172:75,1173:67,1174:100,1175:92,1176:67,1177:58,1178:75,1179:67,1180:83,1181:75,1182:75,1183:67,1184:83,1185:75,1186:83,1187:75,1188:100,1189:83,1190:117,1191:100,1192:92,1193:75,1194:75,1195:58,1196:75,1197:58,1198:75,1199:58,1200:75,1201:58,1202:75,1203:75,1204:100,1205:83,1206:75,1207:67,1208:75,1209:67,1210:75,1211:58,1212:92,1213:75,1214:92,1215:75,1216:33,1217:92,1218:83,1219:75,1220:67,1221:83,1222:67,1223:83,1224:75,1225:83,1226:75,1227:75,1228:58,1229:100,1230:83,1231:25,1232:75,1233:67,1234:75,1235:67,1236:100,1237:100,1238:67,1239:67,1240:75,1241:67,1242:75,1243:67,1244:92,1245:83,1246:67,1247:58,1248:67,1249:58,1250:83,1251:75,1252:83,1253:75,1254:92,1255:67,1256:92,1257:67,1258:92,1259:67,1260:75,1261:58,1262:75,1263:58,1264:75,1265:58,1266:75,1267:58,1268:75,1269:58,1270:58,1271:42,1272:92,1273:83,1274:58,1275:42,1276:75,1277:58,1278:75,1279:58,2026:67,19977:108,65403:58},this._ELLIPSIS_LENGTH=new e("…").length,this._DOT_LENGTH=new e(".").length},e.em_snippet=function(t,r,o,n){void 0===n&&(n="HIGHLIGHTED_TRUNCATED_STRING_MIDDLE"),null==r&&(r=50),null==o&&(o=.75);var i=new e(t.toString());switch(n){case"HIGHLIGHTED_TRUNCATED_STRING_END":return i.snippet_end(r).toString();case"HIGHLIGHTED_TRUNCATED_STRING_START":return i.snippet_start(r).toString();case"HIGHLIGHTED_TRUNCATED_STRING_LAST_WORD":return i.snippet_last_word(r).toString();case"HIGHLIGHTED_TRUNCATED_STRING_FILE_EXTENSION":return i.snippet_file_extension(r).toString();case"HIGHLIGHTED_TRUNCATED_STRING_MIDDLE":default:return i.snippet(r,o).toString()}},e.prototype.widthInfo=function(){for(var e={"-1":0},t=0,r=this.s.length,o=0<=r;o?t<r:t>r;o?t++:t--)e[t]=e[t-1]+this.ems(this.s.charAt(t));return e},e.prototype.findSpot=function(e){var t;if(!e)return 0;for(var r=0,o=this.s.length;r<=o;){t=Math.floor(r/2+o/2);var n=this.info[t-1];if(n>e)o=t-1;else{if(!(n<e))return t;r=t+1}}return r>t?r:t},e.prototype.ems=function(t){var r=t.charCodeAt(0),o=e.CODEPOINT_TO_WIDTH[r];return o?o/Math.pow(10,e.ACCURACY):768<=r&&r<=879?0:65377<=r&&r<=65500?.58:11904<=r&&r<=40911||44032<=r&&r<=55215||4352<=r&&r<=4607||63744<=r&&r<=64255||65280<=r&&r<=65535||131072<=r&&r<=196607?1.08:.65},e.prototype.substr=function(t,r){var o=this.findSpot(t);if(null!=r){var n=this.findSpot(t+r);if(n-o<this.s.length){var i=this.s.charCodeAt(n-o);65024<=i&&i<=65039&&n--}return new e(this.s.substr(o,n-o))}return new e(this.s.substr(o))},e.prototype.toString=function(){return this.s},e.prototype.snippet=function(t,r){if(void 0===t&&(t=50),void 0===r&&(r=.75),this.length<=t)return this;var o=(t-=e._ELLIPSIS_LENGTH)*r,n=t-o,i=this.length-n,s=this.substr(0,o),a=this.substr(i);return new e(s.toString()+"…"+a.toString())},e.prototype.snippet_end=function(t){return void 0===t&&(t=50),this.length<=t?this:(t-=e._ELLIPSIS_LENGTH,new e(this.substr(0,t).toString()+"…"))},e.prototype.snippet_start=function(t){return void 0===t&&(t=50),this.length<=t?this:(t-=e._ELLIPSIS_LENGTH,new e("…"+this.substr(this.length-t,t).toString()))},e.prototype.snippet_last_word=function(t){if(void 0===t&&(t=50),this.length<=t)return this;var r=this.toString().trim().split(" ").pop(),o=new e(r).length;if(o>=t)return this.snippet(t);var n=(t-=e._ELLIPSIS_LENGTH)-o;return new e(this.substr(0,n).toString()+"…"+r)},e.prototype.snippet_file_extension=function(t){if(void 0===t&&(t=50),this.length<=t)return this;var r=this.toString().trim().split(".").pop(),o=new e(r).length;if(o>=t)return this.snippet(t);var n=(t-=e._ELLIPSIS_LENGTH)-o-e._DOT_LENGTH;return new e(this.substr(0,n).toString()+"…."+r)},e})();t.Emstring=r,r.initClass()})),define("retrieval-components/highlighted-truncated-string/text-highlights",["require","exports","tslib","classnames","react"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n);function i(e,t,r,o){if(r||(r=0),void 0===o&&(o=e.length),!t||!(function(e,t){var r=t.map((function(e){return e.string})).join("");return e===r})(e,t))return[{isHighlighted:!1,text:e.substring(r,o)}];for(var n=[],i=0,s=0,a=t;s<a.length;s++){var l=a[s],c=e.indexOf(l.string,i),d=c+l.string.length;if(i=d,!(c<r&&d<=r||c>=o)){var u=l.string;c<r&&(u=u.slice(r-c)),o<d&&(u=u.slice(0,-(d-o))),n.push({text:u,isHighlighted:l.isHighlighted})}}return n}function s(e,t,r){if(!r)return!1;for(var o=0,n=0,i=r;n<i.length;n++){var s=i[n],a=o+s.string.length-1;if(s.isHighlighted&&a>=e&&o<=t)return!0;o=a+1}return!1}t.highlightSectionsFromHighlightSpans=i,t.highlightReactFromHighlightSpans=function(e,t,r,s){return a=i(e,t,r,s),n.createElement("span",null,a.map((function(e,t){return n.createElement("span",{className:o.default({"rc-hl-truncated-string__highlight":e.isHighlighted}),key:t},e.text)})));var a},t.highlightEllipsisFromHighlightSpans=function(e,t,r){return n.createElement("span",{className:o.default({"rc-hl-truncated-string__highlight":s(e,t,r)})},"…")},t.generateHighlightedTooltipSpans=function(e){return n.createElement("span",null,e.map((function(e,t){return n.createElement("span",{className:o.default({"rc-hl-truncated-string__tooltip-highlight":e.isHighlighted}),key:t},e.text)})))}})),define("dropbox/proto/hql_events/browse/web_browse",["require","exports","tslib","protobufjs-dbx/minimal","dropbox/proto/hql_events/extensions"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=(o=r.__importStar(o)).Reader,s=o.Writer,a=(o.util,o.roots.default||(o.roots.default={}));t.default=a,t.hql_events=a.hql_events=((n=a.hql_events||{}).WebBrowseSelectRow=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.actionSource="",e.prototype.hqlMetadata=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.actionSource&&Object.hasOwnProperty.call(e,"actionSource")&&t.uint32(10).string(e.actionSource),null!=e.hqlMetadata&&Object.hasOwnProperty.call(e,"hqlMetadata")&&a.hql_events.HQLMetadata.encode(e.hqlMetadata,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new a.hql_events.WebBrowseSelectRow;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.actionSource=e.string();break;case 2:o.hqlMetadata=a.hql_events.HQLMetadata.decode(e,e.uint32());break;default:e.skipType(7&n)}}return o},e})(n.WebBrowseSelectRow||{}),n)})),define("dropbox/proto/hql_events/extensions",["require","exports","tslib","protobufjs-dbx/minimal","google/protobuf/descriptor","dropbox/proto/hql_events/taxonomy"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=(o=r.__importStar(o)).Reader,s=o.Writer,a=o.util,l=o.roots.default||(o.roots.default={});t.default=l,t.hql_events=l.hql_events=((n=l.hql_events||{}).HQLEventIdentity=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t;return e.prototype.actionEventId=null,e.prototype.eventName="",e.prototype.eventClass=null,e.prototype.legacyEvent=null,Object.defineProperty(e.prototype,"identity",{get:a.oneOfGetter(t=["actionEventId","eventName"]),set:a.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.actionEventId&&Object.hasOwnProperty.call(e,"actionEventId")&&l.hql_events.HQLEventIdentity.ActionEventIdentity.encode(e.actionEventId,t.uint32(10).fork()).ldelim(),null!=e.eventName&&Object.hasOwnProperty.call(e,"eventName")&&t.uint32(18).string(e.eventName),null!=e.eventClass&&Object.hasOwnProperty.call(e,"eventClass")&&l.hql_events.HQLEventIdentity.EventClass.encode(e.eventClass,t.uint32(26).fork()).ldelim(),null!=e.legacyEvent&&Object.hasOwnProperty.call(e,"legacyEvent")&&l.hql_events.HQLEventIdentity.LegacyEvent.encode(e.legacyEvent,t.uint32(34).fork()).ldelim(),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new l.hql_events.HQLEventIdentity;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.actionEventId=l.hql_events.HQLEventIdentity.ActionEventIdentity.decode(e,e.uint32());break;case 2:o.eventName=e.string();break;case 3:o.eventClass=l.hql_events.HQLEventIdentity.EventClass.decode(e,e.uint32());break;case 4:o.legacyEvent=l.hql_events.HQLEventIdentity.LegacyEvent.decode(e,e.uint32());break;default:e.skipType(7&n)}}return o},e.ActionEventIdentity=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.object="",e.prototype.action=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.object&&Object.hasOwnProperty.call(e,"object")&&t.uint32(10).string(e.object),null!=e.action&&Object.hasOwnProperty.call(e,"action")&&t.uint32(16).int32(e.action),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new l.hql_events.HQLEventIdentity.ActionEventIdentity;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.object=e.string();break;case 2:o.action=e.int32();break;default:e.skipType(7&n)}}return o},e})(e.ActionEventIdentity||{}),e.EventClass=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.className=0,e.prototype.subclassName=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.className&&Object.hasOwnProperty.call(e,"className")&&t.uint32(8).int32(e.className),null!=e.subclassName&&Object.hasOwnProperty.call(e,"subclassName")&&t.uint32(16).int32(e.subclassName),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new l.hql_events.HQLEventIdentity.EventClass;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.className=e.int32();break;case 2:o.subclassName=e.int32();break;default:e.skipType(7&n)}}return o},e})(e.EventClass||{}),e.LegacyEvent=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.table="",e.prototype.name="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.table&&Object.hasOwnProperty.call(e,"table")&&t.uint32(10).string(e.table),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new l.hql_events.HQLEventIdentity.LegacyEvent;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.table=e.string();break;case 2:o.name=e.string();break;default:e.skipType(7&n)}}return o},e})(e.LegacyEvent||{}),e})(n.HQLEventIdentity||{}),n.HQLMetadata=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.appSurface=0,e.prototype.actionSurface=0,e.prototype.identityOverride=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.appSurface&&Object.hasOwnProperty.call(e,"appSurface")&&t.uint32(8).int32(e.appSurface),null!=e.actionSurface&&Object.hasOwnProperty.call(e,"actionSurface")&&t.uint32(16).int32(e.actionSurface),null!=e.identityOverride&&Object.hasOwnProperty.call(e,"identityOverride")&&l.hql_events.HQLEventIdentity.encode(e.identityOverride,t.uint32(26).fork()).ldelim(),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new l.hql_events.HQLMetadata;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.appSurface=e.int32();break;case 2:o.actionSurface=e.int32();break;case 3:o.identityOverride=l.hql_events.HQLEventIdentity.decode(e,e.uint32());break;default:e.skipType(7&n)}}return o},e})(n.HQLMetadata||{}),n)})),define("dropbox/proto/hql_events/taxonomy",["require","exports","tslib","protobufjs-dbx/minimal"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=(o=r.__importStar(o)).Reader,s=o.Writer,a=(o.util,o.roots.default||(o.roots.default={}));t.default=a,t.hql_events=a.hql_events=((n=a.hql_events||{}).TaxonomyAction=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new a.hql_events.TaxonomyAction;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return o},e.Action=(t={},(r=Object.create(t))[t[0]="UNSPECIFIED"]=0,r[t[1]="START"]=1,r[t[2]="FOREGROUND"]=2,r[t[3]="SHOWN"]=3,r[t[4]="HOVER"]=4,r[t[5]="SCROLL"]=5,r[t[6]="SEARCH"]=6,r[t[7]="SELECT"]=7,r[t[8]="PIN"]=8,r[t[9]="UNPIN"]=9,r[t[10]="MOVE"]=10,r[t[11]="RENAME"]=11,r[t[12]="COPY"]=12,r[t[13]="DELETE"]=13,r[t[14]="OPEN"]=14,r[t[15]="CREATE"]=15,r[t[16]="VERSION_HISTORY"]=16,r[t[17]="DOWNLOAD"]=17,r[t[18]="TRANSFER"]=18,r[t[19]="COMMENT"]=19,r[t[20]="STAR"]=20,r[t[21]="UNSTAR"]=21,r[t[22]="UPLOAD"]=22,r[t[23]="REQUEST"]=23,r[t[24]="REWIND_HISTORY"]=24,r[t[25]="SHARE"]=25,r[t[26]="EDIT"]=26,r[t[27]="PREVIEW"]=27,r[t[28]="INITIATE"]=28,r[t[29]="FAIL"]=29,r[t[30]="SUCCEED"]=30,r[t[31]="ATTEMPT"]=31,r[t[32]="PREVIEW_RENDER_SUCCEEDED"]=32,r[t[33]="DISMISS"]=33,r),e})(n.TaxonomyAction||{}),n.TaxonomyClass=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new a.hql_events.TaxonomyClass;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return o},e.ClassName=(t={},(r=Object.create(t))[t[0]="UNSPECIFIED"]=0,r[t[1]="SEE_AND_CLICK"]=1,r[t[2]="FILE_ACTIONS"]=2,r),e})(n.TaxonomyClass||{}),n.TaxonomySubclass=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new a.hql_events.TaxonomySubclass;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return o},e.SubclassName=(t={},(r=Object.create(t))[t[0]="UNSPECIFIED"]=0,r[t[1]="SHARE"]=1,r),e})(n.TaxonomySubclass||{}),n.TaxonomyAppSurface=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new a.hql_events.TaxonomyAppSurface;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return o},e.AppSurface=(t={},(r=Object.create(t))[t[0]="UNSPECIFIED"]=0,r[t[1]="DESKTOP_COLLAB_BROWSE"]=1,r[t[2]="DESKTOP_TRAY"]=2,r),e})(n.TaxonomyAppSurface||{}),n.TaxonomyActionSurface=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new a.hql_events.TaxonomyActionSurface;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return o},e.ActionSurface=(t={},(r=Object.create(t))[t[0]="UNSPECIFIED"]=0,r[t[1]="SIGN_IN_PAGE"]=1,r[t[2]="SIGN_IN_DBX_PAGE"]=2,r[t[3]="SIGN_IN_GOOGLE_MODAL"]=3,r[t[4]="INTERSTITIAL_GOOGLE_ACCOUNTS_PAGE"]=4,r[t[5]="SIGNUP_PAGE"]=5,r[t[6]="START_MENU"]=6,r[t[7]="START_DOCK"]=7,r[t[8]="TRAY_ICON"]=8,r[t[9]="NOTIFICATIONS_TAB"]=9,r[t[10]="RECENT_TAB"]=10,r[t[11]="FOR_YOU_TAB"]=11,r[t[12]="RECENT_YOU_SUB_TAB"]=12,r[t[13]="RECENT_TEAM_SUB_TAB"]=13,r[t[14]="CALENDAR_EVENT_MENU"]=14,r[t[15]="SHARING_MODAL"]=15,r[t[16]="TOP_BAR"]=16,r[t[17]="FOR_YOU_TABS"]=17,r[t[18]="SEARCH_RESULTS"]=18,r[t[19]="TOP_BAR_CREATE_MENU"]=19,r[t[20]="TRAY_MENU"]=20,r),e})(n.TaxonomyActionSurface||{}),n)})),define("google/protobuf/descriptor",["require","exports","tslib","protobufjs-dbx/minimal"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i,s=(o=r.__importStar(o)).Reader,a=o.Writer,l=o.util,c=o.roots.default||(o.roots.default={});t.default=c,t.google=c.google=((n=c.google||{}).protobuf=((i=n.protobuf||{}).FileDescriptorSet=(function(e){function e(e){if(this.file=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.file=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.file&&e.file.length)for(var r=0;r<e.file.length;++r)c.google.protobuf.FileDescriptorProto.encode(e.file[r],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.FileDescriptorSet;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.file&&o.file.length||(o.file=[]),o.file.push(c.google.protobuf.FileDescriptorProto.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return o},e})(i.FileDescriptorSet||{}),i.FileDescriptorProto=(function(e){function e(e){if(this.dependency=[],this.publicDependency=[],this.weakDependency=[],this.messageType=[],this.enumType=[],this.service=[],this.extension=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.package="",e.prototype.dependency=l.emptyArray,e.prototype.publicDependency=l.emptyArray,e.prototype.weakDependency=l.emptyArray,e.prototype.messageType=l.emptyArray,e.prototype.enumType=l.emptyArray,e.prototype.service=l.emptyArray,e.prototype.extension=l.emptyArray,e.prototype.options=null,e.prototype.sourceCodeInfo=null,e.prototype.syntax="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.package&&Object.hasOwnProperty.call(e,"package")&&t.uint32(18).string(e.package),null!=e.dependency&&e.dependency.length)for(var r=0;r<e.dependency.length;++r)t.uint32(26).string(e.dependency[r]);if(null!=e.messageType&&e.messageType.length)for(r=0;r<e.messageType.length;++r)c.google.protobuf.DescriptorProto.encode(e.messageType[r],t.uint32(34).fork()).ldelim();if(null!=e.enumType&&e.enumType.length)for(r=0;r<e.enumType.length;++r)c.google.protobuf.EnumDescriptorProto.encode(e.enumType[r],t.uint32(42).fork()).ldelim();if(null!=e.service&&e.service.length)for(r=0;r<e.service.length;++r)c.google.protobuf.ServiceDescriptorProto.encode(e.service[r],t.uint32(50).fork()).ldelim();if(null!=e.extension&&e.extension.length)for(r=0;r<e.extension.length;++r)c.google.protobuf.FieldDescriptorProto.encode(e.extension[r],t.uint32(58).fork()).ldelim();if(null!=e.options&&Object.hasOwnProperty.call(e,"options")&&c.google.protobuf.FileOptions.encode(e.options,t.uint32(66).fork()).ldelim(),null!=e.sourceCodeInfo&&Object.hasOwnProperty.call(e,"sourceCodeInfo")&&c.google.protobuf.SourceCodeInfo.encode(e.sourceCodeInfo,t.uint32(74).fork()).ldelim(),null!=e.publicDependency&&e.publicDependency.length)for(r=0;r<e.publicDependency.length;++r)t.uint32(80).int32(e.publicDependency[r]);if(null!=e.weakDependency&&e.weakDependency.length)for(r=0;r<e.weakDependency.length;++r)t.uint32(88).int32(e.weakDependency[r]);return null!=e.syntax&&Object.hasOwnProperty.call(e,"syntax")&&t.uint32(98).string(e.syntax),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.FileDescriptorProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.name=e.string();break;case 2:o.package=e.string();break;case 3:o.dependency&&o.dependency.length||(o.dependency=[]),o.dependency.push(e.string());break;case 10:if(o.publicDependency&&o.publicDependency.length||(o.publicDependency=[]),2==(7&n))for(var i=e.uint32()+e.pos;e.pos<i;)o.publicDependency.push(e.int32());else o.publicDependency.push(e.int32());break;case 11:if(o.weakDependency&&o.weakDependency.length||(o.weakDependency=[]),2==(7&n))for(i=e.uint32()+e.pos;e.pos<i;)o.weakDependency.push(e.int32());else o.weakDependency.push(e.int32());break;case 4:o.messageType&&o.messageType.length||(o.messageType=[]),o.messageType.push(c.google.protobuf.DescriptorProto.decode(e,e.uint32()));break;case 5:o.enumType&&o.enumType.length||(o.enumType=[]),o.enumType.push(c.google.protobuf.EnumDescriptorProto.decode(e,e.uint32()));break;case 6:o.service&&o.service.length||(o.service=[]),o.service.push(c.google.protobuf.ServiceDescriptorProto.decode(e,e.uint32()));break;case 7:o.extension&&o.extension.length||(o.extension=[]),o.extension.push(c.google.protobuf.FieldDescriptorProto.decode(e,e.uint32()));break;case 8:o.options=c.google.protobuf.FileOptions.decode(e,e.uint32());break;case 9:o.sourceCodeInfo=c.google.protobuf.SourceCodeInfo.decode(e,e.uint32());break;case 12:o.syntax=e.string();break;default:e.skipType(7&n)}}return o},e})(i.FileDescriptorProto||{}),i.DescriptorProto=(function(e){function e(e){if(this.field=[],this.extension=[],this.nestedType=[],this.enumType=[],this.extensionRange=[],this.oneofDecl=[],this.reservedRange=[],this.reservedName=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.field=l.emptyArray,e.prototype.extension=l.emptyArray,e.prototype.nestedType=l.emptyArray,e.prototype.enumType=l.emptyArray,e.prototype.extensionRange=l.emptyArray,e.prototype.oneofDecl=l.emptyArray,e.prototype.options=null,e.prototype.reservedRange=l.emptyArray,e.prototype.reservedName=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.field&&e.field.length)for(var r=0;r<e.field.length;++r)c.google.protobuf.FieldDescriptorProto.encode(e.field[r],t.uint32(18).fork()).ldelim();if(null!=e.nestedType&&e.nestedType.length)for(r=0;r<e.nestedType.length;++r)c.google.protobuf.DescriptorProto.encode(e.nestedType[r],t.uint32(26).fork()).ldelim();if(null!=e.enumType&&e.enumType.length)for(r=0;r<e.enumType.length;++r)c.google.protobuf.EnumDescriptorProto.encode(e.enumType[r],t.uint32(34).fork()).ldelim();if(null!=e.extensionRange&&e.extensionRange.length)for(r=0;r<e.extensionRange.length;++r)c.google.protobuf.DescriptorProto.ExtensionRange.encode(e.extensionRange[r],t.uint32(42).fork()).ldelim();if(null!=e.extension&&e.extension.length)for(r=0;r<e.extension.length;++r)c.google.protobuf.FieldDescriptorProto.encode(e.extension[r],t.uint32(50).fork()).ldelim();if(null!=e.options&&Object.hasOwnProperty.call(e,"options")&&c.google.protobuf.MessageOptions.encode(e.options,t.uint32(58).fork()).ldelim(),null!=e.oneofDecl&&e.oneofDecl.length)for(r=0;r<e.oneofDecl.length;++r)c.google.protobuf.OneofDescriptorProto.encode(e.oneofDecl[r],t.uint32(66).fork()).ldelim();if(null!=e.reservedRange&&e.reservedRange.length)for(r=0;r<e.reservedRange.length;++r)c.google.protobuf.DescriptorProto.ReservedRange.encode(e.reservedRange[r],t.uint32(74).fork()).ldelim();if(null!=e.reservedName&&e.reservedName.length)for(r=0;r<e.reservedName.length;++r)t.uint32(82).string(e.reservedName[r]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.DescriptorProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.name=e.string();break;case 2:o.field&&o.field.length||(o.field=[]),o.field.push(c.google.protobuf.FieldDescriptorProto.decode(e,e.uint32()));break;case 6:o.extension&&o.extension.length||(o.extension=[]),o.extension.push(c.google.protobuf.FieldDescriptorProto.decode(e,e.uint32()));break;case 3:o.nestedType&&o.nestedType.length||(o.nestedType=[]),o.nestedType.push(c.google.protobuf.DescriptorProto.decode(e,e.uint32()));break;case 4:o.enumType&&o.enumType.length||(o.enumType=[]),o.enumType.push(c.google.protobuf.EnumDescriptorProto.decode(e,e.uint32()));break;case 5:o.extensionRange&&o.extensionRange.length||(o.extensionRange=[]),o.extensionRange.push(c.google.protobuf.DescriptorProto.ExtensionRange.decode(e,e.uint32()));break;case 8:o.oneofDecl&&o.oneofDecl.length||(o.oneofDecl=[]),o.oneofDecl.push(c.google.protobuf.OneofDescriptorProto.decode(e,e.uint32()));break;case 7:o.options=c.google.protobuf.MessageOptions.decode(e,e.uint32());break;case 9:o.reservedRange&&o.reservedRange.length||(o.reservedRange=[]),o.reservedRange.push(c.google.protobuf.DescriptorProto.ReservedRange.decode(e,e.uint32()));break;case 10:o.reservedName&&o.reservedName.length||(o.reservedName=[]),o.reservedName.push(e.string());break;default:e.skipType(7&n)}}return o},e.ExtensionRange=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.start=0,e.prototype.end=0,e.prototype.options=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.start&&Object.hasOwnProperty.call(e,"start")&&t.uint32(8).int32(e.start),null!=e.end&&Object.hasOwnProperty.call(e,"end")&&t.uint32(16).int32(e.end),null!=e.options&&Object.hasOwnProperty.call(e,"options")&&c.google.protobuf.ExtensionRangeOptions.encode(e.options,t.uint32(26).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.DescriptorProto.ExtensionRange;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.start=e.int32();break;case 2:o.end=e.int32();break;case 3:o.options=c.google.protobuf.ExtensionRangeOptions.decode(e,e.uint32());break;default:e.skipType(7&n)}}return o},e})(e.ExtensionRange||{}),e.ReservedRange=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.start=0,e.prototype.end=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.start&&Object.hasOwnProperty.call(e,"start")&&t.uint32(8).int32(e.start),null!=e.end&&Object.hasOwnProperty.call(e,"end")&&t.uint32(16).int32(e.end),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.DescriptorProto.ReservedRange;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.start=e.int32();break;case 2:o.end=e.int32();break;default:e.skipType(7&n)}}return o},e})(e.ReservedRange||{}),e})(i.DescriptorProto||{}),i.ExtensionRangeOptions=(function(e){function e(e){if(this.uninterpretedOption=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.uninterpretedOption=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.uninterpretedOption&&e.uninterpretedOption.length)for(var r=0;r<e.uninterpretedOption.length;++r)c.google.protobuf.UninterpretedOption.encode(e.uninterpretedOption[r],t.uint32(7994).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.ExtensionRangeOptions;e.pos<r;){var n=e.uint32();switch(n>>>3){case 999:o.uninterpretedOption&&o.uninterpretedOption.length||(o.uninterpretedOption=[]),o.uninterpretedOption.push(c.google.protobuf.UninterpretedOption.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return o},e})(i.ExtensionRangeOptions||{}),i.FieldDescriptorProto=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.name="",e.prototype.number=0,e.prototype.label=1,e.prototype.type=1,e.prototype.typeName="",e.prototype.extendee="",e.prototype.defaultValue="",e.prototype.oneofIndex=0,e.prototype.jsonName="",e.prototype.options=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.extendee&&Object.hasOwnProperty.call(e,"extendee")&&t.uint32(18).string(e.extendee),null!=e.number&&Object.hasOwnProperty.call(e,"number")&&t.uint32(24).int32(e.number),null!=e.label&&Object.hasOwnProperty.call(e,"label")&&t.uint32(32).int32(e.label),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(40).int32(e.type),null!=e.typeName&&Object.hasOwnProperty.call(e,"typeName")&&t.uint32(50).string(e.typeName),null!=e.defaultValue&&Object.hasOwnProperty.call(e,"defaultValue")&&t.uint32(58).string(e.defaultValue),null!=e.options&&Object.hasOwnProperty.call(e,"options")&&c.google.protobuf.FieldOptions.encode(e.options,t.uint32(66).fork()).ldelim(),null!=e.oneofIndex&&Object.hasOwnProperty.call(e,"oneofIndex")&&t.uint32(72).int32(e.oneofIndex),null!=e.jsonName&&Object.hasOwnProperty.call(e,"jsonName")&&t.uint32(82).string(e.jsonName),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.FieldDescriptorProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.name=e.string();break;case 3:o.number=e.int32();break;case 4:o.label=e.int32();break;case 5:o.type=e.int32();break;case 6:o.typeName=e.string();break;case 2:o.extendee=e.string();break;case 7:o.defaultValue=e.string();break;case 9:o.oneofIndex=e.int32();break;case 10:o.jsonName=e.string();break;case 8:o.options=c.google.protobuf.FieldOptions.decode(e,e.uint32());break;default:e.skipType(7&n)}}return o},e.Type=(t={},(r=Object.create(t))[t[1]="TYPE_DOUBLE"]=1,r[t[2]="TYPE_FLOAT"]=2,r[t[3]="TYPE_INT64"]=3,r[t[4]="TYPE_UINT64"]=4,r[t[5]="TYPE_INT32"]=5,r[t[6]="TYPE_FIXED64"]=6,r[t[7]="TYPE_FIXED32"]=7,r[t[8]="TYPE_BOOL"]=8,r[t[9]="TYPE_STRING"]=9,r[t[10]="TYPE_GROUP"]=10,r[t[11]="TYPE_MESSAGE"]=11,r[t[12]="TYPE_BYTES"]=12,r[t[13]="TYPE_UINT32"]=13,r[t[14]="TYPE_ENUM"]=14,r[t[15]="TYPE_SFIXED32"]=15,r[t[16]="TYPE_SFIXED64"]=16,r[t[17]="TYPE_SINT32"]=17,r[t[18]="TYPE_SINT64"]=18,r),e.Label=(function(){var e={},t=Object.create(e);return t[e[1]="LABEL_OPTIONAL"]=1,t[e[2]="LABEL_REQUIRED"]=2,t[e[3]="LABEL_REPEATED"]=3,t})(),e})(i.FieldDescriptorProto||{}),i.OneofDescriptorProto=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.options=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.options&&Object.hasOwnProperty.call(e,"options")&&c.google.protobuf.OneofOptions.encode(e.options,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.OneofDescriptorProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.name=e.string();break;case 2:o.options=c.google.protobuf.OneofOptions.decode(e,e.uint32());break;default:e.skipType(7&n)}}return o},e})(i.OneofDescriptorProto||{}),i.EnumDescriptorProto=(function(e){function e(e){if(this.value=[],this.reservedRange=[],this.reservedName=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.value=l.emptyArray,e.prototype.options=null,e.prototype.reservedRange=l.emptyArray,e.prototype.reservedName=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.value&&e.value.length)for(var r=0;r<e.value.length;++r)c.google.protobuf.EnumValueDescriptorProto.encode(e.value[r],t.uint32(18).fork()).ldelim();if(null!=e.options&&Object.hasOwnProperty.call(e,"options")&&c.google.protobuf.EnumOptions.encode(e.options,t.uint32(26).fork()).ldelim(),null!=e.reservedRange&&e.reservedRange.length)for(r=0;r<e.reservedRange.length;++r)c.google.protobuf.EnumDescriptorProto.EnumReservedRange.encode(e.reservedRange[r],t.uint32(34).fork()).ldelim();if(null!=e.reservedName&&e.reservedName.length)for(r=0;r<e.reservedName.length;++r)t.uint32(42).string(e.reservedName[r]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.EnumDescriptorProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.name=e.string();break;case 2:o.value&&o.value.length||(o.value=[]),o.value.push(c.google.protobuf.EnumValueDescriptorProto.decode(e,e.uint32()));break;case 3:o.options=c.google.protobuf.EnumOptions.decode(e,e.uint32());break;case 4:o.reservedRange&&o.reservedRange.length||(o.reservedRange=[]),o.reservedRange.push(c.google.protobuf.EnumDescriptorProto.EnumReservedRange.decode(e,e.uint32()));break;case 5:o.reservedName&&o.reservedName.length||(o.reservedName=[]),o.reservedName.push(e.string());break;default:e.skipType(7&n)}}return o},e.EnumReservedRange=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.start=0,e.prototype.end=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.start&&Object.hasOwnProperty.call(e,"start")&&t.uint32(8).int32(e.start),null!=e.end&&Object.hasOwnProperty.call(e,"end")&&t.uint32(16).int32(e.end),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.EnumDescriptorProto.EnumReservedRange;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.start=e.int32();break;case 2:o.end=e.int32();break;default:e.skipType(7&n)}}return o},e})(e.EnumReservedRange||{}),e})(i.EnumDescriptorProto||{}),i.EnumValueDescriptorProto=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.number=0,e.prototype.options=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.number&&Object.hasOwnProperty.call(e,"number")&&t.uint32(16).int32(e.number),null!=e.options&&Object.hasOwnProperty.call(e,"options")&&c.google.protobuf.EnumValueOptions.encode(e.options,t.uint32(26).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.EnumValueDescriptorProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.name=e.string();break;case 2:o.number=e.int32();break;case 3:o.options=c.google.protobuf.EnumValueOptions.decode(e,e.uint32());break;default:e.skipType(7&n)}}return o},e})(i.EnumValueDescriptorProto||{}),i.ServiceDescriptorProto=(function(e){function e(e){if(this.method=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.method=l.emptyArray,e.prototype.options=null,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.method&&e.method.length)for(var r=0;r<e.method.length;++r)c.google.protobuf.MethodDescriptorProto.encode(e.method[r],t.uint32(18).fork()).ldelim();return null!=e.options&&Object.hasOwnProperty.call(e,"options")&&c.google.protobuf.ServiceOptions.encode(e.options,t.uint32(26).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.ServiceDescriptorProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.name=e.string();break;case 2:o.method&&o.method.length||(o.method=[]),o.method.push(c.google.protobuf.MethodDescriptorProto.decode(e,e.uint32()));break;case 3:o.options=c.google.protobuf.ServiceOptions.decode(e,e.uint32());break;default:e.skipType(7&n)}}return o},e})(i.ServiceDescriptorProto||{}),i.MethodDescriptorProto=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name="",e.prototype.inputType="",e.prototype.outputType="",e.prototype.options=null,e.prototype.clientStreaming=!1,e.prototype.serverStreaming=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.inputType&&Object.hasOwnProperty.call(e,"inputType")&&t.uint32(18).string(e.inputType),null!=e.outputType&&Object.hasOwnProperty.call(e,"outputType")&&t.uint32(26).string(e.outputType),null!=e.options&&Object.hasOwnProperty.call(e,"options")&&c.google.protobuf.MethodOptions.encode(e.options,t.uint32(34).fork()).ldelim(),null!=e.clientStreaming&&Object.hasOwnProperty.call(e,"clientStreaming")&&t.uint32(40).bool(e.clientStreaming),null!=e.serverStreaming&&Object.hasOwnProperty.call(e,"serverStreaming")&&t.uint32(48).bool(e.serverStreaming),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.MethodDescriptorProto;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.name=e.string();break;case 2:o.inputType=e.string();break;case 3:o.outputType=e.string();break;case 4:o.options=c.google.protobuf.MethodOptions.decode(e,e.uint32());break;case 5:o.clientStreaming=e.bool();break;case 6:o.serverStreaming=e.bool();break;default:e.skipType(7&n)}}return o},e})(i.MethodDescriptorProto||{}),i.FileOptions=(function(e){function e(e){if(this.uninterpretedOption=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.javaPackage="",e.prototype.javaOuterClassname="",e.prototype.javaMultipleFiles=!1,e.prototype.javaGenerateEqualsAndHash=!1,e.prototype.javaStringCheckUtf8=!1,e.prototype.optimizeFor=1,e.prototype.goPackage="",e.prototype.ccGenericServices=!1,e.prototype.javaGenericServices=!1,e.prototype.pyGenericServices=!1,e.prototype.phpGenericServices=!1,e.prototype.deprecated=!1,e.prototype.ccEnableArenas=!1,e.prototype.objcClassPrefix="",e.prototype.csharpNamespace="",e.prototype.swiftPrefix="",e.prototype.phpClassPrefix="",e.prototype.phpNamespace="",e.prototype.phpMetadataNamespace="",e.prototype.rubyPackage="",e.prototype.uninterpretedOption=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.javaPackage&&Object.hasOwnProperty.call(e,"javaPackage")&&t.uint32(10).string(e.javaPackage),null!=e.javaOuterClassname&&Object.hasOwnProperty.call(e,"javaOuterClassname")&&t.uint32(66).string(e.javaOuterClassname),null!=e.optimizeFor&&Object.hasOwnProperty.call(e,"optimizeFor")&&t.uint32(72).int32(e.optimizeFor),null!=e.javaMultipleFiles&&Object.hasOwnProperty.call(e,"javaMultipleFiles")&&t.uint32(80).bool(e.javaMultipleFiles),null!=e.goPackage&&Object.hasOwnProperty.call(e,"goPackage")&&t.uint32(90).string(e.goPackage),null!=e.ccGenericServices&&Object.hasOwnProperty.call(e,"ccGenericServices")&&t.uint32(128).bool(e.ccGenericServices),null!=e.javaGenericServices&&Object.hasOwnProperty.call(e,"javaGenericServices")&&t.uint32(136).bool(e.javaGenericServices),null!=e.pyGenericServices&&Object.hasOwnProperty.call(e,"pyGenericServices")&&t.uint32(144).bool(e.pyGenericServices),null!=e.javaGenerateEqualsAndHash&&Object.hasOwnProperty.call(e,"javaGenerateEqualsAndHash")&&t.uint32(160).bool(e.javaGenerateEqualsAndHash),null!=e.deprecated&&Object.hasOwnProperty.call(e,"deprecated")&&t.uint32(184).bool(e.deprecated),null!=e.javaStringCheckUtf8&&Object.hasOwnProperty.call(e,"javaStringCheckUtf8")&&t.uint32(216).bool(e.javaStringCheckUtf8),null!=e.ccEnableArenas&&Object.hasOwnProperty.call(e,"ccEnableArenas")&&t.uint32(248).bool(e.ccEnableArenas),null!=e.objcClassPrefix&&Object.hasOwnProperty.call(e,"objcClassPrefix")&&t.uint32(290).string(e.objcClassPrefix),null!=e.csharpNamespace&&Object.hasOwnProperty.call(e,"csharpNamespace")&&t.uint32(298).string(e.csharpNamespace),null!=e.swiftPrefix&&Object.hasOwnProperty.call(e,"swiftPrefix")&&t.uint32(314).string(e.swiftPrefix),null!=e.phpClassPrefix&&Object.hasOwnProperty.call(e,"phpClassPrefix")&&t.uint32(322).string(e.phpClassPrefix),null!=e.phpNamespace&&Object.hasOwnProperty.call(e,"phpNamespace")&&t.uint32(330).string(e.phpNamespace),null!=e.phpGenericServices&&Object.hasOwnProperty.call(e,"phpGenericServices")&&t.uint32(336).bool(e.phpGenericServices),null!=e.phpMetadataNamespace&&Object.hasOwnProperty.call(e,"phpMetadataNamespace")&&t.uint32(354).string(e.phpMetadataNamespace),null!=e.rubyPackage&&Object.hasOwnProperty.call(e,"rubyPackage")&&t.uint32(362).string(e.rubyPackage),null!=e.uninterpretedOption&&e.uninterpretedOption.length)for(var r=0;r<e.uninterpretedOption.length;++r)c.google.protobuf.UninterpretedOption.encode(e.uninterpretedOption[r],t.uint32(7994).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.FileOptions;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.javaPackage=e.string();break;case 8:o.javaOuterClassname=e.string();break;case 10:o.javaMultipleFiles=e.bool();break;case 20:o.javaGenerateEqualsAndHash=e.bool();break;case 27:o.javaStringCheckUtf8=e.bool();break;case 9:o.optimizeFor=e.int32();break;case 11:o.goPackage=e.string();break;case 16:o.ccGenericServices=e.bool();break;case 17:o.javaGenericServices=e.bool();break;case 18:o.pyGenericServices=e.bool();break;case 42:o.phpGenericServices=e.bool();break;case 23:o.deprecated=e.bool();break;case 31:o.ccEnableArenas=e.bool();break;case 36:o.objcClassPrefix=e.string();break;case 37:o.csharpNamespace=e.string();break;case 39:o.swiftPrefix=e.string();break;case 40:o.phpClassPrefix=e.string();break;case 41:o.phpNamespace=e.string();break;case 44:o.phpMetadataNamespace=e.string();break;case 45:o.rubyPackage=e.string();break;case 999:o.uninterpretedOption&&o.uninterpretedOption.length||(o.uninterpretedOption=[]),o.uninterpretedOption.push(c.google.protobuf.UninterpretedOption.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return o},e.OptimizeMode=(t={},(r=Object.create(t))[t[1]="SPEED"]=1,r[t[2]="CODE_SIZE"]=2,r[t[3]="LITE_RUNTIME"]=3,r),e})(i.FileOptions||{}),i.MessageOptions=(function(e){function e(e){if(this.uninterpretedOption=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.messageSetWireFormat=!1,e.prototype.noStandardDescriptorAccessor=!1,e.prototype.deprecated=!1,e.prototype.mapEntry=!1,e.prototype.uninterpretedOption=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.messageSetWireFormat&&Object.hasOwnProperty.call(e,"messageSetWireFormat")&&t.uint32(8).bool(e.messageSetWireFormat),null!=e.noStandardDescriptorAccessor&&Object.hasOwnProperty.call(e,"noStandardDescriptorAccessor")&&t.uint32(16).bool(e.noStandardDescriptorAccessor),null!=e.deprecated&&Object.hasOwnProperty.call(e,"deprecated")&&t.uint32(24).bool(e.deprecated),null!=e.mapEntry&&Object.hasOwnProperty.call(e,"mapEntry")&&t.uint32(56).bool(e.mapEntry),null!=e.uninterpretedOption&&e.uninterpretedOption.length)for(var r=0;r<e.uninterpretedOption.length;++r)c.google.protobuf.UninterpretedOption.encode(e.uninterpretedOption[r],t.uint32(7994).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.MessageOptions;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.messageSetWireFormat=e.bool();break;case 2:o.noStandardDescriptorAccessor=e.bool();break;case 3:o.deprecated=e.bool();break;case 7:o.mapEntry=e.bool();break;case 999:o.uninterpretedOption&&o.uninterpretedOption.length||(o.uninterpretedOption=[]),o.uninterpretedOption.push(c.google.protobuf.UninterpretedOption.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return o},e})(i.MessageOptions||{}),i.FieldOptions=(function(e){function e(e){if(this.uninterpretedOption=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.ctype=0,e.prototype.packed=!1,e.prototype.jstype=0,e.prototype.lazy=!1,e.prototype.deprecated=!1,e.prototype.weak=!1,e.prototype.uninterpretedOption=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.ctype&&Object.hasOwnProperty.call(e,"ctype")&&t.uint32(8).int32(e.ctype),null!=e.packed&&Object.hasOwnProperty.call(e,"packed")&&t.uint32(16).bool(e.packed),null!=e.deprecated&&Object.hasOwnProperty.call(e,"deprecated")&&t.uint32(24).bool(e.deprecated),null!=e.lazy&&Object.hasOwnProperty.call(e,"lazy")&&t.uint32(40).bool(e.lazy),null!=e.jstype&&Object.hasOwnProperty.call(e,"jstype")&&t.uint32(48).int32(e.jstype),null!=e.weak&&Object.hasOwnProperty.call(e,"weak")&&t.uint32(80).bool(e.weak),null!=e.uninterpretedOption&&e.uninterpretedOption.length)for(var r=0;r<e.uninterpretedOption.length;++r)c.google.protobuf.UninterpretedOption.encode(e.uninterpretedOption[r],t.uint32(7994).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.FieldOptions;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.ctype=e.int32();break;case 2:o.packed=e.bool();break;case 6:o.jstype=e.int32();break;case 5:o.lazy=e.bool();break;case 3:o.deprecated=e.bool();break;case 10:o.weak=e.bool();break;case 999:o.uninterpretedOption&&o.uninterpretedOption.length||(o.uninterpretedOption=[]),o.uninterpretedOption.push(c.google.protobuf.UninterpretedOption.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return o},e.CType=(t={},(r=Object.create(t))[t[0]="STRING"]=0,r[t[1]="CORD"]=1,r[t[2]="STRING_PIECE"]=2,r),e.JSType=(function(){var e={},t=Object.create(e);return t[e[0]="JS_NORMAL"]=0,t[e[1]="JS_STRING"]=1,t[e[2]="JS_NUMBER"]=2,t})(),e})(i.FieldOptions||{}),i.OneofOptions=(function(e){function e(e){if(this.uninterpretedOption=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.uninterpretedOption=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.uninterpretedOption&&e.uninterpretedOption.length)for(var r=0;r<e.uninterpretedOption.length;++r)c.google.protobuf.UninterpretedOption.encode(e.uninterpretedOption[r],t.uint32(7994).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.OneofOptions;e.pos<r;){var n=e.uint32();switch(n>>>3){case 999:o.uninterpretedOption&&o.uninterpretedOption.length||(o.uninterpretedOption=[]),o.uninterpretedOption.push(c.google.protobuf.UninterpretedOption.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return o},e})(i.OneofOptions||{}),i.EnumOptions=(function(e){function e(e){if(this.uninterpretedOption=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.allowAlias=!1,e.prototype.deprecated=!1,e.prototype.uninterpretedOption=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.allowAlias&&Object.hasOwnProperty.call(e,"allowAlias")&&t.uint32(16).bool(e.allowAlias),null!=e.deprecated&&Object.hasOwnProperty.call(e,"deprecated")&&t.uint32(24).bool(e.deprecated),null!=e.uninterpretedOption&&e.uninterpretedOption.length)for(var r=0;r<e.uninterpretedOption.length;++r)c.google.protobuf.UninterpretedOption.encode(e.uninterpretedOption[r],t.uint32(7994).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.EnumOptions;e.pos<r;){var n=e.uint32();switch(n>>>3){case 2:o.allowAlias=e.bool();break;case 3:o.deprecated=e.bool();break;case 999:o.uninterpretedOption&&o.uninterpretedOption.length||(o.uninterpretedOption=[]),o.uninterpretedOption.push(c.google.protobuf.UninterpretedOption.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return o},e})(i.EnumOptions||{}),i.EnumValueOptions=(function(e){function e(e){if(this.uninterpretedOption=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.deprecated=!1,e.prototype.uninterpretedOption=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.deprecated&&Object.hasOwnProperty.call(e,"deprecated")&&t.uint32(8).bool(e.deprecated),null!=e.uninterpretedOption&&e.uninterpretedOption.length)for(var r=0;r<e.uninterpretedOption.length;++r)c.google.protobuf.UninterpretedOption.encode(e.uninterpretedOption[r],t.uint32(7994).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.EnumValueOptions;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.deprecated=e.bool();break;case 999:o.uninterpretedOption&&o.uninterpretedOption.length||(o.uninterpretedOption=[]),o.uninterpretedOption.push(c.google.protobuf.UninterpretedOption.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return o},e})(i.EnumValueOptions||{}),i.ServiceOptions=(function(e){function e(e){if(this.uninterpretedOption=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.deprecated=!1,e.prototype.uninterpretedOption=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.deprecated&&Object.hasOwnProperty.call(e,"deprecated")&&t.uint32(264).bool(e.deprecated),null!=e.uninterpretedOption&&e.uninterpretedOption.length)for(var r=0;r<e.uninterpretedOption.length;++r)c.google.protobuf.UninterpretedOption.encode(e.uninterpretedOption[r],t.uint32(7994).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.ServiceOptions;e.pos<r;){var n=e.uint32();switch(n>>>3){case 33:o.deprecated=e.bool();break;case 999:o.uninterpretedOption&&o.uninterpretedOption.length||(o.uninterpretedOption=[]),o.uninterpretedOption.push(c.google.protobuf.UninterpretedOption.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return o},e})(i.ServiceOptions||{}),i.MethodOptions=(function(e){function e(e){if(this.uninterpretedOption=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.deprecated=!1,e.prototype.idempotencyLevel=0,e.prototype.uninterpretedOption=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.deprecated&&Object.hasOwnProperty.call(e,"deprecated")&&t.uint32(264).bool(e.deprecated),null!=e.idempotencyLevel&&Object.hasOwnProperty.call(e,"idempotencyLevel")&&t.uint32(272).int32(e.idempotencyLevel),null!=e.uninterpretedOption&&e.uninterpretedOption.length)for(var r=0;r<e.uninterpretedOption.length;++r)c.google.protobuf.UninterpretedOption.encode(e.uninterpretedOption[r],t.uint32(7994).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.MethodOptions;e.pos<r;){var n=e.uint32();switch(n>>>3){case 33:o.deprecated=e.bool();break;case 34:o.idempotencyLevel=e.int32();break;case 999:o.uninterpretedOption&&o.uninterpretedOption.length||(o.uninterpretedOption=[]),o.uninterpretedOption.push(c.google.protobuf.UninterpretedOption.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return o},e.IdempotencyLevel=(t={},(r=Object.create(t))[t[0]="IDEMPOTENCY_UNKNOWN"]=0,r[t[1]="NO_SIDE_EFFECTS"]=1,r[t[2]="IDEMPOTENT"]=2,r),e})(i.MethodOptions||{}),i.UninterpretedOption=(function(e){function e(e){if(this.name=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.name=l.emptyArray,e.prototype.identifierValue="",e.prototype.positiveIntValue=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.negativeIntValue=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.doubleValue=0,e.prototype.stringValue=l.newBuffer([]),e.prototype.aggregateValue="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.name&&e.name.length)for(var r=0;r<e.name.length;++r)c.google.protobuf.UninterpretedOption.NamePart.encode(e.name[r],t.uint32(18).fork()).ldelim();return null!=e.identifierValue&&Object.hasOwnProperty.call(e,"identifierValue")&&t.uint32(26).string(e.identifierValue),null!=e.positiveIntValue&&Object.hasOwnProperty.call(e,"positiveIntValue")&&t.uint32(32).uint64(e.positiveIntValue),null!=e.negativeIntValue&&Object.hasOwnProperty.call(e,"negativeIntValue")&&t.uint32(40).int64(e.negativeIntValue),null!=e.doubleValue&&Object.hasOwnProperty.call(e,"doubleValue")&&t.uint32(49).double(e.doubleValue),null!=e.stringValue&&Object.hasOwnProperty.call(e,"stringValue")&&t.uint32(58).bytes(e.stringValue),null!=e.aggregateValue&&Object.hasOwnProperty.call(e,"aggregateValue")&&t.uint32(66).string(e.aggregateValue),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.UninterpretedOption;e.pos<r;){var n=e.uint32();switch(n>>>3){case 2:o.name&&o.name.length||(o.name=[]),o.name.push(c.google.protobuf.UninterpretedOption.NamePart.decode(e,e.uint32()));break;case 3:o.identifierValue=e.string();break;case 4:o.positiveIntValue=e.uint64();break;case 5:o.negativeIntValue=e.int64();break;case 6:o.doubleValue=e.double();break;case 7:o.stringValue=e.bytes();break;case 8:o.aggregateValue=e.string();break;default:e.skipType(7&n)}}return o},e.NamePart=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.namePart="",e.prototype.isExtension=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t.uint32(10).string(e.namePart),t.uint32(16).bool(e.isExtension),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.UninterpretedOption.NamePart;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.namePart=e.string();break;case 2:o.isExtension=e.bool();break;default:e.skipType(7&n)}}if(!o.hasOwnProperty("namePart"))throw l.ProtocolError("missing required 'namePart'",{instance:o});if(!o.hasOwnProperty("isExtension"))throw l.ProtocolError("missing required 'isExtension'",{instance:o});return o},e})(e.NamePart||{}),e})(i.UninterpretedOption||{}),i.SourceCodeInfo=(function(e){function e(e){if(this.location=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.location=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.location&&e.location.length)for(var r=0;r<e.location.length;++r)c.google.protobuf.SourceCodeInfo.Location.encode(e.location[r],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.SourceCodeInfo;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.location&&o.location.length||(o.location=[]),o.location.push(c.google.protobuf.SourceCodeInfo.Location.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return o},e.Location=(function(e){function e(e){if(this.path=[],this.span=[],this.leadingDetachedComments=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.path=l.emptyArray,e.prototype.span=l.emptyArray,e.prototype.leadingComments="",e.prototype.trailingComments="",e.prototype.leadingDetachedComments=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.path&&e.path.length){t.uint32(10).fork();for(var r=0;r<e.path.length;++r)t.int32(e.path[r]);t.ldelim()}if(null!=e.span&&e.span.length){for(t.uint32(18).fork(),r=0;r<e.span.length;++r)t.int32(e.span[r]);t.ldelim()}if(null!=e.leadingComments&&Object.hasOwnProperty.call(e,"leadingComments")&&t.uint32(26).string(e.leadingComments),null!=e.trailingComments&&Object.hasOwnProperty.call(e,"trailingComments")&&t.uint32(34).string(e.trailingComments),null!=e.leadingDetachedComments&&e.leadingDetachedComments.length)for(r=0;r<e.leadingDetachedComments.length;++r)t.uint32(50).string(e.leadingDetachedComments[r]);return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.SourceCodeInfo.Location;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:if(o.path&&o.path.length||(o.path=[]),2==(7&n))for(var i=e.uint32()+e.pos;e.pos<i;)o.path.push(e.int32());else o.path.push(e.int32());break;case 2:if(o.span&&o.span.length||(o.span=[]),2==(7&n))for(i=e.uint32()+e.pos;e.pos<i;)o.span.push(e.int32());else o.span.push(e.int32());break;case 3:o.leadingComments=e.string();break;case 4:o.trailingComments=e.string();break;case 6:o.leadingDetachedComments&&o.leadingDetachedComments.length||(o.leadingDetachedComments=[]),o.leadingDetachedComments.push(e.string());break;default:e.skipType(7&n)}}return o},e})(e.Location||{}),e})(i.SourceCodeInfo||{}),i.GeneratedCodeInfo=(function(e){function e(e){if(this.annotation=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.annotation=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.annotation&&e.annotation.length)for(var r=0;r<e.annotation.length;++r)c.google.protobuf.GeneratedCodeInfo.Annotation.encode(e.annotation[r],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.GeneratedCodeInfo;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.annotation&&o.annotation.length||(o.annotation=[]),o.annotation.push(c.google.protobuf.GeneratedCodeInfo.Annotation.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return o},e.Annotation=(function(e){function e(e){if(this.path=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.path=l.emptyArray,e.prototype.sourceFile="",e.prototype.begin=0,e.prototype.end=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.path&&e.path.length){t.uint32(10).fork();for(var r=0;r<e.path.length;++r)t.int32(e.path[r]);t.ldelim()}return null!=e.sourceFile&&Object.hasOwnProperty.call(e,"sourceFile")&&t.uint32(18).string(e.sourceFile),null!=e.begin&&Object.hasOwnProperty.call(e,"begin")&&t.uint32(24).int32(e.begin),null!=e.end&&Object.hasOwnProperty.call(e,"end")&&t.uint32(32).int32(e.end),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new c.google.protobuf.GeneratedCodeInfo.Annotation;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:if(o.path&&o.path.length||(o.path=[]),2==(7&n))for(var i=e.uint32()+e.pos;e.pos<i;)o.path.push(e.int32());else o.path.push(e.int32());break;case 2:o.sourceFile=e.string();break;case 3:o.begin=e.int32();break;case 4:o.end=e.int32();break;default:e.skipType(7&n)}}return o},e})(e.Annotation||{}),e})(i.GeneratedCodeInfo||{}),i),n)})),define("modules/clean/hql/index",["require","exports","modules/clean/hql/logger"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logEvent=function(e){r.getLoggerSingleton().add(e)}})),define("modules/clean/hql/api",["require","exports","tslib","modules/clean/api_v2/noauth_client"],(function(e,t,r,o){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT_LOGGING_NAMESPACE="event_logging",t.ADD_EVENTS_ENDPOINT="add_events",t.addEvents=function(e,i){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){return n||(n=new o.NoAuthApiV2Client),[2,n.ns(t.EVENT_LOGGING_NAMESPACE).rpc(t.ADD_EVENTS_ENDPOINT,e,{})]}))}))}})),define("modules/clean/hql/logger",["require","exports","tslib","proto_utils/unpack","modules/clean/hql/api","modules/clean/viewer","modules/core/exception"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),t.TIME_BEFORE_FIRST_FLUSH=5e3,t.MIN_FLUSH_INTERVAL=3e4;function a(e){var t,r,n,a,l,c,d,u;try{u=null===(t=window.ensemble.viewer.getActiveUser())||void 0===t?void 0:t.userId}catch(e){s.reportException({err:e,tags:["hql_web"],severity:s.SEVERITY.NONCRITICAL})}var p=i.Viewer.get_viewer();return{entries:[{core_fields:{user_id:u,team_id:null==p?void 0:p.team_id,paired_user_id:null===(r=null==p?void 0:p.get_users().find((function(e){return e.id!==u})))||void 0===r?void 0:r.id},platform_fields:{".tag":"web_fields",ua_browser_lang:null===(n=window.navigator)||void 0===n?void 0:n.language,is_br_cookies_enabled:null===(a=window.navigator)||void 0===a?void 0:a.cookieEnabled,ua_br_color_depth:null===(l=window.screen)||void 0===l?void 0:l.colorDepth,ua_br_viewport_width:window.innerWidth,ua_br_viewport_height:window.innerHeight,device_screen_height:null===(c=window.screen)||void 0===c?void 0:c.height,device_screen_width:null===(d=window.screen)||void 0===d?void 0:d.width},events:e.map((function(e){var t=e.payload,r=e.ts;return{event_message_name:t.eventMessageName,event_message_data:o.packProto(t.event),event_time_ms:r,session_id:t.sessionId,app_surface_name:t.appSurfaceName,action_surface_name:t.actionSurfaceName}}))}]}}var l,c=(function(){function e(){this.events=[]}return e.prototype.start=function(){var e=this;window.addEventListener("beforeunload",(function(){e.flush({sendBeacon:!0})})),this.scheduleFlush(t.TIME_BEFORE_FIRST_FLUSH)},e.prototype.add=function(e){this.events.push({payload:e,ts:Date.now(),sendAttempts:0})},e.prototype.scheduleFlush=function(e){var t=this;this.timeoutId=setTimeout((function(){return t.flush()}),e)},e.prototype.flush=function(e){var o=(void 0===e?{}:e).sendBeacon,i=void 0!==o&&o;return r.__awaiter(this,void 0,void 0,(function(){var e,o,l,c,d;return r.__generator(this,(function(r){switch(r.label){case 0:if(this.timeoutId&&clearTimeout(this.timeoutId),e=Date.now()+t.MIN_FLUSH_INTERVAL,!(this.events.length>0))return[3,4];o=this.events,this.events=[],r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n.addEvents(a(o),{sendBeacon:i})];case 2:return r.sent(),[3,4];case 3:return l=r.sent(),s.reportException({err:l,tags:["hql_web"],severity:s.SEVERITY.NONCRITICAL}),c=o.filter((function(e){return++e.sendAttempts<4})),(d=this.events).unshift.apply(d,c),[3,4];case 4:return this.scheduleFlush(Math.max(e-Date.now(),0)),[2]}}))}))},e})();t.Logger=c,t.getLoggerSingleton=function(){return l||(l=new c).start(),l}}));
//# sourceMappingURL=pkg-browse.min.js-vflbofH6T.map