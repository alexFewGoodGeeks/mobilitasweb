define("modules/clean/react/file_viewer/ml_experiment",["require","exports","modules/clean/api_v2/user_client"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ML_EXPERIMENT_TYPES={contract:"CONTRACT",esign:"ESIGN",control:"CONTROL",file:"FILE"},t.ML_ENDPOINT_FETCH_TYPES=["CONTRACT","ESIGN"],t.ML_EXPERIMENT_EXTENSIONS=["pdf","docx"],t.fetchDocClassification=function(e,t){var r={file_id:t};return(new n.UserApiV2Client).ns("hellosign").rpc("get_classification",r,{subjectUserId:e})}})),define("modules/clean/react/comments2/data/store",["require","exports","tslib","external/lodash","modules/clean/redux/namespaces","modules/clean/react/comments2/data/reducer","modules/clean/redux/store"],(function(e,t,n,r,a,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),t.getStoreForComments2=r.once((function(){var e;return o.getStoreAndRegisterReducers(((e={})[a.COMMENTS2_NAMESPACE_KEY]=i.reducer,e))}))})),define("modules/clean/react/file_sidebar/store/instance",["require","exports","tslib","redux","modules/clean/react/file_sidebar/store/app/reducer","modules/clean/react/file_sidebar/store/file_activity/reducer","modules/clean/react/file_sidebar/store/sidebar/reducer","modules/clean/react/file_sidebar/store/middleware/thunk","modules/clean/react/file_sidebar/store/middleware/reactor","modules/clean/react/file_sidebar/store/sidebar/reactors","modules/clean/redux/unsupported","modules/clean/redux/devtools"],(function(e,t,n,r,a,i,o,s,c,u,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(r=n.__importStar(r)).combineReducers({app:a.reducer,fileActivity:i.reducer,sidebar:o.reducer});function p(e,t){return"::RESET"===t.type&&(e=void 0),m(e,t)}t.store=l.createStore(p,d.composeEnhancersWithDevTools(r.applyMiddleware(s.thunk(),c.reactor(u.reactors))))})),define("modules/clean/react/file_sidebar/store/sidebar/actions",["require","exports","tslib","modules/clean/react/file_sidebar/store/file_activity/selectors","modules/clean/react/file_sidebar/store/sidebar/helpers","modules/clean/react/file_sidebar/store/sidebar/selectors","modules/clean/react/file_sidebar/file_sidebar_logger","modules/clean/react/file_sidebar/store/sidebar/types","file-viewer/core"],(function(e,t,n,r,a,i,o,s,c){"use strict";function u(e){return function(t,n){t({type:s.ActionType.SidebarOpen,payload:{reason:e}})}}function l(){return function(e,t){var n=t(),a=i.getSidebarContext(n).user;i.getSidebarState(n).open&&(e({type:s.ActionType.SidebarClose}),o.logSidebarClosed({num_comments:i.getTabState(n,"comments").extra.commentCount,num_events:r.getVisibleActivityCount(n),viewing_user_id:a?a.id:null}))}}function d(){return{type:s.ActionType.SidebarIndicateNewFileNav}}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),a=n.__importStar(a),i=n.__importStar(i),t.reset=function(){return{type:s.ActionType.SidebarReset}},t.open=u,t.close=l,t.toggle=function(){return function(e,t){var n=t();i.getSidebarState(n).open?e(l()):e(u("toggle_button"))}},t.completeToggleOpen=function(){return function(e){e(u("toggle_button_after_transition"))}},t.selectTab=function(e){return{type:s.ActionType.SidebarSelectTab,payload:{tabName:e}}},t.thirdpartyBlueDotOnboard=function(){return{type:s.ActionType.SidebarSetThirdPartyBlueDotOnboardState}},t.openFile=function(e){return function(t,n){var r=n(),o=i.getSidebarContext(r);a.isContextChanged(o,e)&&(t({type:s.ActionType.SidebarOpenFile,payload:e}),t(d()))}},t.setComments2DisabledState=function(){return{type:s.ActionType.SidebarSetComments2DisabledState}},t.setComments2ShownState=function(e){return{type:s.ActionType.SidebarSetComments2ShownState,payload:e}},t.setCommentingOnNewFile=d,t.OverrideInitialState=function(e){var t=e===c.FileViewerMode.Documentation?"metadata":"comments";return{type:s.ActionType.SidebarOverrideInitialState,payload:{open:!0,tab:t}}}})),define("modules/clean/react/comments2/data/reducer",["require","exports","tslib","external/lodash","modules/clean/react/comments2/data/actions","modules/clean/react/comments2/data/initial_state","modules/clean/react/comments2/data/util","modules/clean/react/comments2/data/reducer_helper","modules/clean/react/comments2/data/types","comments2/transforms"],(function(e,t,n,r,a,i,o,s,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),u=n.__importStar(u);var l=s.createStatusReducer(a.ActionTypes),d=s.createActionReducer(),m=s.createReducerFrom(d(a.ActionTypes.SetContext,(function(e,t){return t?n.__assign(n.__assign({},t),{status:c.Comments2ContextStatus.Pending}):void 0})),d(a.ActionTypes.SetContextStatus,(function(e,t){return n.__assign(n.__assign({},e),{status:t})})));function p(e,t,n){return e.map((function(e){return e.id===t?n(e):e}))}function _(e,t,a){var i=e.threads[t];return i?(function(e,t){var r;return n.__assign(n.__assign({},e),{threads:n.__assign(n.__assign({},e.threads),(r={},r[t.id]=t,r))})})(e,r.assignIn({},i,a)):e}function g(e,t,r,a){var i,o=t.threads[r];return o?_(t,r,o.pending?n.__assign(n.__assign({},o),((i={})[a]=o.pending.originalValue,i.pending=n.__assign(n.__assign({},o.pending),{error:e}),i)):o):t}function f(e,t,n,r){var a=e.threads[n];return a?_(e,n,{comments:p(a.comments,t,r)}):e}function v(e,t,r,a,i){return f(t,r,a,(function(t){var r;return t.pending?n.__assign(n.__assign({},t),((r={})[i]=t.pending.originalValue,r.pending=n.__assign(n.__assign({},t.pending),{error:e}),r)):t}))}var h=s.createActionReducer(),S=s.createReducerFrom(h(a.ActionTypes.ActivateThread,(function(e,t){var r=t.thread,a=t.pendingAnnotationInfo,i=t.wasPreviewLayerClick;return n.__assign(n.__assign({},e),{activatedThreadId:r.id,documentRectangleToMakeVisible:i?void 0:o.documentRectangleFromThread(r),pendingAnnotationInfo:a||e.pendingAnnotationInfo})})),h(a.ActionTypes.DeactivateAllThreads,(function(e){return r.assignIn({},e,{activatedThreadId:void 0,activatedDocumentAnnotationRectangle:void 0})})),h(a.ActionTypes.ListComments,{Success:function(e,t,r){var a=n.__assign(n.__assign({},e.authors),u.usersToIUserMap(t.authors)),i=n.__assign(n.__assign({},e.threads),u.threadsToIThreadMap(t.threads,a,t.currentRevision));return n.__assign(n.__assign({},e),{threads:i,authors:a,cursor:t.cursor,listCommentsError:void 0})},Error:function(e,t,r){return n.__assign(n.__assign({},e),{listCommentsError:t})}}),h(a.ActionTypes.CreateThread,{Request:function(e,t,r){var i,s=new Date,c=r.annotation,u=r.author,l=r.content,d=r.guid,m={id:d,timestamp:s,read:!0,readonly:!0,isThirdParty:!1,resolved:!1,comments:[{id:d,threadId:d,timestamp:s,author:u,content:l,revisionInfo:{isCurrent:!0},userPermissions:{canDelete:!1,canEdit:!1}}],annotation:c},p=n.__assign(n.__assign({},m),{pending:{action:a.ActionTypes.CreateThread.name,originalValue:void 0,pendingValue:m}}),_=e.pendingAnnotationInfo.annotationMayBeOffscreen?o.documentRectangleFromThread(m):void 0;return n.__assign(n.__assign({},e),{activatedThreadId:d,documentRectangleToMakeVisible:_,threads:n.__assign(n.__assign({},e.threads),(i={},i[d]=p,i))})},Success:function(e,t,r){var a,i=r.guid,o=e.threads,s=i,c=o[s],u=n.__rest(o,["symbol"==typeof s?s:s+""]),l=p(c.comments,i,(function(e){return n.__assign(n.__assign({},e),{id:t.id,userPermissions:{canDelete:!0,canEdit:!(e.content.metadata[0]&&"sticker"===e.content.metadata[0].type)},readonly:!1})}));return n.__assign(n.__assign({},e),{activatedThreadId:e.activatedThreadId===r.guid?t.id:e.activatedThreadId,threads:n.__assign(n.__assign({},u),(a={},a[t.id]=n.__assign(n.__assign({},c),{id:t.id,comments:l,pending:void 0}),a))})},Error:function(e,t,r){var a=e.threads,i=r.guid,o=(a[i],n.__rest(a,["symbol"==typeof i?i:i+""]));return n.__assign(n.__assign({},e),{threads:o})}}),h(a.ActionTypes.ReplyToThread,{Request:function(e,t,r){var i,o=new Date,s=r.author,c=r.content,u=r.guid,l=r.threadId,d={id:u,threadId:l,timestamp:o,author:s,content:c,revisionInfo:{isCurrent:!0},userPermissions:{canDelete:!1,canEdit:!1}},m=e.threads[l],p=n.__assign(n.__assign({},m),{read:!0,comments:n.__spreadArrays(m.comments,[d])}),_=n.__assign(n.__assign({},p),{pending:{action:a.ActionTypes.ReplyToThread.name,originalValue:m,pendingValue:p}});return n.__assign(n.__assign({},e),{activatedThreadId:l,threads:n.__assign(n.__assign({},e.threads),(i={},i[l]=_,i))})},Success:function(e,t,r){var a,i=r.guid,o=r.threadId,s=e.threads[o],c=p(s.comments,i,(function(e){return n.__assign(n.__assign({},e),{id:t.id,userPermissions:{canDelete:!0,canEdit:!(e.content.metadata[0]&&"sticker"===e.content.metadata[0].type)}})}));return n.__assign(n.__assign({},e),{threads:n.__assign(n.__assign({},e.threads),(a={},a[o]=n.__assign(n.__assign({},s),{comments:c,pending:void 0}),a))})},Error:function(e,t,r){var a,i=e.threads[r.threadId],o=i.comments.filter((function(e){return e.id!==r.guid}));return n.__assign(n.__assign({},e),{threads:n.__assign(n.__assign({},e.threads),(a={},a[r.threadId]=n.__assign(n.__assign({},i),{comments:o,pending:void 0}),a))})}}),h(a.ActionTypes.DeleteComment,{Request:function(e,t,r){return f(e,r.commentId,r.threadId,(function(e){return n.__assign(n.__assign({},e),{deleted:!0,pending:{action:a.ActionTypes.DeleteComment.name,originalValue:e.deleted,pendingValue:!0}})}))},Success:function(e,t,r){return f(e,r.commentId,r.threadId,(function(e){return n.__assign(n.__assign({},e),{pending:void 0})}))},Error:function(e,t,n){return v(t,e,n.commentId,n.threadId,"deleted")}}),h(a.ActionTypes.EditComment,{Request:function(e,t,r){return f(e,r.commentId,r.threadId,(function(e){return n.__assign(n.__assign({},e),{content:r.content,pending:{action:a.ActionTypes.EditComment.name,originalValue:e.content,pendingValue:r.content}})}))},Success:function(e,t,r){return f(e,r.commentId,r.threadId,(function(e){return n.__assign(n.__assign({},e),{pending:void 0})}))},Error:function(e,t,n){return v(t,e,n.commentId,n.threadId,"content")}}),h(a.ActionTypes.SetPerfData,(function(e,t){return n.__assign(n.__assign({},e),{perfEvents:n.__assign(n.__assign({},e.perfEvents),t)})})),h(a.ActionTypes.CheckOnboardingStatus,(function(e,t){return n.__assign(n.__assign({},e),{onboardingVariants:{premium_av_comments_pane_surface:!1===t.premium_av_comments_pane_surface,premium_av_preview_surface:!1===t.premium_av_preview_surface,non_premium_av_comments_pane_surface:!1===t.non_premium_av_comments_pane_surface,not_annotatable_file_comments_pane_surface:!1===t.not_annotatable_file_comments_pane_surface,how_to_at_mention_comments_pane_surface:!1===t.how_to_at_mention_comments_pane_surface,image_preview_surface:!1===t.image_preview_surface,document_preview_surface:!1===t.document_preview_surface,share_as_comment:!1===t.share_as_comment}})})),h(a.ActionTypes.MarkOnboarded,(function(e,t,r){var a;return n.__assign(n.__assign({},e),{onboardingVariants:n.__assign(n.__assign({},e.onboardingVariants),(a={},a[r]=!1,a))})})),h(a.ActionTypes.MarkModalVariantShown,(function(e,t){var r;return n.__assign(n.__assign({},e),{modalVariantsShown:n.__assign(n.__assign({},e.modalVariantsShown),(r={},r[t]=!0,r))})})),h(a.ActionTypes.DismissOnboarding,(function(e){return n.__assign(n.__assign({},e),{onboardingVariants:r.mapValues(e.onboardingVariants,(function(){return!1}))})})),h(a.ActionTypes.MarkThreadRead,{Request:function(e,t,n){return _(e,n.threadId,{read:!0,pending:{action:a.ActionTypes.MarkThreadRead.name,originalValue:e.threads[n.threadId].read,pendingValue:!0}})},Success:function(e,t,n){return _(e,n.threadId,{pending:void 0})},Error:function(e,t,n){return g(t,e,n.threadId,"read")}}),h(a.ActionTypes.MarkThreadUnread,{Request:function(e,t,n){return _(e,n,{read:!1,pending:{action:a.ActionTypes.MarkThreadUnread.name,originalValue:e.threads[n].read,pendingValue:!1}})},Success:function(e,t,n){return _(e,n,{pending:void 0})},Error:function(e,t,n){return g(t,e,n,"read")}}),h(a.ActionTypes.MarkThreadResolved,{Request:function(e,t,n){var r={type:"with_details",resolver:n.resolver,resolvedTimestamp:new Date};return _(e,n.threadId,{resolvedInfo:r,pending:{action:a.ActionTypes.MarkThreadResolved.name,originalValue:e.threads[n.threadId].resolvedInfo,pendingValue:r}})},Success:function(e,t,n){return _(e,n.threadId,{pending:void 0})},Error:function(e,t,n){return g(t,e,n.threadId,"resolvedInfo")}}),h(a.ActionTypes.MarkThreadUnresolved,{Request:function(e,t,n){return _(e,n,{resolvedInfo:void 0,pending:{action:a.ActionTypes.MarkThreadUnresolved.name,originalValue:e.threads[n].resolvedInfo,pendingValue:void 0}})},Success:function(e,t,n){return _(e,n,{pending:void 0})},Error:function(e,t,n){return g(t,e,n,"resolvedInfo")}}),h(a.ActionTypes.SetContext,(function(e,t){return n.__assign(n.__assign({},e),r.pick(i.INITIAL_STATE.data,"activatedThreadId","authors","cursor","documentMetadata","enabledStatus","pendingAnnotationInfo","playerIntegrationEnabled","requestEditorFocus","canSeeCommentEditor","subscriptionStatus","threads"))})),h(a.ActionTypes.ToggleShowResolved,(function(e){return n.__assign(n.__assign({},e),{showResolved:!e.showResolved})})),h(a.ActionTypes.UpdateEditorIsEmpty,(function(e,t){return n.__assign(n.__assign({},e),{editorIsEmpty:t})})),h(a.ActionTypes.UpdateDocumentCurrentPage,(function(e,t){return n.__assign(n.__assign({},e),{pendingAnnotationInfo:n.__assign(n.__assign({},e.pendingAnnotationInfo),{currentPageNumber:t})})})),h(a.ActionTypes.UpdatePlayerCurrentTime,(function(e,t){return n.__assign(n.__assign({},e),{pendingAnnotationInfo:n.__assign(n.__assign({},e.pendingAnnotationInfo),{playerCurrentTime:t})})})),h(a.ActionTypes.HoverThread,(function(e,t){return n.__assign(n.__assign({},e),{hoverThreadId:t})})),h(a.ActionTypes.FocusThread,(function(e,t){return n.__assign(n.__assign({},e),{focusedThreadId:t})})),h(a.ActionTypes.SetPendingNumberedAnnotation,(function(e,t){return n.__assign(n.__assign({},e),{pendingAnnotationInfo:n.__assign(n.__assign({},e.pendingAnnotationInfo),{numberedAnnotation:t,annotationMayBeOffscreen:!1})})})),h(a.ActionTypes.ClearPendingNumberedAnnotation,(function(e,t){return n.__assign(n.__assign({},e),{pendingAnnotationInfo:n.__assign(n.__assign({},e.pendingAnnotationInfo),{numberedAnnotation:void 0,annotationMayBeOffscreen:!1})})})),h(a.ActionTypes.SetPendingNumberedAnnotationMayBeOffscreen,(function(e){return n.__assign(n.__assign({},e),{pendingAnnotationInfo:n.__assign(n.__assign({},e.pendingAnnotationInfo),{annotationMayBeOffscreen:!0})})})),h(a.ActionTypes.TrackSidebarCommentsVisibility,(function(e,t){return n.__assign(n.__assign({},e),{visibleInSidebar:t})})),h(a.ActionTypes.DocMetadataLoad,(function(e,t){return n.__assign(n.__assign({},e),{documentMetadata:t})})),h(a.ActionTypes.RequestEditorFocus,(function(e){return n.__assign(n.__assign({},e),{requestEditorFocus:!0})})),h(a.ActionTypes.FulfillEditorFocusRequest,(function(e){if(!e.requestEditorFocus)throw new Error("Fulfilling request for editor focus, but isnt requested in store");return n.__assign(n.__assign({},e),{requestEditorFocus:!1})})),h(a.ActionTypes.EnablePlayerIntegration,(function(e,t){return n.__assign(n.__assign({},e),{playerIntegrationEnabled:!0})})),h(a.ActionTypes.SetUpsellTooltipVariant,(function(e,t){return n.__assign(n.__assign({},e),{upsellTooltipVariant:t})})),h(a.ActionTypes.SetThirdPartySource,(function(e,t){return n.__assign(n.__assign({},e),{thirdPartySource:t})})),h(a.ActionTypes.SetCanSeeCommentEditor,(function(e,t){return n.__assign(n.__assign({},e),{canSeeCommentEditor:t})})),h(a.ActionTypes.RecordEnabledStatus,(function(e,t){return n.__assign(n.__assign({},e),{enabledStatus:r.merge({},e.enabledStatus,t)})})),h(a.ActionTypes.SetSubscriptionStatus,(function(e,t){return n.__assign(n.__assign({},e),{subscriptionStatus:t})})),h(a.ActionTypes.Subscribe,(function(e){return n.__assign(n.__assign({},e),{subscriptionStatus:r.merge({},e.subscriptionStatus,{isSubscribed:!0})})})),h(a.ActionTypes.Unsubscribe,(function(e){return n.__assign(n.__assign({},e),{subscriptionStatus:r.merge({},e.subscriptionStatus,{isSubscribed:!1})})})),h(a.ActionTypes.ResetStore,(function(e,t){return n.__assign({},i.INITIAL_STATE.data)})),h(a.ActionTypes.GetStickers,(function(e,t){return n.__assign(n.__assign({},e),{stickers:t.sticker_sets})})));t.reducer=function(e,t){void 0===e&&(e=i.INITIAL_STATE);var n=m(e.context,t),r=S(e.data,t),a=l(e.statuses,t);return n!==e.context||r!==e.data||a!==e.statuses?{context:n,data:r,statuses:a}:e}})),define("modules/clean/react/comments2/data/action_helper",["require","exports","tslib","modules/clean/react/comments2/data/selectors","modules/clean/react/comments2/util"],(function(e,t,n,r,a){"use strict";function i(e){return{error:e+".Error",request:e+".Request",success:e+".Success"}}function o(e){return{actionTypes:i(e),name:e,type:"async"}}function s(e){return{actionType:e,name:e,type:"sync",zero:!1}}function c(e){return{actionType:e,name:e,type:"sync",zero:!0}}function u(){var e=this;return function(t,i){return n.__awaiter(e,void 0,void 0,(function(){var e,o,s,c,u,l,d;return n.__generator(this,(function(n){switch(n.label){case 0:return e=i.action,o=i.args,s=i.dispatch,c=i.context,u=i.getState,a.isContextSame(c,r.getContext(u()))?[3,2]:[4,t(i)];case 1:return[2,n.sent()];case 2:s({type:e.actionTypes.request,payload:o,meta:{args:o}}),n.label=3;case 3:return n.trys.push([3,5,,6]),[4,t(i)];case 4:return l=n.sent(),s({type:e.actionTypes.success,payload:l,meta:{args:o}}),[2,l];case 5:throw d=n.sent(),s({type:e.actionTypes.error,error:d,meta:{args:o}}),d;case 6:return[2]}}))}))}}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),t.syncReduxAction=function(e,t){return e.zero?{type:e.actionType}:{type:e.actionType,payload:t}},t.requestReduxAction=function(e,t){return{type:e.actionTypes.request,payload:t,meta:{args:t}}},t.successReduxAction=function(e,t,n){return{type:e.actionTypes.success,payload:n,meta:{args:t}}},t.errorReduxAction=function(e,t,n){return{type:e.actionTypes.error,error:n,meta:{args:t}}},t.asyncActionConstants=i,t.asyncAction=o,t.syncAction=s,t.syncAction0=c,t.namespacedActions=function(e){return{asyncAction:function(t){return o(e+"/"+t)},syncAction:function(t){return s(e+"/"+t)},syncAction0:function(t){return c(e+"/"+t)}}},t.syncHandler=function(e){return e.zero?function(){return{type:e.name}}:function(t){return{payload:t,type:e.name}}},t.createAsyncHandler=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t,a){return function(i){return function(o,s){return n.__awaiter(void 0,void 0,void 0,(function(){var c,u;return n.__generator(this,(function(l){switch(l.label){case 0:c=r.getContext(s()),u=e.reduceRight((function(e,t){return function(r){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,t(e,r)];case 1:return[2,n.sent()]}}))}))}}),(function(e){return a(i,e)})),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,u({action:t,args:i,dispatch:o,getState:s,context:c})];case 2:return[2,l.sent()];case 3:return l.sent(),[3,4];case 4:return[2]}}))}))}}}},t.dispatchMiddleware=u,t.thunkHandler=t.createAsyncHandler(),t.asyncHandler=t.createAsyncHandler(u())})),define("modules/clean/react/file_activity_stream/tti_logger",["require","exports","modules/clean/react/file_sidebar/file_sidebar_logger"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){this.hasLogged=!1}return e.prototype.recordStart=function(e){this.startTs=(new Date).getTime(),this.fileId=e,this.hasLogged=!1},e.prototype.recordInteractive=function(e){if(!this.hasLogged&&e===this.fileId&&this.startTs){var t=(new Date).getTime();n.logActivityStreamInteractivity({time_start:this.startTs,time_interactive:t}),this.hasLogged=!0}},e})();t.faStreamTTILogger=new r})),define("modules/clean/react/file_sidebar/store/sidebar/reactors",["require","exports","tslib","modules/clean/react/file_sidebar/file_sidebar_logger","modules/clean/react/file_sidebar/store/sidebar/selectors","modules/clean/react/file_sidebar/store/file_activity/selectors"],(function(e,t,n,r,a,i){"use strict";function o(e){var t=a.getSidebarState(e),n=t.open,r=t.ready;return n&&r}function s(e){return!o(e)}function c(e){var t=a.getSidebarContext(e).user;r.logSidebarOpened({reason:a.getOpenReason(e),num_comments:a.getTabState(e,"comments").extra.commentCount,num_events:i.getVisibleActivityCount(e),viewing_user_id:t?t.id:null})}Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),i=n.__importStar(i),t.reactors=function(e){e({changesFrom:s,changesTo:o},(function(e){c(e.nextState)})),e({changes:function(e,t){if(o(e)&&o(t)){var n=t.sidebar.tabs,r=e.sidebar.tabs;return!(r.activity.ready&&r.comments.ready)&&n.activity.ready&&n.comments.ready}return!1}},(function(e){c(e.nextState)}))}})),define("modules/clean/react/workflows/markup/markup_layer",["require","exports","tslib","react","react-redux","external/lodash","modules/clean/react/workflows/markup/fabric_wrapper","modules/clean/react/css","modules/clean/react/workflows/markup/selectors","modules/clean/react/file_viewer/data/actions","modules/clean/react/workflows/markup/types","modules/clean/react/workflows/markup/fabric"],(function(e,t,n,r,a,i,o,s,c,u,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSelectionChange=function(e){if(e.selected){var n=e.selected,r=n.some((function(e){return["circle","rect"].includes(e.type||"")}))?[l.FormatSubmenuEntry.FILL,l.FormatSubmenuEntry.STROKE]:[l.FormatSubmenuEntry.STROKE];t.props.setMarkupFormatSubmenu(r);var a=n.filter((function(e){return d.getStroke(e)})),i=d.getStroke(a[0]),o=a.every((function(e){return d.getStroke(e)===i})),s=n.filter((function(e){return d.getFill(e)})),c=d.getFill(s[0]),u=s.every((function(e){return d.getFill(e)===c}));i&&o&&t.props.setMarkupStroke(i),c&&u&&t.props.setMarkupFill(c)}},t.handleObjectMoving=function(e){var t=e.target;if(t&&t.canvas&&null!=t.top&&null!=t.left){t.setCoords();var n=t.canvas.getWidth(),r=t.canvas.getHeight(),a=t.getBoundingRect().width,i=t.getBoundingRect().height,o=t.getBoundingRect().top,s=t.getBoundingRect().left;if(!(i>r||a>n)){var c=.9*a,u=.9*i,l=Math.max(t.top,t.top-o-u),d=Math.max(t.left,t.left-s-c);t.top=Math.min(l,r+u-i+t.top-o),t.left=Math.min(d,n+c-a+t.left-s),t.setCoords()}}},t}return n.__extends(t,e),t.prototype.componentDidMount=function(){var e=this.createFabricCanvas(),t=this.props.markupState[this.props.page];t&&t.fabric&&e.loadFromJSON(t.fabric.toJSON(),(function(){e.requestRenderAll()})),this.props.setMarkupCanvas(this.props.page,e,this.getCanvasSize().scale)},t.prototype.createFabricCanvas=function(){var e=new o.fabric.Canvas(this.canvasId);return e.on("selection:updated",this.handleSelectionChange),e.on("selection:created",this.handleSelectionChange),e.on("object:moving",this.handleObjectMoving),e.isDrawingMode=this.props.markupState.isDrawingMode,e},t.prototype.componentDidUpdate=function(){var e=this.props,t=e.markupState,n=e.page,r=this.getCanvasSize(),a=r.width,i=r.height,o=r.scale,s=t[n]&&t[n].fabric;if(s)s.setDimensions({width:a,height:i}),this.props.updateMarkupCanvasScale(n,o);else{var c=this.createFabricCanvas();this.props.setMarkupCanvas(n,c,o)}},t.prototype.shouldComponentUpdate=function(e){return this.props.page!==e.page||!i.isEqual(this.props.pageDimensions,e.pageDimensions)||!i.isEqual(this.props.layerSize,e.layerSize)},t.prototype.getCanvasSize=function(){var e=this.props.layerSize.width,t=this.props.pageDimensions||this.props.layerSize,n=t.width,r=t.height,a=e/n;return{width:Math.round(n*a),height:Math.round(r*a),scale:a}},t.prototype.render=function(){var e=this.getCanvasSize(),t=e.width,n=e.height,a={width:t+"px",height:n+"px"};return this.canvasId="markup-canvas"+this.props.page,r.default.createElement("div",{className:"fv-markup-layer",style:a},r.default.createElement("canvas",{id:this.canvasId,width:t,height:n}))},t})((r=n.__importDefault(r)).default.Component);t._MarkupLayer=m;t.ConnectedMarkupLayer=a.connect((function(e){return{markupState:c.getMarkupState(e)}}),{setMarkupCanvas:u.setMarkupCanvas,updateMarkupCanvasScale:u.updateMarkupCanvasScale,setMarkupFormatSubmenu:u.setMarkupFormatSubmenu,setMarkupFill:u.setMarkupFill,setMarkupStroke:u.setMarkupStroke})(m);var p=s.requireCssWithComponent(t.ConnectedMarkupLayer,["/static/css/file_viewer/markup_layer-vfl8rimjm.css"]);t.MarkupLayer=p})),define("modules/clean/previews/pending_upload_watcher",["require","exports","tslib","modules/clean/ajax","modules/clean/react/file_viewer/data/actions","modules/core/browser","modules/core/uri"],(function(e,t,n,r,a,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),i=n.__importStar(i);var s=(function(){function e(e,t,n){void 0===n&&(n=""),this.pollUrl=new o.URI({path:"/sp/"}).updateQuery({link_type:e,link_key:t,secure_hash:n}).toString()}return e.prototype.startPolling=function(){this.pollPending()},e.prototype.pollSuccess=function(e){var t=JSON.parse(e);t.hasOwnProperty("upload_status")&&"complete"===t.upload_status?a.pendingFileUploaded():setTimeout(this.pollPending.bind(this),2e3)},e.prototype.pollFailure=function(e){e.status<400||e.status>=500?this.retryPoll():i.reload(!0)},e.prototype.retryPoll=function(){setTimeout(this.pollPending.bind(this),2e3)},e.prototype.pollPending=function(){var e=this;r.SilentBackgroundRequest({url:this.pollUrl,success:function(t){e.pollSuccess(t)},error:function(t){e.pollFailure(t)}})},e})();t.PendingUploadWatcher=s})),define("modules/clean/react/open_in_app/button",["require","exports","tslib","react","spectrum/button","modules/clean/open_in_app/actions","modules/core/i18n","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants"],(function(e,t,n,r,a,i,o,s,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleClick=function(){s.logUserAction(c.UserAction.OpenInApp,n.props.userActionContext),i.openInApp(n.props.urls,{onAppNeeded:function(){return n.setState({showInstallAppText:!0})},onAppInstalled:function(){return n.setState({showInstallAppText:!1})}})},n.state={showInstallAppText:!1},n}return n.__extends(t,e),t.prototype.componentWillUnmount=function(){i.cleanUp()},t.prototype.render=function(){return r.default.createElement(a.Button,{className:"control__button open-in-app-button",variant:"primary",onClick:this.handleClick},this.state.showInstallAppText?o.intl.formatMessage({id:"RgopQo",defaultMessage:"Install app?"}):o.intl.formatMessage({id:"B9kRrE",defaultMessage:"Open in app"}))},t})((r=n.__importDefault(r)).default.Component);t.OpenInAppButton=u})),define("modules/clean/react/comments2/data/selectors",["require","exports","tslib","external/lodash","reselect","modules/clean/redux/selectors","modules/clean/redux/namespaces","modules/clean/react/comments2/data/types","modules/clean/react/comments2/data/util","modules/clean/react/comments2/util","modules/clean/react/file_viewer/data/selectors","modules/clean/previews/constants","modules/clean/previews/data/preview_type_util","modules/clean/react/file_viewer/data/selectors","comments2/transforms"],(function(e,t,n,r,a,i,o,s,c,u,l,d,m,p,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),u=n.__importStar(u),p=n.__importStar(p);t.IMAGE_SENTINEL="IMAGE_SENTINEL",t.getState=function(e){return i.getStateAtNamespace(e,o.COMMENTS2_NAMESPACE_KEY)};t.getContext=function(e){var n=t.getState(e).context;return n?{stream:n.stream,viewer:n.viewer}:void 0},t.getContextStatus=function(e){var n=t.getState(e).context;return n?n.status:void 0};var g=a.createSelector(t.getContextStatus,(function(e){return e===s.Comments2ContextStatus.FullyEnabled})),f=a.createSelector(t.getContextStatus,(function(e){return e===s.Comments2ContextStatus.ReadOnly}));function v(e){return m.getPreviewType(p.getPreviewApiDataForCurrentFile(e))}function h(e){return a.createSelector(t.getData,(function(t){return t[e]}))}t.isEnabled=a.createSelector([g,f],(function(e,t){return e||t})),t.getFQPath=function(e){var n=t.getContext(e);return n?n.stream.fq_path:void 0},t.getViewer=function(e){var n=t.getContext(e);return n?n.viewer:void 0},t.getViewerId=function(e){var n=t.getViewer(e);return n?n.id:void 0},t.canCreateAnnotations=function(e){var n=t.getContext(e);return!(!n||!n.viewer)&&!u.isComments2Mobile()&&t.getVisibleInSidebar(e)},t.getPreviewTypeForCurrentFile=v,t.getIsComments2Ready=function(e){var t=e[o.COMMENTS2_NAMESPACE_KEY];return!(!t||!t.context||t.context.status!==s.Comments2ContextStatus.FullyEnabled&&t.context.status!==s.Comments2ContextStatus.ReadOnly)},t.getData=function(e){return t.getState(e).data},t.getRevision=a.createSelector(t.getContext,(function(e){return e&&_.streamToRevision(e.stream)})),t.getSort=a.createSelector(v,(function(e){switch(e){case d.PreviewType.Audio:case d.PreviewType.Video:return s.SortType.VideoTimeCode;default:return s.SortType.Chronological}})),t.getEditorIsEmpty=h("editorIsEmpty"),t.getThreadMap=h("threads");var S=a.createSelector(t.getThreadMap,(function(e){return r.values(e)})),b=a.createSelector(t.getContext,(function(e){return e&&e.stream.isVersionHistoryMode}));function w(e){return t.isEnabled(e)&&!u.isComments2Mobile()&&(function(e){var n=t.getData(e).onboardingVariants;switch(v(e)){case d.PreviewType.Audio:case d.PreviewType.Video:return t.getIsPlayerIntegrationEnabled(e)?n.premium_av_comments_pane_surface:n.non_premium_av_comments_pane_surface;case d.PreviewType.SsrDoc:return n.document_preview_surface||n.how_to_at_mention_comments_pane_surface;case d.PreviewType.Image:return n.image_preview_surface||n.how_to_at_mention_comments_pane_surface;case void 0:return!1;default:return n.not_annotatable_file_comments_pane_surface}})(e)}t.getThreads=a.createSelector([S,t.getSort,b,t.getRevision],(function(e,t,a,i){var o=(function(e,t){switch(t){case s.SortType.Chronological:return r.sortBy(e,[function(e){return e.timestamp.getTime()}]);case s.SortType.VideoTimeCode:var a=r.groupBy(e,(function(e){return e.annotation?"video":"global"})),i=a.video,o=a.global;return n.__spreadArrays(r.sortBy(i,[function(e){return e.annotation.time},function(e){return e.timestamp.getTime()}]),r.sortBy(o,[function(e){return e.timestamp.getTime()}]))}})(e,t);return a?(function(e,t){return e.filter((function(e){var n=e.comments[0].revisionInfo;return n.isCurrent||!t||n.revision&&n.revision.nsId===t.ns_id&&n.revision.sjId<=t.sjid}))})(o,i):o})),t.getCursor=h("cursor"),t.getUnmarkedOnboardingKeysRelevantToCurrentFile=function(e){var n,r=t.getData(e).onboardingVariants;switch(v(e)){case d.PreviewType.SsrDoc:n=["document_preview_surface","how_to_at_mention_comments_pane_surface"];break;case d.PreviewType.Image:n=["image_preview_surface","how_to_at_mention_comments_pane_surface"];break;case d.PreviewType.Audio:case d.PreviewType.Video:n=t.getIsPlayerIntegrationEnabled(e)?["premium_av_comments_pane_surface","premium_av_preview_surface"]:["non_premium_av_comments_pane_surface"];break;case void 0:return[];default:n=["not_annotatable_file_comments_pane_surface"]}return n.filter((function(e){return r[e]}))},t.getShowOnboardingOnVideo=function(e){var n=t.getData(e).onboardingVariants,r=!l.getIsMediaPlaying(e),a=l.getPauseCount(e);return t.isEnabled(e)&&!u.isComments2Mobile()&&t.getIsPlayerIntegrationEnabled(e)&&r&&!w(e)&&n.premium_av_preview_surface&&a%5==1&&a<15},t.getShowShareAsCommentOnboarding=function(e){return t.getData(e).onboardingVariants.share_as_comment},t.getShowOnboardingOnCommentsPane=w,t.getOnboardingVariants=function(e){return t.getData(e).onboardingVariants},t.getHasShownAnyModalVariant=function(e){var n=t.getData(e).modalVariantsShown;return n[s.ModalVariant.EmailVerifyModal]||n[s.ModalVariant.SignUpModal]},t.getActivatedThreadId=h("activatedThreadId");var y=a.createSelector(t.getActivatedThreadId,t.getThreadMap,(function(e,t){return e&&t[e]}));t.getActivatedTimecodeThread=function(e){var t=y(e);return t&&c.isThreadWithTimecodeAnnotation(t)?t:void 0};var T=h("documentRectangleToMakeVisible");t.getDocumentRectangleToMakeVisibleIfComments2Ready=function(e){return t.getIsComments2Ready(e)?T(e):void 0},t.getListCommentsError=h("listCommentsError"),t.getHoverThreadId=h("hoverThreadId"),t.getFocusedThreadId=h("focusedThreadId"),t.getUnresolvedTimecodeThreads=function(e){return(function(e){return t.getThreads(e).filter((function(e){return!e.resolvedInfo}))})(e).filter((function(e){var t=e.annotation;return t&&("video"===t.type||"audio"===t.type)}))},t.getShowResolved=h("showResolved"),t.getStatuses=function(e){return t.getState(e).statuses},t.getIsPlayerIntegrationEnabled=h("playerIntegrationEnabled"),t.getStickers=function(e){return t.getData(e).stickers},t.getCanEnable=function(e){return t.getData(e).enabledStatus.canEnable},t.getCanSubscribe=function(e){return t.getData(e).subscriptionStatus.canSubscribe},t.getIsSubscribed=function(e){return t.getData(e).subscriptionStatus.isSubscribed},t.getStream=function(e){var n=t.getContext(e);return n&&n.stream},t.getStreamId=function(e){var n=t.getContext(e);return n&&n.stream.id};var M=h("pendingAnnotationInfo");function A(e){return M(e).numberedAnnotation}t.getPlayerCurrentTime=function(e){return M(e).playerCurrentTime},t.getCurrentPageNumber=function(e){return M(e).currentPageNumber},t.getPendingNumberedAnnotation=A,t.getHasPendingNumberedAnnotation=function(e){return t.getIsComments2Ready(e)&&!!A(e)},t.getVisibleInSidebar=h("visibleInSidebar");var C=a.createSelector([t.getVisibleInSidebar,t.isEnabled,t.getShowResolved,S],(function(e,t,n,r){return e&&t?(n?r:r.filter((function(e){return!e.resolvedInfo}))).filter((function(e){return e.comments.some((function(e){return!e.deleted}))})):[]})),E=a.createSelector(C,(function(e){return e.filter(c.isThreadWithDocumentAnnotation)})),k=a.createSelector(E,(function(e){return r.groupBy(e,(function(e){return e.annotation.regions[0].page}))}));function I(e,t){return r.get(k(e),t,[])}function P(e){var t=e.annotation;return!!t&&("document"===t.type||"image"===t.type)}function F(e){return C(e).filter((function(e){return e&&void 0!==e.annotation&&"image"===e.annotation.type}))}t.getDisplayedThreadsForLayer=function(e,t){return void 0===t?F(e):I(e,t)},t.getDisplayedThreadsWithDocumentAnnotationsOnPage=I,t.getDisplayedThreadsWithImageAnnotations=F,t.getDisplayedThreadsWithNumberedAnnotations=function(e){return C(e).filter(P)};var R=h("canSeeCommentEditor");t.getStreamSettings=a.createSelector([g,t.getViewer,R],(function(e,t,n){return{canComment:e,canModifyThreads:n&&!!t,canShowEditor:n}})),t.getDocumentMetadata=function(e){switch(v(e)){case d.PreviewType.SsrDoc:return t.getData(e).documentMetadata;case d.PreviewType.Image:return t.IMAGE_SENTINEL;default:return}},t.getIsEditorFocusRequested=h("requestEditorFocus"),t.getThirdPartySource=h("thirdPartySource")})),define("modules/clean/react/comments2/data/actions",["require","exports","tslib","external/lodash","modules/core/browser","modules/core/i18n","modules/clean/redux/types","modules/clean/react/comments2/data/api","file-viewer/core","modules/clean/react/file_sidebar/store/instance","comments2/transforms","modules/clean/react/comments2/data/types","modules/clean/react/comments2/components/snackbars","modules/clean/react/comments2/util","modules/clean/react/comments2/data/logger","modules/clean/react/comments2/data/perf_util","modules/clean/react/comments2/data/selectors","comments2/components/utils/throttle-debounce","modules/clean/bolt","modules/clean/browse_interface","modules/clean/react/comments2/data/action_helper","modules/clean/react/file_sidebar/store/sidebar/actions","modules/clean/react/file_viewer/data/actions"],(function(e,t,n,r,a,i,o,s,c,u,l,d,m,p,_,g,f,v,h,S,b,w,y){"use strict";function T(e){var t=this,r=e.clientFn,a=e.successCallback,i=e.eventToLog;return function(e,o){return n.__awaiter(t,void 0,void 0,(function(){var t,c,u;return n.__generator(this,(function(n){switch(n.label){case 0:if(!(t=f.getContext(o()))||!t.viewer)throw new Error;c=new s.Comments2Api(t.viewer.id,t.stream),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,r(c)];case 2:return u=n.sent(),_.logEvent(i,{stream:t.stream}),a(e,o,u),[3,4];case 3:return n.sent(),_.logErrorEvent("error trying to execute client event "+i,{stream:t.stream}),[3,4];case 4:return[2]}}))}))}}function M(e){return function(n,r){n(Y(e));var a=e.thread,i=r(),o=f.getStream(i);_.logEvent("activate_thread",{stream:o,thread:a}),a.read||a.readonly||n(t.Actions.markThreadRead({threadId:a.id,origin:d.MarkThreadReadOrigin.ThreadActivated}))}}function A(){return T({clientFn:function(e){return e.enableCommenting()},successCallback:C,eventToLog:"enable_comments"})}function C(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return f.getStreamId(t())!==r.id?[2]:[4,e(j(d.Comments2ContextStatus.Pending))];case 1:return n.sent(),e(G(!0,!1)),[2]}}))}))}function E(){return T({clientFn:function(e){return e.disableCommenting()},successCallback:k,eventToLog:"disable_comments"})}function k(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){var a;return n.__generator(this,(function(n){return f.getStreamId(t())!==r.id?[2]:(a=f.getContext(t()),I(e,a,!0),[2])}))}))}function I(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:return[4,e(j(d.Comments2ContextStatus.Disabled))];case 1:return t.sent(),e(y.disableMode(c.FileViewerMode.Commenting)),[4,u.store.dispatch(w.setComments2DisabledState())];case 2:return t.sent(),[2]}}))}))}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),a=n.__importStar(a),p=n.__importStar(p),_=n.__importStar(_),g=n.__importStar(g),f=n.__importStar(f),w=n.__importStar(w),t.HandleErrorArg=m.ShowErrorSnackbarArg,t.enableCommenting=A,t.disableCommenting=E,t.bolt={client:null,subscribe:function(e,n,r){var a=e.app_id,i=e.revision,o=e.token,s=e.unique_id,c=new h.SignedChannelState(a,s,i,o);t.bolt.client?t.bolt.client.update_states([c]):(t.bolt.client=new h.BoltClient([c],n,r),t.bolt.client.start())},unsubscribe:function(){t.bolt.client&&(t.bolt.client.unsubscribe(),t.bolt.client=null)}};var P=p.createBackoff(),F=P.backoff,R=P.resetBackoff;function O(e){var r=this;return function(a,i){return n.__awaiter(r,void 0,void 0,(function(){var r,o,s;return n.__generator(this,(function(n){switch(n.label){case 0:return r=i(),o=f.getContext(r),p.isContextSame(o,e)?[3,2]:(t.bolt.unsubscribe(),a(B(e)),a(We({setContextTime:+new Date,listCompleteTime:0})),e?(s=o&&o.viewer,e.viewer&&!p.isUserSame(s,e.viewer)&&a(t.Actions.checkOnboardingStatus(void 0)),f.getStickers(r)||a(t.Actions.getStickers(void 0)),[4,a(G(!0))]):[3,2]);case 1:n.sent(),n.label=2;case 2:return[2]}}))}))}}t.setFileContext=O;var x=b.namespacedActions("Comments2"),D=x.asyncAction,V=x.syncAction,U=x.syncAction0;function N(e){var t=this,r=e.handleError,a=e.handleSuccess;return function(e,o){return n.__awaiter(t,void 0,void 0,(function(){function t(){return n.__awaiter(this,void 0,void 0,(function(){var c,u,l,d;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e(o)];case 1:return c=n.sent(),[3,3];case 2:throw u=n.sent(),(l=(function(e,t){if(t instanceof s.Comments2Error&&(t.code===s.ErrorCode.FILE_NOT_FOUND||t.code===s.ErrorCode.PERMISSION_DENIED))return{message:i.intl.formatMessage({id:"CKj3RT",defaultMessage:"Either that file was deleted or you no longer have access to it."}),isRetriable:!1};switch(e){case me.name:case _e.name:case he.name:return{message:i.intl.formatMessage({id:"3hOA04",defaultMessage:"We were unable to post the comment."}),isRetriable:!0};case fe.name:return{message:i.intl.formatMessage({id:"CiZnrG",defaultMessage:"We were unable to delete the comment."}),isRetriable:!0};case Me.name:return{message:i.intl.formatMessage({id:"+YPQ5/",defaultMessage:"We were unable to resolve the thread."}),isRetriable:!0};case Ce.name:return{message:i.intl.formatMessage({id:"QUs54P",defaultMessage:"We were unable to unresolve the thread."}),isRetriable:!0};case be.name:return{message:i.intl.formatMessage({id:"Vgd16U",defaultMessage:"We were unable to mark the thread as read."}),isRetriable:!0};case ye.name:return{message:i.intl.formatMessage({id:"4apXur",defaultMessage:"We were unable to mark the thread as unread."}),isRetriable:!0};case ze.name:return{message:i.intl.formatMessage({id:"RmXnr0",defaultMessage:"We were unable to subscribe to the file."}),isRetriable:!0};case Ke.name:return{message:i.intl.formatMessage({id:"oz0V3s",defaultMessage:"We were unable to unsubscribe from the file."}),isRetriable:!0};case J.name:case oe.name:case Ne.name:default:return null}})(o.action.name,u))&&r({message:l.message,retryFn:l.isRetriable?t:void 0}),u;case 3:return(d=(function(e){switch(e){case ze.name:return{message:i.intl.formatMessage({id:"WQpgoO",defaultMessage:"You have subscribed to the file."})};case Ke.name:return{message:i.intl.formatMessage({id:"8o4LmU",defaultMessage:"You have unsubscribed from the file."})};default:return null}})(o.action.name))&&a(d),[2,c]}}))}))}return n.__generator(this,(function(e){switch(e.label){case 0:return[4,t()];case 1:return[2,e.sent()]}}))}))}}function W(){return+new Date}function L(e){var t=this;return function(r,a){return n.__awaiter(t,void 0,void 0,(function(){function t(t){var n=e(a.action.name,t);if(n){var r=W();a.dispatch(ft(n,a.context,r-i))}}var i,o,c;return n.__generator(this,(function(e){switch(e.label){case 0:i=W(),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,r(a)];case 2:return o=e.sent(),[3,4];case 3:throw c=e.sent(),t(c instanceof s.Comments2Error?c.code:"unknown_error"),c;case 4:return t(),[2,o]}}))}))}}t.statusHandlingMiddleware=N,t.perfLoggingMiddleware=L;var H=b.createAsyncHandler(N({handleError:m.showErrorSnackbar,handleSuccess:m.showSuccessSnackbar}),(function(e,t){var n=t.context;if(!n||!n.viewer)throw new Error("Bad state");var a=new s.Comments2Api(n.viewer.id,n.stream);return e(r.merge({},t,{api:a,context:n}))}),(function(e){var t=this;return function(a,i){return n.__awaiter(t,void 0,void 0,(function(){var t,s;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,a(i)];case 1:return t=n.sent(),e(r.merge({},i,{payload:t,status:o.ApiClientStatus.Success})),[2,t];case 2:throw s=n.sent(),e(r.merge({},i,{error:s,status:o.ApiClientStatus.Error})),s;case 3:return[2]}}))}))}})((function(e){var t=e.context.stream,n=f.getThreadMap(e.getState());if(e.status===o.ApiClientStatus.Error)_.logErrorEvent("encountered an error with async api call "+e.action.name,{stream:t});else if(e.status===o.ApiClientStatus.Success){var r=e.args,a=e.payload;switch(e.action.name){case me.name:var i=n[a.id];_.logEvent("new_comment",{commentId:a.id,stream:t,thread:i});break;case _e.name:i=n[r.threadId];_.logEvent("reply_to_comment",{commentId:a.id,stream:t,thread:i});break;case fe.name:i=n[r.threadId];_.logEvent("delete_comment",{commentId:r.commentId,stream:t,thread:i});break;case he.name:i=n[r.threadId];_.logEvent("edit_comment",{commentId:r.commentId,stream:t,thread:i});break;case Me.name:i=n[r.threadId];_.logEvent("resolve_thread",{stream:t,thread:i});break;case Ce.name:i=n[r];_.logEvent("unresolve_thread",{stream:t,thread:i});break;case be.name:var s=r.origin===d.MarkThreadReadOrigin.ThreadActivated?"read_thread":"mark_thread_as_read";i=n[r.threadId];_.logEvent(s,{stream:t,thread:i});break;case ye.name:i=n[r];_.logEvent("mark_thread_as_unread",{stream:t,thread:i});break;case ze.name:_.logEvent("subscribe",{stream:t});break;case Ke.name:_.logEvent("unsubscribe",{stream:t})}}})),L((function(e,t){switch(e){case me.name:case _e.name:case be.name:case ye.name:case Me.name:case Ce.name:return g.threadActionCompleted(e,t);case fe.name:case he.name:return g.commentActionCompleted(e,t)}})),b.dispatchMiddleware()),z=V("SetContext"),B=b.syncHandler(z),q=V("SetContextStatus"),j=b.syncHandler(q),K=D("ListComments"),G=function(e,r){return void 0===e&&(e=!1),void 0===r&&(r=!0),function(o,g){return n.__awaiter(void 0,void 0,void 0,(function(){var h,S,b,T,M,A,C,E,k,P,O,x,D,V,U,N,W,L,H,z,B,q,X,Y,Z,Q,J,$;return n.__generator(this,(function(n){switch(n.label){case 0:if(h=g(),!(S=f.getContext(h)))return[2];o({type:K.actionTypes.request}),b=S.stream,T=S.viewer,M=T?new s.Comments2Api(T.id,b):new s.Comments2LoggedOutApi(b),n.label=1;case 1:return n.trys.push([1,6,,7]),[4,M.listComments(e,f.getCursor(h))];case 2:if(A=n.sent(),C=A.bolt_info,E=A.cursor,k=A.status,P=A.supported_enhancements,O=A.threads,x=A.users,D=A.permissions,V=+new Date,U=f.getContextStatus(h),N=k[".tag"],W="enabled"===N||"readonly"===N,U===d.Comments2ContextStatus.Pending&&W&&(L=f.getData(h),H=L.perfEvents&&L.perfEvents.setContextTime||0,o(t.Actions.logSimplePerfEvent("initial_list_completed_ms",V-H))),z=g(),B=f.getContext(z),!p.isContextSame(B,S))return[2];if(D&&(o(Ue({canEnable:D.can_enable_commenting})),o(He({canSubscribe:D.can_subscribe,isSubscribed:D.is_subscribed})),o(De(D.can_see_comment_editor)),o(W?y.enableMode(c.FileViewerMode.Commenting):y.disableMode(c.FileViewerMode.Commenting))),P&&(q=P.third_party_source,X=P.time_based_annotations,Y=P.time_based_annotations_upsell_tooltip_variant,Z=(void 0===Y?{".tag":"other"}:Y)[".tag"],X&&o(Ie()),"other"!==Z&&o(Fe(Z)),q&&o(Oe(q[".tag"]))),Q=r?(te=/comment_id=(.*)/.exec(a.get_uri().getFragment()))?te[1]:void 0:void 0,U===d.Comments2ContextStatus.Pending)switch(k[".tag"]){case"disabled":null!=D&&D.can_enable_commenting,I(o),Q&&m.showErrorSnackbar({message:i.intl.formatMessage({id:"cwWK1c",defaultMessage:"Comments are disabled on this file."})});break;case"enabled":o(We({listCompleteTime:V})),o(j(d.Comments2ContextStatus.FullyEnabled)),u.store.dispatch(w.setComments2ShownState({commentCount:O.filter((function(e){return!e.resolved})).length}));break;case"readonly":o(We({listCompleteTime:V})),o(j(d.Comments2ContextStatus.ReadOnly)),u.store.dispatch(w.setComments2ShownState({commentCount:O.filter((function(e){return!e.resolved})).length}));break;case"comments1":o(j(d.Comments2ContextStatus.Comments1))}return f.isEnabled(h)||U===d.Comments2ContextStatus.Pending&&("enabled"===k[".tag"]||"readonly"===k[".tag"])?[4,o((ee=C,function(e){if(p.useBolt()){var n=v.debounce((function(){R(),e(G(!1,!1))}),2e3);t.bolt.subscribe(ee,n,(function(){t.bolt.unsubscribe(),F((function(){e(G(!1,!1))}))}))}}))]:[3,5];case 3:return n.sent(),J=l.streamToRevision(b),[4,o({type:K.actionTypes.success,payload:{authors:x,cursor:E,threads:O,currentRevision:J}})];case 4:n.sent(),Q&&o(t.Actions.activateComment(Q)),n.label=5;case 5:return[3,7];case 6:return($=n.sent())instanceof s.Comments2Error&&($.code===s.ErrorCode.FILE_NOT_FOUND?o(j(d.Comments2ContextStatus.Disabled)):T&&M instanceof s.Comments2Api&&_.logErrorEvent(($.message,": "+$.message),{stream:b})),o({type:K.actionTypes.error,error:$}),[3,7];case 7:return[2]}var ee,te}))}))}},X=V("ActivateThread"),Y=b.syncHandler(X),Z=U("DeactivateAllThreads"),Q=b.syncHandler(Z),J=D("CheckOnboardingStatus"),$=H(J,(function(e,t){return t.api.checkOnboardingStatus()})),ee=D("GetStickers"),te=H(ee,(function(e,t){return t.api.getStickers()})),ne=V("HoverAnnotation"),re=b.syncHandler(ne),ae=V("FocusAnnotation"),ie=b.syncHandler(ae),oe=D("MarkOnboarded"),se=H(oe,(function(e,t){return t.api.markHasOnboarded(e)})),ce=V("DismissOnboarding"),ue=b.syncHandler(ce),le=V("MarkModalVariantShown"),de=b.syncHandler(le),me=D("CreateThread"),pe=H(me,(function(e,t){var n=e.annotation,r=(e.author,e.content),a=(e.guid,e.source),i=t.api,o=t.context.stream,s=l.iCommentContentToUserSubmittedComment({annotation:n,content:r,stream:o});return i.createThread(s,a)})),_e=D("ReplyToThread"),ge=H(_e,(function(e,t){e.author;var n=e.content,r=(e.guid,e.threadId),a=t.api,i=t.context.stream,o=l.iCommentContentToUserSubmittedComment({content:n,stream:i});return a.replyToThread(o,r)})),fe=D("DeleteComment"),ve=H(fe,(function(e,t){var n=e.commentId;e.threadId;return t.api.deleteComment(n)})),he=D("EditComment"),Se=H(he,(function(e,t){var n=e.commentId,r=e.content,a=(e.threadId,t.api),i=t.context.stream,o=l.iCommentContentToUserSubmittedComment({content:r,stream:i});return a.editComment(n,o)})),be=D("MarkThreadRead"),we=H(be,(function(e,t){e.origin;var n=e.threadId;return t.api.markThreadRead(n)})),ye=D("MarkThreadUnread"),Te=H(ye,(function(e,t){return t.api.markThreadUnread(e)})),Me=D("MarkThreadResolved"),Ae=H(Me,(function(e,t){var n=e.threadId;return t.api.markThreadResolved(n)})),Ce=D("MarkThreadUnresolved"),Ee=H(Ce,(function(e,t){return t.api.markThreadUnresolved(e)})),ke=U("EnablePlayerIntegration"),Ie=b.syncHandler(ke),Pe=V("SetUpsellTooltipVariant"),Fe=b.syncHandler(Pe),Re=V("SetThirdPartySource"),Oe=b.syncHandler(Re),xe=V("SetCanSeeCommentEditor"),De=b.syncHandler(xe),Ve=V("RecordEnabledStatus"),Ue=b.syncHandler(Ve),Ne=V("SetPerfData"),We=b.syncHandler(Ne),Le=V("SetSubscriptionStatus"),He=b.syncHandler(Le),ze=D("Subscribe"),Be=H(ze,(function(e,t){return t.api.subscribe()})),qe=U("ToggleShowResolved"),je=b.syncHandler(qe),Ke=D("Unsubscribe"),Ge=H(Ke,(function(e,t){return t.api.unsubscribe()})),Xe=V("UpdateDocumentCurrentPage"),Ye=b.syncHandler(Xe),Ze=V("UpdateEditorIsEmpty"),Qe=b.syncHandler(Ze),Je=V("UpdatePlayerCurrentTime"),$e=b.syncHandler(Je),et=V("DocMetadataLoad"),tt=b.syncHandler(et),nt=V("SetPendingNumberedAnnotation"),rt=b.syncHandler(nt),at=U("ClearPendingNumberedAnnotation"),it=b.syncHandler(at),ot=U("SetPendingNumberedAnnotationMayBeOffscreen"),st=b.syncHandler(ot),ct=U("RequestEditorFocus"),ut=b.syncHandler(ct),lt=U("FulfillEditorFocusRequest"),dt=b.syncHandler(lt),mt=V("TrackSidebarCommentsVisibility"),pt=b.syncHandler(mt),_t=V("ResetStore"),gt=b.syncHandler(_t);function ft(e,t,r){var a=this;return function(){return n.__awaiter(a,void 0,void 0,(function(){var a,i;return n.__generator(this,(function(n){return t?(a=t.viewer,i=t.stream,(a?new s.Comments2Api(a.id,i):new s.Comments2LoggedOutApi(i)).logPerfEvent(e,r),[2]):[2]}))}))}}t.ActionTypes={SetContext:z,SetContextStatus:q,ActivateThread:X,CheckOnboardingStatus:J,CreateThread:me,DeactivateAllThreads:Z,DeleteComment:fe,EditComment:he,EnablePlayerIntegration:ke,ListComments:K,HoverThread:ne,FocusThread:ae,MarkOnboarded:oe,DismissOnboarding:ce,GetStickers:ee,MarkModalVariantShown:le,MarkThreadRead:be,MarkThreadResolved:Me,MarkThreadUnread:ye,MarkThreadUnresolved:Ce,RecordEnabledStatus:Ve,ReplyToThread:_e,SetCanSeeCommentEditor:xe,SetPerfData:Ne,SetSubscriptionStatus:Le,SetThirdPartySource:Re,SetUpsellTooltipVariant:Pe,Subscribe:ze,ToggleShowResolved:qe,Unsubscribe:Ke,UpdateDocumentCurrentPage:Xe,UpdateEditorIsEmpty:Ze,UpdatePlayerCurrentTime:Je,DocMetadataLoad:et,SetPendingNumberedAnnotation:nt,ClearPendingNumberedAnnotation:at,SetPendingNumberedAnnotationMayBeOffscreen:ot,RequestEditorFocus:ct,FulfillEditorFocusRequest:lt,TrackSidebarCommentsVisibility:mt,ResetStore:_t},t.Actions={setContextStatus:j,setFileContext:O,activateComment:function(e){return function(t,n){var r=f.getThreads(n()),a=p.findCommentThread(r,e);!a||a.comment.deleted?m.showErrorSnackbar({message:i.intl.formatMessage({id:"/83u+2",defaultMessage:"That comment has been deleted."})}):a.thread.resolved&&m.showErrorSnackbar({message:i.intl.formatMessage({id:"Uu2ETy",defaultMessage:"That comment has been resolved."})}),a&&t(M({thread:a.thread,pendingAnnotationInfo:p.getAnnotationInfoForThread(a.thread)}))}},activateThread:Y,activateThreadAndMarkAsRead:M,activateThreadByLayerClick:function(e,t){return function(n,r){var a=r();if(f.getIsComments2Ready(a)){var i=f.getDisplayedThreadsForLayer(a,e.page);n(Q());var o=p.getThreadForNumberedAnnotationAtPoint(e,i,t);o&&n(M({thread:o,wasPreviewLayerClick:!0}))}}},activateThreadByMarkerClick:function(e){return function(t){return n.__awaiter(void 0,void 0,void 0,(function(){var r;return n.__generator(this,(function(n){switch(n.label){case 0:return(r=u.store.getState().sidebar).open?[3,2]:[4,u.store.dispatch(w.open("annotation_select"))];case 1:n.sent(),n.label=2;case 2:return"comments"===r.activeTab?[3,4]:[4,u.store.dispatch(w.selectTab("comments"))];case 3:n.sent(),n.label=4;case 4:return t(M(e)),[2]}}))}))}},checkOnboardingStatus:$,createThread:pe,deactivateAllThreads:Q,deleteComment:ve,disableCommenting:E,editComment:Se,enableCommenting:A,enablePlayerIntegration:Ie,hoverThread:re,focusThread:ie,hoverThreadByLayer:function(e,t){return function(n,r){var a=r();if(f.getIsComments2Ready(a)){var i=f.getDisplayedThreadsForLayer(a,e.page),o=p.getThreadForNumberedAnnotationAtPoint(e,i,t);f.getHoverThreadId(a)!==(o&&o.id)&&n(re(o&&o.id))}}},getStickers:te,listComments:G,markOnboarded:se,markOnboardedIfUnmarked:function(e){return function(t,n){f.getOnboardingVariants(n())[e]&&t(se(e))}},dismissOnboarding:ue,markModalVariantShown:de,markThreadRead:we,markThreadResolved:Ae,markThreadUnread:Te,markThreadUnresolved:Ee,recordEnabledStatus:Ue,replyToThread:ge,setCanSeeCommentEditor:De,setPerfData:We,setSubscriptionStatus:He,setThirdPartySource:Oe,setUpsellTooltipVariant:Fe,subscribe:Be,toggleShowResolved:je,unsubscribe:Ge,updateDocumentCurrentPage:Ye,updateEditorIsEmpty:Qe,updatePlayerCurrentTime:$e,setPendingNumberedAnnotation:rt,clearPendingNumberedAnnotation:it,setPendingNumberedAnnotationMayBeOffscreen:st,requestEditorFocus:ut,fulfillEditorFocusRequest:dt,trackSidebarCommentsVisibility:pt,openVersionHistory:function(){return function(e,t){var n=t(),r=f.getViewerId(n),i=f.getFQPath(n);if(i&&r){var o=S.getFileHistoryUrl({fqPath:i,userId:r});a.redirect(o)}}},docMetadataLoad:tt,logPerfEvent:function(e,t){var r=this;return function(a,i){return n.__awaiter(r,void 0,void 0,(function(){var r;return n.__generator(this,(function(n){return r=f.getContext(i()),a(ft(e,r,t)),[2]}))}))}},logSimplePerfEvent:function(e,t){var r=this;return function(a,i){return n.__awaiter(r,void 0,void 0,(function(){var r,a;return n.__generator(this,(function(n){return r=i(),(a=f.getContext(r))&&a.viewer&&new s.Comments2Api(a.viewer.id,a.stream).logSimplePerfEvent(e,t),[2]}))}))}},resetStore:gt}})),define("modules/clean/react/watermarking/watermarking_layer",["require","exports","tslib","react","react-redux","modules/clean/react/css","modules/clean/react/file_viewer/data/actions","modules/clean/react/watermarking/drawing","modules/clean/react/watermarking/selectors","modules/clean/react/watermarking/utils","modules/clean/react/watermarking/types"],(function(e,t,n,r,a,i,o,s,c,u,l){"use strict";function d(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");if(!n)return 0;n.drawImage(e,0,0);for(var r,a,i,o=n.getImageData(0,0,t.width,t.height).data,s=0,c=0,u=o.length;c<u;c+=4)r=o[c],a=o[c+1],i=o[c+2],s+=Math.floor((r+a+i)/3);return Math.floor(s/(e.width*e.height))}Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.updateWatermarkColor=function(){var e=t.props,n=e.thumbUrl,r=e.watermark;n?(t.img=new Image,t.img.crossOrigin="use-credentials",t.img.onload=function(){var e=d(t.img)<127?"white":"black";t.setTextWatermark({color:e})},t.img.src=n):t.setTextWatermark({color:r.textWatermarkingOptions.color})},t.updateWatermarkFontSize=function(){var e=t.props,n=e.pageDimensions,r=e.watermark;if(n){var a=r.textWatermarkingOptions.size,i=Math.floor((n.width+n.height)/2),o=Math.floor(i/200),s=Math.floor(i/5),c=a!==u.DEFAULT_WATERMARKING_STATE.textWatermarkingOptions.size&&o<a&&a<s?a:Math.floor(i/40);t.setTextWatermark({size:c,minSize:o,maxSize:s})}},t.canvasRef=function(e){t.canvas=e},t.redraw=function(){var e=t.props,n=e.tilingFunc,r=e.watermark;if(n&&t.canvas&&r){var a=t.canvas.getContext("2d");if(a){var i=l.getWatermarkingOptions(r),o=t.getCanvasSize(),c=o.canvasWidth,d=o.canvasHeight,m=o.scale;if(a.clearRect(0,0,c,d),i.position!==l.WatermarkPosition.REPEAT){var p,_=i.angle/180*Math.PI;if(r.mode===l.WatermarkingMode.TEXT){if(!(g=r.textWatermarkingOptions).text)return;p=s.drawTextTile(g.text,g.size*m,g.fontFamily,g.color,g.opacity/100,_).canvas}else{var g;if(!(g=r.imageWatermarkingOptions).image)return;p=s.drawImageTile(g.image,g.size*m,g.opacity/100,_).canvas}if(p){var f=i.marginX*m,v=i.marginY*m,h=f,S=v;switch(i.position){case l.WatermarkPosition.CENTER:h=(c-p.width)/2,S=(d-p.height)/2;break;case l.WatermarkPosition.NORTHEAST:h=c-p.width-f;break;case l.WatermarkPosition.SOUTHWEST:S=d-p.height-v;break;case l.WatermarkPosition.SOUTHEAST:h=c-p.width-f,S=d-p.height-v}a.drawImage(p,h,S)}}else{var b=void 0;try{b=n(m)}catch(e){if(e.message===u.WatermarkingError.TILE_NO_INPUT)return;throw e}for(var w=0,y=0,T=(b.startY+y)%b.distanceY-b.height;T<d;T+=b.distanceY){for(var M=(b.startX+w)%b.distanceX-b.width;M<c;M+=b.distanceX)a.drawImage(b.canvas,M,T);w+=b.offsetXPerRow,y+=b.offsetYPerCol}}}}},t}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.updateWatermarkColor(),this.updateWatermarkFontSize(),this.redraw(),this.props.pageDimensions&&this.props.setPageDimensions(this.props.pageDimensions)},t.prototype.componentDidUpdate=function(e){this.props.thumbUrl!==e.thumbUrl&&this.updateWatermarkColor(),this.redraw()},t.prototype.setTextWatermark=function(e){var t=this.props,n=t.updateWatermarkOptions;t.watermark.mode===l.WatermarkingMode.TEXT&&n({textWatermarkingOptions:e})},t.prototype.getCanvasSize=function(){var e=this.props.layerSize.width,t=this.props.pageDimensions||this.props.layerSize,n=t.width,r=t.height,a=e/n;if(this.props.watermark){var i=l.getWatermarkingOptions(this.props.watermark);a=Math.min(a,i.scale)}return{canvasWidth:Math.round(n*a),canvasHeight:Math.round(r*a),scale:a}},t.prototype.render=function(){var e=this.props,t=e.watermark,n=e.tilingFunc;if(!t||!n)return null;var a=this.props.layerSize,i=a.width,o=a.height,s=this.getCanvasSize(),c=s.canvasWidth,u=s.canvasHeight,l={width:i+"px",height:o+"px"};return r.default.createElement("canvas",{ref:this.canvasRef,className:"fv-watermarking-layer",style:l,width:c,height:u})},t})((r=n.__importDefault(r)).default.PureComponent);t._WatermarkingLayer=m;t.ConnectedWatermarkingLayer=a.connect((function(e){return{watermark:c.getWatermarkState(e),tilingFunc:c.getWatermarkTilingFunc(e)}}),{updateWatermarkOptions:o.updateWatermarkOptions,setPageDimensions:o.setPageDimensions})(m);var p=i.requireCssWithComponent(t.ConnectedWatermarkingLayer,["/static/css/file_viewer/watermarking_layer-vflNek1am.css"]);t.WatermarkingLayer=p})),define("modules/clean/react/file_sidebar/file_sidebar_logger",["require","exports","tslib","modules/clean/ajax","modules/clean/react/file_viewer/models"],(function(e,t,n,r,a){"use strict";function i(e,t){var n=a.FileViewerSession.currentSession,i=a.FilePreviewSession.currentSession;if(i&&n){var o={event_name:e,file_viewer_session_id:n.id,file_preview_session_id:i.id,file_ns_id:i.file.ns_id,file_sjid:i.file.sjid,extra:JSON.stringify(t)};r.SilentBackgroundRequest({url:"/log/file_sidebar",data:o})}}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),t.logSidebarTabSelected=function(e){i("sidebar_tab_selected",e)},t.logSidebarOpened=function(e){i("sidebar_opened",e)},t.logSidebarClosed=function(e){i("sidebar_closed",e)},t.logActivityStreamInteractivity=function(e){i("activity_stream_interactivity",e)},t.logFileViewActivityCardExpanded=function(e){i("file_view_activity_expanded",e)}})),define("modules/clean/react/previews/toolbar_flip_buttons",["require","exports","tslib","react","external/lodash","classnames","file-viewer/toolbar","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants","modules/core/i18n"],(function(e,t,n,r,a,i,o,s,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),a=n.__importStar(a),i=n.__importDefault(i),t.ToolbarFlipButtons=function(e){var t=e.className,n=e.count,l=e.index,d=e.onClickNext,m=void 0===d?a.noop:d,p=e.onClickPrevious,_=void 0===p?a.noop:p;return null==n||null==l||n<1?null:r.default.createElement(o.ToolbarFlipButtons,{buttonClassName:"toolbar-button-entry",className:i.default("flip-buttons","image-toolbar__item",t),count:n,intl:u.intl,index:l,onClickPrevious:s.wrapToolbarActionWithLogging(_,c.UserAction.FlipPrevious),onClickNext:s.wrapToolbarActionWithLogging(m,c.UserAction.FlipNext)})}})),define("modules/clean/open_in_app/actions",["require","exports","tslib","modules/clean/open_in_app/types","modules/clean/open_in_mobile_app"],(function(e,t,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),t.openInApp=function(e,t){var n,i=t.onAppNeeded,o=t.onAppInstalled;r.areUrlsIOS(e)?a.default.open_ios(e.iOSAppUrl,e.iOSAppStoreUrl,!(n=(navigator.userAgent||"").match(/OS (\d+)_(\d+)_?(\d+)?/))||parseInt(n[1],10)>=9,i,o):r.areUrlsAndroid(e)&&a.default.open_android_intent(e.androidAppUrl)},t.openImmediately=function(e){var t;if(r.areUrlsIOS(e))t=e.iOSAppUrl;else{if(!r.areUrlsAndroid(e))return;t=e.androidAppUrl}var n=document.createElement("iframe");n.setAttribute("class","open-in-app-transport"),n.setAttribute("src",t),n.setAttribute("style","display: none"),document.body.appendChild(n)},t.cleanUp=function(){a.default.cleanup()}})),define("modules/clean/open_in_mobile_app",["require","exports","tslib","jquery","modules/clean/analytics","modules/core/exception","modules/core/i18n","modules/clean/sharing/constants"],(function(e,t,n,r,a,i,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),a=n.__importStar(a);var c=(function(){function e(){}return e.initClass=function(){var e=this;this.vischange_listener=null,this.open_app_mode=!0,this.try_open_ios_9=function(t,n,r,a){return void 0===r&&(r=function(){}),void 0===a&&(a=function(){}),e.vischange_listener||(e.vischange_listener=function(t){return e.open_app_mode=!0,a()},document.addEventListener("visibilitychange",e.vischange_listener)),e.open_app_mode?(e.open_app_mode=!1,e._onOpenLoggingHandler(),r(),window.location=t):(e._onInstallLoggingHandler(),window.location=n)},this.fallback_will_launch=!1,this.try_open=function(t,n,i){if(e._onOpenLoggingHandler(),!e.fallback_will_launch){var o=r.default("body"),c=!1,u=function(e){return c=!0};document.addEventListener("visibilitychange",u);var l,d=!1,m=function(e){return d=!0};window.addEventListener("pagehide",m),null!=i&&a.ShareTibEventLogger.log_unauth("CLICK_MOBILE_OPEN",s.SHARE_ACTION_ORIGIN_TYPE.WEB_MOBILE,{scl_url:i}),l=r.default("<iframe />",{src:t,style:"display: none;"}),o.append(l);var p=Date.now();return setTimeout((function(){if(e.fallback_will_launch=!1,document.removeEventListener("visibilitychange",u),window.removeEventListener("pagehide",m),!d&&!c&&Date.now()<p+4700)return null!=i&&a.ShareTibEventLogger.log_unauth("CLICK_MOBILE_INSTALL",s.SHARE_ACTION_ORIGIN_TYPE.WEB_MOBILE,{scl_url:i}),window.location.replace(n)}),3200),e.fallback_will_launch=!0}}},e._onOpenLoggingHandler=function(){},e._onInstallLoggingHandler=function(){},e.registerLoggingHandlers=function(e,t){return this._onOpenLoggingHandler=e,this._onInstallLoggingHandler=t},e.open_on_click=function(e,t,n,a,i,s,c){var u=this;void 0===s&&(s=null);return r.default(n).on("click",(function(n){if(n.preventDefault(),c)return u.open_android_intent(c);if(i){a||(a=r.default("<div/>"));var l=a.text();return u.try_open_ios_9(e,t,(function(){return a.text(o.intl.formatMessage({id:"RgopQo",defaultMessage:"Install app?"}))}),(function(){return a.text(l)}))}return u.try_open(e,t,s)}))},e.open_ios=function(e,t,n,r,a){return void 0===r&&(r=function(){}),void 0===a&&(a=function(){}),n?this.try_open_ios_9(e,t,r,a):this.try_open(e,t)},e.open_android_intent=function(e){return i.assert(e&&e.startsWith("intent://www.dropbox.com/sm/launch_intent_or_fallback_page"),"intentUrl must use intent:// protocol"),this._onOpenLoggingHandler&&this._onOpenLoggingHandler(),window.location.href=e},e.redirect_on_load=function(e,t){return this.try_open(e,t)},e.cleanup=function(){if(this.vischange_listener)return document.removeEventListener("visibilitychange",this.vischange_listener)},e})();c.initClass(),t.default=c})),define("modules/clean/react/file_viewer/controller_mode",["require","exports","modules/clean/api_v2/noauth_client","modules/clean/api_v2/user_client"],(function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchControllerMode=function(e,t){return null!=t?(function(e,t){return(new r.UserApiV2Client).ns("file_viewer").rpc("get_mode",e,{subjectUserId:t.id})})(e,t):(function(e){return(new n.NoAuthApiV2Client).ns("file_viewer").rpc("logged_out/get_mode",e,{})})(e)}})),define("modules/clean/react/file_viewer/data/actions",["require","exports","tslib","modules/clean/ajax","modules/clean/react/file_viewer/constants","modules/clean/file_store/actions","modules/clean/previews/data/actions","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/data/selectors","modules/clean/file_store/utils","modules/clean/react/file_viewer/data/types","modules/clean/previews/data/util","modules/clean/react/file_viewer/constants","modules/clean/downloads","modules/core/uri","modules/core/browser","modules/clean/react/file_viewer/controller_mode","modules/clean/react/file_viewer/models","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/watermarking/utils","file-viewer/core","modules/clean/react/workflows/markup/fabric","modules/clean/react/workflows/markup/selectors","modules/clean/react/file_viewer/prompt/campaign_api","modules/clean/react/size_class/constants","modules/clean/react/watermarking/selectors","modules/clean/react/file_viewer/ml_experiment"],(function(e,t,n,r,a,i,o,s,c,u,l,d,m,p,_,g,f,v,h,S,b,w,y,T,M,A,C){"use strict";function E(e){return{type:l.Actions.OpenFile,payload:{fileId:e}}}function k(e){return function(t,n){var r,a=((r={})[b.FileViewerMode.Default]=L,r[b.FileViewerMode.Documentation]=z,r[b.FileViewerMode.Commenting]=B,r[b.FileViewerMode.Watermarking]=q,r[b.FileViewerMode.Zoom]=j,r[b.FileViewerMode.Slack]=K,r[b.FileViewerMode.Markup]=G,r[b.FileViewerMode.Plugins]=Y,r[b.FileViewerMode.HelloSign]=Z,r[b.FileViewerMode.ProAnalytics]=X,r);a[e]&&a[e](t,n)}}function I(e){return h.filePreviewEventEmitter.emit(m.EventType.SidebarModeSelected,v.FilePreviewSession.currentSession,{selected_mode:e}),{type:l.Actions.UpdateMode,payload:{mode:e}}}function P(e){return function(t,n){var r=c.getCurrentFileId(n());r&&t((function(e,t){return{type:l.Actions.UpdateRenderStatus,payload:{fileId:e,renderStatus:t}}})(r,e))}}function F(e){return h.filePreviewEventEmitter.emit(m.EventType.SidebarPaneSelected,v.FilePreviewSession.currentSession,{selected_pane:e}),{type:l.Actions.PushSidebarPane,payload:{paneId:e}}}function R(){return{type:l.Actions.ResetSidebarPaneStack}}function O(){return{type:l.Actions.ResetSelectedSidebarControlId}}function x(e){return{type:l.Actions.SetSelectedSidebarControlId,payload:{controlId:e}}}function D(e){var t=e===b.SidebarVisibility.Open?m.EventType.SidebarOpened:m.EventType.SidebarClosed;return h.filePreviewEventEmitter.emit(t,v.FilePreviewSession.currentSession),{type:l.Actions.SetSidebarVisibility,payload:{visibility:e}}}function V(e){return function(t,n){t({type:l.Actions.UpdateWatermarkOptions,payload:{options:e}}),S.setLocalStorageWatermarkingState(c.getCurrentUser(n()),A.getWatermarkState(n()))}}function U(e){return function(t,n){t({type:l.Actions.SwitchWatermarkingMode,payload:{mode:e}}),S.setLocalStorageWatermarkingState(c.getCurrentUser(n()),A.getWatermarkState(n()))}}function N(e,t,r){return n.__awaiter(this,void 0,void 0,(function(){var a,i;return n.__generator(this,(function(o){switch(o.label){case 0:return[4,S.getUserMetadataTextWatermarkingState(e)];case 1:return a=o.sent(),[4,S.getLocalStorageWatermarkingState(e)];case 2:return(i=o.sent())?(V({textWatermarkingOptions:n.__assign(n.__assign({},i.textWatermarkingOptions),a),imageWatermarkingOptions:i.imageWatermarkingOptions})(t,r),U(i.mode)(t,r)):a?V({textWatermarkingOptions:a})(t,r):V({textWatermarkingOptions:{text:S.getDefaultText(e)}})(t,r),[2]}}))}))}function W(e){return{type:l.Actions.SetTrialMode,payload:{isTrialMode:e}}}function L(e,t){var n=t(),r=c.getMode(n);e(W(!1)),e(O()),r!==b.FileViewerMode.Default&&e(I(b.FileViewerMode.Default))}function H(e,t,n,r){return function(a,i){var o=i(),s=c.getSidebar(o).visibility,u=c.getMode(o);s===b.SidebarVisibility.Closed&&a(D(b.SidebarVisibility.Open)),u!==e&&(a(W(!!r&&r(o))),a(x(t)),a(R()),a(F(n)),a(I(e)))}}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),p=n.__importStar(p),g=n.__importStar(g),t.openFullScreen=function(){return{type:l.Actions.OpenFullScreen}},t.closeFullScreen=function(){return{type:l.Actions.CloseFullScreen}},t.openSidebar=function(e,t){return void 0===e&&(e=a.DocType.default),function(n){n({type:l.Actions.OpenSidebar,payload:{type:e}}),s.logUserAction(a.UserAction.ToggleSidebarOn,t)}},t.closeSidebar=function(e,t){return void 0===e&&(e=a.DocType.default),function(n){n({type:l.Actions.CloseSidebar,payload:{type:e}}),s.logUserAction(a.UserAction.ToggleSidebarOff,t)}},t.dismissAppDownloadInterstitial=function(){return{type:l.Actions.DismissAppDownloadInterstitial}},t.openFileById=E,t.closeFile=function(){return{type:l.Actions.CloseFile}},t.changeMode=k,t.disableMode=function(e){return{type:l.Actions.DisableMode,payload:{mode:e}}},t.enableMode=function(e){return{type:l.Actions.EnableMode,payload:{mode:e}}},t.updateMode=I,t.openFile=function(e){var t=this;return function(r,a){return n.__awaiter(t,void 0,void 0,(function(){var t,s;return n.__generator(this,(function(n){return t=u.getFileStoreId(e),s=i.putFile(e),r(s),!d.previewDataPresentForFile(a(),e)&&!d.previewDataInFlight(a(),e)&&(s.payload.file.preview?r(o.populateFilesPreviewData([s.payload.file])):r(o.fetchPreviewData([s.payload.file]))),r(E(t)),[2]}))}))}},t.setRenderStatusForCurrentFile=P,t.setRenderStatusSuccessForCurrentFile=function(){return P(m.PreviewRenderStatus.Succeeded)},t.fetchShowOverQuotaUpsell=function(e){return function(t,n){e&&void 0===c.getShowOverQuotaUpsell(n())&&r.SilentBackgroundRequest({url:"/should_show_file_preview_upsell",data:{_subject_uid:e.id},success:function(e){try{var n=JSON.parse(e);n&&t((r=n.shouldShowFilePreviewUpsell,{type:l.Actions.SetShowOverQuotaUpsell,payload:r}))}catch(e){}var r}})}},t.pushSidebarPane=F,t.popSidebarPane=function(){return{type:l.Actions.PopSidebarPane}},t.resetSidebarPaneStack=R,t.resetSelectedSidebarControlId=O,t.setSelectedSidebarControlId=x,t.setSidebarVisibility=D,t.setPageDimensions=function(e){return{type:l.Actions.SetPageDimensions,payload:{pageDimensions:e}}},t.updateWatermarkOptions=V,t.switchWatermarkingMode=U,t.setMarkupCanvas=function(e,t,n){return{type:l.Actions.SetMarkupCanvas,payload:{page:e,fabric:t,scale:n}}},t.updateMarkupCanvasScale=function(e,t){return{type:l.Actions.UpdateMarkupCanvasScale,payload:{page:e,scale:t}}},t.setMarkupDrawingMode=function(e){return function(t,n){t({type:l.Actions.SetMarkupDrawingMode,payload:{isDrawingMode:e}}),w.setDrawingMode(y.getMarkupState(n()),e)}},t.setMarkupStroke=function(e){return function(t){t({type:l.Actions.SetMarkupStroke,payload:{color:e}}),w.setBaseBrushColor(e)}},t.setMarkupFill=function(e){return{type:l.Actions.SetMarkupFill,payload:{color:e}}},t.setMarkupFormatSubmenu=function(e){return{type:l.Actions.SetMarkupSubmenuType,payload:{formatSubmenu:e}}},t.resetMarkupState=function(){return function(e,t){w.disposeCanvas(y.getMarkupState(t())),e({type:l.Actions.ResetMarkupState})}},t.switchRevisionAction=function(e){return function(t){e.preview&&t(o.overridePreviewForComments(e,e.preview)),t({type:l.Actions.SwitchRevision,payload:{file:e}})}},t.restoreRevisionAction=function(){return function(e,t){var n=c.getActiveFile(t());n&&e(o.clearCommentsPreviewOverride(n)),e({type:l.Actions.RestoreRevision})}},t.saveForwardRevision=function(e){return function(t){t(i.putFile(e,e.revision_id)),e.preview&&t(o.overridePreviewForComments(e,e.preview)),t({type:l.Actions.SaveForwardRevision,payload:{revisionKey:e.revision_id}})}},t.download=function(e){var t=_.URI.parse(e.href);t.updateQuery({dl:"1"}),p.get({url:t.toString()})},t.pendingFileUploaded=function(){g.reload(!0)},t.setMediaPlaying=function(){return function(e){e({type:l.Actions.PlayMedia})}},t.setMediaPaused=function(){return function(e){e({type:l.Actions.PauseMedia})}},t.resetFileViewerStore=function(){return function(e){e({type:l.Actions.ResetStore})}},t.forceHideToolbar=function(){return{type:l.Actions.ForceHideToolbar}},t.disableForceHideToolbar=function(){return{type:l.Actions.DisableForceHideToolbar}},t.fetchControllerModeAction=function(e,t,r){var a=this;return function(i,o){return n.__awaiter(a,void 0,void 0,(function(){var a,s,u,d;return n.__generator(this,(function(n){switch(n.label){case 0:i({type:l.Actions.FetchControllerModeRequest}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,f.fetchControllerMode(e,t)];case 2:return a=n.sent().mode,h.filePreviewEventEmitter.emit(m.EventType.FilePreviewModeDetermined,v.FilePreviewSession.currentSession,{mode:a}),r===M.SizeClass.Small||r===M.SizeClass.Medium?(i(x(b.SidebarControlId.Documentation)),i(F(b.SidebarPaneId.Documentation)),i(I(b.FileViewerMode.Documentation)),[2]):(s=(function(e){var t=b.FileViewerMode.Default;if(e)switch(e[".tag"]){case"commenting_mode":t=b.FileViewerMode.Commenting;break;case"documentation_mode":t=b.FileViewerMode.Documentation;break;case"other":t=b.FileViewerMode.Default}return t})(a),(u=c.getMode(o()))&&u!==b.FileViewerMode.Default||i(k(s)),[3,4]);case 3:return d=n.sent(),i({type:l.Actions.FetchControllerModeError,payload:d}),[3,4];case 4:return[2]}}))}))}},t.fetchBestCampaignsAction=function(e,t){var r=this;return function(a,i){return n.__awaiter(r,void 0,void 0,(function(){var r;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,T.fetchBestCampaigns(e.id,t)];case 1:return r=n.sent().campaigns,a({type:l.Actions.SetBestCampaign,payload:{campaign:r[0]}}),[2]}}))}))}},t.fetchDocClassificationAction=function(e,t){var r=this;return function(a,i){return n.__awaiter(r,void 0,void 0,(function(){var r;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,C.fetchDocClassification(e,t)];case 1:return r=n.sent().predicted_types,a({type:l.Actions.SetDocClassification,payload:{docClassification:{predicted_types:r},fileId:t}}),[2]}}))}))}},t.updateCurrentPageIndex=function(e){return{type:l.Actions.UpdateCurrentPageIndex,payload:{currentPageIndex:e}}},t.pageDown=function(){return{type:l.Actions.PageDown}},t.pageUp=function(){return{type:l.Actions.PageUp}},t.registerUser=function(e){return function(t,n){t({type:l.Actions.RegisterUser,payload:{user:e}}),N(e,t,n)}},t.loadWatermarkingStateFromStorage=N;var z=H(b.FileViewerMode.Documentation,b.SidebarControlId.Documentation,b.SidebarPaneId.Documentation),B=H(b.FileViewerMode.Commenting,b.SidebarControlId.Comments,b.SidebarPaneId.Comments),q=H(b.FileViewerMode.Watermarking,b.SidebarControlId.Watermarking,b.SidebarPaneId.Watermarking,(function(e){return S.allowWatermarkTrial(c.getCurrentUser(e))})),j=H(b.FileViewerMode.Zoom,b.SidebarControlId.Zoom,b.SidebarPaneId.Zoom),K=H(b.FileViewerMode.Slack,b.SidebarControlId.Slack,b.SidebarPaneId.SlackHome),G=H(b.FileViewerMode.Markup,b.SidebarControlId.Markup,b.SidebarPaneId.Markup),X=H(b.FileViewerMode.ProAnalytics,b.SidebarControlId.ProAnalytics,b.SidebarPaneId.ProAnalytics),Y=function(){},Z=function(){};t.overflowZoomOn=function(){return{type:l.Actions.OverflowZoomOn}},t.overflowZoomOff=function(){return{type:l.Actions.OverflowZoomOff}}})),define("modules/clean/react/file_viewer/data/reducer",["require","exports","tslib","modules/clean/react/file_viewer/data/types","modules/clean/react/watermarking/utils","modules/clean/react/file_viewer/constants","file-viewer/core","modules/clean/react/workflows/markup/utils"],(function(e,t,n,r,a,i,o,s){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0}),t.defaultState={currentFileId:void 0,currentPageIndex:0,fileRevision:void 0,latestFileId:void 0,forceHideToolbar:!1,isFullScreen:!1,isSidebarOpen:(c={},c[i.DocType.ppt]=!0,c[i.DocType.pdf]=!1,c),mode:o.FileViewerMode.Default,disabledModes:{},renderStatuses:{},showOverQuotaUpsell:void 0,sidebar:{visibility:o.SidebarVisibility.Closed,paneStack:[],selectedControlId:void 0},watermark:a.DEFAULT_WATERMARKING_STATE,markup:s.DEFAULT_MARKUP_STATE,campaign:void 0,overflowZoom:!1,docClassifications:{},docClassificationVariant:null},t.fileViewerReducer=function(e,a){var i,c,u,l,d,m,p,_;switch(void 0===e&&(e=t.defaultState),a.type){case r.Actions.CloseFile:return n.__assign(n.__assign({},e),{currentFileId:void 0,fileRevision:void 0,latestFileId:void 0});case r.Actions.OpenFile:var g=a.payload;return n.__assign(n.__assign({},e),{currentFileId:g.fileId,fileRevision:void 0,latestFileId:void 0});case r.Actions.SwitchRevision:g=a.payload;return n.__assign(n.__assign({},e),{fileRevision:g.file});case r.Actions.RestoreRevision:return n.__assign(n.__assign({},e),{fileRevision:void 0,currentFileId:e.latestFileId||e.currentFileId,latestFileId:void 0});case r.Actions.SetPageDimensions:var f=a.payload.pageDimensions;return n.__assign(n.__assign({},e),{pageDimensions:f});case r.Actions.UpdateWatermarkOptions:var v=a.payload.options;return n.__assign(n.__assign({},e),{watermark:n.__assign(n.__assign({},e.watermark),{textWatermarkingOptions:n.__assign(n.__assign({},e.watermark.textWatermarkingOptions),v.textWatermarkingOptions),imageWatermarkingOptions:n.__assign(n.__assign({},e.watermark.imageWatermarkingOptions),v.imageWatermarkingOptions)})});case r.Actions.SwitchWatermarkingMode:var h=a.payload.mode;return n.__assign(n.__assign({},e),{watermark:n.__assign(n.__assign({},e.watermark),{mode:h})});case r.Actions.SetMarkupCanvas:var S=a.payload,b=S.page,w=S.fabric,y=S.scale;return n.__assign(n.__assign({},e),{markup:n.__assign(n.__assign({},e.markup),(i={},i[b]={scale:y,fabric:w},i))});case r.Actions.UpdateMarkupCanvasScale:var T=a.payload;b=T.page,y=T.scale;return n.__assign(n.__assign({},e),{markup:n.__assign(n.__assign({},e.markup),(c={},c[b]=n.__assign(n.__assign({},e.markup[b]),{scale:y}),c))});case r.Actions.ResetMarkupState:return n.__assign(n.__assign({},e),{markup:s.DEFAULT_MARKUP_STATE});case r.Actions.SetMarkupDrawingMode:var M=a.payload.isDrawingMode;return n.__assign(n.__assign({},e),{markup:n.__assign(n.__assign({},e.markup),{isDrawingMode:M})});case r.Actions.SetMarkupFill:var A=a.payload.color;return n.__assign(n.__assign({},e),{markup:n.__assign(n.__assign({},e.markup),{fillColor:A})});case r.Actions.SetMarkupStroke:A=a.payload.color;return n.__assign(n.__assign({},e),{markup:n.__assign(n.__assign({},e.markup),{strokeColor:A})});case r.Actions.SetMarkupSubmenuType:var C=a.payload.formatSubmenu;return n.__assign(n.__assign({},e),{markup:n.__assign(n.__assign({},e.markup),{formatSubmenu:C})});case r.Actions.SaveForwardRevision:g=a.payload;return n.__assign(n.__assign({},e),{latestFileId:g.revisionKey});case r.Actions.UpdateMode:g=a.payload;return n.__assign(n.__assign({},e),{mode:g.mode});case r.Actions.DisableMode:g=a.payload;return n.__assign(n.__assign({},e),{disabledModes:n.__assign(n.__assign({},e.disabledModes),(u={},u[g.mode]=!0,u))});case r.Actions.EnableMode:g=a.payload;return n.__assign(n.__assign({},e),{disabledModes:n.__assign(n.__assign({},e.disabledModes),(l={},l[g.mode]=!1,l))});case r.Actions.OpenFullScreen:return n.__assign(n.__assign({},e),{isFullScreen:!0});case r.Actions.CloseFullScreen:return n.__assign(n.__assign({},e),{isFullScreen:!1});case r.Actions.OpenSidebar:g=a.payload;return n.__assign(n.__assign({},e),{isSidebarOpen:n.__assign(n.__assign({},e.isSidebarOpen),(d={},d[g.type]=!0,d))});case r.Actions.CloseSidebar:g=a.payload;return n.__assign(n.__assign({},e),{isSidebarOpen:n.__assign(n.__assign({},e.isSidebarOpen),(m={},m[g.type]=!1,m))});case r.Actions.DismissAppDownloadInterstitial:return n.__assign(n.__assign({},e),{appDownloadInterstitialDismissed:!0});case r.Actions.SetShowOverQuotaUpsell:g=a.payload;return n.__assign(n.__assign({},e),{showOverQuotaUpsell:g});case r.Actions.UpdateRenderStatus:g=a.payload;return n.__assign(n.__assign({},e),{renderStatuses:n.__assign(n.__assign({},e.renderStatuses),(p={},p[g.fileId]=g.renderStatus,p))});case r.Actions.PlayMedia:return n.__assign(n.__assign({},e),{isMediaPlaying:!0});case r.Actions.PauseMedia:return n.__assign(n.__assign({},e),{isMediaPlaying:!1,pauseCount:e.pauseCount?e.pauseCount+1:1});case r.Actions.ResetStore:return t.defaultState;case r.Actions.UpdateCurrentPageIndex:g=a.payload;return n.__assign(n.__assign({},e),{currentPageIndex:g.currentPageIndex});case r.Actions.ForceHideToolbar:return n.__assign(n.__assign({},e),{forceHideToolbar:!0});case r.Actions.DisableForceHideToolbar:return n.__assign(n.__assign({},e),{forceHideToolbar:!1});case r.Actions.PopSidebarPane:return e.sidebar.paneStack.length<1?e:n.__assign(n.__assign({},e),{sidebar:n.__assign(n.__assign({},e.sidebar),{paneStack:e.sidebar.paneStack.slice(0,-1)})});case r.Actions.PushSidebarPane:g=a.payload;return e.sidebar.paneStack.includes(g.paneId)?e:n.__assign(n.__assign({},e),{sidebar:n.__assign(n.__assign({},e.sidebar),{paneStack:n.__spreadArrays(e.sidebar.paneStack,[g.paneId])})});case r.Actions.SetSelectedSidebarControlId:g=a.payload;return n.__assign(n.__assign({},e),{sidebar:n.__assign(n.__assign({},e.sidebar),{selectedControlId:g.controlId})});case r.Actions.ResetSidebarPaneStack:return n.__assign(n.__assign({},e),{sidebar:n.__assign(n.__assign({},e.sidebar),{paneStack:[]})});case r.Actions.ResetSelectedSidebarControlId:return n.__assign(n.__assign({},e),{sidebar:n.__assign(n.__assign({},e.sidebar),{selectedControlId:void 0})});case r.Actions.SetSidebarVisibility:g=a.payload;return n.__assign(n.__assign({},e),{sidebar:n.__assign(n.__assign({},e.sidebar),{visibility:g.visibility})});case r.Actions.FetchControllerModeError:return n.__assign(n.__assign({},e),{mode:o.FileViewerMode.Commenting});case r.Actions.SetBestCampaign:g=a.payload;return n.__assign(n.__assign({},e),{campaign:g.campaign});case r.Actions.SetDocClassification:g=a.payload;return n.__assign(n.__assign({},e),{docClassifications:n.__assign(n.__assign({},e.docClassifications),(_={},_[g.fileId]=g.docClassification,_))});case r.Actions.PageDown:return void 0===(E=e.currentPageIndex)?e:n.__assign(n.__assign({},e),{currentPageIndex:E+1});case r.Actions.PageUp:var E;return void 0===(E=e.currentPageIndex)?e:n.__assign(n.__assign({},e),{currentPageIndex:E-1});case r.Actions.RegisterUser:g=a.payload;return n.__assign(n.__assign({},e),{currentUser:g.user});case r.Actions.SetTrialMode:g=a.payload;return n.__assign(n.__assign({},e),{isTrialMode:g.isTrialMode});case r.Actions.OverflowZoomOn:return n.__assign(n.__assign({},e),{overflowZoom:!0});case r.Actions.OverflowZoomOff:return n.__assign(n.__assign({},e),{overflowZoom:!1});default:return e}}})),define("modules/clean/react/file_viewer/data/selectors",["require","exports","tslib","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/clean/file_store/selectors","modules/clean/previews/data/selectors","modules/clean/react/file_viewer/constants","modules/clean/previews/data/preview_type_util","reselect","external/lodash","modules/clean/react/extensions/data/selectors","modules/clean/react/extensions/client","file-viewer/core"],(function(e,t,n,r,a,i,o,s,c,u,l,d,m,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),l=n.__importStar(l),t.getFileViewerState=function(e){return a.getStateAtNamespace(e,r.FILE_VIEWER_NAMESPACE_KEY)},t.getIsFullScreen=function(e){return t.getFileViewerState(e).isFullScreen},t.getIsSidebarOpen=function(e){return t.getFileViewerState(e).isSidebarOpen},t.getCurrentPageIndex=function(e){return t.getFileViewerState(e).currentPageIndex},t.getAppDownloadInterstitial=function(e){return t.getFileViewerState(e).appDownloadInterstitialDismissed},t.getCurrentFileId=function(e){return t.getFileViewerState(e).currentFileId},t.getCurrentFile=u.createSelector(l.nthArg(0),t.getCurrentFileId,i.getFile),t.getPastFile=function(e){return t.getFileViewerState(e).fileRevision},t.getCurrentUser=function(e){return t.getFileViewerState(e).currentUser},t.getMode=function(e){return t.getFileViewerState(e).mode},t.getDisabledModes=function(e){return t.getFileViewerState(e).disabledModes},t.getSidebar=function(e){return t.getFileViewerState(e).sidebar},t.getAnnotationAllowed=u.createSelector(t.getMode,(function(e){return e===p.FileViewerMode.Commenting})),t.getIsTrialMode=function(e){return t.getFileViewerState(e).isTrialMode},t.getIsEditMode=function(e){return t.getIsMarkupMode(e)||t.getIsWatermarkingMode(e)},t.getIsWatermarkingMode=function(e){return t.getMode(e)===p.FileViewerMode.Watermarking},t.getIsMarkupMode=function(e){return t.getMode(e)===p.FileViewerMode.Markup},t.getPageDimensions=function(e){return t.getFileViewerState(e).pageDimensions},t.getActiveFile=function(e){return t.getPastFile(e)||t.getCurrentFile(e)},t.getShowOverQuotaUpsell=function(e){return t.getFileViewerState(e).showOverQuotaUpsell};t.getSelectedPromptCampaign=function(e){return t.getFileViewerState(e).campaign},t.getRenderStatusForCurrentFile=function(e){var n=t.getCurrentFileId(e);if(n)return(function(e,n){return t.getFileViewerState(e).renderStatuses[n]})(e,n)},t.getIsMediaPlaying=function(e){return t.getFileViewerState(e).isMediaPlaying},t.getPauseCount=function(e){var n=t.getFileViewerState(e).pauseCount;return n||0},t.getPreviewApiDataForCurrentFile=function(e){var n=t.getCurrentFile(e);return o.getApiDataForFile(e,n).data},t.getIsFlippingEnabled=function(e){var n=t.getPreviewApiDataForCurrentFile(e);return!(t.getIsEditMode(e)||t.getIsMediaPlaying(e)||t.getIsFullScreen(e)&&c.isSsrDoc(n))},t.shouldForceHideToolbar=function(e){return t.getFileViewerState(e).forceHideToolbar},t.getExtensionsEnabled=function(e){var n=t.getActiveFile(e);return!n||!d.fileExtensionsConfigs(e)[n.file_id]||d.fileExtensionsConfigs(e)[n.file_id].displayState!==m.DisplayState.DISABLED},t.isOverflowZoomMode=function(e){return!0===t.getFileViewerState(e).overflowZoom},t.getHelloSignAppActionForFile=function(e,t){return d.getShareActionsForFile(e,t).filter((function(e){return e.app_id===s.HELLOSIGN_PROD_APP_ID}))[0]},t.getDocClassificationForFile=function(e,n){var r=t.getFileViewerState(e);if(r&&r.docClassifications&&r.docClassifications[n])return r.docClassifications[n]}})),define("modules/clean/react/file_viewer/data/store",["require","exports","modules/clean/redux/store","modules/clean/redux/namespaces","modules/clean/file_store/reducer","modules/clean/react/file_viewer/data/reducer","modules/clean/previews/data/reducer","modules/clean/previews/data/actions","modules/clean/file_store/actions","modules/clean/react/file_viewer/data/actions","modules/clean/react/extensions/data/store"],(function(e,t,n,r,a,i,o,s,c,u,l){"use strict";var d;Object.defineProperty(t,"__esModule",{value:!0}),t.fileViewerReducerMap=((d={})[r.FILE_NAMESPACE_KEY]=a.fileNamespaceReducer,d[r.FILE_VIEWER_NAMESPACE_KEY]=i.fileViewerReducer,d[r.PREVIEW_NAMESPACE_KEY]=o.reducer,d),t.getStoreForFileViewer=function(){return l.getStore(),n.getStoreAndRegisterReducers(t.fileViewerReducerMap)},t.hydrateFileViewerNamespace=function(e,t,n){var r=t.file;r&&e.dispatch(u.openFile(r)),n&&e.dispatch(u.registerUser(n))},t.hydrateFileStore=function(e,t){e.dispatch(s.populateFilesPreviewData(t)),e.dispatch(c.putFiles(t))},t.updateFileStore=function(e,t){e.dispatch(c.putFiles(t))}})),define("modules/clean/react/file_viewer/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.CloseFile="FileViewer/CloseFile",e.CloseFullScreen="FileViewer/CloseFullScreen",e.CloseSidebar="FileViewer/CloseSidebar",e.DismissAppDownloadInterstitial="FileViewer/DismissAppDownloadInterstitial",e.DisableForceHideToolbar="FileViewer/DisableForceHideToolbar",e.ForceHideToolbar="FileViewer/ForceHideToolbar",e.UpdateMode="FileViewer/UpdateMode",e.DisableMode="FileViewer/DisableMode",e.EnableMode="FileViewer/EnableMode",e.OpenFile="FileViewer/OpenFile",e.OpenFullScreen="FileViewer/OpenFullScreen",e.OpenSidebar="FileViewer/OpenSidebar",e.PageDown="FileViewer/PageDown",e.PageUp="FileViewer/PageUp",e.PauseMedia="FileViewer/PauseMedia",e.PlayMedia="FileViewer/PlayMedia",e.PopSidebarPane="FileViewer/PopSidebarPane",e.PushSidebarPane="FileViewer/PushSidebarPane",e.SetSelectedSidebarControlId="FileViewer/SetSelectedSidebarControlId",e.ResetSidebarPaneStack="FileViewer/ResetSidebarPaneStack",e.ResetSelectedSidebarControlId="FileViewer/ResetSelectedSidebarControlId",e.ResetStore="FileViewer/ResetStore",e.UpdateCurrentPageIndex="FileViewer/UpdateCurrentPageIndex",e.RestoreRevision="FileViewer/RestoreRevision",e.SaveForwardRevision="FileViewer/SaveForwardRevision",e.SetCurrentCalloutType="FileViewer/SetCurrentCalloutType",e.SetShowOverQuotaUpsell="FileViewer/SetShowOverQuotaUpsell",e.SetSidebarVisibility="FileViewer/SetSidebarVisibility",e.SetPageDimensions="FileViewer/SetPageDimensions",e.UpdateWatermarkOptions="FileViewer/UpdateWatermarkOptions",e.SwitchWatermarkingMode="FileViewer/SwitchWatermarkingMode",e.SetMarkupCanvas="FileViewer/SetMarkupCanvas",e.UpdateMarkupCanvasScale="FileViewer/UpdateMarkupCanvasScale",e.ResetMarkupState="FileViewer/ResetMarkupState",e.SetMarkupDrawingMode="FileViewer/SetMarkupDrawingMode",e.SetMarkupFill="FileViewer/SetMarkupFill",e.SetMarkupStroke="FileViewer/SetMarkupStroke",e.SetMarkupSubmenuType="FileViewer/SetMarkupSubmenuType",e.SwitchRevision="FileViewer/SwitchRevision",e.UpdateRenderStatus="FileViewer/UpdateRenderStatus",e.RegisterUser="FileViewer/RegisterUser",e.SetTrialMode="FileViewer/SetTrialMode",e.FetchControllerModeRequest="FileViewer/FetchControllerModeRequest",e.FetchControllerModeSuccess="FileViewer/FetchControllerModeSuccess",e.FetchControllerModeError="FileViewer/FetchControllerModeError",e.FetchBestCampaign="FileViewer/FetchBestCampaign",e.SetBestCampaign="FileViewer/SetBestCampaign",e.SetDocClassification="FileViewer/SetDocClassification",e.OverflowZoomOn="FileViewer/OverflowZoomOn",e.OverflowZoomOff="FileViewer/OverflowZoomOff"})(t.Actions||(t.Actions={}))})),define("modules/clean/react/file_viewer/data/utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isUserOwnerOfFile=function(e,t){return e&&t&&e.home_ns_id===t.ns_id}})),define("modules/clean/react/file_viewer/file_preview_event_emitter",["require","exports","tslib","eventemitter3"],(function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),t.filePreviewEventEmitter=new r.default})),define("modules/clean/react/file_viewer/logging",["require","exports","modules/clean/react/file_viewer/models","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/file_viewer/constants"],(function(e,t,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logUserAction=function(e,t,i){void 0===i&&(i={}),null!=n.FilePreviewSession.currentSession&&r.filePreviewEventEmitter.emit(a.EventType.FilePreviewUserAction,n.FilePreviewSession.currentSession,e,t,i)},t.wrapToolbarActionWithLogging=function(e,n){return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=e.apply(void 0,r);return t.logUserAction(n,a.UserActionContext.Toolbar),o}},t.wrapKeyboardActionWithLogging=function(e,n){return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=e.apply(void 0,r);return t.logUserAction(n,a.UserActionContext.Keyboard),o}}})),define("modules/clean/react/file_viewer/models",["require","exports","tslib","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/previews/constants","modules/clean/uuid","modules/clean/web_timing_logger","modules/core/browser","modules/core/browser_detection","modules/core/exception"],(function(e,t,n,r,a,i,o,s,c,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),c=n.__importStar(c),l=n.__importStar(l);var d={};d[r.EventType.FilePreviewAttemptStarted]=null,d[r.EventType.FilePreviewSupportConfirmed]=r.EventType.FilePreviewAttemptStarted,d[r.EventType.FilePreviewSupportDenied]=r.EventType.FilePreviewAttemptStarted,d[r.EventType.FilePreviewDownloadAttempted]=r.EventType.FilePreviewSupportConfirmed,d[r.EventType.FilePreviewDownloadSucceeded]=r.EventType.FilePreviewDownloadAttempted,d[r.EventType.FilePreviewDownloadFailed]=r.EventType.FilePreviewDownloadAttempted,d[r.EventType.FilePreviewRenderSucceeded]=r.EventType.FilePreviewDownloadSucceeded,d[r.EventType.FilePreviewRenderFailed]=r.EventType.FilePreviewDownloadSucceeded;var m=(function(){function e(e){this.id=e||o.UUID.v4({allowInsecure:!0}),this.deviceType=this._deviceTypeString()}return e.prototype._deviceTypeString=function(){return u.is_supported_mobile_browser()?"mobile":u.is_tablet()?"tablet":"desktop"},e.currentSession=null,e})();t.FileViewerSession=m;var p=(function(){function e(e){var t=e.id,n=e.fileViewerSession,r=e.file,a=e.previewType,i=e.sourceContext,s=e.sourceAction;this.passwordNeeded=!1,l.assert(!!n,"FileViewerSession required"),l.assert(!!r,"File required"),this.id=t||o.UUID.v4({allowInsecure:!0}),this.fileViewerSession=n,this.file=r,this.previewType=a,this.sourceContext=i,this.sourceAction=s,this.previewTimeline={},this.lastEvent=null}return e.prototype.recordEvent=function(e,t){if(void 0===t&&(t={}),!(t instanceof Object))throw new Error("extra param of recordEvent should be an object.");this.isEventInTimeline(e)||d.hasOwnProperty(e)&&this.lastEvent!==d[e]||(this.addToTimeline(e),a.filePreviewEventEmitter.emit(e,this,t),this.lastEvent=e)},e.prototype.markPrimaryEvent=function(){var e;e=window._timingData&&window._timingData.tti?window._timingData.tti.getTime():c.now(),this.primaryMarkTs||(this.primaryMarkTs=e)},e.prototype.timeToPrimaryMark=function(){return this.timeToMark(this.primaryMarkTs)},e.prototype.timeToMark=function(e){if(void 0!==e)switch(this.sourceAction){default:return;case i.PreviewSourceAction.Visit:var t=s.start_time();return void 0!==t?e-t:void 0;case i.PreviewSourceAction.Click:var n=this.previewTimeline[r.EventType.FilePreviewAttemptStarted];if(!n)return;var a=n.timestamp;if(void 0===a)return;return e-a}},e.prototype.isEventInTimeline=function(e){return e in this.previewTimeline},e.prototype.addToTimeline=function(e){this.previewTimeline[e]={timestamp:c.now()}},e.currentSession=null,e})();t.FilePreviewSession=p})),define("modules/clean/react/file_viewer/open_button/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.DOWNLOAD=0]="DOWNLOAD",e[e.UNITY_FILE=1]="UNITY_FILE",e[e.UNITY_FOLDER=2]="UNITY_FOLDER",e[e.OPEN_WITH=3]="OPEN_WITH",e[e.OPEN_IN_PAPER=4]="OPEN_IN_PAPER",e[e.APP_ACTION=5]="APP_ACTION",e[e.PREPARE_FOR_SIGNATURE=6]="PREPARE_FOR_SIGNATURE",e[e.SHARE_TO_SLACK=7]="SHARE_TO_SLACK",e[e.PRESENT_IN_ZOOM=8]="PRESENT_IN_ZOOM",e[e.SHARE_TO_TRELLO=9]="SHARE_TO_TRELLO",e[e.INVITE_VIA_EMAIL=10]="INVITE_VIA_EMAIL",e[e.OPEN_WITH_CLOUD_DOC=11]="OPEN_WITH_CLOUD_DOC",e[e.OPEN_MORE_APPS=12]="OPEN_MORE_APPS",e[e.OPEN_ADD_APPS=13]="OPEN_ADD_APPS"})(t.OpenButtonAction||(t.OpenButtonAction={}))})),define("modules/clean/react/file_viewer/prompt/campaign_api",["require","exports","modules/clean/api_v2/user_client"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchBestCampaigns=function(e,t){var r={client_context:{platform:"web",locations:["targeted_bubble"],ref_page:["preview","file_viewer"],display_context:"fv_preview_type="+t}};return(new n.UserApiV2Client).ns("prompt").rpc("get_best_campaigns",r,{subjectUserId:e})}})),define("modules/clean/react/location/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e,t){void 0===t&&(t={}),this.path=e,this.query=t}return e.fromURI=function(t){return new e(t.getPath(),t.getQuery())},e})();t.Location=n})),define("modules/clean/react/size_class/size_class",["require","exports","tslib","react","classnames","hoist-non-react-statics","spectrum/match","modules/clean/react/size_class/constants","modules/clean/react/helpers"],(function(e,t,n,r,a,i,o,s,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),a=n.__importDefault(a),i=n.__importDefault(i),t.SizeClass=s.SizeClass,t.withSizeClass=function(e,t){void 0===t&&(t={});var u=(function(i){function u(t){var n=i.call(this,t)||this;return n.displayName="WithSizeClass("+c.getDisplayName(e),n.onMatchSmall=function(){return n.setState({sizeClass:s.SizeClass.Small})},n.onMatchMedium=function(){return n.setState({sizeClass:s.SizeClass.Medium})},n.onMatchLarge=function(){return n.setState({sizeClass:s.SizeClass.Large})},n.onMatchExtraLarge=function(){return n.setState({sizeClass:s.SizeClass.ExtraLarge})},window.matchMedia(s.MEDIA_SIZE_CLASS_EXTRA_LARGE).matches?n.state={sizeClass:s.SizeClass.ExtraLarge}:window.matchMedia(s.MEDIA_SIZE_CLASS_LARGE).matches?n.state={sizeClass:s.SizeClass.Large}:window.matchMedia(s.MEDIA_SIZE_CLASS_MEDIUM).matches?n.state={sizeClass:s.SizeClass.Medium}:n.state={sizeClass:s.SizeClass.Small},n}return n.__extends(u,i),u.prototype.render=function(){var i,c=t.isResponsiveEnabled,u=t.responsiveClassName,l=void 0===u?"":u,d=!c||c();return r.default.createElement("div",{className:a.default((i={},i[l]=d,i))},r.default.createElement(o.Match,{media:s.MEDIA_SIZE_CLASS_SMALL,onMatch:this.onMatchSmall}),r.default.createElement(o.Match,{media:s.MEDIA_SIZE_CLASS_MEDIUM,onMatch:this.onMatchMedium}),r.default.createElement(o.Match,{media:s.MEDIA_SIZE_CLASS_LARGE,onMatch:this.onMatchLarge}),r.default.createElement(o.Match,{media:s.MEDIA_SIZE_CLASS_EXTRA_LARGE,onMatch:this.onMatchExtraLarge}),r.default.createElement(e,n.__assign({},this.props,{sizeClass:d?this.state.sizeClass:s.SizeClass.Large})))},u})(r.default.Component);return i.default(u,e)}})),define("modules/clean/react/size_class/utils",["require","exports","modules/clean/react/size_class/constants"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSmallerThanLarge=function(e){return e!==n.SizeClass.Large&&e!==n.SizeClass.ExtraLarge}})),define("modules/clean/react/watermarking/drawing",["require","exports"],(function(e,t){"use strict";function n(e,t,n,r,a){void 0===a&&(a=!1),e.save(),e.font=n+"px "+r;var i=e.measureText(t);return e.restore(),a?{width:i.width,height:i.actualBoundingBoxAscent+i.actualBoundingBoxDescent||n}:{width:i.width,height:i.fontBoundingBoxAscent+i.fontBoundingBoxDescent||n}}Object.defineProperty(t,"__esModule",{value:!0}),t.drawTextTile=function(e,t,r,a,i,o){var s=document.createElement("canvas"),c=s.getContext("2d");if(!c)throw new Error("Cannot draw on canvas");var u=n(c,e,t,r),l=u.width,d=u.height;s.width=Math.abs(l*Math.cos(o))+Math.abs(d*Math.sin(o)),s.height=Math.abs(l*Math.sin(o))+Math.abs(d*Math.cos(o)),c.font=t+"px "+r,c.globalAlpha=i,c.fillStyle=a,c.textBaseline="bottom";var m=0,p=s.height;o<.5*Math.PI?m=d*Math.sin(o):o<Math.PI?(m=d*Math.sin(o)-l*Math.cos(o),p+=d*Math.cos(o)):o<1.5*Math.PI?(m=-l*Math.cos(o),p=0):p+=l*Math.sin(o),c.translate(m,p),c.rotate(-o),c.fillText(e,0,0);var _=n(c,e,t,r,!0),g=_.width;return{canvas:s,actualUnrotatedHeight:_.height,actualUnrotatedWidth:g}},t.drawImageTile=function(e,t,n,r){var a=document.createElement("canvas"),i=a.getContext("2d");if(!i)throw new Error("Cannot draw on canvas");var o=r||0,s=e.width*t,c=e.height*t;a.width=Math.round(Math.abs(s*Math.cos(o))+Math.abs(c*Math.sin(o))),a.height=Math.round(Math.abs(s*Math.sin(o))+Math.abs(c*Math.cos(o)));var u=0,l=0;return o<.5*Math.PI?l=s*Math.sin(o):o<Math.PI?(u=-s*Math.cos(o),l=s*Math.sin(o)-c*Math.cos(o)):o<1.5*Math.PI?(u=-s*Math.cos(o)-c*Math.sin(o),l=-c*Math.cos(o)):u=-c*Math.sin(o),i.globalAlpha=n,i.translate(u,l),i.rotate(-o),i.drawImage(e,0,0,s,c),{canvas:a,actualUnrotatedHeight:c,actualUnrotatedWidth:s}}})),define("modules/clean/react/watermarking/selectors",["require","exports","tslib","reselect","external/lodash","modules/clean/react/watermarking/types","modules/clean/react/watermarking/utils","modules/clean/react/watermarking/drawing","modules/clean/react/file_viewer/data/selectors"],(function(e,t,n,r,a,i,o,s,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),t.getWatermarkState=function(e){return c.getFileViewerState(e).watermark},t.getWatermarkTilingFunc=r.createSelector(t.getWatermarkState,(function(e){return a.memoize((function(t){var n=i.getWatermarkingOptions(e),r=n.angle,a=n.opacity,c=n.size,u=r%360,l=r/180*Math.PI,d=l%(Math.PI/2),m=(function(n){if(e.mode===i.WatermarkingMode.TEXT){var r=e.textWatermarkingOptions,u=r.color,l=r.fontFamily,d=r.text;return s.drawTextTile(d,c*t,l,u,a/100,n)}var m=e.imageWatermarkingOptions.image;if(!m)throw new o.WatermarkingError(o.WatermarkingError.TILE_NO_INPUT);return s.drawImageTile(m,c*t,a/100,n)})(l),p=m.canvas,_=m.actualUnrotatedHeight,g=m.actualUnrotatedWidth,f=Math.max(_,g),v=f/2,h=f/2;e.mode===i.WatermarkingMode.TEXT&&(v=2*_,h=e.textWatermarkingOptions.lineHeight*_);var S=g+v,b=_+h,w=0,y=0,T=0;return u%180==0?(w=S,y=b,T=v/-1.2):u%180==90?(w=b,y=S):u>0&&u<90||u>180&&u<270?(w=b/Math.sin(d),y=S*Math.sin(d),T=-S*Math.cos(d)):(u>90&&u<180||u>270&&u<360)&&(w=b/Math.cos(d),y=S*Math.cos(d),T=S*Math.sin(d)),{canvas:p,width:p.width,height:p.height,distanceX:w,distanceY:y,startX:-p.width/2,startY:-p.height/2,offsetXPerRow:T,offsetYPerCol:0}}))}))})),define("modules/clean/react/watermarking/types",["require","exports"],(function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.TEXT="text",e.IMAGE="image"})(n=t.WatermarkingMode||(t.WatermarkingMode={})),(function(e){e.REPEAT="REPEAT",e.CENTER="CENTER",e.NORTHWEST="NORTHWEST",e.NORTHEAST="NORTHEAST",e.SOUTHEAST="SOUTHEAST",e.SOUTHWEST="SOUTHWEST"})(t.WatermarkPosition||(t.WatermarkPosition={})),t.getWatermarkingOptions=function(e){return e.mode===n.TEXT?e.textWatermarkingOptions:e.imageWatermarkingOptions}})),define("modules/clean/react/watermarking/utils",["require","exports","tslib","sjcl","external/lodash","modules/constants/file_viewer","modules/clean/i18n/formatters","modules/constants/page_load","modules/clean/file_store/utils","modules/core/i18n","modules/clean/previews/constants","modules/clean/react/watermarking/drawing","modules/clean/react/watermarking/types","modules/clean/storage","modules/core/cookies","modules/core/exception","modules/clean/react/user_metadata/api"],(function(e,t,n,r,a,i,o,s,c,u,l,d,m,p,_,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),a=n.__importStar(a),g=n.__importStar(g);var v=[".pdf",".jpg",".jpeg",".png",".bmp"];t.DEFAULT_SIZES={size:1,minSize:.2,maxSize:5},t.WATERMARKING_LOCAL_STORAGE_KEY="fileviewer_watermarking_data";var h=(function(e){function t(t){var n=e.call(this,t)||this;return n.message=t,n.name="WatermarkingError",n}return n.__extends(t,e),t.TILE_NO_INPUT="Unable to tile: missing text or image",t})(Error);function S(e){return e&&i.WATERMARK_TRIAL_VARIANT_BY_USER_ID?i.WATERMARK_TRIAL_VARIANT_BY_USER_ID[e.id]:""}function b(e){return!t.isWatermarkingEnabled(e)&&["DEACTIVATED_MENU","POPOVER_WM_VALUE_PROPS","POPOVER_PRO_VALUE_PROPS","TOOLTIP_ON_HOVER"].includes(S(e))}function w(e){return new Promise((function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=function(e){n(e)},r.crossOrigin="anonymous",r.src=e}))}function y(e){var t;try{var n=r.codec.utf8String.toBits(_.Cookies.read("__Host-js_csrf"));t=r.encrypt(n,JSON.stringify(e))}catch(e){g.reportException({err:e,severity:g.SEVERITY.NONCRITICAL,tags:["watermarking"]})}return t}t.WatermarkingError=h,t.fileIsWatermarkable=function(e){return!!e&&(c.isBrowseFile(e)&&!e.read_only&&!!e.ext&&v.includes(e.ext.toLowerCase()))},t.isWatermarkingEnabled=function(e){return!!(e&&i.WATERMARKING_BY_USER_ID&&i.WATERMARKING_BY_USER_ID[e.id])},t.allowWatermark=function(e,n){return t.isWatermarkingEnabled(n)&&t.fileIsWatermarkable(e)},t.getWatermarkTrialVariant=S,t.allowWatermarkTrial=b,t.allowWatermarkOrTrial=function(e,n){return t.allowWatermark(e,n)||b(n)},t.getDefaultText=function(e){if(!e)return"DRAFT";var t=(0,o.createFormatters(s.USER_LOCALE,{}).formatDate)(new Date,{});return e.display_name+" | "+t},t.getImageDefaultSizes=function(e,n){if(!e||!n)return t.DEFAULT_SIZES;var r=e.width/n.width,a=e.height/n.height,i=Math.max(r,a);if(i*t.DEFAULT_SIZES.maxSize<=.9)return t.DEFAULT_SIZES;var o=.9/i;return{size:o/5,minSize:o/25,maxSize:o}},t.DEFAULT_WATERMARKING_STATE={mode:m.WatermarkingMode.TEXT,textWatermarkingOptions:{angle:45,color:"black",opacity:30,fontFamily:"Helvetica, sans-serif",size:20,minSize:5,maxSize:200,lineHeight:3,text:"DRAFT",position:m.WatermarkPosition.REPEAT,marginX:40,marginY:40,scale:1},imageWatermarkingOptions:n.__assign({angle:45,opacity:30,position:m.WatermarkPosition.REPEAT,marginX:40,marginY:40,scale:1},t.DEFAULT_SIZES)},t.getWatermarkScale=function(e){return e===l.PreviewType.SsrDoc?300/72:1},t.getWatermarkingLabelText=function(e,t){if(e)return t===l.PreviewType.Image?u.intl.formatMessage({id:"35NidE",defaultMessage:"Watermarking is available on PDFs, PNGs, JPEGs, and BMPs."}):u.intl.formatMessage({id:"HcLjiD",defaultMessage:"Watermarking is available on PDFs and images."})},t.getImageFromURL=w,t.getWatermarkMilestone=function(e){return"M2"},t.setLocalStorageWatermarkingState=function(e,r){return n.__awaiter(this,void 0,void 0,(function(){var a,i;return n.__generator(this,(function(o){if(e&&r){(a=n.__assign(n.__assign({},r),{imageWatermarkingOptions:n.__assign({},r.imageWatermarkingOptions)})).imageWatermarkingOptions.image&&!a.imageWatermarkingOptions.imageAsDataURL&&(a.imageWatermarkingOptions.imageAsDataURL=d.drawImageTile(a.imageWatermarkingOptions.image,1,1).canvas.toDataURL()),delete a.imageWatermarkingOptions.image,i=y(a);try{p.UserLocalStorage.set(e.id,t.WATERMARKING_LOCAL_STORAGE_KEY,i)}catch(n){if(a.imageWatermarkingOptions.imageAsDataURL){delete a.imageWatermarkingOptions.imageAsDataURL,i=y(a);try{p.UserLocalStorage.set(e.id,t.WATERMARKING_LOCAL_STORAGE_KEY,i)}catch(e){g.reportException({err:n,severity:g.SEVERITY.NONCRITICAL,tags:["watermarking"]})}}}}return[2]}))}))},t.getLocalStorageWatermarkingState=function(e){return n.__awaiter(this,void 0,void 0,(function(){var a,i,o,s,c;return n.__generator(this,(function(n){switch(n.label){case 0:if(!(a=p.UserLocalStorage.get(e.id,t.WATERMARKING_LOCAL_STORAGE_KEY)))return[3,5];n.label=1;case 1:return n.trys.push([1,4,,5]),i=r.codec.utf8String.toBits(_.Cookies.read("__Host-js_csrf")),(o=JSON.parse(r.decrypt(i,a))).imageWatermarkingOptions.imageAsDataURL?(s=o.imageWatermarkingOptions,[4,w(o.imageWatermarkingOptions.imageAsDataURL)]):[3,3];case 2:s.image=n.sent(),n.label=3;case 3:return[2,o];case 4:return c=n.sent(),g.reportException({err:c,severity:g.SEVERITY.NONCRITICAL,tags:["watermarking"]}),[3,5];case 5:return[2]}}))}))},t.getUserMetadataTextWatermarkingState=function(e){return n.__awaiter(this,void 0,Promise,(function(){var t,r,i;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,f.getUserMetadata(["TEXT_WATERMARKING_COLOR","TEXT_WATERMARKING_TEXT","TEXT_WATERMARKING_OPACITY","TEXT_WATERMARKING_ANGLE","TEXT_WATERMARKING_POSITION","TEXT_WATERMARKING_SIZE"],e.id)];case 1:return t=n.sent(),r={color:t.TEXT_WATERMARKING_COLOR?t.TEXT_WATERMARKING_COLOR:void 0,text:t.TEXT_WATERMARKING_TEXT,opacity:t.TEXT_WATERMARKING_OPACITY,angle:t.TEXT_WATERMARKING_ANGLE,position:t.TEXT_WATERMARKING_POSITION?t.TEXT_WATERMARKING_POSITION:void 0,size:t.TEXT_WATERMARKING_SIZE},[2,a.omitBy(r,a.isUndefined)];case 2:return i=n.sent(),g.reportException({err:i,severity:g.SEVERITY.NONCRITICAL,tags:["watermarking"]}),[2];case 3:return[2]}}))}))},t.setUserMetadataTextWatermarkingState=function(e,t){var n=t.textWatermarkingOptions;f.setUserMetadata({TEXT_WATERMARKING_COLOR:n.color,TEXT_WATERMARKING_TEXT:n.text,TEXT_WATERMARKING_OPACITY:n.opacity,TEXT_WATERMARKING_ANGLE:n.angle,TEXT_WATERMARKING_POSITION:n.position,TEXT_WATERMARKING_SIZE:n.size},e.id)},t.isOverQuotaError=function(e){return!(!e||"over_quota_error"!==e[".tag"])},t.isFilesystemError=function(e){return!(!e||"filesystem_error"!==e[".tag"])},t.isUnsupportedFileError=function(e){return!(!e||"unsupported_file_error"!==e[".tag"])},t.isUnauthorizedAccessError=function(e){return!(!e||"unauthorized_access"!==e[".tag"])}})),define("modules/clean/react/workflows/markup/fabric_wrapper",["require","exports","tslib","fabric"],(function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(r=n.__importDefault(r)).default.fabric||r.default;t.fabric=a})),define("modules/clean/react/workflows/markup/fabric",["require","exports","tslib","modules/clean/react/workflows/markup/fabric_wrapper","modules/clean/previews/constants","modules/clean/react/workflows/markup/types","modules/clean/api_v2/user_client"],(function(e,t,n,r,a,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.fabric.Object&&(r.fabric.util.object.extend(r.fabric.Object.prototype,{cornerStyle:"circle",cornerColor:"#0052D9",cornerSize:10,cornerStrokeColor:"white",transparentCorners:!1,drawControls:function(e,t){t=t||{};var n=this._calculateCurrentDimensions(),r=n.x,a=n.y,i=t.cornerSize||this.cornerSize,o=-(r+i)/2,s=-(a+i)/2,c=void 0!==t.transparentCorners?t.transparentCorners:this.transparentCorners,u=void 0!==t.hasRotatingPoint?t.hasRotatingPoint:this.hasRotatingPoint,l=c?"stroke":"fill";return e.save(),e.strokeStyle=e.fillStyle=t.cornerColor||this.cornerColor,this.transparentCorners||(e.strokeStyle=t.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(e,t.cornerDashArray||this.cornerDashArray,null),this._drawControl("tl",e,l,o,s,t),this._drawControl("tr",e,l,o+r,s,t),this._drawControl("bl",e,l,o,s+a,t),this._drawControl("br",e,l,o+r,s+a,t),u&&this._drawControl("mtr",e,l,o+r/2,s-this.rotatingPointOffset,t),e.restore(),this},_findTargetCorner:function(e){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var t=e.x,n=e.y;for(var r in this.__corner=0,this.oCoords)if(this.isControlVisible(r)&&("mtr"!==r||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==r&&"mr"!==r&&"mb"!==r&&"ml"!==r)){var a=void 0;switch(r){case"mt":a=this._getHorizontalImageLines(this.oCoords.tl.corner,this.oCoords.tr.corner);break;case"mr":a=this._getVerticalImageLines(this.oCoords.tr.corner,this.oCoords.br.corner);break;case"mb":a=this._getHorizontalImageLines(this.oCoords.bl.corner,this.oCoords.br.corner);break;case"ml":a=this._getVerticalImageLines(this.oCoords.tl.corner,this.oCoords.bl.corner);break;default:a=this._getImageLines(this.oCoords[r].corner)}var i=this._findCrossPoints({x:t,y:n},a);if(0!==i&&i%2==1)return this.__corner=r,r}return!1},_getHorizontalImageLines:function(e,t){return{topline:{o:e.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:e.bl},leftline:{o:e.bl,d:e.tl}}},_getVerticalImageLines:function(e,t){return{topline:{o:e.tl,d:e.tr},rightline:{o:e.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:e.tl}}}}),r.fabric.util.object.extend(r.fabric.Canvas.prototype,{uniScaleKey:null,_getActionFromCorner:function(e,t,n){if(!t||!e)return"drag";switch(t){case"mtr":return"rotate";case"ml":case"mr":return n.shiftKey?"scale":"scaleX";case"mt":case"mb":return n.shiftKey?"scale":"scaleY";default:return"scale"}}})),r.fabric.BaseBrush&&(c(i.MarkupColor.RED_CHERRY),r.fabric.BaseBrush.prototype.width=3);var s={strokeUniform:!0,strokeWidth:3,stroke:"red"};function c(e){r.fabric.BaseBrush&&(r.fabric.BaseBrush.prototype.color=e)}function u(e){return e&&"group"===e.type}function l(e){return e&&"i-text"===e.type}t.addMarkupObject=function(e,t,a){var o;switch(t){case i.MarkupType.TEXT:o=new r.fabric.IText("Text",n.__assign(n.__assign(n.__assign(n.__assign({},s),{fontSize:22}),a),{fill:a.stroke,stroke:void 0}));break;case i.MarkupType.CIRCLE:o=new r.fabric.Circle(n.__assign(n.__assign(n.__assign({},s),{radius:50,fill:void 0}),a));break;case i.MarkupType.RECT:o=new r.fabric.Rect(n.__assign(n.__assign(n.__assign({},s),{width:100,height:100,fill:void 0}),a));break;case i.MarkupType.ARROW:var c=a.left,u=a.top,l=a.stroke,d=[c,u+100,c+100,u],m=180*Math.atan2(100,100)/Math.PI,p=new r.fabric.Triangle(n.__assign(n.__assign({},s),{angle:m,top:d[3],left:d[2]+3,height:15,width:15,originX:"center",originY:"center",stroke:l,fill:l})),_=new r.fabric.Line(d,n.__assign(n.__assign({},s),a));o=new r.fabric.Group([_,p],n.__assign(n.__assign(n.__assign({},s),{lockUniScaling:!0,centeredScaling:!0}),a))}o&&(e.add(o),e.setActiveObject(o))},t.setDrawingMode=function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&"object"==typeof e[n]){var r=e[n].fabric;r&&(r.isDrawingMode=t)}},t.setBaseBrushColor=c,t.disposeCanvas=function(e){for(var t in e)e[t].fabric&&e[t].fabric.dispose()},t.saveMarkup=function(e,t,r,i,s){return n.__awaiter(this,void 0,void 0,(function(){var c,u,l,d,m,p,_,g,f,v,h,S;return n.__generator(this,(function(n){for(d in c=new o.UserApiV2Client,u=[],l=s===a.PreviewType.SsrDoc?300/72:1,i)if(i.hasOwnProperty(d)&&"object"==typeof i[d]&&(m=i[d].scale,p=l/m,_=i[d].fabric))for(g=0,f=_.getObjects();g<f.length;g++)v=f[g],h=v.getBoundingRect(),u.push({".tag":"burn_image",image:v.toDataURL({multiplier:p}).split(",",2).pop(),x:Math.round(h.left/m),y:Math.round(h.top/m),page:Number(d)});return S={path:t,should_overwrite:r,burn_objects:u},[2,c.ns("workflows").rpc("markup_file",S,{subjectUserId:e})]}))}))},t.setOptionsForActiveObjects=function(e,t){e&&(e.getActiveObjects().forEach((function(e){l(e)?e.set(n.__assign(n.__assign({},t),{stroke:void 0,fill:t.stroke||e.fill})):u(e)?e.forEachObject((function(e){return e.set(n.__assign(n.__assign({},t),{fill:t.stroke||e.stroke}))})):!(function(e){return e&&"path"===e.type})(e)?e.set(t):e.set(n.__assign(n.__assign({},t),{fill:void 0}))})),e.renderAll())},t.getStroke=function(e){return l(e)?e.fill:u(e)?e.getObjects().filter((function(e){return"line"===e.type}))[0].stroke:"stroke"in e?e.stroke:void 0},t.getFill=function(e){if((function(e){return e&&"circle"===e.type})(e)||(function(e){return e&&"rect"===e.type})(e))return e.fill}})),define("modules/clean/react/workflows/markup/selectors",["require","exports","modules/clean/react/file_viewer/data/selectors"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMarkupState=function(e){return n.getFileViewerState(e).markup}})),define("modules/clean/react/workflows/markup/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.TEXT=0]="TEXT",e[e.CIRCLE=1]="CIRCLE",e[e.RECT=2]="RECT",e[e.ARROW=3]="ARROW",e[e.FREEFORM=4]="FREEFORM"})(t.MarkupType||(t.MarkupType={})),(function(e){e.STROKE="stroke",e.FILL="fill"})(t.FormatSubmenuEntry||(t.FormatSubmenuEntry={})),(function(e){e.TRANSPARENT="transparent",e.RED_CHERRY="#D62C0B",e.ORANGE_TANGERINE="#FF8E21",e.GREEN="#00864C",e.DARK_BLUE="#005DD6",e.ULTRAVIOLET="#813BF6",e.WHITE="white",e.BLACK="black"})(t.MarkupColor||(t.MarkupColor={}))})),define("modules/clean/react/workflows/markup/utils",["require","exports","modules/constants/file_viewer","modules/clean/file_store/utils","modules/clean/previews/constants","modules/core/i18n","modules/clean/react/workflows/markup/types"],(function(e,t,n,r,a,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=[".pdf",".jpg",".jpeg",".png",".bmp"];t.OFFSET=10,t.DEFAULT_LEFT=100,t.DEFAULT_TOP=100,t.MOVE_DISTANCE_X=1,t.MOVE_DISTANCE_Y=1,t.fileIsMarkupable=function(e){return!!e&&(r.isBrowseFile(e)&&!e.read_only&&!!e.ext&&s.includes(e.ext.toLowerCase()))};t.userCanMarkup=function(){return["M0"].includes(n.FILE_MARKUP)},t.allowMarkup=function(e){return t.userCanMarkup()&&t.fileIsMarkupable(e)},t.getMarkupLabelText=function(e,t){if(e)return t===a.PreviewType.Image?i.intl.formatMessage({id:"4hf7s2",defaultMessage:"Markup is available on PDFs, PNGs, JPEGs, and BMPs."}):i.intl.formatMessage({id:"PSKrse",defaultMessage:"Markup is available on PDFs and images."})},t.getMarkupErrorMessage=function(e){switch(e[".tag"]){case"over_quota_error":return i.intl.formatMessage({id:"ebkvMX",defaultMessage:"Can’t save because your account is full. Upgrade to get more space."});case"filesystem_error":return i.intl.formatMessage({id:"rV+Py+",defaultMessage:"Couldn’t save markup. Refresh the page to try again."});case"unsupported_file_error":return i.intl.formatMessage({id:"9ZczZk",defaultMessage:"Can’t save. Markup isn’t available for this file type."});case"unauthorized_access":return i.intl.formatMessage({id:"+/+p5G",defaultMessage:"You don’t have permission to save to this folder."});default:return i.intl.formatMessage({id:"rV+Py+",defaultMessage:"Couldn’t save markup. Refresh the page to try again."})}},t.DEFAULT_MARKUP_STATE={isDrawingMode:!1,formatSubmenu:[],strokeColor:o.MarkupColor.RED_CHERRY,fillColor:o.MarkupColor.TRANSPARENT}})),define("modules/clean/react/user_metadata/api",["require","exports","modules/clean/api_v2/user_client","modules/clean/react/user_metadata/util"],(function(e,t,n,r){"use strict";function a(e){var t=r.removeEmptyFields(e),n=r.getUserMetadataKeys(t),a={};return n.forEach((function(e){a[e]=JSON.stringify(t[e])})),a}function i(e){var t=r.getUserMetadataKeys(e.metadata),n={};return t.forEach((function(t){var r=JSON.parse(e.metadata[t]);null!=r&&(n[t]=r)})),n}function o(e,t){return(new n.UserApiV2Client).ns("user_metadata").rpc("user_metadata/get",e,{subjectUserId:t})}function s(e,t){return(new n.UserApiV2Client).ns("user_metadata").rpc("user_metadata/set",e,{subjectUserId:t})}Object.defineProperty(t,"__esModule",{value:!0}),t.getUserMetadata=function(e,t){return o({metadata:e},t).then(i)},t.setUserMetadata=function(e,t){return s({metadata:a(e)},t).then(i)},t.prepareUserMetadataSetArg=a,t.processUserMetadataResult=i,t.fetchUserMetadata=o,t.mutateUserMetadata=s})),define("modules/clean/react/user_metadata/util",["require","exports"],(function(e,t){"use strict";function n(e){return Object.keys(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.pickMetadata=function(e,t){var n={};return e.forEach((function(e){n[e]=t[e]})),n},t.removeEmptyFields=function(e){var t=n(e),r={};return t.forEach((function(t){null!=e[t]&&(r[t]=e[t])})),r},t.getUserMetadataKeys=n})),define("modules/clean/react/previews/preview_toolbar_button",["require","exports","tslib","classnames","react","modules/clean/react/sprite","modules/clean/static_urls","spectrum/icon_document","spectrum/tooltip"],(function(e,t,n,r,a,i,o,s,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),a=n.__importDefault(a),t.PreviewToolbarButton=function(e){var t=e.className,n=e["data-test"],u=e.disabled,l=e.iconName,d=e.onClick,m=e.spriteGroup,p=e.spriteName,_=e.spectrumIconName,g=e.tooltip;return a.default.createElement("div",{className:r.default(t,"toolbar-button-entry"),"data-test":n},a.default.createElement(c.Tooltip,{positioning:"above",positionOffset:24,tooltipContent:g},a.default.createElement("button",{className:t+"-button","aria-label":g,onClick:d},void 0!==l?a.default.createElement("img",{src:o.static_url("/static/images/previews/toolbar/"+l+".svg"),alt:g,className:r.default({disabled:u})}):void 0!==p?a.default.createElement(i.Sprite,{group:m,name:p,alt:g,className:r.default({disabled:u})}):a.default.createElement(s.IconDocument,{name:_}))))}})),define("spectrum/icon_document",["require","exports","tslib","react","spectrum/icon_templates/stateless","spectrum/svg_icon_bundle","spectrum/icon_document/bundle"],(function(e,t,n,r,a,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),t.ICONS=o.ICONS,t.IconDocument=function(e){var t=e.name,n=r.createElement(i.SvgIconBundle,{focusable:"false",icon:o.ICONS[t]});return r.createElement(a.Component,Object.assign({icon:n},e))},t.IconDocument.displayName="IconDocument"})),define("spectrum/icon_document/bundle",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICONS=JSON.parse('\n    {"date-small":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#000\\" fill-rule=\\"nonzero\\"><path d=\\"M4 4h16v16H4V4zm2 2v12h12V6H6z\\"></path><path d=\\"M5 8h14v2H5zM7 2h2v4H7zM15 2h2v4h-2z\\"></path></g></g>"},"date":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#000\\" fill-rule=\\"nonzero\\"><path d=\\"M6 6h20v20H6V6zm2 2v16h16V8H8z\\"></path><path d=\\"M7 11h18v2H7zM11 4h2v4h-2zM19 4h2v4h-2z\\"></path></g></g>"},"signature-small":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#000\\" fill-rule=\\"nonzero\\"><path d=\\"M1 18h22v1H1z\\"></path><path d=\\"M10.874 17.262c-1.33 1.046-1.25 2.246-.297 2.723 1.076.537 2.438-.321 3.206-2.953.226-.774.42-1.509.583-2.205-1.06.632-2.251 1.46-3.492 2.435zm4.589.26c-1.044 3.578-3.487 5.118-5.668 4.028-2.131-1.065-2.317-3.844-.003-5.664 1.857-1.46 3.565-2.6 5.014-3.317.634-4.207-.218-6.501-2.436-6.681-1.374-.111-1.993.459-2.027 1.713-.041 1.48.799 3.57 2.34 5.61l-1.397 1.054c-1.76-2.33-2.746-4.782-2.693-6.713.062-2.246 1.534-3.602 3.918-3.408 3.355.272 4.634 3.065 4.144 7.711 1.236-.31 2.137-.102 2.578.742.211.404.28.842.24 1.308a3.4 3.4 0 0 1-.025.205c1.118-.989 1.885-1.388 2.896-1.103.22.063.432.163.632.299l-.986 1.446a.42.42 0 0 0-.121-.06c-.223-.063-.618.152-1.332.792l-.42.379c-.17.151-.308.267-.442.37-.42.32-.786.5-1.217.5-.758 0-1.248-.545-1.188-1.264a2.4 2.4 0 0 1 .12-.543c.034-.105.181-.524.157-.454.11-.32.166-.532.182-.719a.652.652 0 0 0-.037-.325c.02.04.003.044-.143.053-.287.018-.69.127-1.183.324a38.652 38.652 0 0 1-.903 3.717zM1.381 11.619L2.62 10.38l4.95 4.95-1.238 1.237z\\"></path><path d=\\"M6.377 10.382l1.238 1.236-4.948 4.952-1.238-1.237z\\"></path></g></g>"},"signature":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#000\\" fill-rule=\\"nonzero\\"><path d=\\"M3 24h26v1H3z\\"></path><path d=\\"M12.5 23.31c-1.983 1.56-1.857 3.437-.376 4.177 1.643.821 3.682-.464 4.79-4.26.37-1.271.68-2.47.931-3.594-1.6.917-3.43 2.172-5.345 3.678zm6.334.476c-1.423 4.878-4.698 6.942-7.604 5.49-2.828-1.413-3.075-5.094.034-7.538 2.627-2.065 5.04-3.666 7.065-4.65.94-6.089-.293-9.445-3.584-9.712-2.047-.166-3.02.73-3.072 2.607-.058 2.126 1.133 5.09 3.313 7.976l-1.595 1.206c-2.431-3.218-3.79-6.597-3.717-9.237.082-3.012 2.03-4.805 5.233-4.546 4.596.373 6.315 4.295 5.547 10.86 1.785-.52 3.073-.3 3.663.83.273.523.363 1.094.31 1.705a4.971 4.971 0 0 1-.175.925c.12-.105.252-.223.4-.356 1.565-1.402 2.605-1.969 3.947-1.59.285.08.558.21.818.387l-1.126 1.652a.807.807 0 0 0-.235-.114c-.414-.117-1.015.21-2.07 1.155-.07.063-.47.426-.586.529a10.64 10.64 0 0 1-.604.506c-.55.42-1.024.653-1.565.653-.928 0-1.51-.649-1.437-1.524.018-.219.07-.436.158-.71.046-.143.25-.725.217-.63.16-.462.24-.774.265-1.057.023-.255-.008-.449-.09-.605-.063-.122-.828-.083-2.231.498-.3 1.634-.728 3.4-1.279 5.29z\\"></path><path d=\\"M8.293 14.294l1.415 1.414-4.997 5-1.414-1.414z\\"></path><path d=\\"M3.297 15.708l1.414-1.414 5 5-1.414 1.414z\\"></path></g></g>"},"text-small":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#000\\" fill-rule=\\"nonzero\\"><path d=\\"M4 4h16v16H4V4zm2 2v12h12V6H6z\\"></path><path d=\\"M8 8h8v2H8z\\"></path><path d=\\"M11 9h2v7h-2z\\"></path></g></g>"},"text":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#000\\" fill-rule=\\"nonzero\\"><path d=\\"M6 6h20v20H6V6zm2 2v16h16V8H8z\\"></path><path d=\\"M11 11h10v2H11zM15 13h2v8h-2z\\"></path></g></g>"}}\n  ')}));
//# sourceMappingURL=pkg-shared_link_core.min.js-vflQjWWUK.map